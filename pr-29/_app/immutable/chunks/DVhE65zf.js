import{Q as J,X as ue,a1 as L,T as k,av as de,Y as Te,f as C,m as xe,_ as Ie,$ as Ae,a0 as se,a2 as H,U as D,ag as ve,aJ as Ce,an as re,K as Ne,R as X,W as Oe,a4 as Me,ae as ie,aH as pe,i as De,aL as me,M as ge,O as Le,aM as he,aN as He,aO as Y,aD as K,aP as Re,aQ as Be,aG as $e,N as Pe,aR as _e,q as Se,aS as Ue,aT as Je,j as qe,Z as Ye,aU as ze,az as Ge,e as Ve,d as We,aV as Xe,au as ye,aW as Ke,a3 as O,aX as R,aY as Qe,C as Ze,G as je,H as z,J as $,I as P,F as ea}from"./DyJ43TGI.js";import{b as aa,f as be,a as M,s as ta,e as sa,t as G}from"./BESELRjb.js";import{i as ra}from"./JMgyEzd3.js";import{s as ia,i as V,a as na}from"./CCL4udNy.js";function Oa(a,e){return e}function la(a,e,t){for(var s=[],n=e.length,i=0;i<n;i++)Re(e[i].e,s,!0);Be(s,()=>{var r=s.length===0&&t!==null;if(r){var f=t,o=f.parentNode;$e(o),o.append(f),a.items.clear(),T(a,e[0].prev,e[n-1].next)}for(var u=0;u<n;u++){var c=e[u];r||(a.items.delete(c.k),T(a,c.prev,c.next)),Pe(c.e,!r)}a.first===e[0]&&(a.first=e[0].prev)})}function oa(a,e,t,s,n,i=null){var r=a,f=new Map,o=null,u=(e&_e)!==0,c=(e&he)!==0,S=(e&me)!==0;if(u){var p=a;r=k?L(de(p)):p.appendChild(J())}k&&Te();var v=null,_=xe(()=>{var g=t();return De(g)?g:g==null?[]:pe(g)}),d,l=!0;function m(){fa(h,d,r,e,s),v!==null&&(d.length===0?(v.fragment?(r.before(v.fragment),v.fragment=null):ge(v.effect),y.first=v.effect):Le(v.effect,()=>{v=null}))}var y=ue(()=>{d=C(_);var g=d.length;let x=!1;if(k){var I=Ie(r)===Ae;I!==(g===0)&&(r=se(),L(r),H(!1),x=!0)}for(var b=new Set,F=Ne,w=null,ee=Oe(),N=0;N<g;N+=1){k&&D.nodeType===ve&&D.data===Ce&&(r=D,x=!0,H(!1));var q=d[N],B=s(q,N),E=l?null:f.get(B);E?(c&&re(E.v,q),S?re(E.i,N):E.i=N,ee&&F.skipped_effects.delete(E.e)):(E=ca(l?r:null,w,q,B,N,n,e,t),l&&(E.o=!0,w===null?o=E:w.next=E,w=E),f.set(B,E)),b.add(B)}if(g===0&&i&&!v)if(l)v={fragment:null,effect:X(()=>i(r))};else{var ae=document.createDocumentFragment(),te=J();ae.append(te),v={fragment:ae,effect:X(()=>i(te))}}if(k&&g>0&&L(se()),!l)if(ee){for(const[Ee,ke]of f)b.has(Ee)||F.skipped_effects.add(ke.e);F.oncommit(m),F.ondiscard(()=>{})}else m();x&&H(!0),C(_)}),h={effect:y,items:f,first:o};l=!1,k&&(r=D)}function fa(a,e,t,s,n){var i=(s&Ue)!==0,r=e.length,f=a.items,o=a.first,u,c=null,S,p=[],v=[],_,d,l,m;if(i)for(m=0;m<r;m+=1)_=e[m],d=n(_,m),l=f.get(d),l.a?.measure(),(S??=new Set).add(l);for(m=0;m<r;m+=1){if(_=e[m],d=n(_,m),l=f.get(d),a.first??=l,!l.o){l.o=!0;var y=c?c.next:o;T(a,c,l),T(a,l,y),W(l,y,t),c=l,p=[],v=[],o=c.next;continue}if((l.e.f&Y)!==0&&(ge(l.e),i&&(l.a?.unfix(),(S??=new Set).delete(l))),l!==o){if(u!==void 0&&u.has(l)){if(p.length<v.length){var h=v[0],g;c=h.prev;var x=p[0],I=p[p.length-1];for(g=0;g<p.length;g+=1)W(p[g],h,t);for(g=0;g<v.length;g+=1)u.delete(v[g]);T(a,x.prev,I.next),T(a,c,x),T(a,I,h),o=h,c=I,m-=1,p=[],v=[]}else u.delete(l),W(l,o,t),T(a,l.prev,l.next),T(a,l,c===null?a.first:c.next),T(a,c,l),c=l;continue}for(p=[],v=[];o!==null&&o.k!==d;)(o.e.f&Y)===0&&(u??=new Set).add(o),v.push(o),o=o.next;if(o===null)continue;l=o}p.push(l),c=l,o=l.next}if(o!==null||u!==void 0){for(var b=u===void 0?[]:pe(u);o!==null;)(o.e.f&Y)===0&&b.push(o),o=o.next;var F=b.length;if(F>0){var w=(s&_e)!==0&&r===0?t:null;if(i){for(m=0;m<F;m+=1)b[m].a?.measure();for(m=0;m<F;m+=1)b[m].a?.fix()}la(a,b,w)}}i&&Se(()=>{if(S!==void 0)for(l of S)l.a?.apply()})}function ca(a,e,t,s,n,i,r,f){var o=(r&he)!==0,u=(r&He)===0,c=o?u?Me(t,!1,!1):ie(t):t,S=(r&me)===0?n:ie(n),p={i:S,v:c,k:s,a:null,e:null,o:!1,prev:e,next:null};try{if(a===null){var v=document.createDocumentFragment();v.append(a=J())}return p.e=X(()=>i(a,c,S,f)),e!==null&&(e.next=p),p}finally{}}function W(a,e,t){for(var s=a.next?a.next.e.nodes_start:t,n=e?e.e.nodes_start:t,i=a.e.nodes_start;i!==null&&i!==s;){var r=K(i);n.before(i),i=r}}function T(a,e,t){e===null?(a.first=t,a.effect.first=t&&t.e):(e.e.next&&(e.e.next.prev=null),e.next=t,e.e.next=t&&t.e),t===null?a.effect.last=e&&e.e:(t.e.prev&&(t.e.prev.next=null),t.prev=e,t.e.prev=e&&e.e)}function Ma(a,e){let t=null,s=k;var n;if(k){t=D;for(var i=de(document.head);i!==null&&(i.nodeType!==ve||i.data!==a);)i=K(i);if(i===null)H(!1);else{var r=K(i);i.remove(),L(r)}}k||(n=document.head.appendChild(J()));try{ue(()=>e(n),Je)}finally{s&&(H(!0),L(t))}}function Fe(a){var e,t,s="";if(typeof a=="string"||typeof a=="number")s+=a;else if(typeof a=="object")if(Array.isArray(a)){var n=a.length;for(e=0;e<n;e++)a[e]&&(t=Fe(a[e]))&&(s&&(s+=" "),s+=t)}else for(t in a)a[t]&&(s&&(s+=" "),s+=t);return s}function ua(){for(var a,e,t=0,s="",n=arguments.length;t<n;t++)(a=arguments[t])&&(e=Fe(a))&&(s&&(s+=" "),s+=e);return s}function Da(a){return typeof a=="object"?ua(a):a??""}const ne=[...` 	
\r\f \v\uFEFF`];function da(a,e,t){var s=a==null?"":""+a;if(e&&(s=s?s+" "+e:e),t){for(var n in t)if(t[n])s=s?s+" "+n:n;else if(s.length)for(var i=n.length,r=0;(r=s.indexOf(n,r))>=0;){var f=r+i;(r===0||ne.includes(s[r-1]))&&(f===s.length||ne.includes(s[f]))?s=(r===0?"":s.substring(0,r))+s.substring(f+1):r=f}}return s===""?null:s}function La(a,e){return a==null?null:String(a)}function va(a,e,t,s,n,i){var r=a.__className;if(k||r!==t||r===void 0){var f=da(t,s,i);(!k||f!==a.getAttribute("class"))&&(f==null?a.removeAttribute("class"):a.className=f),a.__className=t}else if(i&&n!==i)for(var o in i){var u=!!i[o];(n==null||u!==!!n[o])&&a.classList.toggle(o,u)}return i}const pa=()=>performance.now(),A={tick:a=>requestAnimationFrame(a),now:()=>pa(),tasks:new Set};function we(){const a=A.now();A.tasks.forEach(e=>{e.c(a)||(A.tasks.delete(e),e.f())}),A.tasks.size!==0&&A.tick(we)}function ma(a){let e;return A.tasks.size===0&&A.tick(we),{promise:new Promise(t=>{A.tasks.add(e={c:a,f:t})}),abort(){A.tasks.delete(e)}}}function U(a,e){ye(()=>{a.dispatchEvent(new CustomEvent(e))})}function ga(a){if(a==="float")return"cssFloat";if(a==="offset")return"cssOffset";if(a.startsWith("--"))return a;const e=a.split("-");return e.length===1?e[0]:e[0]+e.slice(1).map(t=>t[0].toUpperCase()+t.slice(1)).join("")}function le(a){const e={},t=a.split(";");for(const s of t){const[n,i]=s.split(":");if(!n||i===void 0)break;const r=ga(n.trim());e[r]=i.trim()}return e}const ha=a=>a;function _a(a,e,t,s){var n=(a&Xe)!==0,i="both",r,f=e.inert,o=e.style.overflow,u,c;function S(){return ye(()=>r??=t()(e,s?.()??{},{direction:i}))}var p={is_global:n,in(){e.inert=f,U(e,"introstart"),u=Q(e,S(),c,1,()=>{U(e,"introend"),u?.abort(),u=r=void 0,e.style.overflow=o})},out(l){e.inert=!0,U(e,"outrostart"),c=Q(e,S(),u,0,()=>{U(e,"outroend"),l?.()})},stop:()=>{u?.abort(),c?.abort()}},v=qe;if((v.transitions??=[]).push(p),aa){var _=n;if(!_){for(var d=v.parent;d&&(d.f&Ye)!==0;)for(;(d=d.parent)&&(d.f&ze)===0;);_=!d||(d.f&Ge)!==0}_&&Ve(()=>{We(()=>p.in())})}}function Q(a,e,t,s,n){var i=s===1;if(Ke(e)){var r,f=!1;return Se(()=>{if(!f){var l=e({direction:i?"in":"out"});r=Q(a,l,t,s,n)}}),{abort:()=>{f=!0,r?.abort()},deactivate:()=>r.deactivate(),reset:()=>r.reset(),t:()=>r.t()}}if(t?.deactivate(),!e?.duration)return n(),{abort:O,deactivate:O,reset:O,t:()=>s};const{delay:o=0,css:u,tick:c,easing:S=ha}=e;var p=[];if(i&&t===void 0&&(c&&c(0,1),u)){var v=le(u(0,1));p.push(v,v)}var _=()=>1-s,d=a.animate(p,{duration:o,fill:"forwards"});return d.onfinish=()=>{d.cancel();var l=t?.t()??1-s;t?.abort();var m=s-l,y=e.duration*Math.abs(m),h=[];if(y>0){var g=!1;if(u)for(var x=Math.ceil(y/16.666666666666668),I=0;I<=x;I+=1){var b=l+m*S(I/x),F=le(u(b,1-b));h.push(F),g||=F.overflow==="hidden"}g&&(a.style.overflow="hidden"),_=()=>{var w=d.currentTime;return l+m*S(w/y)},c&&ma(()=>{if(d.playState!=="running")return!1;var w=_();return c(w,1-w),!0})}d=a.animate(h,{duration:y,fill:"forwards"}),d.onfinish=()=>{_=()=>s,c?.(s,1-s),n()}},{abort:()=>{d&&(d.cancel(),d.effect=null,d.onfinish=O)},deactivate:()=>{n=O},reset:()=>{s===0&&c?.(1,0)},t:()=>_()}}function Sa(){const{subscribe:a,update:e}=R([]);let t=0;return{subscribe:a,add:(s,n="info",i=3e3)=>{const r=t++,f={id:r,message:s,type:n,duration:i};e(o=>[...o,f]),i>0&&setTimeout(()=>{e(o=>o.filter(u=>u.id!==r))},i)},remove:s=>{e(n=>n.filter(i=>i.id!==s))},clear:()=>{e(()=>[])}}}const oe=Sa(),Z={name:"",class:"",subclass:"",level:1,race:"",background:"",alignment:"",armorClass:10,initiative:0,speed:"30 ft",currentHP:0,maxHP:0,tempHP:0,hitDice:{current:3,max:3},abilities:{strength:10,dexterity:10,constitution:10,intelligence:10,wisdom:10,charisma:10},proficiencyBonus:2,saveProficiencies:{strength:!1,dexterity:!1,constitution:!1,intelligence:!1,wisdom:!1,charisma:!1},skillProficiencies:{acrobatics:!1,animalHandling:!1,arcana:!1,athletics:!1,deception:!1,history:!1,insight:!1,intimidation:!1,investigation:!1,medicine:!1,nature:!1,perception:!1,performance:!1,persuasion:!1,religion:!1,sleightOfHand:!1,stealth:!1,survival:!1},attacks:[],features:"",equipment:"",notes:"",classFeatures:{features:{},spellSlots:[],spellSlotsByLevel:{},preparedSpells:""},racialTraits:[]};function ya(){try{const a=localStorage.getItem("dndCharacter");if(a){const e={...Z,...JSON.parse(a)};return!e.attacks||!Array.isArray(e.attacks)?e.attacks=[]:e.attacks=e.attacks.map(t=>({...t,id:t.id||crypto.randomUUID()})),e.classFeatures?(e.classFeatures.features||(e.classFeatures.features={}),e.classFeatures.spellSlots||(e.classFeatures.spellSlots=[]),e.classFeatures.spellSlotsByLevel||(e.classFeatures.spellSlotsByLevel={}),e.classFeatures.preparedSpells===void 0&&(e.classFeatures.preparedSpells="")):e.classFeatures={features:{},spellSlots:[],spellSlotsByLevel:{},preparedSpells:""},e}}catch(a){console.error("Failed to load character from storage:",a)}return Z}const j=R(ya());j.subscribe(a=>{try{localStorage.setItem("dndCharacter",JSON.stringify(a))}catch(e){console.error("Failed to save character to storage:",e)}});const fe=R(!0);{const a=localStorage.getItem("dndMode");fe.set(a==="edit"),fe.subscribe(e=>{localStorage.setItem("dndMode",e?"edit":"use")})}const Ha=Qe(j,a=>{const e=t=>Math.floor((t-10)/2);return{strength:e(a.abilities.strength),dexterity:e(a.abilities.dexterity),constitution:e(a.abilities.constitution),intelligence:e(a.abilities.intelligence),wisdom:e(a.abilities.wisdom),charisma:e(a.abilities.charisma)}});function ba(a){return Math.ceil(a/4)+1}function Ra(){j.update(a=>(a.proficiencyBonus=ba(a.level),a))}function Ba(a){const e=JSON.stringify(a,null,2),t="data:application/json;charset=utf-8,"+encodeURIComponent(e),s=`${a.name||"character"}_${new Date().toISOString().split("T")[0]}.json`,n=document.createElement("a");n.setAttribute("href",t),n.setAttribute("download",s),n.click()}function $a(a){return new Promise((e,t)=>{const s=new FileReader;s.onload=n=>{try{const i=JSON.parse(n.target?.result),r={...Z,...i};r.attacks&&Array.isArray(r.attacks)&&(r.attacks=r.attacks.map(f=>({...f,id:f.id||crypto.randomUUID()}))),r.classFeatures?(r.classFeatures.features||(r.classFeatures.features={}),r.classFeatures.spellSlots||(r.classFeatures.spellSlots=[]),r.classFeatures.spellSlotsByLevel||(r.classFeatures.spellSlotsByLevel={}),r.classFeatures.preparedSpells===void 0&&(r.classFeatures.preparedSpells="")):r.classFeatures={features:{},spellSlots:[],spellSlotsByLevel:{},preparedSpells:""},e(r)}catch{t(new Error("Invalid character file"))}},s.onerror=()=>t(new Error("Failed to read file")),s.readAsText(a)})}const Pa=R("");function Fa(){try{const a=localStorage.getItem("dndCollapsedStates");if(a){const e=JSON.parse(a);return{characterInfo:e.characterInfo??!1,combatStats:e.combatStats??!1,abilityScores:e.abilityScores??!1,skills:e.skills??!1,attacks:e.attacks??!1,classFeatures:e.classFeatures??!1,racialTraits:e.racialTraits??!1,notes:e.notes??!1,damageInput:e.damageInput??!1}}}catch(a){console.error("Failed to load collapsed states:",a)}return{characterInfo:!1,combatStats:!1,abilityScores:!1,skills:!1,attacks:!1,classFeatures:!1,racialTraits:!1,notes:!1,damageInput:!1}}const wa=R(Fa());wa.subscribe(a=>{try{localStorage.setItem("dndCollapsedStates",JSON.stringify(a))}catch(e){console.error("Failed to save collapsed states:",e)}});function Ea(a){const e=a-1;return e*e*e+1}function ce(a){const e=typeof a=="string"&&a.match(/^\s*(-?[\d.]+)([^\s]*)\s*$/);return e?[parseFloat(e[1]),e[2]||"px"]:[a,"px"]}function ka(a,{delay:e=0,duration:t=400,easing:s=Ea,x:n=0,y:i=0,opacity:r=0}={}){const f=getComputedStyle(a),o=+f.opacity,u=f.transform==="none"?"":f.transform,c=o*(1-r),[S,p]=ce(n),[v,_]=ce(i);return{delay:e,duration:t,easing:s,css:(d,l)=>`
			transform: ${u} translate(${(1-d)*S}${p}, ${(1-d)*v}${_});
			opacity: ${o-c*l}`}}var Ta=be('<div><span class="toast-icon svelte-1cpok13"><!> <!> <!></span> <span class="toast-message svelte-1cpok13"> </span> <button class="toast-close svelte-1cpok13" aria-label="Close notification">×</button></div>'),xa=be('<div class="toast-container svelte-1cpok13"></div>');function Ua(a,e){Ze(e,!1);const t=()=>na(oe,"$toasts",s),[s,n]=ia();ra();var i=xa();oa(i,5,t,r=>r.id,(r,f)=>{var o=Ta(),u=z(o),c=z(u);{var S=h=>{var g=G("✓");M(h,g)};V(c,h=>{C(f).type==="success"&&h(S)})}var p=$(c,2);{var v=h=>{var g=G("✕");M(h,g)};V(p,h=>{C(f).type==="error"&&h(v)})}var _=$(p,2);{var d=h=>{var g=G("ℹ");M(h,g)};V(_,h=>{C(f).type==="info"&&h(d)})}P(u);var l=$(u,2),m=z(l,!0);P(l);var y=$(l,2);P(o),ea(()=>{va(o,1,`toast toast-${C(f).type??""}`,"svelte-1cpok13"),ta(m,C(f).message)}),sa("click",y,()=>oe.remove(C(f).id)),_a(3,o,()=>ka,()=>({y:-50,duration:300})),M(r,o)}),P(i),M(a,i),je(),n()}export{Ua as T,wa as a,va as b,j as c,Ha as d,oa as e,fe as f,Da as g,Ma as h,Oa as i,oe as j,Ba as k,$a as l,Pa as s,La as t,Ra as u};
