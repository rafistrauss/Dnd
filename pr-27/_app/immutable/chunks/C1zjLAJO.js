import{Q as q,X as ue,a1 as U,T as F,av as de,Y as xe,f as I,m as Ae,_ as Ie,$ as Re,a0 as se,a2 as P,U as O,ag as ve,aJ as Ne,an as re,K as Me,R as K,W as Le,a4 as Oe,ae as ie,aH as pe,i as Ue,aL as me,M as ge,O as Pe,aM as he,aN as De,aO as W,aD as Q,aP as He,aQ as $e,aG as Be,N as Je,aR as ye,q as _e,aS as qe,aT as Ge,j as We,Z as ze,aU as Ye,az as Ve,e as Xe,d as Ke,aV as Qe,au as Se,aW as Ze,a3 as M,aX as D,aY as je,C as ea,G as aa,H as z,J as $,I as B,F as ta}from"./DyJ43TGI.js";import{b as sa,f as be,a as L,s as ra,e as ia,t as Y}from"./BESELRjb.js";import{i as na}from"./JMgyEzd3.js";import{s as la,i as V,a as oa}from"./CCL4udNy.js";function Oa(e,a){return a}function fa(e,a,t){for(var s=[],n=a.length,i=0;i<n;i++)He(a[i].e,s,!0);$e(s,()=>{var r=s.length===0&&t!==null;if(r){var f=t,l=f.parentNode;Be(l),l.append(f),e.items.clear(),E(e,a[0].prev,a[n-1].next)}for(var u=0;u<n;u++){var c=a[u];r||(e.items.delete(c.k),E(e,c.prev,c.next)),Je(c.e,!r)}e.first===a[0]&&(e.first=a[0].prev)})}function ca(e,a,t,s,n,i=null){var r=e,f=new Map,l=null,u=(a&ye)!==0,c=(a&he)!==0,_=(a&me)!==0;if(u){var p=e;r=F?U(de(p)):p.appendChild(q())}F&&xe();var v=null,y=Ae(()=>{var g=t();return Ue(g)?g:g==null?[]:pe(g)}),d,o=!0;function m(){ua(h,d,r,a,s),v!==null&&(d.length===0?(v.fragment?(r.before(v.fragment),v.fragment=null):ge(v.effect),S.first=v.effect):Pe(v.effect,()=>{v=null}))}var S=ue(()=>{d=I(y);var g=d.length;let C=!1;if(F){var x=Ie(r)===Re;x!==(g===0)&&(r=se(),U(r),P(!1),C=!0)}for(var b=new Set,T=Me,k=null,ee=Le(),R=0;R<g;R+=1){F&&O.nodeType===ve&&O.data===Ne&&(r=O,C=!0,P(!1));var G=d[R],H=s(G,R),w=o?null:f.get(H);w?(c&&re(w.v,G),_?re(w.i,R):w.i=R,ee&&T.skipped_effects.delete(w.e)):(w=da(o?r:null,k,G,H,R,n,a,t),o&&(w.o=!0,k===null?l=w:k.next=w,k=w),f.set(H,w)),b.add(H)}if(g===0&&i&&!v)if(o)v={fragment:null,effect:K(()=>i(r))};else{var ae=document.createDocumentFragment(),te=q();ae.append(te),v={fragment:ae,effect:K(()=>i(te))}}if(F&&g>0&&U(se()),!o)if(ee){for(const[Ee,Ce]of f)b.has(Ee)||T.skipped_effects.add(Ce.e);T.oncommit(m),T.ondiscard(()=>{})}else m();C&&P(!0),I(y)}),h={effect:S,items:f,first:l};o=!1,F&&(r=O)}function ua(e,a,t,s,n){var i=(s&qe)!==0,r=a.length,f=e.items,l=e.first,u,c=null,_,p=[],v=[],y,d,o,m;if(i)for(m=0;m<r;m+=1)y=a[m],d=n(y,m),o=f.get(d),o.a?.measure(),(_??=new Set).add(o);for(m=0;m<r;m+=1){if(y=a[m],d=n(y,m),o=f.get(d),e.first??=o,!o.o){o.o=!0;var S=c?c.next:l;E(e,c,o),E(e,o,S),X(o,S,t),c=o,p=[],v=[],l=c.next;continue}if((o.e.f&W)!==0&&(ge(o.e),i&&(o.a?.unfix(),(_??=new Set).delete(o))),o!==l){if(u!==void 0&&u.has(o)){if(p.length<v.length){var h=v[0],g;c=h.prev;var C=p[0],x=p[p.length-1];for(g=0;g<p.length;g+=1)X(p[g],h,t);for(g=0;g<v.length;g+=1)u.delete(v[g]);E(e,C.prev,x.next),E(e,c,C),E(e,x,h),l=h,c=x,m-=1,p=[],v=[]}else u.delete(o),X(o,l,t),E(e,o.prev,o.next),E(e,o,c===null?e.first:c.next),E(e,c,o),c=o;continue}for(p=[],v=[];l!==null&&l.k!==d;)(l.e.f&W)===0&&(u??=new Set).add(l),v.push(l),l=l.next;if(l===null)continue;o=l}p.push(o),c=o,l=o.next}if(l!==null||u!==void 0){for(var b=u===void 0?[]:pe(u);l!==null;)(l.e.f&W)===0&&b.push(l),l=l.next;var T=b.length;if(T>0){var k=(s&ye)!==0&&r===0?t:null;if(i){for(m=0;m<T;m+=1)b[m].a?.measure();for(m=0;m<T;m+=1)b[m].a?.fix()}fa(e,b,k)}}i&&_e(()=>{if(_!==void 0)for(o of _)o.a?.apply()})}function da(e,a,t,s,n,i,r,f){var l=(r&he)!==0,u=(r&De)===0,c=l?u?Oe(t,!1,!1):ie(t):t,_=(r&me)===0?n:ie(n),p={i:_,v:c,k:s,a:null,e:null,o:!1,prev:a,next:null};try{if(e===null){var v=document.createDocumentFragment();v.append(e=q())}return p.e=K(()=>i(e,c,_,f)),a!==null&&(a.next=p),p}finally{}}function X(e,a,t){for(var s=e.next?e.next.e.nodes_start:t,n=a?a.e.nodes_start:t,i=e.e.nodes_start;i!==null&&i!==s;){var r=Q(i);n.before(i),i=r}}function E(e,a,t){a===null?(e.first=t,e.effect.first=t&&t.e):(a.e.next&&(a.e.next.prev=null),a.next=t,a.e.next=t&&t.e),t===null?e.effect.last=a&&a.e:(t.e.prev&&(t.e.prev.next=null),t.prev=a,t.e.prev=a&&a.e)}function Ua(e,a){let t=null,s=F;var n;if(F){t=O;for(var i=de(document.head);i!==null&&(i.nodeType!==ve||i.data!==e);)i=Q(i);if(i===null)P(!1);else{var r=Q(i);i.remove(),U(r)}}F||(n=document.head.appendChild(q()));try{ue(()=>a(n),Ge)}finally{s&&(P(!0),U(t))}}function Te(e){var a,t,s="";if(typeof e=="string"||typeof e=="number")s+=e;else if(typeof e=="object")if(Array.isArray(e)){var n=e.length;for(a=0;a<n;a++)e[a]&&(t=Te(e[a]))&&(s&&(s+=" "),s+=t)}else for(t in e)e[t]&&(s&&(s+=" "),s+=t);return s}function va(){for(var e,a,t=0,s="",n=arguments.length;t<n;t++)(e=arguments[t])&&(a=Te(e))&&(s&&(s+=" "),s+=a);return s}function Pa(e){return typeof e=="object"?va(e):e??""}const ne=[...` 	
\r\f \v\uFEFF`];function pa(e,a,t){var s=e==null?"":""+e;if(a&&(s=s?s+" "+a:a),t){for(var n in t)if(t[n])s=s?s+" "+n:n;else if(s.length)for(var i=n.length,r=0;(r=s.indexOf(n,r))>=0;){var f=r+i;(r===0||ne.includes(s[r-1]))&&(f===s.length||ne.includes(s[f]))?s=(r===0?"":s.substring(0,r))+s.substring(f+1):r=f}}return s===""?null:s}function Da(e,a){return e==null?null:String(e)}function ma(e,a,t,s,n,i){var r=e.__className;if(F||r!==t||r===void 0){var f=pa(t,s,i);(!F||f!==e.getAttribute("class"))&&(f==null?e.removeAttribute("class"):e.className=f),e.__className=t}else if(i&&n!==i)for(var l in i){var u=!!i[l];(n==null||u!==!!n[l])&&e.classList.toggle(l,u)}return i}const ga=()=>performance.now(),A={tick:e=>requestAnimationFrame(e),now:()=>ga(),tasks:new Set};function ke(){const e=A.now();A.tasks.forEach(a=>{a.c(e)||(A.tasks.delete(a),a.f())}),A.tasks.size!==0&&A.tick(ke)}function ha(e){let a;return A.tasks.size===0&&A.tick(ke),{promise:new Promise(t=>{A.tasks.add(a={c:e,f:t})}),abort(){A.tasks.delete(a)}}}function J(e,a){Se(()=>{e.dispatchEvent(new CustomEvent(a))})}function ya(e){if(e==="float")return"cssFloat";if(e==="offset")return"cssOffset";if(e.startsWith("--"))return e;const a=e.split("-");return a.length===1?a[0]:a[0]+a.slice(1).map(t=>t[0].toUpperCase()+t.slice(1)).join("")}function le(e){const a={},t=e.split(";");for(const s of t){const[n,i]=s.split(":");if(!n||i===void 0)break;const r=ya(n.trim());a[r]=i.trim()}return a}const _a=e=>e;function Sa(e,a,t,s){var n=(e&Qe)!==0,i="both",r,f=a.inert,l=a.style.overflow,u,c;function _(){return Se(()=>r??=t()(a,s?.()??{},{direction:i}))}var p={is_global:n,in(){a.inert=f,J(a,"introstart"),u=Z(a,_(),c,1,()=>{J(a,"introend"),u?.abort(),u=r=void 0,a.style.overflow=l})},out(o){a.inert=!0,J(a,"outrostart"),c=Z(a,_(),u,0,()=>{J(a,"outroend"),o?.()})},stop:()=>{u?.abort(),c?.abort()}},v=We;if((v.transitions??=[]).push(p),sa){var y=n;if(!y){for(var d=v.parent;d&&(d.f&ze)!==0;)for(;(d=d.parent)&&(d.f&Ye)===0;);y=!d||(d.f&Ve)!==0}y&&Xe(()=>{Ke(()=>p.in())})}}function Z(e,a,t,s,n){var i=s===1;if(Ze(a)){var r,f=!1;return _e(()=>{if(!f){var o=a({direction:i?"in":"out"});r=Z(e,o,t,s,n)}}),{abort:()=>{f=!0,r?.abort()},deactivate:()=>r.deactivate(),reset:()=>r.reset(),t:()=>r.t()}}if(t?.deactivate(),!a?.duration)return n(),{abort:M,deactivate:M,reset:M,t:()=>s};const{delay:l=0,css:u,tick:c,easing:_=_a}=a;var p=[];if(i&&t===void 0&&(c&&c(0,1),u)){var v=le(u(0,1));p.push(v,v)}var y=()=>1-s,d=e.animate(p,{duration:l,fill:"forwards"});return d.onfinish=()=>{d.cancel();var o=t?.t()??1-s;t?.abort();var m=s-o,S=a.duration*Math.abs(m),h=[];if(S>0){var g=!1;if(u)for(var C=Math.ceil(S/16.666666666666668),x=0;x<=C;x+=1){var b=o+m*_(x/C),T=le(u(b,1-b));h.push(T),g||=T.overflow==="hidden"}g&&(e.style.overflow="hidden"),y=()=>{var k=d.currentTime;return o+m*_(k/S)},c&&ha(()=>{if(d.playState!=="running")return!1;var k=y();return c(k,1-k),!0})}d=e.animate(h,{duration:S,fill:"forwards"}),d.onfinish=()=>{y=()=>s,c?.(s,1-s),n()}},{abort:()=>{d&&(d.cancel(),d.effect=null,d.onfinish=M)},deactivate:()=>{n=M},reset:()=>{s===0&&c?.(1,0)},t:()=>y()}}const ba={githyanki:{name:"Githyanki",traits:[{name:"Githyanki Psionics",description:"You know the Mage Hand cantrip, and the hand is invisible when you cast the cantrip with this trait. When you reach 3rd level, you can cast the Jump spell once with this trait, and you regain the ability to do so when you finish a long rest. When you reach 5th level, you can cast the Misty Step spell once with this trait, and you regain the ability to do so when you finish a long rest. Intelligence is your spellcasting ability for these spells. When you cast them with this trait, they don't require components.",spells:[{name:"Mage Hand",level:0,minCharacterLevel:1,notes:"The hand is invisible when cast with this trait"},{name:"Jump",level:1,minCharacterLevel:3,usesPerRest:1,restType:"long"},{name:"Misty Step",level:2,minCharacterLevel:5,usesPerRest:1,restType:"long"}],spellcastingAbility:"intelligence",componentsRequired:!1}]}};function we(e){const a=e.toLowerCase().trim();return ba[a]||null}function Fe(e,a){const t=we(e);if(!t)return[];const s=[];return t.traits.forEach(n=>{n.spells&&n.spells.forEach(i=>{a>=i.minCharacterLevel&&s.push(i)})}),s}function Ta(){const{subscribe:e,update:a}=D([]);let t=0;return{subscribe:e,add:(s,n="info",i=3e3)=>{const r=t++,f={id:r,message:s,type:n,duration:i};a(l=>[...l,f]),i>0&&setTimeout(()=>{a(l=>l.filter(u=>u.id!==r))},i)},remove:s=>{a(n=>n.filter(i=>i.id!==s))},clear:()=>{a(()=>[])}}}const oe=Ta(),j={name:"",class:"",subclass:"",level:1,race:"",background:"",alignment:"",armorClass:10,initiative:0,speed:"30 ft",currentHP:0,maxHP:0,tempHP:0,hitDice:{current:3,max:3},abilities:{strength:10,dexterity:10,constitution:10,intelligence:10,wisdom:10,charisma:10},proficiencyBonus:2,saveProficiencies:{strength:!1,dexterity:!1,constitution:!1,intelligence:!1,wisdom:!1,charisma:!1},skillProficiencies:{acrobatics:!1,animalHandling:!1,arcana:!1,athletics:!1,deception:!1,history:!1,insight:!1,intimidation:!1,investigation:!1,medicine:!1,nature:!1,perception:!1,performance:!1,persuasion:!1,religion:!1,sleightOfHand:!1,stealth:!1,survival:!1},attacks:[],features:"",equipment:"",notes:"",classFeatures:{features:{},spellSlots:[],spellSlotsByLevel:{},preparedSpells:""},racialTraits:{uses:{}}};function ka(){try{const e=localStorage.getItem("dndCharacter");if(e){const a={...j,...JSON.parse(e)};return!a.attacks||!Array.isArray(a.attacks)?a.attacks=[]:a.attacks=a.attacks.map(t=>({...t,id:t.id||crypto.randomUUID()})),a.classFeatures?(a.classFeatures.features||(a.classFeatures.features={}),a.classFeatures.spellSlots||(a.classFeatures.spellSlots=[]),a.classFeatures.spellSlotsByLevel||(a.classFeatures.spellSlotsByLevel={}),a.classFeatures.preparedSpells===void 0&&(a.classFeatures.preparedSpells="")):a.classFeatures={features:{},spellSlots:[],spellSlotsByLevel:{},preparedSpells:""},a.racialTraits||(a.racialTraits={uses:{}}),a}}catch(e){console.error("Failed to load character from storage:",e)}return j}const N=D(ka());N.subscribe(e=>{try{localStorage.setItem("dndCharacter",JSON.stringify(e))}catch(a){console.error("Failed to save character to storage:",a)}});const fe=D(!0);{const e=localStorage.getItem("dndMode");fe.set(e==="edit"),fe.subscribe(a=>{localStorage.setItem("dndMode",a?"edit":"use")})}const Ha=je(N,e=>{const a=t=>Math.floor((t-10)/2);return{strength:a(e.abilities.strength),dexterity:a(e.abilities.dexterity),constitution:a(e.abilities.constitution),intelligence:a(e.abilities.intelligence),wisdom:a(e.abilities.wisdom),charisma:a(e.abilities.charisma)}});function wa(e){return Math.ceil(e/4)+1}function $a(){N.update(e=>(e.proficiencyBonus=wa(e.level),e))}function Ba(e){const a=JSON.stringify(e,null,2),t="data:application/json;charset=utf-8,"+encodeURIComponent(a),s=`${e.name||"character"}_${new Date().toISOString().split("T")[0]}.json`,n=document.createElement("a");n.setAttribute("href",t),n.setAttribute("download",s),n.click()}function Ja(e){return new Promise((a,t)=>{const s=new FileReader;s.onload=n=>{try{const i=JSON.parse(n.target?.result),r={...j,...i};r.attacks&&Array.isArray(r.attacks)&&(r.attacks=r.attacks.map(f=>({...f,id:f.id||crypto.randomUUID()}))),r.classFeatures?(r.classFeatures.features||(r.classFeatures.features={}),r.classFeatures.spellSlots||(r.classFeatures.spellSlots=[]),r.classFeatures.spellSlotsByLevel||(r.classFeatures.spellSlotsByLevel={}),r.classFeatures.preparedSpells===void 0&&(r.classFeatures.preparedSpells="")):r.classFeatures={features:{},spellSlots:[],spellSlotsByLevel:{},preparedSpells:""},r.racialTraits||(r.racialTraits={uses:{}}),a(r)}catch{t(new Error("Invalid character file"))}},s.onerror=()=>t(new Error("Failed to read file")),s.readAsText(e)})}function qa(){N.update(e=>(e.racialTraits||(e.racialTraits={uses:{}}),Fe(e.race,e.level).forEach(t=>{if(t.usesPerRest!==void 0&&t.restType){const s=t.name;e.racialTraits.uses[s]?e.racialTraits.uses[s].maxUses=t.usesPerRest:e.racialTraits.uses[s]={currentUses:t.usesPerRest,maxUses:t.usesPerRest,restType:t.restType}}}),e))}function Ga(e){N.update(a=>(a.racialTraits&&Object.keys(a.racialTraits.uses).forEach(t=>{const s=a.racialTraits.uses[t];(s.restType===e||e==="long"&&s.restType==="short")&&(s.currentUses=s.maxUses)}),a))}function Wa(e){N.update(a=>{if(!a.racialTraits||!a.racialTraits.uses[e])return a;const t=a.racialTraits.uses[e];return t.currentUses>0&&(t.currentUses-=1),a})}function za(){N.update(e=>{if(!e.race)return e;const a=we(e.race);if(!a)return e;const t=Fe(e.race,e.level);return e.attacks||(e.attacks=[]),e.attacks=e.attacks.filter(s=>s.source!=="racial"?!0:t.some(n=>n.name===s.name)),t.forEach(s=>{if(!e.attacks.find(i=>i.source==="racial"&&i.name===s.name)){let i="";for(const f of a.traits)if(f.spells&&f.spells.some(l=>l.name===s.name)){i=f.name;break}const r={id:`racial-${s.name.toLowerCase().replace(/\s+/g,"-")}-${Date.now()}`,name:s.name,bonus:0,damage:"",damageType:"",spellRef:s.name,source:"racial",racialTraitName:i,infoNotes:s.notes||"",notes:s.notes||""};e.attacks.push(r)}}),e})}const Ya=D("");function Fa(){try{const e=localStorage.getItem("dndCollapsedStates");if(e){const a=JSON.parse(e);return{characterInfo:a.characterInfo??!1,combatStats:a.combatStats??!1,abilityScores:a.abilityScores??!1,skills:a.skills??!1,attacks:a.attacks??!1,classFeatures:a.classFeatures??!1,notes:a.notes??!1,damageInput:a.damageInput??!1}}}catch(e){console.error("Failed to load collapsed states:",e)}return{characterInfo:!1,combatStats:!1,abilityScores:!1,skills:!1,attacks:!1,classFeatures:!1,notes:!1,damageInput:!1}}const Ea=D(Fa());Ea.subscribe(e=>{try{localStorage.setItem("dndCollapsedStates",JSON.stringify(e))}catch(a){console.error("Failed to save collapsed states:",a)}});function Ca(e){const a=e-1;return a*a*a+1}function ce(e){const a=typeof e=="string"&&e.match(/^\s*(-?[\d.]+)([^\s]*)\s*$/);return a?[parseFloat(a[1]),a[2]||"px"]:[e,"px"]}function xa(e,{delay:a=0,duration:t=400,easing:s=Ca,x:n=0,y:i=0,opacity:r=0}={}){const f=getComputedStyle(e),l=+f.opacity,u=f.transform==="none"?"":f.transform,c=l*(1-r),[_,p]=ce(n),[v,y]=ce(i);return{delay:a,duration:t,easing:s,css:(d,o)=>`
			transform: ${u} translate(${(1-d)*_}${p}, ${(1-d)*v}${y});
			opacity: ${l-c*o}`}}var Aa=be('<div><span class="toast-icon svelte-1cpok13"><!> <!> <!></span> <span class="toast-message svelte-1cpok13"> </span> <button class="toast-close svelte-1cpok13" aria-label="Close notification">×</button></div>'),Ia=be('<div class="toast-container svelte-1cpok13"></div>');function Va(e,a){ea(a,!1);const t=()=>oa(oe,"$toasts",s),[s,n]=la();na();var i=Ia();ca(i,5,t,r=>r.id,(r,f)=>{var l=Aa(),u=z(l),c=z(u);{var _=h=>{var g=Y("✓");L(h,g)};V(c,h=>{I(f).type==="success"&&h(_)})}var p=$(c,2);{var v=h=>{var g=Y("✕");L(h,g)};V(p,h=>{I(f).type==="error"&&h(v)})}var y=$(p,2);{var d=h=>{var g=Y("ℹ");L(h,g)};V(y,h=>{I(f).type==="info"&&h(d)})}B(u);var o=$(u,2),m=z(o,!0);B(o);var S=$(o,2);B(l),ta(()=>{ma(l,1,`toast toast-${I(f).type??""}`,"svelte-1cpok13"),ra(m,I(f).message)}),ia("click",S,()=>oe.remove(I(f).id)),Sa(3,l,()=>xa,()=>({y:-50,duration:300})),L(r,l)}),B(i),L(e,i),aa(),n()}export{Va as T,N as a,ma as b,Ea as c,Ha as d,ca as e,fe as f,Pa as g,Ua as h,Oa as i,oe as j,Wa as k,qa as l,za as m,Ba as n,Ja as o,Fe as p,Ga as r,Ya as s,Da as t,$a as u};
