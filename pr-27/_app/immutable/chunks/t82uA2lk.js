import{Q as q,X as ue,a1 as U,T as k,av as de,Y as Ee,f as A,m as Ce,_ as xe,$ as Ie,a0 as se,a2 as P,U as L,ag as ve,aJ as Ae,an as re,K as Re,R as K,W as Ne,a4 as Me,ae as ie,aH as pe,i as Oe,aL as me,M as he,O as Le,aM as ge,aN as Ue,aO as W,aD as Q,aP as Pe,aQ as He,aG as De,N as Be,aR as ye,q as _e,aS as $e,aT as Je,j as qe,Z as Ge,aU as We,az as ze,e as Ye,d as Ve,aV as Xe,au as Se,aW as Ke,a3 as M,aX as H,aY as Qe,C as Ze,G as je,H as z,J as B,I as $,F as ea}from"./DyJ43TGI.js";import{b as aa,f as be,a as O,s as ta,e as sa,t as Y}from"./BESELRjb.js";import{i as ra}from"./JMgyEzd3.js";import{s as ia,i as V,a as na}from"./CCL4udNy.js";function La(a,e){return e}function la(a,e,t){for(var s=[],n=e.length,i=0;i<n;i++)Pe(e[i].e,s,!0);He(s,()=>{var r=s.length===0&&t!==null;if(r){var f=t,o=f.parentNode;De(o),o.append(f),a.items.clear(),E(a,e[0].prev,e[n-1].next)}for(var u=0;u<n;u++){var c=e[u];r||(a.items.delete(c.k),E(a,c.prev,c.next)),Be(c.e,!r)}a.first===e[0]&&(a.first=e[0].prev)})}function oa(a,e,t,s,n,i=null){var r=a,f=new Map,o=null,u=(e&ye)!==0,c=(e&ge)!==0,_=(e&me)!==0;if(u){var p=a;r=k?U(de(p)):p.appendChild(q())}k&&Ee();var v=null,y=Ce(()=>{var h=t();return Oe(h)?h:h==null?[]:pe(h)}),d,l=!0;function m(){fa(g,d,r,e,s),v!==null&&(d.length===0?(v.fragment?(r.before(v.fragment),v.fragment=null):he(v.effect),S.first=v.effect):Le(v.effect,()=>{v=null}))}var S=ue(()=>{d=A(y);var h=d.length;let C=!1;if(k){var x=xe(r)===Ie;x!==(h===0)&&(r=se(),U(r),P(!1),C=!0)}for(var b=new Set,T=Re,w=null,ee=Ne(),R=0;R<h;R+=1){k&&L.nodeType===ve&&L.data===Ae&&(r=L,C=!0,P(!1));var G=d[R],D=s(G,R),F=l?null:f.get(D);F?(c&&re(F.v,G),_?re(F.i,R):F.i=R,ee&&T.skipped_effects.delete(F.e)):(F=ca(l?r:null,w,G,D,R,n,e,t),l&&(F.o=!0,w===null?o=F:w.next=F,w=F),f.set(D,F)),b.add(D)}if(h===0&&i&&!v)if(l)v={fragment:null,effect:K(()=>i(r))};else{var ae=document.createDocumentFragment(),te=q();ae.append(te),v={fragment:ae,effect:K(()=>i(te))}}if(k&&h>0&&U(se()),!l)if(ee){for(const[Fe,ke]of f)b.has(Fe)||T.skipped_effects.add(ke.e);T.oncommit(m),T.ondiscard(()=>{})}else m();C&&P(!0),A(y)}),g={effect:S,items:f,first:o};l=!1,k&&(r=L)}function fa(a,e,t,s,n){var i=(s&$e)!==0,r=e.length,f=a.items,o=a.first,u,c=null,_,p=[],v=[],y,d,l,m;if(i)for(m=0;m<r;m+=1)y=e[m],d=n(y,m),l=f.get(d),l.a?.measure(),(_??=new Set).add(l);for(m=0;m<r;m+=1){if(y=e[m],d=n(y,m),l=f.get(d),a.first??=l,!l.o){l.o=!0;var S=c?c.next:o;E(a,c,l),E(a,l,S),X(l,S,t),c=l,p=[],v=[],o=c.next;continue}if((l.e.f&W)!==0&&(he(l.e),i&&(l.a?.unfix(),(_??=new Set).delete(l))),l!==o){if(u!==void 0&&u.has(l)){if(p.length<v.length){var g=v[0],h;c=g.prev;var C=p[0],x=p[p.length-1];for(h=0;h<p.length;h+=1)X(p[h],g,t);for(h=0;h<v.length;h+=1)u.delete(v[h]);E(a,C.prev,x.next),E(a,c,C),E(a,x,g),o=g,c=x,m-=1,p=[],v=[]}else u.delete(l),X(l,o,t),E(a,l.prev,l.next),E(a,l,c===null?a.first:c.next),E(a,c,l),c=l;continue}for(p=[],v=[];o!==null&&o.k!==d;)(o.e.f&W)===0&&(u??=new Set).add(o),v.push(o),o=o.next;if(o===null)continue;l=o}p.push(l),c=l,o=l.next}if(o!==null||u!==void 0){for(var b=u===void 0?[]:pe(u);o!==null;)(o.e.f&W)===0&&b.push(o),o=o.next;var T=b.length;if(T>0){var w=(s&ye)!==0&&r===0?t:null;if(i){for(m=0;m<T;m+=1)b[m].a?.measure();for(m=0;m<T;m+=1)b[m].a?.fix()}la(a,b,w)}}i&&_e(()=>{if(_!==void 0)for(l of _)l.a?.apply()})}function ca(a,e,t,s,n,i,r,f){var o=(r&ge)!==0,u=(r&Ue)===0,c=o?u?Me(t,!1,!1):ie(t):t,_=(r&me)===0?n:ie(n),p={i:_,v:c,k:s,a:null,e:null,o:!1,prev:e,next:null};try{if(a===null){var v=document.createDocumentFragment();v.append(a=q())}return p.e=K(()=>i(a,c,_,f)),e!==null&&(e.next=p),p}finally{}}function X(a,e,t){for(var s=a.next?a.next.e.nodes_start:t,n=e?e.e.nodes_start:t,i=a.e.nodes_start;i!==null&&i!==s;){var r=Q(i);n.before(i),i=r}}function E(a,e,t){e===null?(a.first=t,a.effect.first=t&&t.e):(e.e.next&&(e.e.next.prev=null),e.next=t,e.e.next=t&&t.e),t===null?a.effect.last=e&&e.e:(t.e.prev&&(t.e.prev.next=null),t.prev=e,t.e.prev=e&&e.e)}function Ua(a,e){let t=null,s=k;var n;if(k){t=L;for(var i=de(document.head);i!==null&&(i.nodeType!==ve||i.data!==a);)i=Q(i);if(i===null)P(!1);else{var r=Q(i);i.remove(),U(r)}}k||(n=document.head.appendChild(q()));try{ue(()=>e(n),Je)}finally{s&&(P(!0),U(t))}}function Te(a){var e,t,s="";if(typeof a=="string"||typeof a=="number")s+=a;else if(typeof a=="object")if(Array.isArray(a)){var n=a.length;for(e=0;e<n;e++)a[e]&&(t=Te(a[e]))&&(s&&(s+=" "),s+=t)}else for(t in a)a[t]&&(s&&(s+=" "),s+=t);return s}function ua(){for(var a,e,t=0,s="",n=arguments.length;t<n;t++)(a=arguments[t])&&(e=Te(a))&&(s&&(s+=" "),s+=e);return s}function Pa(a){return typeof a=="object"?ua(a):a??""}const ne=[...` 	
\r\f \v\uFEFF`];function da(a,e,t){var s=a==null?"":""+a;if(e&&(s=s?s+" "+e:e),t){for(var n in t)if(t[n])s=s?s+" "+n:n;else if(s.length)for(var i=n.length,r=0;(r=s.indexOf(n,r))>=0;){var f=r+i;(r===0||ne.includes(s[r-1]))&&(f===s.length||ne.includes(s[f]))?s=(r===0?"":s.substring(0,r))+s.substring(f+1):r=f}}return s===""?null:s}function Ha(a,e){return a==null?null:String(a)}function va(a,e,t,s,n,i){var r=a.__className;if(k||r!==t||r===void 0){var f=da(t,s,i);(!k||f!==a.getAttribute("class"))&&(f==null?a.removeAttribute("class"):a.className=f),a.__className=t}else if(i&&n!==i)for(var o in i){var u=!!i[o];(n==null||u!==!!n[o])&&a.classList.toggle(o,u)}return i}const pa=()=>performance.now(),I={tick:a=>requestAnimationFrame(a),now:()=>pa(),tasks:new Set};function we(){const a=I.now();I.tasks.forEach(e=>{e.c(a)||(I.tasks.delete(e),e.f())}),I.tasks.size!==0&&I.tick(we)}function ma(a){let e;return I.tasks.size===0&&I.tick(we),{promise:new Promise(t=>{I.tasks.add(e={c:a,f:t})}),abort(){I.tasks.delete(e)}}}function J(a,e){Se(()=>{a.dispatchEvent(new CustomEvent(e))})}function ha(a){if(a==="float")return"cssFloat";if(a==="offset")return"cssOffset";if(a.startsWith("--"))return a;const e=a.split("-");return e.length===1?e[0]:e[0]+e.slice(1).map(t=>t[0].toUpperCase()+t.slice(1)).join("")}function le(a){const e={},t=a.split(";");for(const s of t){const[n,i]=s.split(":");if(!n||i===void 0)break;const r=ha(n.trim());e[r]=i.trim()}return e}const ga=a=>a;function ya(a,e,t,s){var n=(a&Xe)!==0,i="both",r,f=e.inert,o=e.style.overflow,u,c;function _(){return Se(()=>r??=t()(e,s?.()??{},{direction:i}))}var p={is_global:n,in(){e.inert=f,J(e,"introstart"),u=Z(e,_(),c,1,()=>{J(e,"introend"),u?.abort(),u=r=void 0,e.style.overflow=o})},out(l){e.inert=!0,J(e,"outrostart"),c=Z(e,_(),u,0,()=>{J(e,"outroend"),l?.()})},stop:()=>{u?.abort(),c?.abort()}},v=qe;if((v.transitions??=[]).push(p),aa){var y=n;if(!y){for(var d=v.parent;d&&(d.f&Ge)!==0;)for(;(d=d.parent)&&(d.f&We)===0;);y=!d||(d.f&ze)!==0}y&&Ye(()=>{Ve(()=>p.in())})}}function Z(a,e,t,s,n){var i=s===1;if(Ke(e)){var r,f=!1;return _e(()=>{if(!f){var l=e({direction:i?"in":"out"});r=Z(a,l,t,s,n)}}),{abort:()=>{f=!0,r?.abort()},deactivate:()=>r.deactivate(),reset:()=>r.reset(),t:()=>r.t()}}if(t?.deactivate(),!e?.duration)return n(),{abort:M,deactivate:M,reset:M,t:()=>s};const{delay:o=0,css:u,tick:c,easing:_=ga}=e;var p=[];if(i&&t===void 0&&(c&&c(0,1),u)){var v=le(u(0,1));p.push(v,v)}var y=()=>1-s,d=a.animate(p,{duration:o,fill:"forwards"});return d.onfinish=()=>{d.cancel();var l=t?.t()??1-s;t?.abort();var m=s-l,S=e.duration*Math.abs(m),g=[];if(S>0){var h=!1;if(u)for(var C=Math.ceil(S/16.666666666666668),x=0;x<=C;x+=1){var b=l+m*_(x/C),T=le(u(b,1-b));g.push(T),h||=T.overflow==="hidden"}h&&(a.style.overflow="hidden"),y=()=>{var w=d.currentTime;return l+m*_(w/S)},c&&ma(()=>{if(d.playState!=="running")return!1;var w=y();return c(w,1-w),!0})}d=a.animate(g,{duration:S,fill:"forwards"}),d.onfinish=()=>{y=()=>s,c?.(s,1-s),n()}},{abort:()=>{d&&(d.cancel(),d.effect=null,d.onfinish=M)},deactivate:()=>{n=M},reset:()=>{s===0&&c?.(1,0)},t:()=>y()}}const _a={githyanki:{name:"Githyanki",traits:[{name:"Githyanki Psionics",description:"You know the Mage Hand cantrip, and the hand is invisible when you cast the cantrip with this trait. When you reach 3rd level, you can cast the Jump spell once with this trait, and you regain the ability to do so when you finish a long rest. When you reach 5th level, you can cast the Misty Step spell once with this trait, and you regain the ability to do so when you finish a long rest. Intelligence is your spellcasting ability for these spells. When you cast them with this trait, they don't require components.",spells:[{name:"Mage Hand",level:0,minCharacterLevel:1,notes:"The hand is invisible when cast with this trait"},{name:"Jump",level:1,minCharacterLevel:3,usesPerRest:1,restType:"long"},{name:"Misty Step",level:2,minCharacterLevel:5,usesPerRest:1,restType:"long"}],spellcastingAbility:"intelligence",componentsRequired:!1}]}};function Sa(a){const e=a.toLowerCase().trim();return _a[e]||null}function ba(a,e){const t=Sa(a);if(!t)return[];const s=[];return t.traits.forEach(n=>{n.spells&&n.spells.forEach(i=>{e>=i.minCharacterLevel&&s.push(i)})}),s}function Ta(){const{subscribe:a,update:e}=H([]);let t=0;return{subscribe:a,add:(s,n="info",i=3e3)=>{const r=t++,f={id:r,message:s,type:n,duration:i};e(o=>[...o,f]),i>0&&setTimeout(()=>{e(o=>o.filter(u=>u.id!==r))},i)},remove:s=>{e(n=>n.filter(i=>i.id!==s))},clear:()=>{e(()=>[])}}}const oe=Ta(),j={name:"",class:"",subclass:"",level:1,race:"",background:"",alignment:"",armorClass:10,initiative:0,speed:"30 ft",currentHP:0,maxHP:0,tempHP:0,hitDice:{current:3,max:3},abilities:{strength:10,dexterity:10,constitution:10,intelligence:10,wisdom:10,charisma:10},proficiencyBonus:2,saveProficiencies:{strength:!1,dexterity:!1,constitution:!1,intelligence:!1,wisdom:!1,charisma:!1},skillProficiencies:{acrobatics:!1,animalHandling:!1,arcana:!1,athletics:!1,deception:!1,history:!1,insight:!1,intimidation:!1,investigation:!1,medicine:!1,nature:!1,perception:!1,performance:!1,persuasion:!1,religion:!1,sleightOfHand:!1,stealth:!1,survival:!1},attacks:[],features:"",equipment:"",notes:"",classFeatures:{features:{},spellSlots:[],spellSlotsByLevel:{},preparedSpells:""},racialTraits:{uses:{}}};function wa(){try{const a=localStorage.getItem("dndCharacter");if(a){const e={...j,...JSON.parse(a)};return!e.attacks||!Array.isArray(e.attacks)?e.attacks=[]:e.attacks=e.attacks.map(t=>({...t,id:t.id||crypto.randomUUID()})),e.classFeatures?(e.classFeatures.features||(e.classFeatures.features={}),e.classFeatures.spellSlots||(e.classFeatures.spellSlots=[]),e.classFeatures.spellSlotsByLevel||(e.classFeatures.spellSlotsByLevel={}),e.classFeatures.preparedSpells===void 0&&(e.classFeatures.preparedSpells="")):e.classFeatures={features:{},spellSlots:[],spellSlotsByLevel:{},preparedSpells:""},e.racialTraits||(e.racialTraits={uses:{}}),e}}catch(a){console.error("Failed to load character from storage:",a)}return j}const N=H(wa());N.subscribe(a=>{try{localStorage.setItem("dndCharacter",JSON.stringify(a))}catch(e){console.error("Failed to save character to storage:",e)}});const fe=H(!0);{const a=localStorage.getItem("dndMode");fe.set(a==="edit"),fe.subscribe(e=>{localStorage.setItem("dndMode",e?"edit":"use")})}const Da=Qe(N,a=>{const e=t=>Math.floor((t-10)/2);return{strength:e(a.abilities.strength),dexterity:e(a.abilities.dexterity),constitution:e(a.abilities.constitution),intelligence:e(a.abilities.intelligence),wisdom:e(a.abilities.wisdom),charisma:e(a.abilities.charisma)}});function Fa(a){return Math.ceil(a/4)+1}function Ba(){N.update(a=>(a.proficiencyBonus=Fa(a.level),a))}function $a(a){const e=JSON.stringify(a,null,2),t="data:application/json;charset=utf-8,"+encodeURIComponent(e),s=`${a.name||"character"}_${new Date().toISOString().split("T")[0]}.json`,n=document.createElement("a");n.setAttribute("href",t),n.setAttribute("download",s),n.click()}function Ja(a){return new Promise((e,t)=>{const s=new FileReader;s.onload=n=>{try{const i=JSON.parse(n.target?.result),r={...j,...i};r.attacks&&Array.isArray(r.attacks)&&(r.attacks=r.attacks.map(f=>({...f,id:f.id||crypto.randomUUID()}))),r.classFeatures?(r.classFeatures.features||(r.classFeatures.features={}),r.classFeatures.spellSlots||(r.classFeatures.spellSlots=[]),r.classFeatures.spellSlotsByLevel||(r.classFeatures.spellSlotsByLevel={}),r.classFeatures.preparedSpells===void 0&&(r.classFeatures.preparedSpells="")):r.classFeatures={features:{},spellSlots:[],spellSlotsByLevel:{},preparedSpells:""},r.racialTraits||(r.racialTraits={uses:{}}),e(r)}catch{t(new Error("Invalid character file"))}},s.onerror=()=>t(new Error("Failed to read file")),s.readAsText(a)})}function qa(){N.update(a=>(a.racialTraits||(a.racialTraits={uses:{}}),ba(a.race,a.level).forEach(t=>{if(t.usesPerRest!==void 0&&t.restType){const s=t.name;a.racialTraits.uses[s]?a.racialTraits.uses[s].maxUses=t.usesPerRest:a.racialTraits.uses[s]={currentUses:t.usesPerRest,maxUses:t.usesPerRest,restType:t.restType}}}),a))}function Ga(a){N.update(e=>(e.racialTraits&&Object.keys(e.racialTraits.uses).forEach(t=>{const s=e.racialTraits.uses[t];(s.restType===a||a==="long"&&s.restType==="short")&&(s.currentUses=s.maxUses)}),e))}function Wa(a){N.update(e=>{if(!e.racialTraits||!e.racialTraits.uses[a])return e;const t=e.racialTraits.uses[a];return t.currentUses>0&&(t.currentUses-=1),e})}const za=H("");function ka(){try{const a=localStorage.getItem("dndCollapsedStates");if(a){const e=JSON.parse(a);return{characterInfo:e.characterInfo??!1,combatStats:e.combatStats??!1,abilityScores:e.abilityScores??!1,skills:e.skills??!1,attacks:e.attacks??!1,classFeatures:e.classFeatures??!1,notes:e.notes??!1,damageInput:e.damageInput??!1}}}catch(a){console.error("Failed to load collapsed states:",a)}return{characterInfo:!1,combatStats:!1,abilityScores:!1,skills:!1,attacks:!1,classFeatures:!1,notes:!1,damageInput:!1}}const Ea=H(ka());Ea.subscribe(a=>{try{localStorage.setItem("dndCollapsedStates",JSON.stringify(a))}catch(e){console.error("Failed to save collapsed states:",e)}});function Ca(a){const e=a-1;return e*e*e+1}function ce(a){const e=typeof a=="string"&&a.match(/^\s*(-?[\d.]+)([^\s]*)\s*$/);return e?[parseFloat(e[1]),e[2]||"px"]:[a,"px"]}function xa(a,{delay:e=0,duration:t=400,easing:s=Ca,x:n=0,y:i=0,opacity:r=0}={}){const f=getComputedStyle(a),o=+f.opacity,u=f.transform==="none"?"":f.transform,c=o*(1-r),[_,p]=ce(n),[v,y]=ce(i);return{delay:e,duration:t,easing:s,css:(d,l)=>`
			transform: ${u} translate(${(1-d)*_}${p}, ${(1-d)*v}${y});
			opacity: ${o-c*l}`}}var Ia=be('<div><span class="toast-icon svelte-1cpok13"><!> <!> <!></span> <span class="toast-message svelte-1cpok13"> </span> <button class="toast-close svelte-1cpok13" aria-label="Close notification">×</button></div>'),Aa=be('<div class="toast-container svelte-1cpok13"></div>');function Ya(a,e){Ze(e,!1);const t=()=>na(oe,"$toasts",s),[s,n]=ia();ra();var i=Aa();oa(i,5,t,r=>r.id,(r,f)=>{var o=Ia(),u=z(o),c=z(u);{var _=g=>{var h=Y("✓");O(g,h)};V(c,g=>{A(f).type==="success"&&g(_)})}var p=B(c,2);{var v=g=>{var h=Y("✕");O(g,h)};V(p,g=>{A(f).type==="error"&&g(v)})}var y=B(p,2);{var d=g=>{var h=Y("ℹ");O(g,h)};V(y,g=>{A(f).type==="info"&&g(d)})}$(u);var l=B(u,2),m=z(l,!0);$(l);var S=B(l,2);$(o),ea(()=>{va(o,1,`toast toast-${A(f).type??""}`,"svelte-1cpok13"),ta(m,A(f).message)}),sa("click",S,()=>oe.remove(A(f).id)),ya(3,o,()=>xa,()=>({y:-50,duration:300})),O(r,o)}),$(i),O(a,i),je(),n()}export{Ya as T,N as a,va as b,Ea as c,Da as d,oa as e,fe as f,Pa as g,Ua as h,La as i,oe as j,qa as k,Sa as l,ba as m,Wa as n,$a as o,Ja as p,Ga as r,za as s,Ha as t,Ba as u};
