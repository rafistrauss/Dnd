import{f as H,a as F,c as at,t as gt}from"../chunks/Cyr8EI15.js";import{i as Ce}from"../chunks/BJ1yDyTj.js";import{a as ct,f as zt,aP as Ft,k as st,h as we,g as qt,U as Jt,z as t,a9 as Fe,V as Wt,W as Vt,X as _t,j as lt,e as Ve,C as Yt,aJ as Xt,au as yt,c as Oe,b as vt,s as Zt,$ as q,am as kt,aH as Et,R as pt,aQ as Lt,aR as Nt,r as Rt,p as Kt,aS as Qt,aT as it,q as ea,aU as ta,i as aa,aV as sa,aW as la,aG as ia,d as ra,a0 as na,aX as oa,aY as ca,aZ as Tt,aN as va,w as h,Z as Mt,a_ as da,E as je,J as o,G as te,I as De,M as l,K as n,a$ as Ye,b0 as Ge,b1 as Pt,a2 as k,F as Pe,b2 as Ke,A as Be,b3 as ua,Y as fa,b4 as pa}from"../chunks/DM0qd9jt.js";import{e as T,s as Q}from"../chunks/DKYd184O.js";import{s as ke,a as Ee,c as re,i as ve,d as Xe,p as Je,b as dt}from"../chunks/6QxiVTJ6.js";import{r as B,a as Ht,s as Ue,b as xt,h as ba}from"../chunks/_Fzwdlkr.js";import{w as Ut,d as ha,c as We,o as ma}from"../chunks/DXHZsIE1.js";import{b as Ze}from"../chunks/C3C3cqOX.js";function He(e,s){return s}function ga(e,s,a){for(var i=[],p=s.length,f=0;f<p;f++)sa(s[f].e,i,!0);la(i,()=>{var r=i.length===0&&a!==null;if(r){var b=a,c=b.parentNode;ia(c),c.append(b),e.items.clear(),Se(e,s[0].prev,s[p-1].next)}for(var _=0;_<p;_++){var m=s[_];r||(e.items.delete(m.k),Se(e,m.prev,m.next)),ra(m.e,!r)}e.first===s[0]&&(e.first=s[0].prev)})}function Ne(e,s,a,i,p,f=null){var r=e,b=new Map,c=null,_=(s&Ft)!==0,m=(s&Lt)!==0,E=(s&Nt)!==0;if(_){var g=e;r=we?st(qt(g)):g.appendChild(ct())}we&&Jt();var x=null,w=Fe(()=>{var $=a();return pt($)?$:$==null?[]:Et($)}),S,v=!0;function d(){_a(A,S,r,s,i),x!==null&&(S.length===0?(x.fragment?(r.before(x.fragment),x.fragment=null):Rt(x.effect),M.first=x.effect):Kt(x.effect,()=>{x=null}))}var M=zt(()=>{S=t(w);var $=S.length;let y=!1;if(we){var N=Wt(r)===Vt;N!==($===0)&&(r=_t(),st(r),lt(!1),y=!0)}for(var L=new Set,z=Oe,P=null,O=Zt(),C=0;C<$;C+=1){we&&Ve.nodeType===Yt&&Ve.data===Xt&&(r=Ve,y=!0,lt(!1));var Z=S[C],Y=i(Z,C),j=v?null:b.get(Y);j?(m&&yt(j.v,Z),E?yt(j.i,C):j.i=C,O&&z.skipped_effects.delete(j.e)):(j=ya(v?r:null,P,Z,Y,C,p,s,a),v&&(j.o=!0,P===null?c=j:P.next=j,P=j),b.set(Y,j)),L.add(Y)}if($===0&&f&&!x)if(v)x={fragment:null,effect:vt(()=>f(r))};else{var V=document.createDocumentFragment(),G=ct();V.append(G),x={fragment:V,effect:vt(()=>f(G))}}if(we&&$>0&&st(_t()),!v)if(O){for(const[J,ne]of b)L.has(J)||z.skipped_effects.add(ne.e);z.oncommit(d),z.ondiscard(()=>{})}else d();y&&lt(!0),t(w)}),A={effect:M,items:b,first:c};v=!1,we&&(r=Ve)}function _a(e,s,a,i,p){var f=(i&ta)!==0,r=s.length,b=e.items,c=e.first,_,m=null,E,g=[],x=[],w,S,v,d;if(f)for(d=0;d<r;d+=1)w=s[d],S=p(w,d),v=b.get(S),v.a?.measure(),(E??=new Set).add(v);for(d=0;d<r;d+=1){if(w=s[d],S=p(w,d),v=b.get(S),e.first??=v,!v.o){v.o=!0;var M=m?m.next:c;Se(e,m,v),Se(e,v,M),rt(v,M,a),m=v,g=[],x=[],c=m.next;continue}if((v.e.f&it)!==0&&(Rt(v.e),f&&(v.a?.unfix(),(E??=new Set).delete(v))),v!==c){if(_!==void 0&&_.has(v)){if(g.length<x.length){var A=x[0],$;m=A.prev;var y=g[0],N=g[g.length-1];for($=0;$<g.length;$+=1)rt(g[$],A,a);for($=0;$<x.length;$+=1)_.delete(x[$]);Se(e,y.prev,N.next),Se(e,m,y),Se(e,N,A),c=A,m=N,d-=1,g=[],x=[]}else _.delete(v),rt(v,c,a),Se(e,v.prev,v.next),Se(e,v,m===null?e.first:m.next),Se(e,m,v),m=v;continue}for(g=[],x=[];c!==null&&c.k!==S;)(c.e.f&it)===0&&(_??=new Set).add(c),x.push(c),c=c.next;if(c===null)continue;v=c}g.push(v),m=v,c=v.next}if(c!==null||_!==void 0){for(var L=_===void 0?[]:Et(_);c!==null;)(c.e.f&it)===0&&L.push(c),c=c.next;var z=L.length;if(z>0){var P=(i&Ft)!==0&&r===0?a:null;if(f){for(d=0;d<z;d+=1)L[d].a?.measure();for(d=0;d<z;d+=1)L[d].a?.fix()}ga(e,L,P)}}f&&ea(()=>{if(E!==void 0)for(v of E)v.a?.apply()})}function ya(e,s,a,i,p,f,r,b){var c=(r&Lt)!==0,_=(r&Qt)===0,m=c?_?q(a,!1,!1):kt(a):a,E=(r&Nt)===0?p:kt(p),g={i:E,v:m,k:i,a:null,e:null,o:!1,prev:s,next:null};try{if(e===null){var x=document.createDocumentFragment();x.append(e=ct())}return g.e=vt(()=>f(e,m,E,b)),s!==null&&(s.next=g),g}finally{}}function rt(e,s,a){for(var i=e.next?e.next.e.nodes_start:a,p=s?s.e.nodes_start:a,f=e.e.nodes_start;f!==null&&f!==i;){var r=aa(f);p.before(f),f=r}}function Se(e,s,a){s===null?(e.first=a,e.effect.first=a&&a.e):(s.e.next&&(s.e.next.prev=null),s.next=a,s.e.next=a&&a.e),a===null?e.effect.last=s&&s.e:(a.e.prev&&(a.e.prev.next=null),a.prev=s,a.e.prev=s&&s.e)}const $t=[...` 	
\r\fÂ \v\uFEFF`];function ka(e,s,a){var i=e==null?"":""+e;if(a){for(var p in a)if(a[p])i=i?i+" "+p:p;else if(i.length)for(var f=p.length,r=0;(r=i.indexOf(p,r))>=0;){var b=r+f;(r===0||$t.includes(i[r-1]))&&(b===i.length||$t.includes(i[b]))?i=(r===0?"":i.substring(0,r))+i.substring(b+1):r=b}}return i===""?null:i}function St(e,s,a,i,p,f){var r=e.__className;if(we||r!==a||r===void 0){var b=ka(a,i,f);(!we||b!==e.getAttribute("class"))&&(b==null?e.removeAttribute("class"):e.className=b),e.__className=a}else if(f&&p!==f)for(var c in f){var _=!!f[c];(p==null||_!==!!p[c])&&e.classList.toggle(c,_)}return f}function Ot(e,s,a=!1){if(e.multiple){if(s==null)return;if(!pt(s))return oa();for(var i of e.options)i.selected=s.includes(wt(i));return}for(i of e.options){var p=wt(i);if(ca(p,s)){i.selected=!0;return}}(!a||s!==void 0)&&(e.selectedIndex=-1)}function xa(e){var s=new MutationObserver(()=>{Ot(e,e.__value)});s.observe(e,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),na(()=>{s.disconnect()})}function wt(e){return"__value"in e?e.__value:e.value}function W(e,s,a=s){var i=new WeakSet;Tt(e,"input",async p=>{var f=p?e.defaultValue:e.value;if(f=nt(e)?ot(f):f,a(f),Oe!==null&&i.add(Oe),await va(),f!==(f=s())){var r=e.selectionStart,b=e.selectionEnd,c=e.value.length;if(e.value=f??"",b!==null){var _=e.value.length;r===b&&b===c&&_>c?(e.selectionStart=_,e.selectionEnd=_):(e.selectionStart=r,e.selectionEnd=Math.min(b,_))}}}),(we&&e.defaultValue!==e.value||h(s)==null&&e.value)&&(a(nt(e)?ot(e.value):e.value),Oe!==null&&i.add(Oe)),Mt(()=>{var p=s();if(e===document.activeElement){var f=da??Oe;if(i.has(f))return}nt(e)&&p===ot(e.value)||e.type==="date"&&!p&&!e.value||p!==e.value&&(e.value=p??"")})}function bt(e,s,a=s){Tt(e,"change",i=>{var p=i?e.defaultChecked:e.checked;a(p)}),(we&&e.defaultChecked!==e.checked||h(s)==null)&&a(e.checked),Mt(()=>{var i=s();e.checked=!!i})}function nt(e){var s=e.type;return s==="number"||s==="range"}function ot(e){return e===""?null:+e}function Gt(e){return function(...s){var a=s[0];return a.stopPropagation(),e?.apply(this,s)}}function Qe(e,s){var a=e.$$events?.[s.type],i=pt(a)?a.slice():a==null?[]:[a];for(var p of i)p.call(this,s)}const ut={name:"",class:"",level:1,race:"",background:"",alignment:"",armorClass:10,initiative:0,speed:"30 ft",currentHP:0,maxHP:0,tempHP:0,hitDice:{current:3,max:3},abilities:{strength:10,dexterity:10,constitution:10,intelligence:10,wisdom:10,charisma:10},proficiencyBonus:2,saveProficiencies:{strength:!1,dexterity:!1,constitution:!1,intelligence:!1,wisdom:!1,charisma:!1},skillProficiencies:{acrobatics:!1,animalHandling:!1,arcana:!1,athletics:!1,deception:!1,history:!1,insight:!1,intimidation:!1,investigation:!1,medicine:!1,nature:!1,perception:!1,performance:!1,persuasion:!1,religion:!1,sleightOfHand:!1,stealth:!1,survival:!1},attacks:[],features:"",equipment:"",notes:"",classFeatures:{features:{},spellSlots:[],preparedSpells:""}};function $a(){try{const e=localStorage.getItem("dndCharacter");if(e){const s={...ut,...JSON.parse(e)};return s.attacks&&Array.isArray(s.attacks)&&(s.attacks=s.attacks.map(a=>({...a,id:a.id||crypto.randomUUID()}))),s.classFeatures?(s.classFeatures.features||(s.classFeatures.features={}),s.classFeatures.spellSlots||(s.classFeatures.spellSlots=[]),s.classFeatures.preparedSpells===void 0&&(s.classFeatures.preparedSpells="")):s.classFeatures={features:{},spellSlots:[],preparedSpells:""},s}}catch(e){console.error("Failed to load character from storage:",e)}return ut}const I=Ut($a());I.subscribe(e=>{try{localStorage.setItem("dndCharacter",JSON.stringify(e))}catch(s){console.error("Failed to save character to storage:",s)}});const et=Ut(!0);{const e=localStorage.getItem("dndMode");et.set(e==="edit"),et.subscribe(s=>{localStorage.setItem("dndMode",s?"edit":"use")})}const ht=ha(I,e=>{const s=a=>Math.floor((a-10)/2);return{strength:s(e.abilities.strength),dexterity:s(e.abilities.dexterity),constitution:s(e.abilities.constitution),intelligence:s(e.abilities.intelligence),wisdom:s(e.abilities.wisdom),charisma:s(e.abilities.charisma)}});function Sa(e){return Math.ceil(e/4)+1}function Bt(){I.update(e=>(e.proficiencyBonus=Sa(e.level),e))}function wa(e){const s=JSON.stringify(e,null,2),a="data:application/json;charset=utf-8,"+encodeURIComponent(s),i=`${e.name||"character"}_${new Date().toISOString().split("T")[0]}.json`,p=document.createElement("a");p.setAttribute("href",a),p.setAttribute("download",i),p.click()}function Ca(e){return new Promise((s,a)=>{const i=new FileReader;i.onload=p=>{try{const f=JSON.parse(p.target?.result),r={...ut,...f};r.attacks&&Array.isArray(r.attacks)&&(r.attacks=r.attacks.map(b=>({...b,id:b.id||crypto.randomUUID()}))),r.classFeatures?(r.classFeatures.features||(r.classFeatures.features={}),r.classFeatures.spellSlots||(r.classFeatures.spellSlots=[]),r.classFeatures.preparedSpells===void 0&&(r.classFeatures.preparedSpells="")):r.classFeatures={features:{},spellSlots:[],preparedSpells:""},s(r)}catch{a(new Error("Invalid character file"))}},i.onerror=()=>a(new Error("Failed to read file")),i.readAsText(e)})}const ft={paladin:{name:"Paladin",hitDice:"d10",spellcaster:!0,spellcastingAbility:"charisma",spellSlotsByLevel:{1:0,2:2,3:3,4:3,5:4,6:4,7:4,8:4,9:4,10:4,11:4,12:4,13:4,14:4,15:4,16:4,17:4,18:4,19:4,20:4},features:[{name:"Divine Sense",type:"uses",maxUses:(e,s=1)=>1+Math.max(1,s),resetOn:"long",description:"Detect celestials, fiends, and undead within 60 feet",minLevel:1},{name:"Lay on Hands",type:"pool",maxPool:e=>e*5,resetOn:"long",description:"Heal wounds or cure disease",minLevel:1},{name:"Divine Smite",type:"spellSlot",description:"Expend spell slot to deal extra radiant damage",minLevel:2,rollable:!0},{name:"Channel Divinity",type:"uses",maxUses:e=>e>=18?3:e>=6?2:1,resetOn:"short",description:"Sacred Weapon or Turn Undead",minLevel:3}]},fighter:{name:"Fighter",hitDice:"d10",spellcaster:!1,features:[{name:"Second Wind",type:"uses",maxUses:1,resetOn:"short",description:"Regain 1d10 + fighter level HP as bonus action",minLevel:1,rollable:!0,rollFormula:e=>`1d10+${e}`},{name:"Action Surge",type:"uses",maxUses:e=>e>=17?2:1,resetOn:"short",description:"Take one additional action on your turn",minLevel:2},{name:"Indomitable",type:"uses",maxUses:e=>e>=17?3:e>=13?2:1,resetOn:"long",description:"Reroll a failed saving throw",minLevel:9}]},rogue:{name:"Rogue",hitDice:"d8",spellcaster:!1,features:[{name:"Sneak Attack",type:"info",description:e=>`Deal ${Math.ceil(e/2)}d6 extra damage once per turn with advantage or ally nearby`,minLevel:1,rollable:!0,rollFormula:e=>`${Math.ceil(e/2)}d6`},{name:"Cunning Action",type:"info",description:"Dash, Disengage, or Hide as a bonus action",minLevel:2},{name:"Uncanny Dodge",type:"info",description:"Use reaction to halve damage from an attack",minLevel:5},{name:"Evasion",type:"info",description:"Take no damage on successful Dex save (half on fail)",minLevel:7}]},wizard:{name:"Wizard",hitDice:"d6",spellcaster:!0,spellcastingAbility:"intelligence",spellSlotsByLevel:{1:2,2:3,3:4,4:4,5:4,6:4,7:4,8:4,9:4,10:4,11:4,12:4,13:4,14:4,15:4,16:4,17:4,18:4,19:4,20:4},features:[{name:"Arcane Recovery",type:"uses",maxUses:1,resetOn:"long",description:e=>`Recover spell slots totaling up to ${Math.ceil(e/2)} levels during short rest`,minLevel:1},{name:"Spell Mastery",type:"info",description:"Cast one 1st-level and one 2nd-level spell at will",minLevel:18}]},cleric:{name:"Cleric",hitDice:"d8",spellcaster:!0,spellcastingAbility:"wisdom",spellSlotsByLevel:{1:2,2:3,3:4,4:4,5:4,6:4,7:4,8:4,9:4,10:4,11:4,12:4,13:4,14:4,15:4,16:4,17:4,18:4,19:4,20:4},features:[{name:"Channel Divinity",type:"uses",maxUses:e=>e>=18?3:e>=6?2:1,resetOn:"short",description:"Turn Undead or domain-specific ability",minLevel:2},{name:"Destroy Undead",type:"info",description:e=>`Channel Divinity destroys undead of CR ${e>=17?4:e>=14?3:e>=11?2:e>=8?1:.5} or lower`,minLevel:5},{name:"Divine Intervention",type:"uses",maxUses:1,resetOn:"long",description:e=>`${e}% chance to succeed, implore deity for aid`,minLevel:10}]},barbarian:{name:"Barbarian",hitDice:"d12",spellcaster:!1,features:[{name:"Rage",type:"uses",maxUses:e=>e>=20?1/0:e>=17?6:e>=12?5:e>=6?4:e>=3?3:2,resetOn:"long",description:e=>`+${e>=16?4:e>=9?3:2} damage, resistance to physical damage`,minLevel:1},{name:"Reckless Attack",type:"info",description:"Gain advantage on melee attacks, enemies get advantage on you",minLevel:2},{name:"Danger Sense",type:"info",description:"Advantage on Dex saves against effects you can see",minLevel:2}]}};function ze(e){const s=e.toLowerCase();return ft[s]||null}function Ct(e,s){const a=ze(e);return a?a.features.filter(i=>!i.minLevel||i.minLevel<=s):[]}function jt(e,s){const a=ze(e);return!a||!a.spellcaster||!a.spellSlotsByLevel?0:a.spellSlotsByLevel[s]||0}function Dt(e,s,a){const i=ze(e);return!i||!i.spellcaster?0:Math.max(1,a+s)}function ja(e,s,a){const i=ze(e);return!i||!i.spellcaster?null:8+s+a}function Da(){return Object.keys(ft).map(e=>({id:e,name:ft[e].name}))}var Aa=H("<option> </option>"),Ia=H('<section class="character-info svelte-172i2fj"><h2 class="svelte-172i2fj">Character Info</h2> <div class="info-grid svelte-172i2fj"><div class="form-group svelte-172i2fj"><label for="characterName" class="svelte-172i2fj">Character Name</label> <input type="text" id="characterName" placeholder="Enter name" class="svelte-172i2fj"/></div> <div class="form-group svelte-172i2fj"><label for="characterClass" class="svelte-172i2fj">Class</label> <select id="characterClass" class="svelte-172i2fj"><option>Select Class</option><!></select></div> <div class="form-group svelte-172i2fj"><label for="characterLevel" class="svelte-172i2fj">Level</label> <input type="number" id="characterLevel" min="1" max="20" class="svelte-172i2fj"/></div> <div class="form-group svelte-172i2fj"><label for="characterRace" class="svelte-172i2fj">Race</label> <input type="text" id="characterRace" placeholder="e.g., Human" class="svelte-172i2fj"/></div> <div class="form-group svelte-172i2fj"><label for="characterBackground" class="svelte-172i2fj">Background</label> <input type="text" id="characterBackground" placeholder="e.g., Soldier" class="svelte-172i2fj"/></div> <div class="form-group svelte-172i2fj"><label for="characterAlignment" class="svelte-172i2fj">Alignment</label> <input type="text" id="characterAlignment" placeholder="e.g., Lawful Good" class="svelte-172i2fj"/></div></div></section>');function Fa(e,s){je(s,!1);const a=()=>ke(I,"$character",i),[i,p]=Ee(),f=Da();function r(P){const O=P.target;I.update(C=>(C.class=O.value,C))}function b(P){const O=P.target;I.update(C=>(C.level=parseInt(O.value)||1,C)),Bt()}Ce();var c=Ia(),_=l(o(c),2),m=o(_),E=l(o(m),2);B(E),n(m);var g=l(m,2),x=l(o(g),2),w=o(x);w.value=w.__value="";var S=l(w);Ne(S,1,()=>f,He,(P,O)=>{var C=Aa(),Z=o(C,!0);n(C);var Y={};te(()=>{Q(Z,t(O).name),Y!==(Y=t(O).id)&&(C.value=(C.__value=t(O).id)??"")}),F(P,C)}),n(x);var v;xa(x),n(g);var d=l(g,2),M=l(o(d),2);B(M),n(d);var A=l(d,2),$=l(o(A),2);B($),n(A);var y=l(A,2),N=l(o(y),2);B(N),n(y);var L=l(y,2),z=l(o(L),2);B(z),n(L),n(_),n(c),te(()=>{v!==(v=a().class)&&(x.value=(x.__value=a().class)??"",Ot(x,a().class)),Ht(M,a().level)}),W(E,()=>a().name,P=>re(I,h(a).name=P,h(a))),T("change",x,r),T("change",M,b),W($,()=>a().race,P=>re(I,h(a).race=P,h(a))),W(N,()=>a().background,P=>re(I,h(a).background=P,h(a))),W(z,()=>a().alignment,P=>re(I,h(a).alignment=P,h(a))),F(e,c),De(),p()}var Ea=H('<div class="ability-card svelte-bbv1xt"><h3 class="svelte-bbv1xt"> </h3> <input type="number" class="ability-score svelte-bbv1xt" min="1" max="30"/> <div class="ability-modifier svelte-bbv1xt"> </div> <button class="roll-btn svelte-bbv1xt">Check</button> <div class="save-row svelte-bbv1xt"><input type="checkbox" class="svelte-bbv1xt"/> <label class="svelte-bbv1xt">Save</label> <button class="roll-btn-small svelte-bbv1xt">Roll</button></div></div>'),La=H('<section class="ability-scores svelte-bbv1xt"><h2 class="svelte-bbv1xt">Ability Scores</h2> <div class="proficiency-bonus svelte-bbv1xt"><label for="profBonus">Proficiency Bonus</label> <input type="number" id="profBonus" class="prof-input svelte-bbv1xt"/></div> <div class="abilities-grid svelte-bbv1xt"></div></section>');function Na(e,s){je(s,!1);const a=()=>ke(ht,"$abilityModifiers",p),i=()=>ke(I,"$character",p),[p,f]=Ee(),r=We(),b=[{key:"strength",label:"Strength"},{key:"dexterity",label:"Dexterity"},{key:"constitution",label:"Constitution"},{key:"intelligence",label:"Intelligence"},{key:"wisdom",label:"Wisdom"},{key:"charisma",label:"Charisma"}];function c(){Bt()}function _(S){const v=a()[S],d=`1d20${v>=0?"+":""}${v}`;r("roll",d)}function m(S){const v=a()[S],d=i().saveProficiencies[S]?i().proficiencyBonus:0,M=v+d,A=`1d20${M>=0?"+":""}${M}`;r("roll",A)}Ce();var E=La(),g=l(o(E),2),x=l(o(g),2);B(x),n(g);var w=l(g,2);Ne(w,5,()=>b,He,(S,v)=>{let d=()=>t(v).key,M=()=>t(v).label;var A=Ea(),$=o(A),y=o($,!0);n($);var N=l($,2);B(N);var L=l(N,2),z=o(L);n(L);var P=l(L,2),O=l(P,2),C=o(O);B(C);var Z=l(C,2),Y=l(Z,2);n(O),n(A),te(j=>{Q(y,j),Q(z,`${a()[d()]>=0?"+":""}${a()[d()]??""}`),Ue(C,"id",`${d()}-save`),Ue(Z,"for",`${d()}-save`)},[()=>M().substring(0,3).toUpperCase()]),W(N,()=>i().abilities[d()],j=>re(I,h(i).abilities[d()]=j,h(i))),T("change",N,c),T("click",P,()=>_(d())),bt(C,()=>i().saveProficiencies[d()],j=>re(I,h(i).saveProficiencies[d()]=j,h(i))),T("click",Y,()=>m(d())),F(S,A)}),n(w),n(E),W(x,()=>i().proficiencyBonus,S=>re(I,h(i).proficiencyBonus=S,h(i))),F(e,E),De(),f()}var Ra=H('<section class="combat-stats svelte-1r5hyyb"><h2 class="svelte-1r5hyyb">Combat Stats</h2> <div class="stats-grid svelte-1r5hyyb"><div class="stat-box svelte-1r5hyyb"><label for="armorClass" class="svelte-1r5hyyb">Armor Class</label> <input type="number" id="armorClass" class="stat-input svelte-1r5hyyb"/></div> <div class="stat-box svelte-1r5hyyb"><label for="initiative" class="svelte-1r5hyyb">Initiative</label> <input type="number" id="initiative" class="stat-input svelte-1r5hyyb"/></div> <div class="stat-box svelte-1r5hyyb"><label for="speed" class="svelte-1r5hyyb">Speed</label> <input type="text" id="speed" class="stat-input svelte-1r5hyyb"/></div></div> <div class="hp-section svelte-1r5hyyb"><h3 class="svelte-1r5hyyb">Hit Points</h3> <div class="hp-display svelte-1r5hyyb"><div class="hp-inputs svelte-1r5hyyb"><input type="number" class="hp-current svelte-1r5hyyb" min="0"/> <span class="hp-separator svelte-1r5hyyb">/</span> <input type="number" class="hp-max svelte-1r5hyyb" min="0"/></div> <div class="hp-controls svelte-1r5hyyb"><button class="hp-btn svelte-1r5hyyb">âˆ’</button> <button class="hp-btn svelte-1r5hyyb">+</button> <button class="hp-btn svelte-1r5hyyb">âˆ’5</button> <button class="hp-btn svelte-1r5hyyb">+5</button></div></div> <div class="temp-hp svelte-1r5hyyb"><label for="tempHP" class="svelte-1r5hyyb">Temp HP</label> <input type="number" id="tempHP" min="0" class="svelte-1r5hyyb"/></div></div> <div class="hit-dice-section svelte-1r5hyyb"><h3 class="svelte-1r5hyyb">Hit Dice</h3> <div class="hit-dice-display svelte-1r5hyyb"><input type="number" class="hit-dice-input svelte-1r5hyyb" min="0"/> <span>/</span> <input type="number" class="hit-dice-input svelte-1r5hyyb" min="0"/></div></div></section>');function Ta(e,s){je(s,!1);const a=()=>ke(I,"$character",i),[i,p]=Ee();function f(j){I.update(V=>(V.currentHP=Math.max(0,Math.min(V.maxHP,V.currentHP+j)),V))}Ce();var r=Ra(),b=l(o(r),2),c=o(b),_=l(o(c),2);B(_),n(c);var m=l(c,2),E=l(o(m),2);B(E),n(m);var g=l(m,2),x=l(o(g),2);B(x),n(g),n(b);var w=l(b,2),S=l(o(w),2),v=o(S),d=o(v);B(d);var M=l(d,4);B(M),n(v);var A=l(v,2),$=o(A),y=l($,2),N=l(y,2),L=l(N,2);n(A),n(S);var z=l(S,2),P=l(o(z),2);B(P),n(z),n(w);var O=l(w,2),C=l(o(O),2),Z=o(C);B(Z);var Y=l(Z,4);B(Y),n(C),n(O),n(r),te(()=>{Ue(d,"max",a().maxHP),Ue(Z,"max",a().hitDice.max)}),W(_,()=>a().armorClass,j=>re(I,h(a).armorClass=j,h(a))),W(E,()=>a().initiative,j=>re(I,h(a).initiative=j,h(a))),W(x,()=>a().speed,j=>re(I,h(a).speed=j,h(a))),W(d,()=>a().currentHP,j=>re(I,h(a).currentHP=j,h(a))),W(M,()=>a().maxHP,j=>re(I,h(a).maxHP=j,h(a))),T("click",$,()=>f(-1)),T("click",y,()=>f(1)),T("click",N,()=>f(-5)),T("click",L,()=>f(5)),W(P,()=>a().tempHP,j=>re(I,h(a).tempHP=j,h(a))),W(Z,()=>a().hitDice.current,j=>re(I,h(a).hitDice.current=j,h(a))),W(Y,()=>a().hitDice.max,j=>re(I,h(a).hitDice.max=j,h(a))),F(e,r),De(),p()}const At={acrobatics:"dexterity",animalHandling:"wisdom",arcana:"intelligence",athletics:"strength",deception:"charisma",history:"intelligence",insight:"wisdom",intimidation:"charisma",investigation:"intelligence",medicine:"wisdom",nature:"intelligence",perception:"wisdom",performance:"charisma",persuasion:"charisma",religion:"intelligence",sleightOfHand:"dexterity",stealth:"dexterity",survival:"wisdom"};var Ma=H('<div class="skill-row svelte-1f1pl16"><input type="checkbox" class="svelte-1f1pl16"/> <label class="svelte-1f1pl16"> <span class="ability-tag svelte-1f1pl16"> </span></label> <span class="skill-modifier svelte-1f1pl16"> </span> <button class="roll-btn svelte-1f1pl16">Roll</button></div>'),Pa=H('<section class="skills svelte-1f1pl16"><h2 class="svelte-1f1pl16">Skills</h2> <div class="skills-grid svelte-1f1pl16"></div></section>');function Ha(e,s){je(s,!1);const a=()=>ke(ht,"$abilityModifiers",p),i=()=>ke(I,"$character",p),[p,f]=Ee(),r=We(),b=[{key:"acrobatics",label:"Acrobatics"},{key:"animalHandling",label:"Animal Handling"},{key:"arcana",label:"Arcana"},{key:"athletics",label:"Athletics"},{key:"deception",label:"Deception"},{key:"history",label:"History"},{key:"insight",label:"Insight"},{key:"intimidation",label:"Intimidation"},{key:"investigation",label:"Investigation"},{key:"medicine",label:"Medicine"},{key:"nature",label:"Nature"},{key:"perception",label:"Perception"},{key:"performance",label:"Performance"},{key:"persuasion",label:"Persuasion"},{key:"religion",label:"Religion"},{key:"sleightOfHand",label:"Sleight of Hand"},{key:"stealth",label:"Stealth"},{key:"survival",label:"Survival"}];function c(g){const x=At[g],w=a()[x],S=i().skillProficiencies[g]?i().proficiencyBonus:0;return w+S}function _(g){const x=c(g),w=`1d20${x>=0?"+":""}${x}`;r("roll",w)}Ce();var m=Pa(),E=l(o(m),2);Ne(E,5,()=>b,He,(g,x)=>{let w=()=>t(x).key,S=()=>t(x).label;const v=Fe(()=>At[w()]),d=Fe(()=>c(w()));var M=Ma(),A=o(M);B(A);var $=l(A,2),y=o($),N=l(y),L=o(N);n(N),n($);var z=l($,2),P=o(z);n(z);var O=l(z,2);n(M),te(C=>{Ue(A,"id",w()),Ue($,"for",w()),Q(y,`${S()??""} `),Q(L,`(${C??""})`),Q(P,`${t(d)>=0?"+":""}${t(d)??""}`)},[()=>t(v).substring(0,3).toUpperCase()]),bt(A,()=>i().skillProficiencies[w()],C=>re(I,h(i).skillProficiencies[w()]=C,h(i))),T("click",O,()=>_(w())),F(g,M)}),n(E),n(m),F(e,m),De(),f()}var Ua=H('<div class="attack-card svelte-14o91c5"><div class="attack-header svelte-14o91c5"><input type="text" placeholder="Attack name" class="attack-name svelte-14o91c5"/> <button class="btn-remove svelte-14o91c5">Ã—</button></div> <div class="attack-details svelte-14o91c5"><div class="attack-field svelte-14o91c5"><label class="svelte-14o91c5">Bonus</label> <input type="number" class="attack-bonus svelte-14o91c5"/></div> <div class="attack-field svelte-14o91c5"><label class="svelte-14o91c5">Damage</label> <input type="text" placeholder="e.g., 2d6+3" class="attack-damage svelte-14o91c5"/></div> <div class="attack-field svelte-14o91c5"><label class="svelte-14o91c5">Type</label> <input type="text" placeholder="e.g., slashing" class="attack-type svelte-14o91c5"/></div></div> <div class="attack-actions svelte-14o91c5"><button class="btn btn-primary">Roll Attack</button> <button class="btn btn-secondary">Roll Damage</button></div></div>'),Oa=H('<p class="no-attacks svelte-14o91c5">No attacks added yet. Click "Add Attack" to create one.</p>'),Ga=H('<section class="attacks svelte-14o91c5"><h2 class="svelte-14o91c5">Attacks & Spells</h2> <button class="btn btn-secondary">Add Attack</button> <div class="attacks-list svelte-14o91c5"><!> <!></div></section>');function Ba(e,s){je(s,!1);const a=()=>ke(I,"$character",i),[i,p]=Ee(),f=We();function r(){I.update(v=>(v.attacks=[...v.attacks,{id:crypto.randomUUID(),name:"",bonus:0,damage:"",damageType:""}],v))}function b(v){I.update(d=>(d.attacks=d.attacks.filter(M=>M.id!==v),d))}function c(v){const d=`1d20${v.bonus>=0?"+":""}${v.bonus}`;f("roll",{notation:d,damageNotation:v.damage,attackName:v.name})}function _(v){if(!v.damage){alert(`${v.name}: No damage specified`);return}f("roll",{notation:v.damage})}Ce();var m=Ga(),E=l(o(m),2),g=l(E,2),x=o(g);Ne(x,1,()=>a().attacks,v=>v.id,(v,d,M)=>{var A=Ua(),$=o(A),y=o($);B(y);var N=l(y,2);n($);var L=l($,2),z=o(L),P=l(o(z),2);B(P),n(z);var O=l(z,2),C=l(o(O),2);B(C),n(O);var Z=l(O,2),Y=l(o(Z),2);B(Y),n(Z),n(L);var j=l(L,2),V=o(j),G=l(V,2);n(j),n(A),W(y,()=>t(d).name,J=>(t(d).name=J,Ye(()=>a()),Xe(i,"$character"))),T("click",N,()=>b(t(d).id)),W(P,()=>t(d).bonus,J=>(t(d).bonus=J,Ye(()=>a()),Xe(i,"$character"))),W(C,()=>t(d).damage,J=>(t(d).damage=J,Ye(()=>a()),Xe(i,"$character"))),W(Y,()=>t(d).damageType,J=>(t(d).damageType=J,Ye(()=>a()),Xe(i,"$character"))),T("click",V,()=>c(t(d))),T("click",G,()=>_(t(d))),F(v,A)});var w=l(x,2);{var S=v=>{var d=Oa();F(v,d)};ve(w,v=>{a().attacks.length===0&&v(S)})}n(g),n(m),T("click",E,r),F(e,m),De(),p()}var za=H('<p class="no-features svelte-1kpvv0n">Select a class to see available features</p>'),qa=H('<p class="no-features svelte-1kpvv0n">No class features available at this level</p>'),Ja=H('<input type="checkbox" class="slot-checkbox svelte-1kpvv0n"/>'),Wa=H('<div class="spell-slots svelte-1kpvv0n"><label class="svelte-1kpvv0n">1st Level Spell Slots</label> <div class="slots-tracker svelte-1kpvv0n"><!> <button class="btn-small svelte-1kpvv0n">Long Rest</button></div></div>'),Va=H('<div class="feature-box spellcasting svelte-1kpvv0n"><h3 class="svelte-1kpvv0n"> </h3> <div class="spell-stats svelte-1kpvv0n"><div class="spell-stat svelte-1kpvv0n"><label class="svelte-1kpvv0n">Spell Save DC</label> <div class="spell-value svelte-1kpvv0n"> </div></div> <div class="spell-stat svelte-1kpvv0n"><label class="svelte-1kpvv0n">Prepared Spells</label> <div class="spell-value svelte-1kpvv0n"> </div></div></div> <!> <div class="prepared-spells svelte-1kpvv0n"><label class="svelte-1kpvv0n">Prepared Spells</label> <textarea placeholder="List your prepared spells..." class="svelte-1kpvv0n"></textarea></div></div>'),Ya=H('<p class="unlimited svelte-1kpvv0n">Unlimited Uses</p>'),Xa=H('<input type="checkbox" class="use-checkbox svelte-1kpvv0n"/>'),Za=H('<input type="checkbox" class="use-checkbox svelte-1kpvv0n"/>'),Ka=H('<!> <button class="btn-small svelte-1kpvv0n"> </button>',1),Qa=H('<div class="uses-tracker svelte-1kpvv0n"><!></div>'),es=H('<div class="pool-tracker svelte-1kpvv0n"><input type="number" min="0" class="pool-input svelte-1kpvv0n"/> <span> </span> <button class="btn-small svelte-1kpvv0n"> </button></div>'),ts=H('<div class="feature-box svelte-1kpvv0n"><h3 class="svelte-1kpvv0n"> </h3> <p class="feature-description svelte-1kpvv0n"> </p> <!></div>'),as=H('<div class="features-grid svelte-1kpvv0n"><!> <!></div>'),ss=H('<section class="class-features svelte-1kpvv0n"><h2 class="svelte-1kpvv0n">Class Features</h2> <!></section>');function ls(e,s){je(s,!1);const a=()=>ke(I,"$character",p),i=()=>ke(ht,"$abilityModifiers",p),[p,f]=Ee(),r=q(),b=q(),c=q();let _=q(0),m=q(0);function E(y,N){I.update(L=>(L.classFeatures.features[y]||(L.classFeatures.features[y]=[]),L.classFeatures.features[y]=Array(N).fill(!1),L))}function g(y,N){I.update(L=>(L.classFeatures.features[y]=N,L))}function x(){I.update(y=>(y.classFeatures.spellSlots=Array(t(c)).fill(!1),y))}function w(y){if(typeof y.maxUses=="function"){if(y.name==="Divine Sense"&&t(r)?.spellcastingAbility){const N=i()[t(r).spellcastingAbility];return y.maxUses(a().level,N)}return y.maxUses(a().level)}return y.maxUses||0}function S(y){return typeof y.maxPool=="function"?y.maxPool(a().level):y.maxPool||0}function v(y){return typeof y.description=="function"?y.description(a().level):y.description}Ge(()=>(a(),ze),()=>{k(r,a().class?ze(a().class):null)}),Ge(()=>(a(),Ct),()=>{k(b,a().class?Ct(a().class,a().level):[])}),Ge(()=>(a(),jt),()=>{k(c,a().class?jt(a().class,a().level):0)}),Ge(()=>(t(r),i(),a(),Dt),()=>{if(t(r)?.spellcaster&&t(r).spellcastingAbility){const y=i()[t(r).spellcastingAbility];k(_,ja(a().class,y,a().proficiencyBonus)||0),k(m,Dt(a().class,a().level,y))}}),Pt(),Ce();var d=ss(),M=l(o(d),2);{var A=y=>{var N=za();F(y,N)},$=y=>{var N=at(),L=Pe(N);{var z=O=>{var C=qa();F(O,C)},P=O=>{var C=as(),Z=o(C);{var Y=V=>{var G=Va(),J=o(G),ne=o(J);n(J);var ge=l(J,2),D=o(ge),X=l(o(D),2),oe=o(X,!0);n(X),n(D);var pe=l(D,2),be=l(o(pe),2),_e=o(be,!0);n(be),n(pe),n(ge);var xe=l(ge,2);{var Re=U=>{var K=Wa(),le=l(o(K),2),ie=o(le);Ne(ie,1,()=>(t(c),h(()=>Array(t(c)))),He,(ce,fe,de)=>{var he=Ja();B(he),bt(he,()=>a().classFeatures.spellSlots[de],ye=>re(I,h(a).classFeatures.spellSlots[de]=ye,h(a))),F(ce,he)});var ae=l(ie,2);n(le),n(K),T("click",ae,x),F(U,K)};ve(xe,U=>{t(c)>0&&U(Re)})}var u=l(xe,2),R=l(o(u),2);Ke(R),n(u),n(G),te(U=>{Q(ne,`Spellcasting (${U??""})`),Q(oe,t(_)),Q(_e,t(m))},[()=>(t(r),h(()=>t(r).spellcastingAbility?.toUpperCase()))]),W(R,()=>a().classFeatures.preparedSpells,U=>re(I,h(a).classFeatures.preparedSpells=U,h(a))),F(V,G)};ve(Z,V=>{t(r),h(()=>t(r)?.spellcaster)&&V(Y)})}var j=l(Z,2);Ne(j,1,()=>t(b),He,(V,G)=>{const J=Fe(()=>(t(G),h(()=>t(G).name.replace(/\s+/g,"")))),ne=Fe(()=>(a(),Be(t(J)),h(()=>a().classFeatures.features[t(J)]))),ge=Fe(()=>(Be(t(ne)),h(()=>Array.isArray(t(ne))))),D=Fe(()=>typeof t(ne)=="number");var X=ts(),oe=o(X),pe=o(oe,!0);n(oe);var be=l(oe,2),_e=o(be,!0);n(be);var xe=l(be,2);{var Re=R=>{const U=Fe(()=>(t(G),h(()=>w(t(G)))));var K=Qa(),le=o(K);{var ie=ce=>{var fe=Ya();F(ce,fe)},ae=ce=>{var fe=Ka(),de=Pe(fe);Ne(de,1,()=>(Be(t(U)),h(()=>Array(t(U)))),He,(Le,Te,$e)=>{var Me=at(),ee=Pe(Me);{var ue=se=>{var me=Xa();B(me),te(()=>xt(me,(Be(t(ne)),h(()=>t(ne)&&t(ne)[$e]||!1)))),T("change",me,qe=>{I.update(Ie=>{Ie.classFeatures.features[t(J)]||(Ie.classFeatures.features[t(J)]=[]);const tt=Ie.classFeatures.features[t(J)];return tt[$e]=qe.currentTarget.checked,Ie})}),F(se,me)},Ae=se=>{var me=Za();B(me),xt(me,!1),T("change",me,qe=>{I.update(Ie=>{Ie.classFeatures.features[t(J)]||(Ie.classFeatures.features[t(J)]=[]);const tt=Ie.classFeatures.features[t(J)];return tt[$e]=qe.currentTarget.checked,Ie})}),F(se,me)};ve(ee,se=>{t(ge)?se(ue):se(Ae,!1)})}F(Le,Me)});var he=l(de,2),ye=o(he,!0);n(he),te(()=>Q(ye,(t(G),h(()=>t(G).resetOn==="short"?"Short Rest":"Long Rest")))),T("click",he,()=>E(t(J),t(U))),F(ce,fe)};ve(le,ce=>{t(U)===1/0?ce(ie):ce(ae,!1)})}n(K),F(R,K)},u=R=>{var U=at(),K=Pe(U);{var le=ie=>{const ae=Fe(()=>(t(G),h(()=>S(t(G)))));var ce=es(),fe=o(ce);B(fe);var de=l(fe,2),he=o(de);n(de);var ye=l(de,2),Le=o(ye,!0);n(ye),n(ce),te(()=>{Ht(fe,t(D)&&t(ne)!==void 0?t(ne):t(ae)),Ue(fe,"max",t(ae)),Q(he,`/ ${t(ae)??""}`),Q(Le,(t(G),h(()=>t(G).resetOn==="short"?"Short Rest":"Long Rest")))}),T("input",fe,Te=>{I.update($e=>($e.classFeatures.features[t(J)]=parseInt(Te.currentTarget.value)||0,$e))}),T("click",ye,()=>g(t(J),t(ae))),F(ie,ce)};ve(K,ie=>{t(G),h(()=>t(G).type==="pool")&&ie(le)},!0)}F(R,U)};ve(xe,R=>{t(G),h(()=>t(G).type==="uses")?R(Re):R(u,!1)})}n(X),te(R=>{Q(pe,(t(G),h(()=>t(G).name))),Q(_e,R)},[()=>(t(G),h(()=>v(t(G))))]),F(V,X)}),n(C),F(O,C)};ve(L,O=>{t(b),h(()=>t(b).length===0)?O(z):O(P,!1)},!0)}F(y,N)};ve(M,y=>{a(),h(()=>!a().class)?y(A):y($,!1)})}n(d),F(e,d),De(),f()}var is=H('<section class="notes svelte-wttn0l"><h2 class="svelte-wttn0l">Features & Traits</h2> <textarea placeholder="Enter features, traits, and special abilities..." class="svelte-wttn0l"></textarea> <h2 class="svelte-wttn0l">Equipment</h2> <textarea placeholder="List your equipment and inventory..." class="svelte-wttn0l"></textarea> <h2 class="svelte-wttn0l">Notes</h2> <textarea placeholder="Additional notes..." class="svelte-wttn0l"></textarea></section>');function rs(e,s){je(s,!1);const a=()=>ke(I,"$character",i),[i,p]=Ee();Ce();var f=is(),r=l(o(f),2);Ke(r);var b=l(r,4);Ke(b);var c=l(b,4);Ke(c),n(f),W(r,()=>a().features,_=>re(I,h(a).features=_,h(a))),W(b,()=>a().equipment,_=>re(I,h(a).equipment=_,h(a))),W(c,()=>a().notes,_=>re(I,h(a).notes=_,h(a))),F(e,f),De(),p()}var ns=H('<div class="loading svelte-1r90jgp"><p class="svelte-1r90jgp">Loading 3D dice...</p></div>'),os=H('<div class="custom-dice-selector svelte-1r90jgp"><h3 class="svelte-1r90jgp">Choose Dice to Roll</h3> <div class="dice-inputs svelte-1r90jgp"><div class="dice-input-group svelte-1r90jgp"><label for="d4" class="svelte-1r90jgp">d4</label> <input type="number" id="d4" min="0" max="10" class="svelte-1r90jgp"/></div> <div class="dice-input-group svelte-1r90jgp"><label for="d6" class="svelte-1r90jgp">d6</label> <input type="number" id="d6" min="0" max="10" class="svelte-1r90jgp"/></div> <div class="dice-input-group svelte-1r90jgp"><label for="d8" class="svelte-1r90jgp">d8</label> <input type="number" id="d8" min="0" max="10" class="svelte-1r90jgp"/></div> <div class="dice-input-group svelte-1r90jgp"><label for="d10" class="svelte-1r90jgp">d10</label> <input type="number" id="d10" min="0" max="10" class="svelte-1r90jgp"/></div> <div class="dice-input-group svelte-1r90jgp"><label for="d12" class="svelte-1r90jgp">d12</label> <input type="number" id="d12" min="0" max="10" class="svelte-1r90jgp"/></div> <div class="dice-input-group svelte-1r90jgp"><label for="d20" class="svelte-1r90jgp">d20</label> <input type="number" id="d20" min="0" max="10" class="svelte-1r90jgp"/></div></div> <div class="dice-controls svelte-1r90jgp"><button class="btn btn-primary svelte-1r90jgp"> </button> <button class="btn btn-secondary svelte-1r90jgp">Reset</button></div></div>'),cs=H('<span class="crit-badge svelte-1r90jgp">CRITICAL!</span>'),vs=H('<p class="svelte-1r90jgp"> </p>'),ds=H('<p class="modifier-text svelte-1r90jgp"> </p>'),us=H('<button class="btn btn-follow-up svelte-1r90jgp"> </button>'),fs=H('<div class="follow-up-actions svelte-1r90jgp"></div>'),ps=H('<div class="result-header svelte-1r90jgp"><h3 class="svelte-1r90jgp"> </h3> <!></div> <div class="result-total svelte-1r90jgp"> </div> <div class="result-details svelte-1r90jgp"><!> <!></div> <!>',1),bs=H('<div role="button" tabindex="-1"><div class="modal-content svelte-1r90jgp" role="dialog" tabindex="0"><div class="modal-header svelte-1r90jgp"><h2 class="svelte-1r90jgp">Dice Roller</h2> <button class="close-btn svelte-1r90jgp">Ã—</button></div> <!> <div class="dice-main-area svelte-1r90jgp"><div class="dice-container svelte-1r90jgp"></div> <!></div> <div><!></div></div></div>');function hs(e,s){je(s,!1);const a=q(),i=We();let p=Je(s,"notation",12,""),f=Je(s,"visible",8,!1),r=Je(s,"damageNotation",12,""),b=Je(s,"attackName",12,""),c=null,_=q(void 0),m=q(!1),E=q(""),g=q(null),x=q(0),w=q(0),S=q(0),v=q(0),d=q(0),M=q(0),A=q(0),$=q([]),y=q(!1);function N(){if(window.DICE&&t(_))try{c&&t(_)&&ua(_,t(_).innerHTML="");const u=t(_).clientWidth||500,R=t(_).clientHeight||300;c=new window.DICE.dice_box(t(_),{w:u,h:R}),k(m,!0),console.log(`Dice box initialized with dimensions: ${u}x${R}`)}catch(u){console.error("Error initializing dice box:",u)}}ma(()=>{const u=U=>new Promise((K,le)=>{if(document.querySelector(`script[src="${U}"]`)){console.log(`Script already loaded: ${U}`),K(null);return}const ae=document.createElement("script");ae.src=U,ae.onload=()=>{console.log(`Loaded: ${U}`),K(null)},ae.onerror=()=>{console.error(`Failed to load: ${U}`),le(new Error(`Failed to load ${U}`))},document.head.appendChild(ae)});setTimeout(()=>{u(`${Ze}/libs/three.min.js`).then(()=>u(`${Ze}/libs/cannon.min.js`)).then(()=>u(`${Ze}/libs/teal.js`)).then(()=>u(`${Ze}/dice.js`)).then(()=>{console.log("All scripts loaded, initializing dice box..."),console.log("DICE available:",!!window.DICE),console.log("Container available:",!!t(_)),N()}).catch(U=>{console.error("Failed to load dice libraries:",U)})},100);const R=()=>{t(m)&&(console.log("Window resized, reinitializing dice box..."),N())};return window.addEventListener("resize",R),()=>{window.removeEventListener("resize",R)}});function L(u,R="other"){if(!c||!t(m))return;console.log("Rolling dice:",u,"type:",R),c.diceToRoll=u;const U=le=>(console.log("Before roll:",le),null),K=le=>{if(console.log("After roll:",le),console.log("Result:",le.resultTotal),k(g,le),R==="attack"||R==="check"||R==="save"){const ie=le.results?.filter(ae=>ae.sides===20)||[];if(ie.length>0){const ae=ie[0].value;k(y,ae===20)}}if(k($,[]),R==="attack"&&r())if(t(y)){const ie=O(r());t($).push({label:`Roll Critical Damage (${ie})`,notation:ie})}else t($).push({label:`Roll Damage (${r()})`,notation:r()})};c.start_throw(U,K)}function z(){const u=[];t(x)>0&&u.push(`${t(x)}d4`),t(w)>0&&u.push(`${t(w)}d6`),t(S)>0&&u.push(`${t(S)}d8`),t(v)>0&&u.push(`${t(v)}d10`),t(d)>0&&u.push(`${t(d)}d12`),t(M)>0&&u.push(`${t(M)}d20`);let R=u.join("+")||"1d20";return t(A)!==0&&(R+=t(A)>=0?`+${t(A)}`:`${t(A)}`),R}function P(){const u=z();L(u)}function O(u){return u.replace(/(\d+)d(\d+)/g,(R,U,K)=>`${parseInt(U)*2}d${K}`)}function C(){k(x,0),k(w,0),k(S,0),k(v,0),k(d,0),k(M,0),k(A,0),k(g,null),k($,[]),k(y,!1)}function Z(){i("close"),p(""),r(""),b(""),k(E,""),k(g,null),C()}Ge(()=>(t(x),t(w),t(S),t(v),t(d),t(M),t(A)),()=>{k(a,(()=>{const u=[];t(x)>0&&u.push(`${t(x)}d4`),t(w)>0&&u.push(`${t(w)}d6`),t(S)>0&&u.push(`${t(S)}d8`),t(v)>0&&u.push(`${t(v)}d10`),t(d)>0&&u.push(`${t(d)}d12`),t(M)>0&&u.push(`${t(M)}d20`);let R=u.join("+")||"1d20";return t(A)!==0&&(R+=t(A)>=0?`+${t(A)}`:`${t(A)}`),R})())}),Ge(()=>(Be(p()),t(m),Be(f())),()=>{if(p()&&t(m)&&f()){k(E,p()),k(g,null),k($,[]),k(y,!1);const u=p().includes("1d20")?"attack":"other";setTimeout(()=>L(p(),u),200)}}),Pt(),Ce();var Y=bs();let j;var V=o(Y),G=o(V),J=l(o(G),2);n(G);var ne=l(G,2);{var ge=u=>{var R=ns();F(u,R)};ve(ne,u=>{t(m)||u(ge)})}var D=l(ne,2),X=o(D);dt(X,u=>k(_,u),()=>t(_));var oe=l(X,2);{var pe=u=>{var R=os(),U=l(o(R),2),K=o(U),le=l(o(K),2);B(le),n(K);var ie=l(K,2),ae=l(o(ie),2);B(ae),n(ie);var ce=l(ie,2),fe=l(o(ce),2);B(fe),n(ce);var de=l(ce,2),he=l(o(de),2);B(he),n(de);var ye=l(de,2),Le=l(o(ye),2);B(Le),n(ye);var Te=l(ye,2),$e=l(o(Te),2);B($e),n(Te),n(U);var Me=l(U,2),ee=o(Me),ue=o(ee);n(ee);var Ae=l(ee,2);n(Me),n(R),te(()=>{ee.disabled=!t(m),Q(ue,`Roll ${t(a)??""}`)}),W(le,()=>t(x),se=>k(x,se)),W(ae,()=>t(w),se=>k(w,se)),W(fe,()=>t(S),se=>k(S,se)),W(he,()=>t(v),se=>k(v,se)),W(Le,()=>t(d),se=>k(d,se)),W($e,()=>t(M),se=>k(M,se)),T("click",ee,P),T("click",Ae,C),F(u,R)};ve(oe,u=>{p()||u(pe)})}n(D);var be=l(D,2);let _e;var xe=o(be);{var Re=u=>{var R=ps(),U=Pe(R),K=o(U),le=o(K,!0);n(K);var ie=l(K,2);{var ae=ee=>{var ue=cs();F(ee,ue)};ve(ie,ee=>{t(y)&&ee(ae)})}n(U);var ce=l(U,2),fe=o(ce,!0);n(ce);var de=l(ce,2),he=o(de);{var ye=ee=>{var ue=vs(),Ae=o(ue,!0);n(ue),te(()=>Q(Ae,(t(g),h(()=>t(g).resultString)))),F(ee,ue)};ve(he,ee=>{t(g),h(()=>t(g).resultString)&&ee(ye)})}var Le=l(he,2);{var Te=ee=>{var ue=ds(),Ae=o(ue);n(ue),te(()=>Q(Ae,`Modifier: ${t(g),h(()=>t(g).constant>=0?"+":"")??""}${t(g),h(()=>t(g).constant)??""}`)),F(ee,ue)};ve(Le,ee=>{t(g),h(()=>t(g).constant)&&ee(Te)})}n(de);var $e=l(de,2);{var Me=ee=>{var ue=fs();Ne(ue,5,()=>t($),He,(Ae,se)=>{var me=us(),qe=o(me,!0);n(me),te(()=>Q(qe,(t(se),h(()=>t(se).label)))),T("click",me,()=>L(t(se).notation,"damage")),F(Ae,me)}),n(ue),F(ee,ue)};ve($e,ee=>{t($),h(()=>t($).length>0)&&ee(Me)})}te(()=>{Q(le,b()?`${b()} - Result`:"Result"),Q(fe,(t(g),h(()=>t(g).resultTotal)))}),F(u,R)};ve(xe,u=>{t(g)&&u(Re)})}n(be),n(V),n(Y),te(()=>{j=St(Y,1,"modal-overlay svelte-1r90jgp",null,j,{hidden:!f()}),_e=St(be,1,"roll-result svelte-1r90jgp",null,_e,{"has-result":t(g)})}),T("click",J,Z),T("click",V,Gt(function(u){Qe.call(this,s,u)})),T("keydown",V,function(u){Qe.call(this,s,u)}),T("click",Y,Z),T("keydown",Y,u=>u.key==="Escape"&&Z()),F(e,Y),De()}const mt="https://api.github.com/gists";async function ms(e,s,a){if(!s)throw new Error("GitHub token is required");const i=JSON.stringify(e,null,2),p=`${e.name||"character"}_dnd.json`,f={description:a||`D&D Character: ${e.name}`,public:!1,files:{[p]:{content:i}}},r=await fetch(mt,{method:"POST",headers:{Authorization:`token ${s}`,"Content-Type":"application/json"},body:JSON.stringify(f)});if(!r.ok)throw new Error(`Failed to create gist: ${r.statusText}`);return(await r.json()).id}async function gs(e,s,a){if(!s||!a)throw new Error("GitHub token and Gist ID are required");const i=JSON.stringify(e,null,2),f={files:{[`${e.name||"character"}_dnd.json`]:{content:i}}},r=await fetch(`${mt}/${a}`,{method:"PATCH",headers:{Authorization:`token ${s}`,"Content-Type":"application/json"},body:JSON.stringify(f)});if(!r.ok)throw new Error(`Failed to update gist: ${r.statusText}`)}async function _s(e,s){if(!e)throw new Error("Gist ID is required");const a={"Content-Type":"application/json"};s&&(a.Authorization=`token ${s}`);const i=await fetch(`${mt}/${e}`,{method:"GET",headers:a});if(!i.ok)throw new Error(`Failed to load gist: ${i.statusText}`);const p=await i.json(),f=Object.values(p.files);if(f.length===0)throw new Error("No files found in gist");const b=f[0].content;try{const c=JSON.parse(b);return c.attacks&&Array.isArray(c.attacks)&&(c.attacks=c.attacks.map(_=>({..._,id:_.id||crypto.randomUUID()}))),c.classFeatures?(c.classFeatures.features||(c.classFeatures.features={}),c.classFeatures.spellSlots||(c.classFeatures.spellSlots=[]),c.classFeatures.preparedSpells===void 0&&(c.classFeatures.preparedSpells="")):c.classFeatures={features:{},spellSlots:[],preparedSpells:""},c}catch{throw new Error("Invalid character data in gist")}}function It(e){typeof window<"u"&&localStorage.setItem("dnd_gist_config",JSON.stringify(e))}function ys(){if(typeof window<"u"){const e=localStorage.getItem("dnd_gist_config");if(e)return JSON.parse(e)}return{}}var ks=H('<div class="error-message svelte-1jb5ckg"> </div>'),xs=H('<div class="form-group svelte-1jb5ckg"><label for="gistId" class="svelte-1jb5ckg">Gist ID (leave empty to create new)</label> <input type="text" id="gistId" placeholder="Optional: existing Gist ID to update" class="svelte-1jb5ckg"/></div> <div class="form-group svelte-1jb5ckg"><label for="description" class="svelte-1jb5ckg">Description</label> <input type="text" id="description" placeholder="D&amp;D Character Sheet" class="svelte-1jb5ckg"/></div>',1),$s=H('<div class="form-group svelte-1jb5ckg"><label for="gistId" class="svelte-1jb5ckg">Gist ID *</label> <input type="text" id="gistId" placeholder="Enter Gist ID" required class="svelte-1jb5ckg"/></div>'),Ss=H('<div class="modal-overlay svelte-1jb5ckg" role="button" tabindex="-1"><div class="modal-content svelte-1jb5ckg" role="dialog" tabindex="0"><div class="modal-header svelte-1jb5ckg"><h2 class="svelte-1jb5ckg"> </h2> <button class="close-btn svelte-1jb5ckg">Ã—</button></div> <div class="modal-body svelte-1jb5ckg"><!> <div class="form-group svelte-1jb5ckg"><label for="token" class="svelte-1jb5ckg">GitHub Token (optional for public gists) <a href="https://github.com/settings/tokens" target="_blank" rel="noopener" class="svelte-1jb5ckg">Get token</a></label> <input type="password" id="token" placeholder="ghp_xxxxxxxxxxxxx" class="svelte-1jb5ckg"/></div> <!> <div class="modal-actions svelte-1jb5ckg"><button class="btn btn-primary svelte-1jb5ckg"><!></button> <button class="btn btn-secondary svelte-1jb5ckg">Cancel</button></div></div></div></div>');function ws(e,s){je(s,!1);const a=()=>ke(I,"$character",i),[i,p]=Ee(),f=We();let r=Je(s,"mode",8,"save"),b=q(""),c=q(""),_=q(""),m=q(!1),E=q("");const g=ys();g.token&&k(b,g.token),g.gistId&&k(c,g.gistId);async function x(){if(!t(b)){k(E,"GitHub token is required");return}k(m,!0),k(E,"");try{if(t(c))await gs(a(),t(b),t(c)),alert("Character updated in Gist successfully!");else{const D=await ms(a(),t(b),t(_));k(c,D),alert(`Character saved to Gist! ID: ${D}`)}It({token:t(b),gistId:t(c)}),f("close")}catch(D){k(E,D.message||"Failed to save to Gist")}finally{k(m,!1)}}async function w(){if(!t(c)){k(E,"Gist ID is required");return}k(m,!0),k(E,"");try{const D=await _s(t(c),t(b)||void 0);I.set(D),It({token:t(b),gistId:t(c)}),alert("Character loaded from Gist successfully!"),f("close")}catch(D){k(E,D.message||"Failed to load from Gist")}finally{k(m,!1)}}function S(){f("close")}Ce();var v=Ss(),d=o(v),M=o(d),A=o(M),$=o(A,!0);n(A);var y=l(A,2);n(M);var N=l(M,2),L=o(N);{var z=D=>{var X=ks(),oe=o(X,!0);n(X),te(()=>Q(oe,t(E))),F(D,X)};ve(L,D=>{t(E)&&D(z)})}var P=l(L,2),O=l(o(P),2);B(O),n(P);var C=l(P,2);{var Z=D=>{var X=xs(),oe=Pe(X),pe=l(o(oe),2);B(pe),n(oe);var be=l(oe,2),_e=l(o(be),2);B(_e),n(be),te(()=>{pe.disabled=t(m),_e.disabled=t(m)}),W(pe,()=>t(c),xe=>k(c,xe)),W(_e,()=>t(_),xe=>k(_,xe)),F(D,X)},Y=D=>{var X=$s(),oe=l(o(X),2);B(oe),n(X),te(()=>oe.disabled=t(m)),W(oe,()=>t(c),pe=>k(c,pe)),F(D,X)};ve(C,D=>{r()==="save"?D(Z):D(Y,!1)})}var j=l(C,2),V=o(j),G=o(V);{var J=D=>{var X=gt();te(()=>Q(X,r()==="save"?"Saving...":"Loading...")),F(D,X)},ne=D=>{var X=gt();te(()=>Q(X,r()==="save"?"Save":"Load")),F(D,X)};ve(G,D=>{t(m)?D(J):D(ne,!1)})}n(V);var ge=l(V,2);n(j),n(N),n(d),n(v),te(()=>{Q($,r()==="save"?"Save to GitHub Gist":"Load from GitHub Gist"),O.disabled=t(m),V.disabled=t(m),ge.disabled=t(m)}),T("click",y,S),W(O,()=>t(b),D=>k(b,D)),T("click",V,function(...D){(r()==="save"?x:w)?.apply(this,D)}),T("click",ge,S),T("click",d,Gt(function(D){Qe.call(this,s,D)})),T("keydown",d,function(D){Qe.call(this,s,D)}),T("click",v,S),T("keydown",v,D=>D.key==="Escape"&&S()),F(e,v),De(),p()}var Cs=H('<link rel="icon" type="image/png" href="/favicon.png"/>'),js=H('<div class="container svelte-1uha8ag"><header class="svelte-1uha8ag"><div class="header-top svelte-1uha8ag"><h1 class="svelte-1uha8ag">D&D Character Sheet</h1> <div class="mode-toggle"><button class="btn btn-mode svelte-1uha8ag"> </button></div></div> <div class="header-actions svelte-1uha8ag"><button class="btn btn-secondary">ðŸŽ² Roll Dice</button> <button class="btn btn-secondary">Save to Gist</button> <button class="btn btn-secondary">Load from Gist</button> <button class="btn btn-secondary">Export JSON</button> <button class="btn btn-secondary">Import JSON</button> <input type="file" accept=".json" style="display: none;"/></div></header> <main class="svelte-1uha8ag"><!> <!> <!> <!> <!> <!> <!></main></div> <!> <!>',1);function Ts(e,s){je(s,!1);const a=()=>ke(I,"$character",p),i=()=>ke(et,"$isEditMode",p),[p,f]=Ee();let r=q(!1),b=q(!1),c=q("save"),_=q(void 0),m=q(""),E=q(""),g=q(""),x=q();function w(u){k(m,""),setTimeout(typeof u=="string"?()=>{k(m,u),k(E,""),k(g,"")}:()=>{k(m,u.notation),k(E,u.damageNotation||""),k(g,u.attackName||"")},0),k(r,!0)}function S(){et.update(u=>!u)}function v(){wa(a())}function d(){t(_)?.click()}async function M(u){const U=u.target.files?.[0];if(U)try{const K=await Ca(U);I.set(K),alert("Character imported successfully!")}catch{alert("Failed to import character file")}}Ce();var A=js();ba("1uha8ag",u=>{var R=Cs();fa(()=>{pa.title="D&D Character Sheet"}),F(u,R)});var $=Pe(A),y=o($),N=o(y),L=l(o(N),2),z=o(L),P=o(z,!0);n(z),n(L),n(N);var O=l(N,2),C=o(O),Z=l(C,2),Y=l(Z,2),j=l(Y,2),V=l(j,2),G=l(V,2);dt(G,u=>k(_,u),()=>t(_)),n(O),n(y);var J=l(y,2),ne=o(J);Fa(ne,{});var ge=l(ne,2);Ta(ge,{});var D=l(ge,2);Na(D,{$$events:{roll:u=>w(u.detail)}});var X=l(D,2);Ha(X,{$$events:{roll:u=>w(u.detail)}});var oe=l(X,2);Ba(oe,{$$events:{roll:u=>w(u.detail)}});var pe=l(oe,2);ls(pe,{});var be=l(pe,2);rs(be,{}),n(J),n($);var _e=l($,2);dt(hs(_e,{get notation(){return t(m)},get damageNotation(){return t(E)},get attackName(){return t(g)},get visible(){return t(r)},$$events:{close:()=>k(r,!1)},$$legacy:!0}),u=>k(x,u),()=>t(x));var xe=l(_e,2);{var Re=u=>{ws(u,{get mode(){return t(c)},$$events:{close:()=>k(b,!1)}})};ve(xe,u=>{t(b)&&u(Re)})}te(()=>Q(P,i()?"ðŸ“ Edit Mode":"ðŸŽ² Use Mode")),T("click",z,S),T("click",C,()=>k(r,!0)),T("click",Z,()=>{k(c,"save"),k(b,!0)}),T("click",Y,()=>{k(c,"load"),k(b,!0)}),T("click",j,v),T("click",V,d),T("change",G,M),F(e,A),De(),f()}export{Ts as component};
