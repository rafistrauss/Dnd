import{d as $s,g as Vs,f as d,e as B,a as o,s as $,c as $t,t as Tt}from"../chunks/BESELRjb.js";import{i as Xt}from"../chunks/JMgyEzd3.js";import{c as ka,o as Ca,a as Js,b as Ys}from"../chunks/CtPH092J.js";import{F as L,T as _a,Y as fs,j as Qs,aZ as Xs,U as ws,ag as Zs,aD as el,aK as tl,aE as al,a1 as sl,av as Wa,a7 as _s,i as Is,a_ as ll,a$ as Es,b0 as Za,K as $a,e as Us,b1 as Ns,b2 as il,b3 as nl,b4 as rl,q as ps,b5 as ol,b6 as cl,ab as vl,d as n,r as ys,g as dl,C as Zt,G as ea,H as l,I as s,J as a,b7 as Qe,b8 as ma,s as r,a4 as w,f as e,m as yt,E as Ce,b9 as Jt,ao as sa,A as I,ba as ha,bb as ja,bc as ul}from"../chunks/DyJ43TGI.js";import{t as fl,c as ia,a as pe,e as Ct,i as jt,u as Hs,s as xa,b as Ut,d as es,f as Sa,g as Qa,j as pl,k as Ht,l as ml,m as Ss,n as ns,h as gl,T as bl,o as hl,p as _l,r as Cs,q as Ds}from"../chunks/Fq0DehG0.js";import{i as m,s as da,a as _t,b as Gt,d as Pa,e as yl}from"../chunks/CCL4udNy.js";import{p as At,b as Ua}from"../chunks/iXw84bXb.js";import{b as Ia,r as xl}from"../chunks/rq1H3z0e.js";function ms(i,c,t=!1,v=!1,f=!1){var p=i,g="";L(()=>{var S=Qs;if(g===(g=c()??"")){_a&&fs();return}if(S.nodes_start!==null&&(Xs(S.nodes_start,S.nodes_end),S.nodes_start=S.nodes_end=null),g!==""){if(_a){ws.data;for(var x=fs(),y=x;x!==null&&(x.nodeType!==Zs||x.data!=="");)y=x,x=el(x);if(x===null)throw tl(),al;$s(ws,y),p=sl(x);return}var E=g+"";t?E=`<svg>${E}</svg>`:v&&(E=`<math>${E}</math>`);var T=Vs(E);if((t||v)&&(T=Wa(T)),$s(Wa(T),T.lastChild),t||v)for(;Wa(T);)p.before(Wa(T));else p.before(T)}})}function kl(i,c,t,v,f){_a&&fs();var p=c.$$slots?.[t],g=!1;p===!0&&(p=c[t],g=!0),p===void 0?f!==null&&f(i):p(i,g?()=>v:v)}function $l(i,c,t,v){var f=i.__style;if(_a||f!==c){var p=fl(c);(!_a||p!==i.getAttribute("style"))&&(p==null?i.removeAttribute("style"):i.style.cssText=p),i.__style=c}return v}function Xa(i,c,t=!1){if(i.multiple){if(c==null)return;if(!Is(c))return ll();for(var v of i.options)v.selected=c.includes(Ea(v));return}for(v of i.options){var f=Ea(v);if(Es(f,c)){v.selected=!0;return}}(!t||c!==void 0)&&(i.selectedIndex=-1)}function gs(i){var c=new MutationObserver(()=>{Xa(i,i.__value)});c.observe(i,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),_s(()=>{c.disconnect()})}function Na(i,c,t=c){var v=new WeakSet,f=!0;Za(i,"change",p=>{var g=p?"[selected]":":checked",S;if(i.multiple)S=[].map.call(i.querySelectorAll(g),Ea);else{var x=i.querySelector(g)??i.querySelector("option:not([disabled])");S=x&&Ea(x)}t(S),$a!==null&&v.add($a)}),Us(()=>{var p=c();if(i===document.activeElement){var g=Ns??$a;if(v.has(g))return}if(Xa(i,p,f),f&&p===void 0){var S=i.querySelector(":checked");S!==null&&(p=Ea(S),t(p))}i.__value=p,f=!1}),gs(i)}function Ea(i){return"__value"in i?i.__value:i.value}const wl=Symbol("is custom element"),Sl=Symbol("is html");function $e(i){if(_a){var c=!1,t=()=>{if(!c){if(c=!0,i.hasAttribute("value")){var v=i.value;vt(i,"value",null),i.value=v}if(i.hasAttribute("checked")){var f=i.checked;vt(i,"checked",null),i.checked=f}}};i.__on_r=t,ps(t),ol()}}function Ra(i,c){var t=xs(i);t.value===(t.value=c??void 0)||i.value===c&&(c!==0||i.nodeName!=="PROGRESS")||(i.value=c??"")}function Os(i,c){var t=xs(i);t.checked!==(t.checked=c??void 0)&&(i.checked=c)}function vt(i,c,t,v){var f=xs(i);_a&&(f[c]=i.getAttribute(c),c==="src"||c==="srcset"||c==="href"&&i.nodeName==="LINK")||f[c]!==(f[c]=t)&&(c==="loading"&&(i[il]=t),t==null?i.removeAttribute(c):typeof t!="string"&&Cl(i).includes(c)?i[c]=t:i.setAttribute(c,t))}function xs(i){return i.__attributes??={[wl]:i.nodeName.includes("-"),[Sl]:i.namespaceURI===nl}}var Ls=new Map;function Cl(i){var c=i.getAttribute("is")||i.nodeName,t=Ls.get(c);if(t)return t;Ls.set(c,t=[]);for(var v,f=i,p=Element.prototype;p!==f;){v=cl(f);for(var g in v)v[g].set&&t.push(g);f=rl(f)}return t}function Ve(i,c,t=c){var v=new WeakSet;Za(i,"input",async f=>{var p=f?i.defaultValue:i.value;if(p=os(i)?cs(p):p,t(p),$a!==null&&v.add($a),await vl(),p!==(p=c())){var g=i.selectionStart,S=i.selectionEnd,x=i.value.length;if(i.value=p??"",S!==null){var y=i.value.length;g===S&&S===x&&y>x?(i.selectionStart=y,i.selectionEnd=y):(i.selectionStart=g,i.selectionEnd=Math.min(S,y))}}}),(_a&&i.defaultValue!==i.value||n(c)==null&&i.value)&&(t(os(i)?cs(i.value):i.value),$a!==null&&v.add($a)),ys(()=>{var f=c();if(i===document.activeElement){var p=Ns??$a;if(v.has(p))return}os(i)&&f===cs(i.value)||i.type==="date"&&!f&&!i.value||f!==i.value&&(i.value=f??"")})}const rs=new Set;function As(i,c,t,v,f=v){var p=t.getAttribute("type")==="checkbox",g=i;let S=!1;if(c!==null)for(var x of c)g=g[x]??=[];g.push(t),Za(t,"change",()=>{var y=t.__value;p&&(y=js(g,y,t.checked)),f(y)},()=>f(p?[]:null)),ys(()=>{var y=v();if(_a&&t.defaultChecked!==t.checked){S=!0;return}p?(y=y||[],t.checked=y.includes(t.__value)):t.checked=Es(t.__value,y)}),_s(()=>{var y=g.indexOf(t);y!==-1&&g.splice(y,1)}),rs.has(g)||(rs.add(g),ps(()=>{g.sort((y,E)=>y.compareDocumentPosition(E)===4?-1:1),rs.delete(g)})),ps(()=>{if(S){var y;if(p)y=js(g,y,t.checked);else{var E=g.find(T=>T.checked);y=E?.__value}f(y)}})}function wa(i,c,t=c){Za(i,"change",v=>{var f=v?i.defaultChecked:i.checked;t(f)}),(_a&&i.defaultChecked!==i.checked||n(c)==null)&&t(i.checked),ys(()=>{var v=c();i.checked=!!v})}function js(i,c,t){for(var v=new Set,f=0;f<i.length;f+=1)i[f].checked&&v.add(i[f].__value);return t||v.delete(c),Array.from(v)}function os(i){var c=i.type;return c==="number"||c==="range"}function cs(i){return i===""?null:+i}function Dl(i,c,t){var v=dl(i,c);v&&v.set&&(i[c]=t,_s(()=>{i[c]=null}))}function ks(i){return function(...c){var t=c[0];return t.stopPropagation(),i?.apply(this,c)}}function Ma(i,c){var t=i.$$events?.[c.type],v=Is(t)?t.slice():t==null?[]:[t];for(var f of v)f.call(this,c)}const Ll="";function Gs(...i){return Ia+Ll+xl(i[0],i[1])}const bs={paladin:{name:"Paladin",hitDice:"d10",spellcaster:!0,spellcastingAbility:"charisma",spellSlotsByLevel:{1:0,2:2,3:3,4:3,5:4,6:4,7:4,8:4,9:4,10:4,11:4,12:4,13:4,14:4,15:4,16:4,17:4,18:4,19:4,20:4},features:[{name:"Divine Sense",type:"uses",maxUses:(i,c=1)=>1+Math.max(1,c),resetOn:"long",description:"Detect celestials, fiends, and undead within 60 feet",minLevel:1},{name:"Lay on Hands",type:"pool",maxPool:i=>i*5,resetOn:"long",description:"Heal wounds or cure disease",minLevel:1},{name:"Divine Smite",type:"spellSlot",description:"Expend spell slot to deal extra radiant damage",minLevel:2,rollable:!0},{name:"Channel Divinity",type:"pool",maxPool:i=>i>=18?3:i>=6?2:1,resetOn:"short",description:"Sacred Weapon or Turn Undead",minLevel:3}]},fighter:{name:"Fighter",hitDice:"d10",spellcaster:!1,features:[{name:"Second Wind",type:"uses",maxUses:1,resetOn:"short",description:"Regain 1d10 + fighter level HP as bonus action",minLevel:1,rollable:!0,rollFormula:i=>`1d10+${i}`},{name:"Action Surge",type:"uses",maxUses:i=>i>=17?2:1,resetOn:"short",description:"Take one additional action on your turn",minLevel:2},{name:"Indomitable",type:"uses",maxUses:i=>i>=17?3:i>=13?2:1,resetOn:"long",description:"Reroll a failed saving throw",minLevel:9}],subclasses:{champion:{name:"Champion",features:[{name:"Improved Critical",type:"info",description:"Critical hit on 19-20",minLevel:3},{name:"Remarkable Athlete",type:"info",description:"Add half proficiency to STR/DEX/CON checks, increase long jump distance",minLevel:7},{name:"Additional Fighting Style",type:"info",description:"Choose a second fighting style",minLevel:10},{name:"Superior Critical",type:"info",description:"Critical hit on 18-20",minLevel:15},{name:"Survivor",type:"info",description:"Regain 5 + CON mod HP at start of turn if below half HP",minLevel:18}]},battlemaster:{name:"Battle Master",features:[{name:"Combat Superiority",type:"uses",maxUses:i=>i>=15?6:i>=7?5:4,resetOn:"short",description:i=>`Use superiority dice (${i>=18?"d12":i>=10?"d10":"d8"}) for maneuvers`,minLevel:3},{name:"Know Your Enemy",type:"info",description:"Learn capabilities of creatures you observe",minLevel:7},{name:"Improved Combat Superiority",type:"info",description:"Superiority dice become d10",minLevel:10},{name:"Relentless",type:"info",description:"Regain 1 superiority die if you have none at start of turn",minLevel:15}]}}},rogue:{name:"Rogue",hitDice:"d8",spellcaster:!1,features:[{name:"Sneak Attack",type:"info",description:i=>`Deal ${Math.ceil(i/2)}d6 extra damage once per turn with advantage or ally nearby`,minLevel:1,rollable:!0,rollFormula:i=>`${Math.ceil(i/2)}d6`},{name:"Cunning Action",type:"info",description:"Dash, Disengage, or Hide as a bonus action",minLevel:2},{name:"Uncanny Dodge",type:"info",description:"Use reaction to halve damage from an attack",minLevel:5},{name:"Evasion",type:"info",description:"Take no damage on successful Dex save (half on fail)",minLevel:7}]},wizard:{name:"Wizard",hitDice:"d6",spellcaster:!0,spellcastingAbility:"intelligence",spellSlotsByLevel:{1:2,2:3,3:4,4:4,5:4,6:4,7:4,8:4,9:4,10:4,11:4,12:4,13:4,14:4,15:4,16:4,17:4,18:4,19:4,20:4},features:[{name:"Arcane Recovery",type:"uses",maxUses:1,resetOn:"long",description:i=>`Recover spell slots totaling up to ${Math.ceil(i/2)} levels during short rest`,minLevel:1},{name:"Spell Mastery",type:"info",description:"Cast one 1st-level and one 2nd-level spell at will",minLevel:18}]},cleric:{name:"Cleric",hitDice:"d8",spellcaster:!0,spellcastingAbility:"wisdom",spellSlotsByLevel:{1:2,2:3,3:4,4:4,5:4,6:4,7:4,8:4,9:4,10:4,11:4,12:4,13:4,14:4,15:4,16:4,17:4,18:4,19:4,20:4},features:[{name:"Channel Divinity",type:"pool",maxPool:i=>i>=18?4:i>=6?3:2,resetOn:"short",description:"Turn Undead or domain-specific ability",minLevel:2},{name:i=>i>=5?"Sear Undead":"Turn Undead",subName:i=>i>=5?"Improved Turn Undead":null,type:"channelDivinity",description:(i,c=1)=>{let t="As a Magic action, you present your Holy Symbol and censure Undead creatures. Each Undead of your choice within 30 feet of you must make a Wisdom saving throw. If the creature fails its save, it has the Frightened and Incapacitated conditions for 1 minute. For that duration, it tries to move as far from you as it can on its turns. This effect ends early on the creature if it takes any damage, if you have the Incapacitated condition, or if you die.";if(i>=5){const v=Math.max(1,c);t+=` <br /><br />
            
          With Sear Undead, roll ${v}d8 radiant damage to turned undead.`}return t},minLevel:2,rollable:!0,rollFormula:(i,c=1)=>i>=5?`${Math.max(1,c)}d8`:""},{name:"Divine Intervention",type:"uses",maxUses:1,resetOn:"long",description:i=>`${i}% chance to succeed, implore deity for aid`,minLevel:10}],subclasses:{war:{name:"War Domain",features:[{name:"War Priest",type:"uses",maxUses:(i,c=1)=>Math.max(1,c),resetOn:"long",description:"Make one weapon attack as a bonus action",minLevel:1},{name:"Channel Divinity",type:"info",description:"Additional Channel Divinity options from War Domain",minLevel:2,subFeatures:[{name:"Guided Strike",type:"channelDivinity",description:"Use your Channel Divinity to gain +10 to an attack roll. Make this choice after you see the roll, but before the DM says whether the attack hits or misses.",minLevel:2},{name:"War God's Blessing",type:"channelDivinity",description:"Use reaction to grant +10 to an ally's attack roll within 30 feet. Consumes one use of Channel Divinity.",minLevel:6,resetOn:"short"}]},{name:"Divine Strike",type:"info",description:i=>`Deal extra ${i>=14?"2d8":"1d8"} weapon damage once per turn`,minLevel:8,rollable:!0,rollFormula:i=>i>=14?"2d8":"1d8"},{name:"Avatar of Battle",type:"info",description:"Gain resistance to nonmagical weapon damage",minLevel:17}]},life:{name:"Life Domain",features:[{name:"Disciple of Life",type:"info",description:"Healing spells restore additional 2 + spell level HP",minLevel:1},{name:"Preserve Life",type:"pool",maxPool:i=>i*5,resetOn:"short",description:"Restore HP to creatures within 30 feet",minLevel:2},{name:"Blessed Healer",type:"info",description:"Regain 2 + spell level HP when you cast healing spell",minLevel:6},{name:"Divine Strike",type:"info",description:i=>`Deal extra ${i>=14?"2d8":"1d8"} radiant damage once per turn`,minLevel:8,rollable:!0,rollFormula:i=>i>=14?"2d8":"1d8"},{name:"Supreme Healing",type:"info",description:"Maximize healing dice instead of rolling",minLevel:17}]}}},barbarian:{name:"Barbarian",hitDice:"d12",spellcaster:!1,features:[{name:"Rage",type:"uses",maxUses:i=>i>=20?1/0:i>=17?6:i>=12?5:i>=6?4:i>=3?3:2,resetOn:"long",description:i=>`+${i>=16?4:i>=9?3:2} damage, resistance to physical damage`,minLevel:1},{name:"Reckless Attack",type:"info",description:"Gain advantage on melee attacks, enemies get advantage on you",minLevel:2},{name:"Danger Sense",type:"info",description:"Advantage on Dex saves against effects you can see",minLevel:2}],subclasses:{berserker:{name:"Path of the Berserker",features:[{name:"Frenzy",type:"info",description:"While raging, make melee attack as bonus action (gain 1 exhaustion after rage)",minLevel:3},{name:"Mindless Rage",type:"info",description:"Cannot be charmed or frightened while raging",minLevel:6},{name:"Intimidating Presence",type:"info",description:"Use action to frighten creature within 30 feet",minLevel:10},{name:"Retaliation",type:"info",description:"When damaged by creature within 5 feet, make melee attack as reaction",minLevel:14}]}}}};function va(i){const c=i.toLowerCase();return bs[c]||null}function Ta(i,c,t){const v=va(i);if(!v)return[];const f=v.features.filter(p=>!p.minLevel||p.minLevel<=c);if(t&&v.subclasses&&v.subclasses[t]){const p=v.subclasses[t].features.filter(g=>!g.minLevel||g.minLevel<=c);return[...f,...p]}return f}function Bs(i){const c=va(i);return!c||!c.subclasses?[]:Object.keys(c.subclasses).map(t=>({id:t,name:c.subclasses[t].name}))}function Rs(i,c){const t=va(i);return!t||!t.spellcaster||!t.spellSlotsByLevel?0:t.spellSlotsByLevel[c]||0}function Ms(i,c,t){const v=va(i);return!v||!v.spellcaster?0:Math.max(1,t+c)}function Al(i,c,t){const v=va(i);return!v||!v.spellcaster?null:8+c+t}function jl(){return Object.keys(bs).map(i=>({id:i,name:bs[i].name}))}var Bl=d('<div class="section-header svelte-ls99y2" role="button" tabindex="0"><h2 class="svelte-ls99y2"> </h2> <span class="collapse-btn svelte-ls99y2"> </span></div>');function Da(i,c){Zt(c,!1);let t=At(c,"title",8),v=At(c,"collapsed",8),f=At(c,"ariaLabel",8,""),p=At(c,"onToggle",8);Xt();var g=Bl(),S=l(g),x=l(S,!0);s(S);var y=a(S,2),E=l(y,!0);s(y),s(g),L(()=>{vt(g,"aria-expanded",!v()),vt(g,"aria-label",f()),$(x,t()),$(E,v()?"‚ñº":"‚ñ≤")}),B("click",g,function(...T){p()?.apply(this,T)}),B("keydown",g,T=>{(T.key==="Enter"||T.key===" ")&&p()()}),o(i,g),ea()}var Rl=d("<option> </option>"),Ml=d("<option> </option>"),Tl=d('<div class="form-group svelte-172i2fj"><label for="characterSubclass" class="svelte-172i2fj">Subclass</label> <select id="characterSubclass" class="svelte-172i2fj"><option>Select Subclass</option><!></select></div>'),Fl=d('<div class="info-grid svelte-172i2fj"><div class="form-group svelte-172i2fj"><label for="characterName" class="svelte-172i2fj">Character Name</label> <input type="text" id="characterName" placeholder="Enter name" class="svelte-172i2fj"/></div> <div class="form-group svelte-172i2fj"><label for="characterClass" class="svelte-172i2fj">Class</label> <select id="characterClass" class="svelte-172i2fj"><option>Select Class</option><!></select></div> <!> <div class="form-group svelte-172i2fj"><label for="characterLevel" class="svelte-172i2fj">Level</label> <input type="number" id="characterLevel" min="1" max="20" class="svelte-172i2fj"/></div> <div class="form-group svelte-172i2fj"><label for="characterRace" class="svelte-172i2fj">Race</label> <input type="text" id="characterRace" placeholder="e.g., Human" class="svelte-172i2fj"/></div> <div class="form-group svelte-172i2fj"><label for="characterBackground" class="svelte-172i2fj">Background</label> <input type="text" id="characterBackground" placeholder="e.g., Soldier" class="svelte-172i2fj"/></div> <div class="form-group svelte-172i2fj"><label for="characterAlignment" class="svelte-172i2fj">Alignment</label> <input type="text" id="characterAlignment" placeholder="e.g., Lawful Good" class="svelte-172i2fj"/></div></div>'),Pl=d('<section class="character-info svelte-172i2fj"><!> <!></section>');function Il(i,c){Zt(c,!1);const t=()=>_t(pe,"$character",f),v=()=>_t(ia,"$collapsedStates",f),[f,p]=da(),g=w(),S=jl();function x(U){const M=U.target;pe.update(F=>(F.class=M.value,F.subclass="",F))}function y(U){const M=U.target;pe.update(F=>(F.subclass=M.value,F))}function E(U){const M=U.target;pe.update(F=>(F.level=parseInt(M.value)||1,F)),Hs()}Qe(()=>(t(),Bs),()=>{r(g,t().class?Bs(t().class):[])}),ma(),Xt();var T=Pl(),X=l(T);{let U=yt(()=>(v(),n(()=>v().characterInfo?"Expand":"Collapse")));Da(X,{title:"Character Info",get collapsed(){return v(),n(()=>v().characterInfo)},get ariaLabel(){return e(U)},onToggle:()=>ia.update(M=>({...M,characterInfo:!M.characterInfo}))})}var Y=a(X,2);{var ee=U=>{var M=Fl(),F=l(M),ie=a(l(F),2);$e(ie),s(F);var ge=a(F,2),Ge=a(l(ge),2),De=l(Ge);De.value=De.__value="";var ve=a(De);Ct(ve,1,()=>S,jt,(Je,Ee)=>{var Ae=Rl(),h=l(Ae,!0);s(Ae);var P={};L(()=>{$(h,(e(Ee),n(()=>e(Ee).name))),P!==(P=(e(Ee),n(()=>e(Ee).id)))&&(Ae.value=(Ae.__value=(e(Ee),n(()=>e(Ee).id)))??"")}),o(Je,Ae)}),s(Ge);var ce;gs(Ge),s(ge);var ye=a(ge,2);{var qe=Je=>{var Ee=Tl(),Ae=a(l(Ee),2),h=l(Ae);h.value=h.__value="";var P=a(h);Ct(P,1,()=>e(g),jt,(Ze,tt)=>{var mt=Ml(),Dt=l(mt,!0);s(mt);var Bt={};L(()=>{$(Dt,(e(tt),n(()=>e(tt).name))),Bt!==(Bt=(e(tt),n(()=>e(tt).id)))&&(mt.value=(mt.__value=(e(tt),n(()=>e(tt).id)))??"")}),o(Ze,mt)}),s(Ae);var de;gs(Ae),s(Ee),L(()=>{de!==(de=(t(),n(()=>t().subclass)))&&(Ae.value=(Ae.__value=(t(),n(()=>t().subclass)))??"",Xa(Ae,(t(),n(()=>t().subclass))))}),B("change",Ae,y),o(Je,Ee)};m(ye,Je=>{e(g),n(()=>e(g).length>0)&&Je(qe)})}var V=a(ye,2),A=a(l(V),2);$e(A),s(V);var _=a(V,2),H=a(l(_),2);$e(H),s(_);var W=a(_,2),me=a(l(W),2);$e(me),s(W);var _e=a(W,2),Ie=a(l(_e),2);$e(Ie),s(_e),s(M),L(()=>{ce!==(ce=(t(),n(()=>t().class)))&&(Ge.value=(Ge.__value=(t(),n(()=>t().class)))??"",Xa(Ge,(t(),n(()=>t().class)))),Ra(A,(t(),n(()=>t().level)))}),Ve(ie,()=>t().name,Je=>Gt(pe,n(t).name=Je,n(t))),B("change",Ge,x),B("change",A,E),Ve(H,()=>t().race,Je=>Gt(pe,n(t).race=Je,n(t))),Ve(me,()=>t().background,Je=>Gt(pe,n(t).background=Je,n(t))),Ve(Ie,()=>t().alignment,Je=>Gt(pe,n(t).alignment=Je,n(t))),o(U,M)};m(Y,U=>{v(),n(()=>!v().characterInfo)&&U(ee)})}s(T),o(i,T),ea(),p()}var El=d('<div class="ability-card svelte-bbv1xt"><h3 class="svelte-bbv1xt"> </h3> <input type="number" class="ability-score svelte-bbv1xt" min="1" max="30"/> <div class="ability-modifier svelte-bbv1xt"> </div> <div class="roll-buttons svelte-bbv1xt"><button class="roll-btn svelte-bbv1xt">Check</button> <button class="roll-btn svelte-bbv1xt">Save</button></div> <div class="save-proficiency svelte-bbv1xt"><input type="checkbox" class="svelte-bbv1xt"/> <label class="svelte-bbv1xt">Save Prof.</label></div></div>'),Ul=d('<div class="proficiency-bonus svelte-bbv1xt"><label for="profBonus">Proficiency Bonus</label> <input type="number" id="profBonus" class="prof-input svelte-bbv1xt"/></div> <div class="abilities-grid svelte-bbv1xt"></div>',1),Nl=d("<section><!> <!></section>");function Hl(i,c){Zt(c,!1);const t=()=>_t(es,"$abilityModifiers",S),v=()=>_t(pe,"$character",S),f=()=>_t(xa,"$searchFilter",S),p=()=>_t(ia,"$collapsedStates",S),g=()=>_t(Sa,"$isEditMode",S),[S,x]=da(),y=w(),E=w(),T=ka(),X=[{key:"strength",label:"Strength"},{key:"dexterity",label:"Dexterity"},{key:"constitution",label:"Constitution"},{key:"intelligence",label:"Intelligence"},{key:"wisdom",label:"Wisdom"},{key:"charisma",label:"Charisma"}];function Y(){Hs()}function ee(De){const ve=t()[De],ce=`1d20${ve>=0?"+":""}${ve}`,ye=[];ye.push({value:"1d20",source:"base die"}),ve!==0&&ye.push({value:ve,source:De}),T("roll",{notation:ce,rollType:"check",bonusBreakdown:ye})}function U(De){const ve=t()[De],ce=v().saveProficiencies[De]?v().proficiencyBonus:0,ye=ve+ce,qe=`1d20${ye>=0?"+":""}${ye}`,V=[];V.push({value:"1d20",source:"base die"}),ve!==0&&V.push({value:ve,source:De}),ce!==0&&V.push({value:ce,source:"proficiency"}),T("roll",{notation:qe,rollType:"save",bonusBreakdown:V})}Qe(()=>f(),()=>{r(y,X.filter(({label:De})=>f()?De.toLowerCase().includes(f().toLowerCase()):!0))}),Qe(()=>(e(y),f()),()=>{r(E,e(y).length>0||!f()||f().toLowerCase().includes("proficiency"))}),ma(),Xt();var M=Nl();let F;var ie=l(M);Da(ie,{title:"Ability Scores",get collapsed(){return p(),n(()=>p().abilityScores)},ariaLabel:"Toggle Ability Scores Section",onToggle:()=>ia.update(De=>({...De,abilityScores:!De.abilityScores}))});var ge=a(ie,2);{var Ge=De=>{var ve=Ul(),ce=Ce(ve),ye=a(l(ce),2);$e(ye),s(ce);var qe=a(ce,2);Ct(qe,5,()=>e(y),jt,(V,A)=>{let _=()=>e(A).key,H=()=>e(A).label;var W=El(),me=l(W),_e=l(me,!0);s(me);var Ie=a(me,2);$e(Ie);var Je=a(Ie,2),Ee=l(Je);s(Je);var Ae=a(Je,2),h=l(Ae),P=a(h,2);s(Ae);var de=a(Ae,2),Ze=l(de);$e(Ze);var tt=a(Ze,2);s(de),s(W),L(mt=>{$(_e,mt),$(Ee,`${t(),_(),n(()=>t()[_()]>=0?"+":"")??""}${t(),_(),n(()=>t()[_()])??""}`),Ze.disabled=!g(),vt(Ze,"id",`${_()}-save`),vt(tt,"for",`${_()}-save`)},[()=>(H(),n(()=>H().substring(0,3).toUpperCase()))]),Ve(Ie,()=>v().abilities[_()],mt=>Gt(pe,n(v).abilities[_()]=mt,n(v))),B("change",Ie,Y),B("click",h,()=>ee(_())),B("click",P,()=>U(_())),wa(Ze,()=>v().saveProficiencies[_()],mt=>Gt(pe,n(v).saveProficiencies[_()]=mt,n(v))),o(V,W)}),s(qe),Ve(ye,()=>v().proficiencyBonus,V=>Gt(pe,n(v).proficiencyBonus=V,n(v))),o(De,ve)};m(ge,De=>{p(),n(()=>!p().abilityScores)&&De(Ge)})}s(M),L(()=>F=Ut(M,1,"ability-scores svelte-bbv1xt",null,F,{hidden:!e(E)})),o(i,M),ea(),x()}const qs=[{name:"Unarmored",type:"none",baseAC:10},{name:"Padded",type:"light",baseAC:11},{name:"Leather",type:"light",baseAC:11},{name:"Studded Leather",type:"light",baseAC:12},{name:"Hide",type:"medium",baseAC:12,maxDexBonus:2},{name:"Chain Shirt",type:"medium",baseAC:13,maxDexBonus:2},{name:"Scale Mail",type:"medium",baseAC:14,maxDexBonus:2},{name:"Breastplate",type:"medium",baseAC:14,maxDexBonus:2},{name:"Half Plate",type:"medium",baseAC:15,maxDexBonus:2},{name:"Ring Mail",type:"heavy",baseAC:14,maxDexBonus:0},{name:"Chain Mail",type:"heavy",baseAC:16,maxDexBonus:0},{name:"Splint",type:"heavy",baseAC:17,maxDexBonus:0},{name:"Plate",type:"heavy",baseAC:18,maxDexBonus:0}];function Ws(i){return qs.find(c=>c.name===i)}function Ol(i,c,t){if(!i)return 10+c+(t?2:0);const v=Ws(i);if(!v)return 10+c+(t?2:0);let f=v.baseAC;return v.maxDexBonus===void 0?f+=c:v.maxDexBonus>0&&(f+=Math.min(c,v.maxDexBonus)),t&&(f+=2),f}function Ha(i){return Math.floor((i-10)/2)}function hs(i,c){if(!i.class)return null;const t=va(i.class);if(!t||!t.spellcaster||!t.spellcastingAbility)return null;const v=Ha(c[t.spellcastingAbility]);return 8+i.proficiencyBonus+v}function vs(i,c){if(!i.class)return 0;const t=va(i.class);return!t||!t.spellcaster||!t.spellcastingAbility?0:Ha(c[t.spellcastingAbility])}function Gl(i,c){const t=[],v=Ha(c.dexterity),f=i.armorName?Ws(i.armorName):void 0;if(f){if(f.type==="none")t.push("Unarmored"),t.push("Base: 10"),t.push(`Dexterity: ${v>=0?"+":""}${v}`);else if(f.type==="light")t.push(`${f.name}: ${f.baseAC}`),t.push(`Dexterity: ${v>=0?"+":""}${v}`);else if(f.type==="medium"){const p=Math.min(2,v);t.push(`${f.name}: ${f.baseAC}`),t.push(`Dexterity: ${p>=0?"+":""}${p} (max +2)`)}else f.type==="heavy"&&(t.push(`${f.name}: ${f.baseAC}`),t.push("Dexterity: +0 (heavy armor)"));i.shieldEquipped&&t.push("Shield: +2")}else{t.push("Base: 10"),v!==0&&t.push(`Dexterity: ${v>=0?"+":""}${v}`);const p=10+v,g=i.armorClass-p;g!==0&&t.push(`Other: ${g>=0?"+":""}${g}`)}return i.activeStates&&i.activeStates.length>0&&i.activeStates.forEach(p=>{typeof p.acBonus=="number"&&p.acBonus!==0&&(!p.target||p.target==="self")&&t.push(`${p.name}: ${p.acBonus>=0?"+":""}${p.acBonus}`)}),t.join(`
`)}function ql(i,c){const t=[],v=Ha(c.dexterity);t.push(`Dexterity: ${v>=0?"+":""}${v}`);const f=i.initiative-v;return f!==0&&t.push(`Other Bonuses: ${f>=0?"+":""}${f}`),t.join(`
`)}function Wl(i,c){if(!i.class)return"";const t=va(i.class);if(!t||!t.spellcaster||!t.spellcastingAbility)return"";const v=[],f=Ha(c[t.spellcastingAbility]),p=t.spellcastingAbility.charAt(0).toUpperCase()+t.spellcastingAbility.slice(1);return v.push("Base: 8"),v.push(`Proficiency: +${i.proficiencyBonus}`),v.push(`${p}: ${f>=0?"+":""}${f}`),v.join(`
`)}function zl(i,c,t){const v=[];let f=i;const p=c.toLowerCase().trim();if(t.activeStates){for(const S of t.activeStates)if(S.immunities&&S.immunities.length>0&&S.immunities.some(y=>y.toLowerCase().trim()===p))return v.push(`Immune to ${c} (${S.name})`),{finalDamage:0,adjustments:v}}let g=!1;if(t.activeStates){for(const S of t.activeStates)if(S.resistances&&S.resistances.length>0&&S.resistances.some(y=>y.toLowerCase().trim()===p)){const y=Math.floor(f/2);v.push(`Resistant to ${c} (${S.name}): ${f} ‚Üí ${y}`),f=y,g=!0;break}}if(!g&&t.race){const S=Qa(t.race);if(S){for(const x of S.traits)if(x.resistances&&x.resistances.some(y=>y.toLowerCase().trim()===p)){const y=Math.floor(f/2);v.push(`Resistant to ${c} (racial trait): ${f} ‚Üí ${y}`),f=y,g=!0;break}}}return v.length===0&&v.push(`No adjustments for ${c}`),{finalDamage:f,adjustments:v}}function Kl(i,c){const t={...i};if(t.tempHP>0){if(c<=t.tempHP)return t.tempHP-=c,t;c-=t.tempHP,t.tempHP=0}return t.currentHP=Math.max(0,t.currentHP-c),t}var Vl=d('<button class="info-icon svelte-1o8ci7b" type="button">‚ÑπÔ∏è</button>'),Jl=d('<button class="info-icon svelte-1o8ci7b" type="button">‚ÑπÔ∏è</button>'),Yl=d("<div><!></div>"),Ql=d('<div class="tooltip-wrapper svelte-1o8ci7b"><!> <!></div>');function ds(i,c){Zt(c,!1);let t=At(c,"tooltipContent",8),v=At(c,"ariaLabel",8,"Show information"),f=w(!1),p=w(),g=w(!1),S=w(null),x=w(!1),y=w(!1),E=w("");const T=Math.random().toString(36).slice(2);function X(){window.dispatchEvent(new CustomEvent("tooltip-open",{detail:T}))}function Y(V){V.detail!==T&&(r(f,!1),r(x,!1))}function ee(){r(g,window.matchMedia("(pointer: coarse)").matches||"ontouchstart"in window)}function U(){if(!e(S)||!e(p))return;const V=e(p).getBoundingClientRect(),A=e(S).getBoundingClientRect();let _=V.bottom+5,H=V.left;r(x,!1),H+A.width>window.innerWidth-8&&(H=V.right-A.width,r(x,!0),H<8&&(H=8)),H<8&&(H=8),_+A.height>window.innerHeight-8&&(_=V.top-A.height-5),r(E,`position:fixed;top:${_}px;left:${H}px;z-index:1000;`),r(y,!0)}function M(){X(),r(f,!1),r(y,!1),requestAnimationFrame(()=>{r(f,!0),r(y,!1),setTimeout(U,0)})}function F(){r(f,!1),r(x,!1)}function ie(V){V.stopPropagation(),e(f)?(r(f,!1),r(x,!1),r(y,!1)):(X(),r(f,!1),r(y,!1),requestAnimationFrame(()=>{r(f,!0),r(y,!1),setTimeout(U,0)}))}function ge(V){e(p)&&!e(p).contains(V.target)&&(r(f,!1),r(x,!1))}Ca(()=>{ee(),document.addEventListener("click",ge),window.addEventListener("tooltip-open",Y)}),Js(()=>{document.removeEventListener("click",ge),window.removeEventListener("tooltip-open",Y)}),Xt();var Ge=Ql(),De=l(Ge);{var ve=V=>{var A=Vl();L(()=>vt(A,"aria-label",v())),B("click",A,ie),o(V,A)},ce=V=>{var A=Jl();L(()=>vt(A,"aria-label",v())),B("mouseenter",A,M),B("mouseleave",A,F),o(V,A)};m(De,V=>{e(g)?V(ve):V(ce,!1)})}var ye=a(De,2);{var qe=V=>{var A=Yl(),_=l(A);kl(_,c,"content",{},H=>{var W=$t(),me=Ce(W);ms(me,t),o(H,W)}),s(A),Ua(A,H=>r(S,H),()=>e(S)),L(()=>{Ut(A,1,`tooltip-popup ${e(x)?"right-align":""}`,"svelte-1o8ci7b"),$l(A,e(y)?e(E)+"opacity:1;pointer-events:auto;":"opacity:0;pointer-events:none;position:fixed;top:0;left:0;z-index:1000;")}),o(V,A)};m(ye,V=>{e(f)&&V(qe)})}s(Ge),Ua(Ge,V=>r(p,V),()=>e(p)),o(i,Ge),ea()}var Xl=d("<option> </option>"),Zl=d('<div class="armor-config svelte-1r5hyyb"><h4 class="svelte-1r5hyyb">Armor Configuration</h4> <div class="armor-controls svelte-1r5hyyb"><div class="armor-field svelte-1r5hyyb"><label for="armorName" class="svelte-1r5hyyb">Armor</label> <select id="armorName" class="armor-select svelte-1r5hyyb"><option>None (Unarmored)</option><!></select></div> <div class="armor-field svelte-1r5hyyb"><label class="shield-label svelte-1r5hyyb"><input type="checkbox" class="shield-checkbox svelte-1r5hyyb"/> Shield Equipped (+2 AC)</label></div></div></div>'),ei=d('<div class="stat-box svelte-1r5hyyb"><div class="stat-label-with-icon svelte-1r5hyyb"><label for="spellSaveDC" class="svelte-1r5hyyb">Spell Save DC</label> <!></div> <input type="number" id="spellSaveDC" class="stat-input svelte-1r5hyyb" readonly=""/></div>'),ti=d('<span class="hit-dice-type"> </span>'),ai=d('<!> <div class="stats-grid svelte-1r5hyyb"><div class="stat-box svelte-1r5hyyb"><div class="stat-label-with-icon svelte-1r5hyyb"><label for="armorClass" class="svelte-1r5hyyb">Armor Class</label> <!></div> <input type="text" id="armorClass" readonly=""/></div> <div class="stat-box svelte-1r5hyyb"><div class="stat-label-with-icon svelte-1r5hyyb"><label for="initiative" class="svelte-1r5hyyb">Initiative</label> <!></div> <div class="initiative-container svelte-1r5hyyb"><input type="text" id="initiative" class="stat-input initiative-input svelte-1r5hyyb" readonly=""/> <button class="btn btn-primary roll-initiative-btn use-enabled svelte-1r5hyyb" title="Roll Initiative">üé≤</button></div></div> <div class="stat-box svelte-1r5hyyb"><label for="speed" class="svelte-1r5hyyb">Speed</label> <input type="text" id="speed" class="stat-input svelte-1r5hyyb"/></div> <!></div> <div class="hp-section svelte-1r5hyyb"><h3 class="svelte-1r5hyyb">Hit Points</h3> <div><div class="hp-inputs svelte-1r5hyyb"><input type="number" class="hp-current svelte-1r5hyyb" min="0"/> <span class="hp-separator svelte-1r5hyyb">/</span> <input type="number" class="hp-max svelte-1r5hyyb" min="0"/></div> <div class="hp-controls svelte-1r5hyyb"><button class="hp-btn svelte-1r5hyyb">‚àí</button> <button class="hp-btn svelte-1r5hyyb">+</button> <button class="hp-btn svelte-1r5hyyb">‚àí5</button> <button class="hp-btn svelte-1r5hyyb">+5</button></div></div> <div class="temp-hp svelte-1r5hyyb"><label for="tempHP" class="svelte-1r5hyyb">Temp HP</label> <input type="number" id="tempHP" min="0" class="svelte-1r5hyyb"/></div></div> <div class="hit-dice-section svelte-1r5hyyb"><h3 class="svelte-1r5hyyb">Hit Dice</h3> <div class="hit-dice-display svelte-1r5hyyb"><input type="number" class="hit-dice-input svelte-1r5hyyb" min="0"/> <span>/</span> <input type="number" class="hit-dice-input svelte-1r5hyyb" min="0"/> <!></div> <div class="hit-dice-controls svelte-1r5hyyb"><label for="hitDiceCount" class="svelte-1r5hyyb">Roll</label> <div class="hit-dice-count-controls svelte-1r5hyyb"><button class="hit-dice-btn svelte-1r5hyyb">‚àí</button> <input type="number" id="hitDiceCount" class="hit-dice-count-input svelte-1r5hyyb" min="1"/> <button class="hit-dice-btn svelte-1r5hyyb">+</button></div> <button class="btn btn-primary roll-hit-dice use-enabled svelte-1r5hyyb">üé≤ Roll</button></div></div>',1),si=d("<section><!> <!></section>");function li(i,c){Zt(c,!1);const t=()=>_t(pe,"$character",S),v=()=>_t(es,"$abilityModifiers",S),f=()=>_t(xa,"$searchFilter",S),p=()=>_t(ia,"$collapsedStates",S),g=()=>_t(Sa,"$isEditMode",S),[S,x]=da(),y=w(),E=w(),T=w(),X=w(),Y=w(),ee=w(),U=w(),M=ka();let F=w(1);function ie(A){pe.update(_=>(_.currentHP=Math.max(0,Math.min(_.maxHP,_.currentHP+A)),_))}function ge(A){const _=e(F)+A,H=t().hitDice.current;r(F,Math.max(1,Math.min(H,_)))}function Ge(A=1){if(t().hitDice.current<=0){alert("No hit dice remaining!");return}if(!t().class){alert("Please select a class first!");return}const _=va(t().class);if(!_){alert("Invalid class configuration!");return}const H=Math.min(A,t().hitDice.current),W=_.hitDice,me=v().constitution,_e=me*H,Ie=_e>=0?`+${_e}`:`${_e}`,Je=`${H}${W}${Ie}`,Ee=[];if(Ee.push({value:`${H}${W}`,source:"hit dice"}),me!==0)for(let Ae=0;Ae<H;Ae++)Ee.push({value:me,source:"constitution"});M("rollHitDice",{notation:Je,hitDie:W,count:H,bonusBreakdown:Ee})}function De(){const A=t().initiative,H=`1d20${A>=0?`+${A}`:`${A}`}`,W=[];W.push({value:"1d20",source:"base"}),A!==0&&W.push({value:A,source:"initiative"}),M("rollInitiative",{notation:H,bonusBreakdown:W})}Qe(()=>(t(),v(),pe),()=>{if(t().armorName!==void 0||t().shieldEquipped!==void 0){const A=v().dexterity,_=Ol(t().armorName,A,t().shieldEquipped||!1);t().armorClass!==_&&pe.update(H=>({...H,armorClass:_}))}}),Qe(()=>(v(),t(),pe),()=>{const A=v().dexterity;t().initiative!==A&&pe.update(_=>({..._,initiative:A}))}),Qe(()=>t(),()=>{r(y,hs(t(),t().abilities))}),Qe(()=>t(),()=>{r(E,Gl(t(),t().abilities))}),Qe(()=>t(),()=>{r(T,ql(t(),t().abilities))}),Qe(()=>t(),()=>{r(X,Wl(t(),t().abilities))}),Qe(()=>(t(),e(F)),()=>{const A=t().hitDice.current;A>0&&e(F)>A&&r(F,A)}),Qe(()=>t(),()=>{r(Y,t().activeStates&&t().activeStates.length>0?t().activeStates.reduce((A,_)=>A+(_.acBonus||0),0):0)}),Qe(()=>t(),()=>{r(ee,t().activeStates&&t().activeStates.length>0?t().activeStates.some(A=>A.name==="Aid"&&A.target==="self"):!1)}),Qe(()=>f(),()=>{r(U,!f()||"armor class".includes(f().toLowerCase())||"initiative".includes(f().toLowerCase())||"speed".includes(f().toLowerCase())||"hit points".includes(f().toLowerCase())||"hp".includes(f().toLowerCase())||"hit dice".includes(f().toLowerCase())||"spell save".includes(f().toLowerCase())||"combat".includes(f().toLowerCase()))}),ma(),Xt();var ve=si();let ce;var ye=l(ve);{let A=yt(()=>(p(),n(()=>p().combatStats?"Expand":"Collapse")));Da(ye,{title:"Combat Stats",get collapsed(){return p(),n(()=>p().combatStats)},get ariaLabel(){return e(A)},onToggle:()=>ia.update(_=>({..._,combatStats:!_.combatStats}))})}var qe=a(ye,2);{var V=A=>{var _=ai(),H=Ce(_);{var W=he=>{var Le=Zl(),Ue=a(l(Le),2),ft=l(Ue),J=a(l(ft),2);L(()=>{t(),Jt(()=>{})});var ze=l(J);ze.value=(ze.__value=void 0)??"";var dt=a(ze);Ct(dt,1,()=>qs,jt,(ne,le)=>{var Te=$t(),at=Ce(Te);{var Fe=re=>{var q=Xl(),nt=l(q);s(q);var be={};L(()=>{$(nt,`${e(le),n(()=>e(le).name)??""} (AC ${e(le),n(()=>e(le).baseAC)??""})`),be!==(be=(e(le),n(()=>e(le).name)))&&(q.value=(q.__value=(e(le),n(()=>e(le).name)))??"")}),o(re,q)};m(at,re=>{e(le),n(()=>e(le).name!=="Unarmored")&&re(Fe)})}o(ne,Te)}),s(J),s(ft);var b=a(ft,2),N=l(b),oe=l(N);$e(oe),sa(),s(N),s(b),s(Ue),s(Le),Na(J,()=>t().armorName,ne=>Gt(pe,n(t).armorName=ne,n(t))),wa(oe,()=>t().shieldEquipped,ne=>Gt(pe,n(t).shieldEquipped=ne,n(t))),o(he,Le)};m(H,he=>{g()&&he(W)})}var me=a(H,2),_e=l(me),Ie=l(_e),Je=a(l(Ie),2);ds(Je,{get tooltipContent(){return e(E)},ariaLabel:"Show AC breakdown"}),s(Ie);var Ee=a(Ie,2);$e(Ee),s(_e);var Ae=a(_e,2),h=l(Ae),P=a(l(h),2);ds(P,{get tooltipContent(){return e(T)},ariaLabel:"Show Initiative breakdown"}),s(h);var de=a(h,2),Ze=l(de);$e(Ze);var tt=a(Ze,2);s(de),s(Ae);var mt=a(Ae,2),Dt=a(l(mt),2);$e(Dt),s(mt);var Bt=a(mt,2);{var C=he=>{var Le=ei(),Ue=l(Le),ft=a(l(Ue),2);ds(ft,{get tooltipContent(){return e(X)},ariaLabel:"Show Spell Save DC breakdown"}),s(Ue);var J=a(Ue,2);$e(J),s(Le),L(()=>Ra(J,e(y))),o(he,Le)};m(Bt,he=>{e(y)!==null&&he(C)})}s(me);var K=a(me,2),j=a(l(K),2);let G;var Q=l(j),ue=l(Q);$e(ue);var He=a(ue,4);$e(He),s(Q);var Re=a(Q,2),je=l(Re),Be=a(je,2),k=a(Be,2),se=a(k,2);s(Re),s(j);var z=a(j,2),Me=a(l(z),2);$e(Me),s(z),s(K);var we=a(K,2),st=a(l(we),2),xe=l(st);$e(xe);var Z=a(xe,4);$e(Z);var u=a(Z,2);{var lt=he=>{const Le=yt(()=>(I(va),t(),n(()=>va(t().class))));var Ue=$t(),ft=Ce(Ue);{var J=ze=>{const dt=yt(()=>(v(),n(()=>v().constitution)));var b=ti(),N=l(b);s(b),L(()=>$(N,`(${I(e(Le)),n(()=>e(Le).hitDice)??""}${(e(dt)>=0?`+${e(dt)}`:e(dt))??""})`)),o(ze,b)};m(ft,ze=>{e(Le)&&ze(J)})}o(he,Ue)};m(u,he=>{t(),n(()=>t().class)&&he(lt)})}s(st);var Oe=a(st,2),O=a(l(Oe),2),Se=l(O),Ye=a(Se,2);$e(Ye);var gt=a(Ye,2);s(O);var it=a(O,2);s(Oe),s(we),L(()=>{Ra(Ee,(e(Y),t(),n(()=>e(Y)!==0?`${t().armorClass} ‚Üí ${t().armorClass+e(Y)}`:`${t().armorClass}`))),Ut(Ee,1,pl(e(Y)!==0?"stat-input ac-enhanced":"stat-input"),"svelte-1r5hyyb"),Ra(Ze,(t(),n(()=>t().initiative))),G=Ut(j,1,"hp-display svelte-1r5hyyb",null,G,{"aid-active":e(ee)}),vt(ue,"max",(t(),n(()=>t().maxHP))),vt(xe,"max",(t(),n(()=>t().hitDice.max))),Se.disabled=e(F)<=1,vt(Ye,"max",(t(),n(()=>t().hitDice.current))),gt.disabled=(e(F),t(),n(()=>e(F)>=t().hitDice.current)),it.disabled=(t(),n(()=>t().hitDice.current<=0||!t().class))}),B("click",tt,De),Ve(Dt,()=>t().speed,he=>Gt(pe,n(t).speed=he,n(t))),Ve(ue,()=>t().currentHP,he=>Gt(pe,n(t).currentHP=he,n(t))),Ve(He,()=>t().maxHP,he=>Gt(pe,n(t).maxHP=he,n(t))),B("click",je,()=>ie(-1)),B("click",Be,()=>ie(1)),B("click",k,()=>ie(-5)),B("click",se,()=>ie(5)),Ve(Me,()=>t().tempHP,he=>Gt(pe,n(t).tempHP=he,n(t))),Ve(xe,()=>t().hitDice.current,he=>Gt(pe,n(t).hitDice.current=he,n(t))),Ve(Z,()=>t().hitDice.max,he=>Gt(pe,n(t).hitDice.max=he,n(t))),B("click",Se,()=>ge(-1)),Ve(Ye,()=>e(F),he=>r(F,he)),B("input",Ye,he=>{const Le=he.target,Ue=parseInt(Le.value);Ue>t().hitDice.current&&r(F,t().hitDice.current),Ue<1&&r(F,1)}),B("click",gt,()=>ge(1)),B("click",it,()=>Ge(e(F))),o(A,_)};m(qe,A=>{p(),n(()=>!p().combatStats)&&A(V)})}s(ve),L(()=>ce=Ut(ve,1,"combat-stats svelte-1r5hyyb",null,ce,{hidden:!e(U)})),o(i,ve),ea(),x()}const za={acrobatics:"dexterity",animalHandling:"wisdom",arcana:"intelligence",athletics:"strength",deception:"charisma",history:"intelligence",insight:"wisdom",intimidation:"charisma",investigation:"intelligence",medicine:"wisdom",nature:"intelligence",perception:"wisdom",performance:"charisma",persuasion:"charisma",religion:"intelligence",sleightOfHand:"dexterity",stealth:"dexterity",survival:"wisdom"};var ii=d('<div class="skill-row svelte-1f1pl16"><input type="checkbox" class="svelte-1f1pl16"/> <label class="svelte-1f1pl16"> <span class="ability-tag svelte-1f1pl16"> </span></label> <span class="skill-modifier svelte-1f1pl16"> </span> <button class="roll-btn svelte-1f1pl16">Roll</button></div>'),ni=d('<div class="skills-grid svelte-1f1pl16"></div>'),ri=d("<section><!> <!></section>");function oi(i,c){Zt(c,!1);const t=()=>_t(pe,"$character",S),v=()=>_t(es,"$abilityModifiers",S),f=()=>_t(xa,"$searchFilter",S),p=()=>_t(ia,"$collapsedStates",S),g=()=>_t(Sa,"$isEditMode",S),[S,x]=da(),y=w(),E=w(),T=w(),X=w(),Y=w(),ee=w(),U=ka(),M=[{key:"acrobatics",label:"Acrobatics"},{key:"animalHandling",label:"Animal Handling"},{key:"arcana",label:"Arcana"},{key:"athletics",label:"Athletics"},{key:"deception",label:"Deception"},{key:"history",label:"History"},{key:"insight",label:"Insight"},{key:"intimidation",label:"Intimidation"},{key:"investigation",label:"Investigation"},{key:"medicine",label:"Medicine"},{key:"nature",label:"Nature"},{key:"perception",label:"Perception"},{key:"performance",label:"Performance"},{key:"persuasion",label:"Persuasion"},{key:"religion",label:"Religion"},{key:"sleightOfHand",label:"Sleight of Hand"},{key:"stealth",label:"Stealth"},{key:"survival",label:"Survival"}];function F(ce){const ye=za[ce],qe=v()[ye],V=t().skillProficiencies[ce]?t().proficiencyBonus:0,A=e(y)[ce],_=`1d20${A>=0?"+":""}${A}`,H=[];H.push({value:"1d20",source:"base die"}),qe!==0&&H.push({value:qe,source:ye}),V!==0&&H.push({value:V,source:"proficiency"}),U("roll",{notation:_,rollType:"check",bonusBreakdown:H})}Qe(()=>{},()=>{r(y,{})}),Qe(()=>t(),()=>{r(E,t().skillProficiencies)}),Qe(()=>t(),()=>{r(T,t().proficiencyBonus)}),Qe(()=>v(),()=>{r(X,v())}),Qe(()=>(e(X),e(E),e(T)),()=>{for(const{key:ce}of M){const ye=za[ce],qe=e(X)[ye],V=e(E)[ce]?e(T):0;ha(y,e(y)[ce]=qe+V)}}),Qe(()=>f(),()=>{r(Y,M.filter(({label:ce})=>f()?ce.toLowerCase().includes(f().toLowerCase()):!0))}),Qe(()=>e(Y),()=>{r(ee,e(Y).length>0)}),ma(),Xt();var ie=ri();let ge;var Ge=l(ie);{let ce=yt(()=>(p(),n(()=>p().skills?"Expand":"Collapse")));Da(Ge,{title:"Skills",get collapsed(){return p(),n(()=>p().skills)},get ariaLabel(){return e(ce)},onToggle:()=>ia.update(ye=>({...ye,skills:!ye.skills}))})}var De=a(Ge,2);{var ve=ce=>{var ye=ni();Ct(ye,5,()=>e(Y),jt,(qe,V)=>{let A=()=>e(V).key,_=()=>e(V).label;var H=ii(),W=l(H);$e(W);var me=a(W,2),_e=l(me),Ie=a(_e),Je=l(Ie);s(Ie),s(me);var Ee=a(me,2),Ae=l(Ee);s(Ee);var h=a(Ee,2);s(H),L(P=>{Os(W,(e(E),A(),n(()=>e(E)[A()]))),W.disabled=!g(),vt(W,"id",A()),vt(me,"for",A()),$(_e,`${_()??""} `),$(Je,`(${P??""})`),$(Ae,`${e(y),A(),n(()=>e(y)[A()]>=0?"+":"")??""}${e(y),A(),n(()=>e(y)[A()])??""}`)},[()=>(I(za),A(),n(()=>za[A()].substring(0,3).toUpperCase()))]),B("change",W,P=>{console.log("Skill proficiency changed:",A(),P.target.checked),pe.update(de=>({...de,skillProficiencies:{...de.skillProficiencies,[A()]:P.target.checked}}))}),B("click",h,()=>F(A())),o(qe,H)}),s(ye),o(ce,ye)};m(De,ce=>{p(),n(()=>!p().skills)&&ce(ve)})}s(ie),L(()=>ge=Ut(ie,1,"skills svelte-1f1pl16",null,ge,{hidden:!e(ee)})),o(i,ie),ea(),x()}var ci=d('<p class="empty-message svelte-1123ljy">No attacks or spells to reorder.</p>'),vi=d('<li class="reorder-item svelte-1123ljy"><span class="attack-name svelte-1123ljy"> </span> <div class="reorder-buttons svelte-1123ljy"><button class="btn-move svelte-1123ljy" aria-label="Move up">‚ñ≤</button> <button class="btn-move svelte-1123ljy" aria-label="Move down">‚ñº</button></div></li>'),di=d('<ul class="reorder-list svelte-1123ljy"></ul>'),ui=d('<div class="modal-backdrop svelte-1123ljy" role="presentation"><div class="modal-content svelte-1123ljy" role="dialog" aria-modal="true" aria-labelledby="modal-title"><div class="modal-header svelte-1123ljy"><h3 id="modal-title" class="svelte-1123ljy">Reorder Attacks & Spells</h3> <button class="btn-close svelte-1123ljy" aria-label="Close">√ó</button></div> <div class="modal-body svelte-1123ljy"><!></div> <div class="modal-footer svelte-1123ljy"><button class="btn btn-secondary svelte-1123ljy">Cancel</button> <button class="btn btn-primary svelte-1123ljy">Save Order</button></div></div></div>');function fi(i,c){Zt(c,!1);let t=At(c,"show",8,!1),v=At(c,"attacks",24,()=>[]),f=At(c,"onSave",8),p=At(c,"onCancel",8),g=w([]);function S(M,F){const ie=e(g)[M];ha(g,e(g)[M]=e(g)[F]),ha(g,e(g)[F]=ie),r(g,[...e(g)])}function x(M){M>0&&S(M,M-1)}function y(M){M<e(g).length-1&&S(M,M+1)}function E(){f()(e(g))}function T(){p()()}function X(M){M.target===M.currentTarget&&T()}Qe(()=>(I(t()),I(v())),()=>{t()&&r(g,[...v()])}),ma(),Xt();var Y=$t(),ee=Ce(Y);{var U=M=>{var F=ui(),ie=l(F),ge=l(ie),Ge=a(l(ge),2);s(ge);var De=a(ge,2),ve=l(De);{var ce=_=>{var H=ci();o(_,H)},ye=_=>{var H=di();Ct(H,7,()=>e(g),W=>W.id,(W,me,_e)=>{var Ie=vi(),Je=l(Ie),Ee=l(Je,!0);s(Je);var Ae=a(Je,2),h=l(Ae),P=a(h,2);s(Ae),s(Ie),L(()=>{$(Ee,(e(me),n(()=>e(me).name||"(Unnamed attack or spell)"))),h.disabled=e(_e)===0,P.disabled=(I(e(_e)),e(g),n(()=>e(_e)===e(g).length-1))}),B("click",h,()=>x(e(_e))),B("click",P,()=>y(e(_e))),o(W,Ie)}),s(H),o(_,H)};m(ve,_=>{e(g),n(()=>e(g).length===0)?_(ce):_(ye,!1)})}s(De);var qe=a(De,2),V=l(qe),A=a(V,2);s(qe),s(ie),s(F),B("click",Ge,T),B("click",V,T),B("click",A,E),B("click",F,X),o(M,F)};m(ee,M=>{t()&&M(U)})}o(i,Y),ea()}let Ka=null,Va=null;async function zs(){if(Ka)return Ka;try{return Ka=await(await fetch(Gs("/data/spells.json"))).json(),Ka||[]}catch(i){return console.error("Failed to load spells:",i),[]}}async function pi(){if(Va)return Va;try{return Va=await(await fetch(Gs("/data/feats.json"))).json(),Va||[]}catch(i){return console.error("Failed to load feats:",i),[]}}function Ts(i,c){if(!c.trim())return i;const t=c.toLowerCase();return i.filter(v=>v.name.toLowerCase().includes(t)||v.school.toLowerCase().includes(t)||v.classes.some(f=>f.toLowerCase().includes(t))||v.description.toLowerCase().includes(t))}function mi(i,c){return c===null?i:i.filter(t=>t.level===c)}function gi(i,c){if(!c.trim())return i;const t=c.toLowerCase();return i.filter(v=>v.name.toLowerCase().includes(t)||v.description.toLowerCase().includes(t))}function Ja(i){const c=i.description,t=/\b(Strength|Dexterity|Constitution|Intelligence|Wisdom|Charisma)\s+saving\s+throw/i,v=c.match(t);if(!v)return null;const f=v[1].toLowerCase(),g=/half\s+(?:as\s+much\s+)?damage\s+on\s+a\s+successful(?:\s+save)?|on\s+a\s+successful(?:\s+save)?[^.]*half\s+(?:as\s+much\s+)?damage/i.test(c),x=/saving\s+throw\s+or\s+take.*?damage/i.test(c)&&!g;return{ability:f,halfDamageOnSave:g,noDamageOnSave:x}}function bi(i){const c=i.description;return/(plus|add)\s+your\s+spellcasting\s+(ability\s+)?modifier/i.test(c)}function Aa(i){const c=i.description.toLowerCase();return c.includes("ranged spell attack")||c.includes("melee spell attack")}function Ya(i){const c=i.description.toLowerCase();if(["Divine Favor","Bless","Aid","Command","Crusader's Mantle"].includes(i.name))return!0;const f=["takes","take","deals","deal","damage equal to","force damage","fire damage","cold damage","lightning damage","thunder damage","acid damage","poison damage","necrotic damage","radiant damage","psychic damage","regain","regains","hit point"].some(S=>c.includes(S));return["bonus to attack","bonus to damage","bonus to ac","gains a +","gain a +","+1 bonus","+2 bonus","+3 bonus","advantage on","becomes a magic weapon"].some(S=>c.includes(S))&&!f}function hi(i){const c=i.description;let t=0,v=0,f=0,p="";const g=c.match(/\+(\d+)\s+bonus\s+to\s+attack\s+rolls\s+and\s+damage\s+rolls/i);if(g){const x=parseInt(g[1]);t=x,v=x,p=`+${x} to attack and damage rolls`}if(i.name==="Bless"&&(p="Add 1d4 to attack rolls and saves",t="1d4"),i.name==="Aid")return p="+5 HP (max and current) for 8 hours",{attackBonus:0,damageBonus:0,acBonus:0,hpBonus:5,description:p,name:i.name};i.name==="Divine Favor"&&(p="Your weapon attacks deal an extra 1d4 radiant damage on a hit.",v="1d4");const S=c.match(/\+(\d+)\s+bonus\s+to\s+AC/i);return S&&(f=parseInt(S[1]),p=`+${f} to AC`),i.name==="Haste"&&(p="+2 AC, doubled speed, extra action",f=2),i.name==="Crusader's Mantle"&&(p="Your weapon attacks deal an extra 1d4 radiant damage on a hit.",v="1d4"),p||t!==0||v!==0||f!==0?{attackBonus:t,damageBonus:v,acBonus:f,description:p||i.description.substring(0,100),name:i.name}:null}function us(i){const c=i.description,t=/takes?\s+(\d+d\d+)\s+\w+\s+damage[^.]*\.\s*If\s+the\s+target\s+is\s+missing.*?instead\s+takes?\s+(\d+d\d+)/is,v=c.match(t);return v?{baseDamage:v[1],alternateDamage:v[2]}:null}var _i=d('<button class="btn btn-secondary">Reorder</button>'),yi=d('<div class="edit-buttons svelte-14o91c5"><button class="btn btn-secondary">Add Attack</button> <!></div>'),xi=d('<input type="text" placeholder="Attack name" class="attack-name svelte-14o91c5"/>'),ki=d('<h4 class="attack-name-display svelte-14o91c5"> </h4>'),$i=d('<button class="btn-remove svelte-14o91c5">√ó</button>'),wi=d('<div class="attack-field svelte-14o91c5"><label class="svelte-14o91c5">Bonus</label> <input type="number" class="attack-bonus svelte-14o91c5"/></div>'),Si=d('<div class="attack-field svelte-14o91c5"><label class="svelte-14o91c5">Damage</label> <input type="text" placeholder="e.g., 2d6+3" class="attack-damage svelte-14o91c5"/></div>'),Ci=d('<div class="spell-info-loading svelte-14o91c5">Loading spell info...</div>'),Di=d('<li class="svelte-14o91c5"><strong>At Higher Levels:</strong> </li>'),Li=d('<li style="color: #007bff;" class="svelte-14o91c5"><strong>Special:</strong> Mage Hand is invisible when cast via Githyanki Psionics.</li>'),Ai=d('<li style="color: #007bff;" class="svelte-14o91c5"><strong>Cast via:</strong> </li>'),ji=d("<!> <!>",1),Bi=d('<ul class="svelte-14o91c5"><li class="svelte-14o91c5"><strong>Level:</strong> </li> <li class="svelte-14o91c5"><strong>Casting Time:</strong> </li> <li class="svelte-14o91c5"><strong>Range:</strong> </li> <li class="svelte-14o91c5"><strong>Components:</strong> <!></li> <li class="svelte-14o91c5"><strong>Duration:</strong> <!> </li> <li class="svelte-14o91c5"><strong>Description:</strong> </li> <!> <!></ul>'),Ri=d('<span class="scaled-damage svelte-14o91c5" style="margin-left: 8px;"> </span>'),Mi=d('<span class="scaled-damage svelte-14o91c5">(Half damage)</span>'),Ti=d('<span class="scaled-damage svelte-14o91c5">(No damage)</span>'),Fi=d('<div class="target-condition svelte-14o91c5"><label class="svelte-14o91c5"><input type="checkbox" class="use-enabled svelte-14o91c5"/> <!> <!></label></div>'),Pi=d('<span class="scaled-damage svelte-14o91c5"> </span>'),Ii=d('<span class="scaled-damage svelte-14o91c5"> </span>'),Ei=d('<div class="target-condition svelte-14o91c5"><label class="svelte-14o91c5"><input type="checkbox" class="use-enabled svelte-14o91c5"/> Target is missing HP <!></label></div>'),Ui=d("<option> </option>"),Ni=d('<span class="scaled-damage svelte-14o91c5"><!> </span>'),Hi=d('<span class="scaled-damage svelte-14o91c5"> </span>'),Oi=d('<div class="target-condition svelte-14o91c5"><label class="svelte-14o91c5"><input type="checkbox" class="use-enabled svelte-14o91c5"/> Target is Fiend or Undead <!></label></div>'),Gi=d('<div class="spell-level-selector svelte-14o91c5"><label class="svelte-14o91c5">Cast at Level:</label> <select class="spell-level-select use-enabled svelte-14o91c5"></select> <!></div> <!>',1),qi=d('<div class="spell-info svelte-14o91c5"><div class="spell-info-header svelte-14o91c5" role="button" tabindex="0"><h4 class="svelte-14o91c5">Spell Info</h4> <button class="collapse-btn-small svelte-14o91c5"> </button></div> <!></div> <!> <!> <!>',1),Wi=d('<div class="spell-info-missing svelte-14o91c5">Spell info not found.</div>'),zi=d('<div class="attack-notes svelte-14o91c5"><label class="svelte-14o91c5">Notes</label> <textarea placeholder="e.g., DC 15 Dex save, Range 120 ft, Concentration" class="notes-input svelte-14o91c5" rows="2"></textarea></div>'),Ki=d('<div style="margin-bottom: 0.5em;"><label style="font-size:0.95em;"><input type="checkbox" class="svelte-14o91c5"/> Use Racial Trait <span style="color:#007bff; font-size:0.95em; margin-left:0.5em;"> </span></label></div>'),Vi=d('<button class="btn btn-primary">Roll Attack (Spell Slot)</button>'),Ji=d('<button class="btn btn-primary" disabled>No spell slots available</button>'),Yi=d('<button class="btn btn-primary">Roll Attack (Racial Trait)</button>'),Qi=d('<button class="btn btn-primary" disabled>No racial uses left</button>'),Xi=d('<div class="buff-target-selection svelte-14o91c5"><div class="target-options svelte-14o91c5"><label class="target-option svelte-14o91c5"><input type="radio" class="svelte-14o91c5"/> Self</label> <label class="target-option svelte-14o91c5"><input type="radio" class="svelte-14o91c5"/> Other</label></div> <button class="btn btn-info"> </button></div>'),Zi=d('<button class="btn btn-info">Cast Spell</button>'),en=d("<button><!></button>"),tn=d('<button class="btn btn-info">Cast Spell</button>'),an=d("<!> <!> <!> <!>",1),sn=d('<button class="btn btn-secondary">Roll Damage</button>'),ln=d('<button class="btn btn-primary">Roll Attack</button> <!>',1),nn=d('<div class="attack-card svelte-14o91c5"><div class="attack-header svelte-14o91c5"><!> <!></div> <div class="attack-details svelte-14o91c5"><!> <!> <div class="attack-field svelte-14o91c5"><label class="svelte-14o91c5">Type</label> <input type="text" placeholder="e.g., slashing" class="attack-type svelte-14o91c5"/></div></div> <!> <!> <div class="attack-actions svelte-14o91c5"><!> <!></div></div>'),rn=d('<p class="no-attacks svelte-14o91c5">No attacks added yet. Click "Add Attack" to create one.</p>'),on=d('<p class="no-attacks svelte-14o91c5">No attacks match your search.</p>'),cn=d('<span class="ability-uses svelte-14o91c5"> <!></span>'),vn=d('<span class="ability-reaction svelte-14o91c5">‚ö° Reaction</span>'),dn=d('<button class="btn btn-ability svelte-14o91c5">Use Ability</button>'),un=d('<div class="ability-card svelte-14o91c5"><div class="ability-header svelte-14o91c5"><h4 class="ability-name svelte-14o91c5"> </h4> <span class="ability-source svelte-14o91c5"> </span></div> <p class="ability-description svelte-14o91c5"> </p> <div class="ability-footer svelte-14o91c5"><!> <!> <!></div></div>'),fn=d('<div class="condition-abilities-section svelte-14o91c5"><h3 class="abilities-header svelte-14o91c5">Condition Abilities</h3> <p class="section-description svelte-14o91c5">Special actions granted by active conditions (e.g., Flicker of Deceit)</p> <div class="abilities-list svelte-14o91c5"></div></div>'),pn=d('<button class="btn-remove svelte-14o91c5">√ó</button>'),mn=d('<div class="state-card svelte-14o91c5"><div class="state-header svelte-14o91c5"><input type="text" placeholder="Effect name (e.g., Magic Weapon)" class="state-name svelte-14o91c5"/> <!></div> <div class="state-details svelte-14o91c5"><div class="state-field svelte-14o91c5"><label class="svelte-14o91c5">Attack Bonus</label> <input type="text" class="state-bonus svelte-14o91c5" placeholder="0 or 1d4"/></div> <div class="state-field svelte-14o91c5"><label class="svelte-14o91c5">Damage Bonus</label> <input type="text" class="state-bonus svelte-14o91c5"/></div> <div class="state-field svelte-14o91c5"><label class="svelte-14o91c5">Target</label> <select class="state-bonus svelte-14o91c5"><option>Self</option><option>Other</option></select></div></div> <div class="state-description svelte-14o91c5"><label class="svelte-14o91c5">Description</label> <input type="text" placeholder="e.g., +1 to attack and damage rolls (Magic Weapon)" class="state-desc-input svelte-14o91c5"/></div></div>'),gn=d('<div class="states-list svelte-14o91c5"></div>'),bn=d('<p class="no-states svelte-14o91c5">No active effects. Add spell effects that modify your attacks.</p>'),hn=d('<!> <div class="attacks-list svelte-14o91c5"><!> <!> <!></div> <!> <div class="active-states-section svelte-14o91c5"><h3 class="svelte-14o91c5">Active Spell Effects</h3> <p class="section-description svelte-14o91c5">Effects that modify attack and damage rolls (e.g., Magic Weapon, Bless)</p> <button class="btn btn-secondary">Add Effect</button> <!></div>',1),_n=d("<section><!> <!></section> <!>",1);function yn(i,c){Zt(c,!1);const t=()=>_t(pe,"$character",g),v=()=>_t(xa,"$searchFilter",g),f=()=>_t(ia,"$collapsedStates",g),p=()=>_t(Sa,"$isEditMode",g),[g,S]=da(),x=w(),y=w(),E=w(),T=[];let X=w({});function Y(C,K){pe.update(j=>{if(!j.activeStates)return j;const G=j.activeStates.findIndex(Re=>Re.name===C);if(G===-1)return j;const Q=j.activeStates[G];if(!Q.abilities)return j;const ue=Q.abilities.findIndex(Re=>Re.name===K);if(ue===-1)return j;const He=Q.abilities[ue];return He.currentUses!==void 0&&He.currentUses>0&&(He.currentUses-=1,He.usesPerRest!==void 0?Ht.add(`Used ${K} (${He.currentUses}/${He.usesPerRest} remaining)`,"info"):Ht.add(`Used ${K}`,"info")),j})}const ee=ka();let U=w({}),M=w({}),F=w(!1);function ie(C){ha(U,e(U)[C]=!e(U)[C]),r(U,{...e(U)})}function ge(C){return C.description.toLowerCase().includes("regain")&&(C.description.toLowerCase().includes("hit point")||C.description.toLowerCase().includes("hp"))}function Ge(C){return["Shield of Faith","Bless","Aid","Magic Weapon"].includes(C)}function De(){pe.update(C=>(C.attacks=[...C.attacks,{id:crypto.randomUUID(),name:"",bonus:0,damage:"",damageType:"",notes:""}],C))}function ve(C){pe.update(K=>(K.attacks=K.attacks.filter(j=>j.id!==C),K))}function ce(){r(F,!0)}function ye(){r(F,!1)}function qe(C){pe.update(K=>(K.attacks=C,K)),r(F,!1),Ht.add("Attack order updated successfully!","success")}function V(C,K){let j=C.damage,G=!1,Q=!1;const ue=[];if(C.spellRef){const k=W(C.spellRef);if(k&&(Q=Aa(k),k.level>0)){const se=C.castAtLevel||k.level;let z=!1;if(K||C.source==="racial"){if(z=_e(C.name),!z){Ht.add(`No uses of ${C.name} remaining!`,"error");return}}else if(z=me(se),!z){Ht.add(`No level ${se} spell slots available!`,"error");return}const we=Ja(k);we&&C.targetSucceededSave&&we.noDamageOnSave?j="0":(G=we?.halfDamageOnSave&&C.targetSucceededSave||!1,j=Ie(C,k))}}else if(j){const k=j.match(/(\d+d\d+)([+-]?\d+)?/);if(k){const[,se,z]=k,Me=z?parseInt(z):0;if(Me!==0&&ue.push({value:Me,source:"base"}),t().activeStates&&t().activeStates.length>0){let we=0,st=[];for(const xe of t().activeStates)xe.target!=="other"&&(typeof xe.damageBonus=="string"?(st.push(xe.damageBonus),ue.push({value:xe.damageBonus,source:xe.name})):typeof xe.damageBonus=="number"&&xe.damageBonus!==0&&(we+=xe.damageBonus,ue.push({value:xe.damageBonus,source:xe.name})));if(we!==0||st.length>0){const xe=Me+we;let Z=`${se}`;xe!==0&&(Z+=`${xe>=0?"+":""}${xe}`),st.length>0&&(Z+=" + "+st.join(" + ")),j=Z}}}}const He=[];let Re=0;if(Q){const k=vs(t(),t().abilities),se=t().proficiencyBonus||0;He.push({value:se,source:"proficiency"}),He.push({value:k,source:"spellcasting"}),Re=se+k}else C.bonus!==0&&He.push({value:C.bonus,source:"base"}),Re=C.bonus;let je=[];if(t().activeStates)for(const k of t().activeStates)k.target!=="other"&&(typeof k.attackBonus=="number"&&k.attackBonus!==0?(He.push({value:k.attackBonus,source:k.name}),Re+=k.attackBonus):typeof k.attackBonus=="string"&&k.attackBonus&&(je.push(k.attackBonus),He.push({value:k.attackBonus,source:k.name})));let Be=`1d20${Re>=0?"+":""}${Re}`;je.length>0&&(Be+="+"+je.join("+")),ee("roll",{notation:Be,damageNotation:j,attackName:C.name,applyHalfDamage:G,bonusBreakdown:He,damageBreakdown:ue,rollType:"attack"})}function A(C){if(!C.damage){Ht.add(`${C.name}: No damage specified`,"error");return}let K=C.damage,j=!1;const G=[];let Q=C.damageType||"";if(C.spellRef){const ue=W(C.spellRef);if(ue){const He=ge(ue);if(He){const Re=vs(t(),t().abilities),je=K.match(/^(\d+d\d+)/);je&&(K=je[1],Re>0&&(K+=`+${Re}`,G.push({value:Re,source:"spellcasting"}))),Q="Healing"}if(ue.level>0){const Re=C.castAtLevel||ue.level;let je=!1;if(C.source==="racial"){if(je=_e(C.name),!je){Ht.add(`No uses of ${C.name} remaining!`,"error");return}}else if(je=me(Re),!je){Ht.add(`No level ${Re} spell slots available!`,"error");return}const Be=Ja(ue);Be&&C.targetSucceededSave&&Be.noDamageOnSave?K="0":(j=Be?.halfDamageOnSave&&C.targetSucceededSave||!1,He||(K=Ie(C,ue)))}}}else{const ue=K.match(/(\d+d\d+)([+-]\d+)?/);if(ue){const[,He,Re]=ue,je=Re?parseInt(Re):0;if(je!==0&&G.push({value:je,source:"base"}),t().activeStates&&t().activeStates.length>0){let Be=0,k=[];for(const se of t().activeStates)se.target!=="other"&&(typeof se.damageBonus=="string"?(k.push(se.damageBonus),G.push({value:se.damageBonus,source:se.name})):typeof se.damageBonus=="number"&&se.damageBonus!==0&&(G.push({value:se.damageBonus,source:se.name}),Be+=se.damageBonus));if(Be!==0||k.length>0){const se=je+Be;let z=`${He}`;se!==0&&(z+=`${se>=0?"+":""}${se}`),k.length>0&&(z+=" + "+k.join(" + ")),K=z}}}}ee("roll",{notation:K,attackName:C.name,applyHalfDamage:j,bonusBreakdown:G,damageType:Q})}let _=w([]),H=w(!1);Ca(async()=>{r(_,await zs()),r(H,!0)});function W(C){return e(_).find(K=>K.name===C)}function me(C){t().classFeatures.spellSlotsByLevel||Gt(pe,n(t).classFeatures.spellSlotsByLevel={},n(t)),t().classFeatures.spellSlotsByLevel[C]||Gt(pe,n(t).classFeatures.spellSlotsByLevel[C]=Array(2).fill(!1),n(t));const j=t().classFeatures.spellSlotsByLevel[C].findIndex(G=>!G);return j===-1?!1:(pe.update(G=>(G.classFeatures.spellSlotsByLevel||(G.classFeatures.spellSlotsByLevel={}),G.classFeatures.spellSlotsByLevel[C]||(G.classFeatures.spellSlotsByLevel[C]=Array(2).fill(!1)),G.classFeatures.spellSlotsByLevel[C][j]=!0,G)),!0)}function _e(C){return!t().racialTraits||!t().racialTraits.uses[C]?!0:t().racialTraits.uses[C].currentUses<=0?!1:(ml(C),!0)}function Ie(C,K){let j=C.damage,G=0,Q=0;const ue=us(K);if(ue&&C.targetIsDamaged&&(j=ue.alternateDamage),bi(K)&&(Q+=vs(t(),t().abilities)),t().activeStates)for(const we of t().activeStates)we.target!=="other"&&typeof we.damageBonus=="number"&&(Q+=we.damageBonus);if(K.higherLevelSlot&&C.castAtLevel){const we=K.level,xe=(C.castAtLevel||we)-we;if(xe>0){const Z=K.higherLevelSlot.match(/(\d+)d(\d+)\s+for\s+each.*?level\s+above/i);if(Z){const[,u]=Z;G+=xe*parseInt(u)}}}if(C.targetIsFiendOrUndead&&K.description.includes("Fiend or an Undead")){const we=K.description.match(/increases by (\d+)d(\d+) if.*?Fiend or.*?Undead/i);if(we){const[,st]=we;G+=parseInt(st)}}const He=j.match(/(\d+)d(\d+)([+-]\d+)?/);if(!He)return Q!==0?Q>=0?`${Q}`:`${Q}`:j||"0";const[,Re,je,Be]=He,k=parseInt(Re)+G,z=(Be?parseInt(Be):0)+Q;let Me=`${k}d${je}`;return z!==0&&(Me+=z>=0?`+${z}`:`${z}`),Me}function Je(C){const K=[];for(let G=C.level;G<=9;G++){const Q=t().classFeatures.spellSlotsByLevel?.[G];Q&&Q.length>0&&K.push(G)}return K}function Ee(){pe.update(C=>(C.activeStates||(C.activeStates=[]),C.activeStates=[...C.activeStates,{name:"",attackBonus:0,damageBonus:0,description:"",target:"self"}],C))}function Ae(C){pe.update(K=>{if(K.activeStates){const j=K.activeStates[C];j?.hpBonus&&j.target!=="other"&&(K.maxHP-=j.hpBonus,K.currentHP=Math.max(1,Math.min(K.currentHP-j.hpBonus,K.maxHP))),K.activeStates=K.activeStates.filter((G,Q)=>Q!==C)}return K})}function h(C,K="self"){const j=W(C.spellRef);if(!j){Ht.add("Spell not found","error");return}const G=C.castAtLevel||j.level;if(G>0){let k=!1;if(C.source==="racial"){if(k=_e(C.name),!k){Ht.add(`No uses of ${C.name} remaining!`,"error");return}}else if(k=me(G),!k){Ht.add(`No level ${G} spell slots available!`,"error");return}}const Q=hi(j);if(!Q){Ht.add(`${j.name} cast! Check spell description for effects.`,"info");return}let ue=Q.hpBonus||0,He=Q.description;j.name==="Aid"&&G>j.level&&(ue=5+(G-j.level)*5,He=`+${ue} HP (max and current) for 8 hours`);const je=["Shield of Faith","Bless","Aid","Magic Weapon"].includes(j.name);pe.update(k=>{k.activeStates||(k.activeStates=[]);const se=k.activeStates.find(z=>z.name===j.name);return se&&se.hpBonus&&se.target!=="other"&&(k.maxHP-=se.hpBonus,k.currentHP=Math.max(1,Math.min(k.currentHP-se.hpBonus,k.maxHP))),k.activeStates=k.activeStates.filter(z=>z.name!==j.name),ue>0&&K==="self"&&(k.maxHP+=ue,k.currentHP+=ue),k.activeStates=[...k.activeStates,{name:j.name,attackBonus:Q.attackBonus,damageBonus:Q.damageBonus,acBonus:Q.acBonus,description:He,target:K,hpBonus:ue}],k});const Be=K==="self"?" on self":" on other";Ht.add(`${j.name} cast${je?Be:""}! Effect added to Active Spell Effects.`,"success")}Qe(()=>t(),()=>{r(x,t().activeStates?t().activeStates.filter(C=>C.abilities&&C.abilities.length>0).flatMap(C=>C.abilities.map(K=>({...K,conditionName:C.name}))):[])}),Qe(()=>(t(),e(U),e(M)),()=>{if(t()&&t().attacks)for(const C of t().attacks)C.spellRef&&e(U)[C.id]===void 0&&ha(U,e(U)[C.id]=!0),C.spellRef&&e(M)[C.id]===void 0&&ha(M,e(M)[C.id]="self")}),Qe(()=>(t(),v()),()=>{r(y,t().attacks.filter(C=>{if(!v())return!0;const K=v().toLowerCase();return C.name.toLowerCase().includes(K)||C.damageType.toLowerCase().includes(K)}).sort((C,K)=>!C.spellRef&&K.spellRef?-1:C.spellRef&&!K.spellRef?1:0))}),Qe(()=>(v(),e(y)),()=>{r(E,!v()||e(y).length>0||"attack".includes(v().toLowerCase())||"spell".includes(v().toLowerCase()))}),ma(),Xt();var P=_n(),de=Ce(P);let Ze;var tt=l(de);{let C=yt(()=>(f(),n(()=>f().attacks?"Expand":"Collapse")));Da(tt,{title:"Attacks & Spells",get collapsed(){return f(),n(()=>f().attacks)},get ariaLabel(){return e(C)},onToggle:()=>ia.update(K=>({...K,attacks:!K.attacks}))})}var mt=a(tt,2);{var Dt=C=>{var K=hn(),j=Ce(K);{var G=Z=>{var u=yi(),lt=l(u),Oe=a(lt,2);{var O=Se=>{var Ye=_i();B("click",Ye,ce),o(Se,Ye)};m(Oe,Se=>{t(),n(()=>t().attacks.length>0)&&Se(O)})}s(u),B("click",lt,De),o(Z,u)};m(j,Z=>{p()&&Z(G)})}var Q=a(j,2),ue=l(Q);Ct(ue,1,()=>e(y),Z=>Z.id,(Z,u,lt)=>{var Oe=nn(),O=l(Oe),Se=l(O);{var Ye=be=>{var te=xi();$e(te),Ve(te,()=>e(u).name,fe=>(e(u).name=fe,Jt(()=>(e(y),t(),v())))),o(be,te)},gt=be=>{var te=ki(),fe=l(te,!0);s(te),L(()=>$(fe,(e(u),n(()=>e(u).name||"(Unnamed Attack)")))),o(be,te)};m(Se,be=>{p()?be(Ye):be(gt,!1)})}var it=a(Se,2);{var he=be=>{var te=$i();B("click",te,()=>ve(e(u).id)),o(be,te)};m(it,be=>{p()&&be(he)})}s(O);var Le=a(O,2),Ue=l(Le);{var ft=be=>{var te=wi(),fe=l(te),Xe=a(fe,2);$e(Xe),s(te),L(()=>{vt(fe,"for",`attack-bonus-${e(u),n(()=>e(u).id)??""}`),vt(Xe,"id",`attack-bonus-${e(u),n(()=>e(u).id)??""}`)}),Ve(Xe,()=>e(u).bonus,kt=>(e(u).bonus=kt,Jt(()=>(e(y),t(),v())))),o(be,te)};m(Ue,be=>{e(u),n(()=>e(u).bonus!==0&&e(u).bonus!==void 0)&&be(ft)})}var J=a(Ue,2);{var ze=be=>{var te=Si(),fe=l(te),Xe=a(fe,2);$e(Xe),s(te),L(()=>{vt(fe,"for",`attack-damage-${e(u),n(()=>e(u).id)??""}`),vt(Xe,"id",`attack-damage-${e(u),n(()=>e(u).id)??""}`)}),Ve(Xe,()=>e(u).damage,kt=>(e(u).damage=kt,Jt(()=>(e(y),t(),v())))),o(be,te)};m(J,be=>{e(u),n(()=>e(u).damage&&e(u).damage.trim()!=="")&&be(ze)})}var dt=a(J,2),b=l(dt),N=a(b,2);$e(N),s(dt),s(Le);var oe=a(Le,2);{var ne=be=>{var te=$t(),fe=Ce(te);{var Xe=ot=>{var ae=Ci();o(ot,ae)},kt=ot=>{const ae=yt(()=>(e(u),n(()=>W(e(u).spellRef))));var qt=$t(),Ne=Ce(qt);{var xt=ta=>{const Ot=yt(()=>(I(Ja),I(e(ae)),n(()=>Ja(e(ae))))),D=yt(()=>(I(us),I(e(ae)),n(()=>us(e(ae)))));var ke=qi(),et=Ce(ke),We=l(et),R=a(l(We),2),ut=l(R,!0);s(R),s(We);var rt=a(We,2);{var wt=Ke=>{var Rt=Bi(),Yt=l(Rt),Wt=a(l(Yt));s(Yt);var ua=a(Yt,2),ca=a(l(ua));s(ua);var fa=a(ua,2),zt=a(l(fa));s(fa);var la=a(fa,2),Kt=a(l(la)),Nt=a(Kt);{var ra=Lt=>{var aa=Tt();L(()=>$(aa,`(${I(e(ae)),n(()=>e(ae).material)??""})`)),o(Lt,aa)};m(Nt,Lt=>{I(e(ae)),n(()=>e(ae).material)&&Lt(ra)})}s(la);var ga=a(la,2),ba=a(l(ga),2);{var Vt=Lt=>{var aa=Tt("Concentration,");o(Lt,aa)};m(ba,Lt=>{I(e(ae)),n(()=>e(ae).concentration)&&Lt(Vt)})}var oa=a(ba,1,!0);s(ga);var Qt=a(ga,2),ht=a(l(Qt));s(Qt);var St=a(Qt,2);{var Mt=Lt=>{var aa=Di(),Ba=a(l(aa));s(aa),L(()=>$(Ba,` ${I(e(ae)),n(()=>e(ae).higherLevelSlot)??""}`)),o(Lt,aa)};m(St,Lt=>{I(e(ae)),n(()=>e(ae).higherLevelSlot)&&Lt(Mt)})}var It=a(St,2);{var Et=Lt=>{var aa=ji(),Ba=Ce(aa);{var Oa=ya=>{var pa=Li();o(ya,pa)};m(Ba,ya=>{e(u),I(e(ae)),n(()=>e(u).racialTraitName==="Githyanki Psionics"&&e(ae).name==="Mage Hand")&&ya(Oa)})}var as=a(Ba,2);{var ss=ya=>{var pa=Ai(),La=a(l(pa));s(pa),L(()=>$(La,` ${e(u),n(()=>e(u).racialTraitName)??""}`)),o(ya,pa)};m(as,ya=>{e(u),n(()=>e(u).racialTraitName)&&ya(ss)})}o(Lt,aa)};m(It,Lt=>{e(u),n(()=>e(u).source==="racial")&&Lt(Et)})}s(Rt),L(Lt=>{$(Wt,` ${I(e(ae)),n(()=>e(ae).level)??""}`),$(ca,` ${I(e(ae)),n(()=>e(ae).castingTime||e(ae).actionType)??""}`),$(zt,` ${I(e(ae)),n(()=>e(ae).range)??""}`),$(Kt,` ${Lt??""}`),$(oa,(I(e(ae)),n(()=>e(ae).duration))),$(ht,` ${I(e(ae)),n(()=>e(ae).description)??""}`)},[()=>(I(e(ae)),n(()=>e(ae).components.join(", ")))]),o(Ke,Rt)};m(rt,Ke=>{e(U),e(u),n(()=>!e(U)[e(u).id])&&Ke(wt)})}s(et);var Pe=a(et,2);{var ct=Ke=>{var Rt=Fi(),Yt=l(Rt),Wt=l(Yt);$e(Wt);var ua=a(Wt),ca=a(ua);{var fa=Nt=>{var ra=Ri(),ga=l(ra);s(ra),L(ba=>$(ga,`(Spell Save DC: ${ba??""})`),[()=>(I(hs),t(),n(()=>hs(t(),t().abilities)))]),o(Nt,ra)};m(ca,Nt=>{t(),n(()=>t().class)&&Nt(fa)})}var zt=a(ca,2);{var la=Nt=>{var ra=Mi();o(Nt,ra)},Kt=Nt=>{var ra=$t(),ga=Ce(ra);{var ba=Vt=>{var oa=Ti();o(Vt,oa)};m(ga,Vt=>{e(u),I(e(Ot)),n(()=>e(u).targetSucceededSave&&e(Ot).noDamageOnSave)&&Vt(ba)},!0)}o(Nt,ra)};m(zt,Nt=>{e(u),I(e(Ot)),n(()=>e(u).targetSucceededSave&&e(Ot).halfDamageOnSave)?Nt(la):Nt(Kt,!1)})}s(Yt),s(Rt),L(Nt=>$(ua,` Target succeeded on ${Nt??""} save `),[()=>(I(e(Ot)),n(()=>e(Ot).ability.charAt(0).toUpperCase()+e(Ot).ability.slice(1)))]),wa(Wt,()=>e(u).targetSucceededSave,Nt=>(e(u).targetSucceededSave=Nt,Jt(()=>(e(y),t(),v())))),o(Ke,Rt)};m(Pe,Ke=>{e(Ot)&&Ke(ct)})}var bt=a(Pe,2);{var Pt=Ke=>{var Rt=Ei(),Yt=l(Rt),Wt=l(Yt);$e(Wt);var ua=a(Wt,2);{var ca=zt=>{const la=yt(()=>(e(u),I(e(ae)),n(()=>Ie(e(u),e(ae)))));var Kt=Pi(),Nt=l(Kt);s(Kt),L(()=>$(Nt,`(${I(e(D)),n(()=>e(D).alternateDamage)??""}, total: ${e(la)??""})`)),o(zt,Kt)},fa=zt=>{var la=Ii(),Kt=l(la);s(la),L(()=>$(Kt,`(${I(e(D)),n(()=>e(D).baseDamage)??""})`)),o(zt,la)};m(ua,zt=>{e(u),n(()=>e(u).targetIsDamaged)?zt(ca):zt(fa,!1)})}s(Yt),s(Rt),wa(Wt,()=>e(u).targetIsDamaged,zt=>(e(u).targetIsDamaged=zt,Jt(()=>(e(y),t(),v())))),o(Ke,Rt)};m(bt,Ke=>{e(D)&&Ke(Pt)})}var Ft=a(bt,2);{var pt=Ke=>{const Rt=yt(()=>(I(e(ae)),n(()=>Je(e(ae)))));var Yt=$t(),Wt=Ce(Yt);{var ua=ca=>{var fa=Gi(),zt=Ce(fa),la=l(zt),Kt=a(la,2);L(()=>{e(u),Jt(()=>{e(Rt)})}),Ct(Kt,5,()=>e(Rt),jt,(Vt,oa)=>{var Qt=Ui(),ht=l(Qt);s(Qt);var St={};L(()=>{$(ht,`Level ${e(oa)??""}`),St!==(St=e(oa))&&(Qt.value=(Qt.__value=e(oa))??"")}),o(Vt,Qt)}),s(Kt);var Nt=a(Kt,2);{var ra=Vt=>{const oa=yt(()=>(e(u),I(e(ae)),n(()=>Ie(e(u),e(ae)))));var Qt=Ni(),ht=l(Qt);{var St=Et=>{var Lt=Tt("Healing");o(Et,Lt)},Mt=Et=>{var Lt=Tt("Damage");o(Et,Lt)};m(ht,Et=>{I(e(ae)),n(()=>ge(e(ae)))?Et(St):Et(Mt,!1)})}var It=a(ht);s(Qt),L(()=>$(It,` ${e(oa)??""}`)),o(Vt,Qt)};m(Nt,Vt=>{e(u),I(e(ae)),n(()=>e(u).castAtLevel&&e(u).castAtLevel>e(ae).level)&&Vt(ra)})}s(zt);var ga=a(zt,2);{var ba=Vt=>{var oa=Oi(),Qt=l(oa),ht=l(Qt);$e(ht);var St=a(ht,2);{var Mt=It=>{const Et=yt(()=>(e(u),I(e(ae)),n(()=>Ie(e(u),e(ae)))));var Lt=Hi(),aa=l(Lt);s(Lt),L(()=>$(aa,`(+1d8, total: ${e(Et)??""})`)),o(It,Lt)};m(St,It=>{e(u),n(()=>e(u).targetIsFiendOrUndead)&&It(Mt)})}s(Qt),s(oa),wa(ht,()=>e(u).targetIsFiendOrUndead,It=>(e(u).targetIsFiendOrUndead=It,Jt(()=>(e(y),t(),v())))),o(Vt,oa)};m(ga,Vt=>{I(e(ae)),n(()=>e(ae).description.includes("Fiend or an Undead"))&&Vt(ba)})}L(()=>{vt(la,"for",`castLevel-${e(u),n(()=>e(u).id)??""}`),vt(Kt,"id",`castLevel-${e(u),n(()=>e(u).id)??""}`)}),Na(Kt,()=>e(u).castAtLevel,Vt=>(e(u).castAtLevel=Vt,Jt(()=>(e(y),t(),v())))),o(ca,fa)};m(Wt,ca=>{I(e(Rt)),e(X),e(u),n(()=>e(Rt).length>0&&!e(X)[e(u).id])&&ca(ua)})}o(Ke,Yt)};m(Ft,Ke=>{I(e(ae)),n(()=>e(ae).higherLevelSlot&&e(ae).level>0)&&Ke(pt)})}L(()=>{vt(R,"aria-label",(e(U),e(u),n(()=>e(U)[e(u).id]?"Expand":"Collapse"))),$(ut,(e(U),e(u),n(()=>e(U)[e(u).id]?"‚ñº":"‚ñ≤")))}),B("click",We,()=>ie(e(u).id)),B("keydown",We,Ke=>Ke.key==="Enter"&&ie(e(u).id)),o(ta,ke)},na=ta=>{var Ot=Wi();o(ta,Ot)};m(Ne,ta=>{e(ae)?ta(xt):ta(na,!1)})}o(ot,qt)};m(fe,ot=>{e(_),n(()=>e(_).length===0)?ot(Xe):ot(kt,!1)})}o(be,te)};m(oe,be=>{e(u),n(()=>e(u).spellRef)&&be(ne)})}var le=a(oe,2);{var Te=be=>{var te=$t(),fe=Ce(te);{var Xe=kt=>{var ot=zi(),ae=l(ot),qt=a(ae,2);ja(qt),s(ot),L(()=>{vt(ae,"for",`attack-notes-${e(u),n(()=>e(u).id)??""}`),vt(qt,"id",`attack-notes-${e(u),n(()=>e(u).id)??""}`)}),Ve(qt,()=>e(u).notes,Ne=>(e(u).notes=Ne,Jt(()=>(e(y),t(),v())))),o(kt,ot)};m(fe,kt=>{e(u),n(()=>e(u).notes&&e(u).notes.trim()!=="")&&kt(Xe)})}o(be,te)};m(le,be=>{e(u),n(()=>!e(u).spellRef)&&be(Te)})}var at=a(le,2),Fe=l(at);{var re=be=>{const te=yt(()=>(e(u),n(()=>W(e(u).spellRef))));var fe=$t(),Xe=Ce(fe);{var kt=ot=>{const ae=yt(()=>(t(),e(u),n(()=>t().racialTraits&&t().racialTraits.uses[e(u).name])));var qt=an(),Ne=Ce(qt);{var xt=We=>{var R=Ki(),ut=l(R),rt=l(ut);$e(rt);var wt=a(rt,2),Pe=l(wt);s(wt),s(ut),s(R),L(()=>$(Pe,`(${I(e(ae)),n(()=>e(ae).currentUses)??""}/${I(e(ae)),n(()=>e(ae).maxUses)??""} uses left)`)),wa(rt,()=>e(X)[e(u).id],ct=>ha(X,e(X)[e(u).id]=ct)),B("change",rt,()=>{r(X,{...e(X)})}),o(We,R)};m(Ne,We=>{e(u),I(e(ae)),n(()=>e(u).source==="racial"&&e(ae))&&We(xt)})}var na=a(Ne,2);{var ta=We=>{var R=$t(),ut=Ce(R);{var rt=Pe=>{var ct=$t(),bt=Ce(ct);{var Pt=pt=>{var Ke=Vi();B("click",Ke,()=>V(e(u),!1)),o(pt,Ke)},Ft=pt=>{var Ke=Ji();o(pt,Ke)};m(bt,pt=>{t(),I(e(te)),n(()=>t().classFeatures&&t().classFeatures.spellSlotsByLevel&&t().classFeatures.spellSlotsByLevel[e(te).level]?.some(Ke=>!Ke))?pt(Pt):pt(Ft,!1)})}o(Pe,ct)},wt=Pe=>{var ct=$t(),bt=Ce(ct);{var Pt=pt=>{var Ke=Yi();B("click",Ke,()=>V(e(u),!0)),o(pt,Ke)},Ft=pt=>{var Ke=Qi();o(pt,Ke)};m(bt,pt=>{I(e(ae)),n(()=>e(ae)&&e(ae).currentUses>0)?pt(Pt):pt(Ft,!1)})}o(Pe,ct)};m(ut,Pe=>{e(X),e(u),n(()=>!e(X)[e(u).id])?Pe(rt):Pe(wt,!1)})}o(We,R)};m(na,We=>{I(Aa),I(e(te)),n(()=>Aa(e(te)))&&We(ta)})}var Ot=a(na,2);{var D=We=>{var R=$t(),ut=Ce(R);{var rt=Pe=>{var ct=Xi(),bt=l(ct),Pt=l(bt),Ft=l(Pt);$e(Ft),Ft.value=Ft.__value="self",sa(),s(Pt);var pt=a(Pt,2),Ke=l(pt);$e(Ke),Ke.value=Ke.__value="other",sa(),s(pt),s(bt);var Rt=a(bt,2),Yt=l(Rt);s(Rt),s(ct),L(()=>{vt(Ft,"name",`target-${e(u),n(()=>e(u).id)??""}`),vt(Ke,"name",`target-${e(u),n(()=>e(u).id)??""}`),$(Yt,`Cast ${I(e(te)),n(()=>e(te).name)??""}`)}),As(T,[lt],Ft,()=>e(M)[e(u).id],Wt=>ha(M,e(M)[e(u).id]=Wt)),As(T,[lt],Ke,()=>e(M)[e(u).id],Wt=>ha(M,e(M)[e(u).id]=Wt)),B("click",Rt,()=>h(e(u),e(M)[e(u).id])),o(Pe,ct)},wt=Pe=>{var ct=Zi();B("click",ct,()=>h(e(u),"self")),o(Pe,ct)};m(ut,Pe=>{I(e(te)),n(()=>Ge(e(te).name))?Pe(rt):Pe(wt,!1)})}o(We,R)};m(Ot,We=>{I(Aa),I(e(te)),I(Ya),n(()=>!Aa(e(te))&&Ya(e(te)))&&We(D)})}var ke=a(Ot,2);{var et=We=>{var R=$t(),ut=Ce(R);{var rt=Pe=>{var ct=en(),bt=l(ct);{var Pt=pt=>{var Ke=Tt("Roll Healing");o(pt,Ke)},Ft=pt=>{var Ke=Tt("Roll Damage");o(pt,Ke)};m(bt,pt=>{I(e(te)),n(()=>ge(e(te)))?pt(Pt):pt(Ft,!1)})}s(ct),L(pt=>Ut(ct,1,`btn ${pt??""}`),[()=>(I(e(te)),n(()=>ge(e(te))?"btn-success":"btn-secondary"))]),B("click",ct,()=>A(e(u))),o(Pe,ct)},wt=Pe=>{var ct=tn();B("click",ct,()=>h(e(u),"self")),o(Pe,ct)};m(ut,Pe=>{e(u),n(()=>e(u).damage&&e(u).damage.trim()!=="")?Pe(rt):Pe(wt,!1)})}o(We,R)};m(ke,We=>{I(Aa),I(e(te)),I(Ya),n(()=>!Aa(e(te))&&!Ya(e(te)))&&We(et)})}o(ot,qt)};m(Xe,ot=>{e(te)&&ot(kt)})}o(be,fe)};m(Fe,be=>{e(u),e(H),n(()=>e(u).spellRef&&e(H))&&be(re)})}var q=a(Fe,2);{var nt=be=>{var te=ln(),fe=Ce(te),Xe=a(fe,2);{var kt=ot=>{var ae=sn();B("click",ae,()=>A(e(u))),o(ot,ae)};m(Xe,ot=>{e(u),n(()=>e(u).damage&&e(u).damage.trim()!=="")&&ot(kt)})}B("click",fe,()=>V(e(u))),o(be,te)};m(q,be=>{e(u),n(()=>!e(u).spellRef)&&be(nt)})}s(at),s(Oe),L(()=>{vt(b,"for",`attack-type-${e(u),n(()=>e(u).id)??""}`),vt(N,"id",`attack-type-${e(u),n(()=>e(u).id)??""}`)}),Ve(N,()=>e(u).damageType,be=>(e(u).damageType=be,Jt(()=>(e(y),t(),v())))),o(Z,Oe)});var He=a(ue,2);{var Re=Z=>{var u=rn();o(Z,u)};m(He,Z=>{t(),n(()=>t().attacks.length===0)&&Z(Re)})}var je=a(He,2);{var Be=Z=>{var u=on();o(Z,u)};m(je,Z=>{e(y),t(),n(()=>e(y).length===0&&t().attacks.length>0)&&Z(Be)})}s(Q);var k=a(Q,2);{var se=Z=>{var u=fn(),lt=a(l(u),4);Ct(lt,5,()=>e(x),jt,(Oe,O)=>{var Se=un(),Ye=l(Se),gt=l(Ye),it=l(gt,!0);s(gt);var he=a(gt,2),Le=l(he);s(he),s(Ye);var Ue=a(Ye,2),ft=l(Ue,!0);s(Ue);var J=a(Ue,2),ze=l(J);{var dt=le=>{var Te=cn(),at=l(Te),Fe=a(at);{var re=q=>{var nt=Tt();L(()=>$(nt,`per ${e(O),n(()=>e(O).restType)??""} rest`)),o(q,nt)};m(Fe,q=>{e(O),n(()=>e(O).restType)&&q(re)})}s(Te),L(()=>$(at,`${e(O),n(()=>e(O).currentUses??e(O).usesPerRest)??""}/${e(O),n(()=>e(O).usesPerRest)??""} uses `)),o(le,Te)};m(ze,le=>{e(O),n(()=>e(O).usesPerRest)&&le(dt)})}var b=a(ze,2);{var N=le=>{var Te=vn();o(le,Te)};m(b,le=>{e(O),n(()=>e(O).requiresReaction)&&le(N)})}var oe=a(b,2);{var ne=le=>{var Te=dn();L(()=>Te.disabled=(e(O),n(()=>e(O).currentUses===void 0||e(O).currentUses===0))),B("click",Te,()=>Y(e(O).conditionName,e(O).name)),o(le,Te)};m(oe,le=>{p(),e(O),n(()=>!p()&&e(O).usesPerRest)&&le(ne)})}s(J),s(Se),L(()=>{$(it,(e(O),n(()=>e(O).name))),$(Le,`(${e(O),n(()=>e(O).conditionName)??""})`),$(ft,(e(O),n(()=>e(O).description)))}),o(Oe,Se)}),s(lt),s(u),o(Z,u)};m(k,Z=>{e(x),n(()=>e(x).length>0)&&Z(se)})}var z=a(k,2),Me=a(l(z),4),we=a(Me,2);{var st=Z=>{var u=gn();Ct(u,5,()=>(t(),n(()=>t().activeStates)),jt,(lt,Oe,O)=>{var Se=mn(),Ye=l(Se),gt=l(Ye);$e(gt);var it=a(gt,2);{var he=q=>{var nt=pn();B("click",nt,()=>Ae(O)),o(q,nt)};m(it,q=>{p()&&q(he)})}s(Ye);var Le=a(Ye,2),Ue=l(Le),ft=l(Ue);vt(ft,"for",`state-attack-bonus-${O}`);var J=a(ft,2);$e(J),vt(J,"id",`state-attack-bonus-${O}`),s(Ue);var ze=a(Ue,2),dt=l(ze);vt(dt,"for",`state-damage-bonus-${O}`);var b=a(dt,2);$e(b),vt(b,"id",`state-damage-bonus-${O}`),s(ze);var N=a(ze,2),oe=l(N);vt(oe,"for",`state-target-${O}`);var ne=a(oe,2);L(()=>{e(Oe),Jt(()=>{})}),vt(ne,"id",`state-target-${O}`);var le=l(ne);le.value=le.__value="self";var Te=a(le);Te.value=Te.__value="other",s(ne),s(N),s(Le);var at=a(Le,2),Fe=l(at);vt(Fe,"for",`state-desc-${O}`);var re=a(Fe,2);$e(re),vt(re,"id",`state-desc-${O}`),s(at),s(Se),Ve(gt,()=>e(Oe).name,q=>(e(Oe).name=q,Jt(()=>t()),Pa(g,"$character"))),Ve(J,()=>e(Oe).attackBonus,q=>(e(Oe).attackBonus=q,Jt(()=>t()),Pa(g,"$character"))),Ve(b,()=>e(Oe).damageBonus,q=>(e(Oe).damageBonus=q,Jt(()=>t()),Pa(g,"$character"))),Na(ne,()=>e(Oe).target,q=>(e(Oe).target=q,Jt(()=>t()),Pa(g,"$character"))),Ve(re,()=>e(Oe).description,q=>(e(Oe).description=q,Jt(()=>t()),Pa(g,"$character"))),o(lt,Se)}),s(u),o(Z,u)},xe=Z=>{var u=bn();o(Z,u)};m(we,Z=>{t(),n(()=>t().activeStates&&t().activeStates.length>0)?Z(st):Z(xe,!1)})}s(z),B("click",Me,Ee),o(C,K)};m(mt,C=>{f(),n(()=>!f().attacks)&&C(Dt)})}s(de);var Bt=a(de,2);fi(Bt,{get show(){return e(F)},get attacks(){return t(),n(()=>t().attacks)},onSave:qe,onCancel:ye}),L(()=>Ze=Ut(de,1,"attacks svelte-14o91c5",null,Ze,{hidden:!e(E)})),o(i,P),ea(),S()}var xn=d('<span class="slot-checkbox-x svelte-serp1j">&#8212;</span>'),kn=d('<label><input type="checkbox" class="slot-checkbox-input svelte-serp1j"/> <span><!></span></label>');function Fs(i,c){Zt(c,!1);const t=()=>_t(Sa,"$isEditMode",v),[v,f]=da();let p=At(c,"checked",8,!1),g=At(c,"disabled",8,!1),S=At(c,"className",8,""),x=At(c,"index",8,void 0),y=At(c,"ariaLabel",8,void 0);const E=ka();function T(F){E("change",{checked:F.currentTarget.checked,index:x()})}Xt();var X=kn(),Y=l(X);$e(Y);var ee=a(Y,2),U=l(ee);{var M=F=>{var ie=xn();o(F,ie)};m(U,F=>{p()&&F(M)})}s(ee),s(X),L(()=>{Ut(X,1,"slot-checkbox-label "+S()+(t()?"":" not-editable"),"svelte-serp1j"),Os(Y,p()),Y.disabled=g()||!t(),vt(Y,"aria-label",y()),vt(Y,"tabindex",t()?0:-1),Ut(ee,1,`slot-checkbox-custom ${p()?"used":""} ${t()?"":"readonly"}`,"svelte-serp1j")}),B("change",Y,T),o(i,X),ea(),f()}var $n=d('<span style="color:#007bff; margin-left:0.5em;"> </span>'),wn=d("<li><strong> </strong> <!></li>"),Sn=d('<div class="racial-traits"><h4>Racial Traits</h4> <ul></ul></div>'),Cn=d("<li> </li>"),Dn=d('<div class="racial-resistances"><h4>Racial Resistances</h4> <ul></ul></div>'),Ln=d("<!> <!>",1);function An(i,c){Zt(c,!1);const t=()=>_t(pe,"$character",v),[v,f]=da(),p=w(),g=w();let S=w(),x=w();Ca(()=>{t().race&&t().level&&(Ss(),ns(),r(S,t().race),r(x,t().level))}),Qe(()=>(t(),e(S),e(x),ns),()=>{t().race&&t().level&&(t().race!==e(S)||t().level!==e(x))&&(Ss(),ns(),r(S,t().race),r(x,t().level))}),Qe(()=>(t(),Qa),()=>{r(p,(()=>{const ee=t().activeStates?t().activeStates.filter(F=>F.name&&F.name.toLowerCase().includes("racial")).flatMap(F=>F.resistances||[]):[],U=Qa(t().race||""),M=U?U.traits.flatMap(F=>F.resistances||[]):[];return Array.from(new Set([...ee,...M]))})())}),Qe(()=>t(),()=>{r(g,(()=>{const ee=Qa(t().race||"");return ee?ee.traits:[]})())}),ma(),Xt();var y=Ln(),E=Ce(y);{var T=ee=>{var U=Sn(),M=a(l(U),2);Ct(M,5,()=>e(g),jt,(F,ie)=>{var ge=wn(),Ge=l(ge),De=l(Ge);s(Ge);var ve=a(Ge),ce=a(ve);{var ye=qe=>{var V=$n(),A=l(V);s(V),L(_=>$(A,`(Resistances: ${_??""})`),[()=>(e(ie),n(()=>e(ie).resistances.map(_=>_.charAt(0).toUpperCase()+_.slice(1)).join(", ")))]),o(qe,V)};m(ce,qe=>{e(ie),n(()=>e(ie).resistances&&e(ie).resistances.length>0)&&qe(ye)})}s(ge),L(()=>{$(De,`${e(ie),n(()=>e(ie).name)??""}:`),$(ve,` ${e(ie),n(()=>e(ie).description)??""} `)}),o(F,ge)}),s(M),s(U),o(ee,U)};m(E,ee=>{e(g),n(()=>e(g).length>0)&&ee(T)})}var X=a(E,2);{var Y=ee=>{var U=Dn(),M=a(l(U),2);Ct(M,5,()=>e(p),jt,(F,ie)=>{var ge=Cn(),Ge=l(ge,!0);s(ge),L(De=>$(Ge,De),[()=>(e(ie),n(()=>e(ie).charAt(0).toUpperCase()+e(ie).slice(1)))]),o(F,ge)}),s(M),s(U),o(ee,U)};m(X,ee=>{e(p),n(()=>e(p).length>0)&&ee(Y)})}o(i,y),ea(),f()}var jn=d('<p class="no-features svelte-1kpvv0n">Select a class to see available features</p>'),Bn=d('<p class="no-features svelte-1kpvv0n">No class features available at this level</p>'),Rn=d('<h5 class="svelte-1kpvv0n"> </h5>'),Mn=d('<p class="no-uses svelte-1kpvv0n">No Channel Divinity uses remaining</p>'),Tn=d('<div class="channel-divinity-option svelte-1kpvv0n"><button class="btn btn-primary use-enabled svelte-1kpvv0n"><!></button> <!></div>'),Fn=d('<div class="sub-feature-box svelte-1kpvv0n"><h4 class="svelte-1kpvv0n"> </h4> <!> <p class="feature-description svelte-1kpvv0n"><!></p> <!></div>'),Pn=d('<div class="sub-features-grid svelte-1kpvv0n"></div>'),In=d('<div class="feature-box channel-divinity-main svelte-1kpvv0n"><h3 class="svelte-1kpvv0n"> </h3> <p class="feature-description svelte-1kpvv0n"><!></p> <div class="pool-tracker svelte-1kpvv0n"><input type="number" min="0" class="pool-input svelte-1kpvv0n"/> <span> </span> <button class="btn-small svelte-1kpvv0n"> </button></div> <!></div>'),En=d('<div class="spell-slots svelte-1kpvv0n"><label class="svelte-1kpvv0n"> </label> <div class="slots-tracker svelte-1kpvv0n"></div></div>'),Un=d('<div class="all-spell-slots"></div>'),Nn=d('<div class="feature-box spellcasting svelte-1kpvv0n"><h3 class="svelte-1kpvv0n"> </h3> <div class="spell-stats svelte-1kpvv0n"><div class="spell-stat svelte-1kpvv0n"><label class="svelte-1kpvv0n">Spell Save DC</label> <div class="spell-value svelte-1kpvv0n"> </div></div> <div class="spell-stat svelte-1kpvv0n"><label class="svelte-1kpvv0n">Prepared Spells</label> <div class="spell-value svelte-1kpvv0n"> </div></div></div> <!> <div class="prepared-spells svelte-1kpvv0n"><label class="svelte-1kpvv0n">Prepared Spells</label> <textarea placeholder="List your prepared spells..." class="svelte-1kpvv0n"></textarea></div></div>'),Hn=d('<p class="unlimited svelte-1kpvv0n">Unlimited Uses</p>'),On=d('<div class="slots-tracker svelte-1kpvv0n"></div> <div class="uses-actions-row"><button class="btn btn-primary use-enabled"> </button></div> <div class="uses-info svelte-1kpvv0n"><span class="reset-info svelte-1kpvv0n"> </span></div>',1),Gn=d('<div class="uses-tracker svelte-1kpvv0n"><!></div>'),qn=d('<div class="pool-tracker svelte-1kpvv0n"><input type="number" min="0" class="pool-input svelte-1kpvv0n"/> <span> </span> <button class="btn-small svelte-1kpvv0n"> </button></div>'),Wn=d('<div class="feature-box svelte-1kpvv0n"><h3 class="svelte-1kpvv0n"><!> </h3> <p class="feature-description svelte-1kpvv0n"> </p> <!></div>'),zn=d('<!> <div class="features-grid svelte-1kpvv0n"><!> <!></div>',1),Kn=d("<!> <!>",1),Vn=d("<section><!> <!></section>");function Jn(i,c){Zt(c,!1);const t=()=>_t(pe,"$character",g),v=()=>_t(es,"$abilityModifiers",g),f=()=>_t(xa,"$searchFilter",g),p=()=>_t(ia,"$collapsedStates",g),[g,S]=da(),x=w(),y=w(),E=w(),T=w(),X=w(),Y=w(),ee=w(),U=w(),M=w(),F=w(),ie=ka();let ge=w(0),Ge=w(0);function De(h,P){pe.update(de=>(de.classFeatures.features[h]=P,de))}function ve(){pe.update(h=>(h.classFeatures.spellSlotsByLevel||(h.classFeatures.spellSlotsByLevel={}),e(T).forEach(({level:P,slots:de})=>{h.classFeatures.spellSlotsByLevel[P]||(h.classFeatures.spellSlotsByLevel[P]=Array(de).fill(!1))}),h))}function ce(h){if(typeof h.maxUses=="function"){if((h.name==="Divine Sense"||h.name==="War Priest")&&e(x)?.spellcastingAbility){const P=v()[e(x).spellcastingAbility];return h.maxUses(t().level,P)}return h.maxUses(t().level)}return h.maxUses||0}function ye(h,P){pe.update(de=>((!de.classFeatures.features[h]||!Array.isArray(de.classFeatures.features[h])||de.classFeatures.features[h].length!==P)&&(de.classFeatures.features[h]=Array(P).fill(!1)),de))}Ys(()=>{e(Y)&&t()&&t().classFeatures&&t().classFeatures.features&&e(Y).forEach(h=>{if(h.type==="uses"){const de=A(h).replace(/\s+/g,""),Ze=ce(h),tt=t().classFeatures.features[de];(!Array.isArray(tt)||tt.length!==Ze)&&ye(de,Ze)}})});function qe(h){return typeof h.maxPool=="function"?h.maxPool(t().level):h.maxPool||0}function V(h){if(typeof h.description=="function"){if(e(x)?.spellcastingAbility){const P=v()[e(x).spellcastingAbility];return h.description(t().level,P)}return h.description(t().level)}return h.description}function A(h){if(typeof h.name=="function"){if(e(x)?.spellcastingAbility){const P=v()[e(x).spellcastingAbility];return h.name(t().level,P)}return h.name(t().level)}return h.name}function _(h){if(typeof h.subName=="function"){if(e(x)?.spellcastingAbility){const P=v()[e(x).spellcastingAbility];return h.subName(t().level,P)}return h.subName(t().level)}return h.subName||null}function H(h){if(typeof h.rollFormula=="function"){if(e(x)?.spellcastingAbility){const P=v()[e(x).spellcastingAbility];return h.rollFormula(t().level,P)}return h.rollFormula(t().level)}return h.rollFormula||""}function W(h){const P="ChannelDivinity",de=t().classFeatures.features[P];if(typeof de=="number"&&de>0){pe.update(tt=>(tt.classFeatures.features[P]=de-1,tt));const Ze=A(h);if(h.rollable&&h.rollFormula){const tt=H(h);tt?ie("roll",{notation:tt,attackName:Ze,rollType:"other"}):Ht.add(`Used ${Ze}`,"info")}else Ht.add(`Used ${Ze}`,"info")}}function me(){ia.update(h=>({...h,classFeatures:!h.classFeatures}))}Qe(()=>(t(),va),()=>{r(x,t().class?va(t().class):null)}),Qe(()=>(t(),Ta),()=>{r(y,t().class?Ta(t().class,t().level,t().subclass):[])}),Qe(()=>(t(),Rs),()=>{r(E,t().class?Rs(t().class,t().level):0)}),Qe(()=>(e(x),t()),()=>{r(T,(()=>{if(!e(x)?.spellcaster)return[];const h=t().level,P=[];return h>=1&&P.push({level:1,slots:Math.min(4,2+Math.floor(h/3))}),h>=3&&P.push({level:2,slots:Math.min(3,2+Math.floor((h-3)/4))}),h>=5&&P.push({level:3,slots:Math.min(3,2+Math.floor((h-5)/5))}),h>=7&&P.push({level:4,slots:Math.min(3,1+Math.floor((h-7)/6))}),h>=9&&P.push({level:5,slots:Math.min(2,1+Math.floor((h-9)/8))}),h>=11&&P.push({level:6,slots:1}),h>=13&&P.push({level:7,slots:1}),h>=15&&P.push({level:8,slots:1}),h>=17&&P.push({level:9,slots:1}),P})())}),Qe(()=>(e(x),v(),t(),Ms),()=>{if(e(x)?.spellcaster&&e(x).spellcastingAbility){const h=v()[e(x).spellcastingAbility];r(ge,Al(t().class,h,t().proficiencyBonus)||0),r(Ge,Ms(t().class,t().level,h))}}),Qe(()=>(t(),e(x),e(T)),()=>{t().class&&e(x)?.spellcaster&&e(T).length>0&&ve()}),Qe(()=>t(),()=>{r(X,(()=>{const P=t().classFeatures.features["ChannelDivinity"];return typeof P=="number"?P:0})())}),Qe(()=>(e(y),f()),()=>{r(Y,e(y).filter(h=>{if(!f())return!0;const P=f().toLowerCase();return A(h).toLowerCase().includes(P)||V(h).toLowerCase().includes(P)}))}),Qe(()=>e(Y),()=>{r(ee,e(Y).find(h=>h.type==="pool"&&A(h)==="Channel Divinity"))}),Qe(()=>e(Y),()=>{r(U,e(Y).flatMap(h=>{const P=[];return h.subFeatures&&P.push(...h.subFeatures),h.type==="channelDivinity"&&P.push(h),P}))}),Qe(()=>e(Y),()=>{r(M,e(Y).filter(h=>{const P=A(h);return!(h.type==="pool"&&P==="Channel Divinity"||h.type==="channelDivinity"||P==="Channel Divinity"&&h.subFeatures)}))}),Qe(()=>(f(),t(),e(Y)),()=>{r(F,!f()||t().class||"class features".includes(f().toLowerCase())||"spellcasting".includes(f().toLowerCase())||e(Y).length>0)}),ma(),Xt();var _e=Vn();let Ie;var Je=l(_e);{let h=yt(()=>(p(),n(()=>p().classFeatures?"Expand":"Collapse")));Da(Je,{title:"Class Features",get collapsed(){return p(),n(()=>p().classFeatures)},get ariaLabel(){return e(h)},onToggle:me})}var Ee=a(Je,2);{var Ae=h=>{var P=Kn(),de=Ce(P);An(de,{});var Ze=a(de,2);{var tt=Dt=>{var Bt=jn();o(Dt,Bt)},mt=Dt=>{var Bt=$t(),C=Ce(Bt);{var K=G=>{var Q=Bn();o(G,Q)},j=G=>{var Q=zn(),ue=Ce(Q);{var He=se=>{const z=yt(()=>(e(ee),n(()=>A(e(ee))))),Me=yt(()=>(I(e(z)),n(()=>e(z).replace(/\s+/g,"")))),we=yt(()=>(t(),I(e(Me)),n(()=>t().classFeatures.features[e(Me)]))),st=yt(()=>typeof e(we)=="number"),xe=yt(()=>(e(ee),n(()=>qe(e(ee)))));var Z=In(),u=l(Z),lt=l(u,!0);s(u);var Oe=a(u,2),O=l(Oe);ms(O,()=>(e(ee),n(()=>V(e(ee))))),s(Oe);var Se=a(Oe,2),Ye=l(Se);$e(Ye);var gt=a(Ye,2),it=l(gt);s(gt);var he=a(gt,2),Le=l(he,!0);s(he),s(Se);var Ue=a(Se,2);{var ft=J=>{var ze=Pn();Ct(ze,5,()=>e(U),jt,(dt,b)=>{const N=yt(()=>(e(b),n(()=>A(e(b)))));var oe=Fn(),ne=l(oe),le=l(ne,!0);s(ne);var Te=a(ne,2);{var at=be=>{var te=Rn(),fe=l(te,!0);s(te),L(Xe=>$(fe,Xe),[()=>(e(b),n(()=>_(e(b))))]),o(be,te)};m(Te,be=>{e(b),n(()=>e(b).subName)&&be(at)})}var Fe=a(Te,2),re=l(Fe);ms(re,()=>(e(b),n(()=>V(e(b))))),s(Fe);var q=a(Fe,2);{var nt=be=>{var te=Tn(),fe=l(te),Xe=l(fe);{var kt=Ne=>{var xt=Tt();L(()=>$(xt,`Roll ${e(N)??""}`)),o(Ne,xt)},ot=Ne=>{var xt=Tt();L(()=>$(xt,`Use ${e(N)??""}`)),o(Ne,xt)};m(Xe,Ne=>{e(b),n(()=>e(b).rollable&&H(e(b)))?Ne(kt):Ne(ot,!1)})}s(fe);var ae=a(fe,2);{var qt=Ne=>{var xt=Mn();o(Ne,xt)};m(ae,Ne=>{e(X)<=0&&Ne(qt)})}s(te),L(()=>fe.disabled=e(X)<=0),B("click",fe,()=>W(e(b))),o(be,te)};m(q,be=>{e(b),n(()=>e(b).type==="channelDivinity")&&be(nt)})}s(oe),L(()=>$(le,e(N))),o(dt,oe)}),s(ze),o(J,ze)};m(Ue,J=>{e(U),n(()=>e(U).length>0)&&J(ft)})}s(Z),L(()=>{$(lt,e(z)),Ra(Ye,e(st)&&e(we)!==void 0?e(we):e(xe)),vt(Ye,"max",e(xe)),$(it,`/ ${e(xe)??""}`),$(Le,(e(ee),n(()=>e(ee).resetOn==="short"?"Short Rest":"Long Rest")))}),B("input",Ye,J=>{pe.update(ze=>(ze.classFeatures.features[e(Me)]=parseInt(J.currentTarget.value)||0,ze))}),B("click",he,()=>De(e(Me),e(xe))),o(se,Z)};m(ue,se=>{e(ee)&&se(He)})}var Re=a(ue,2),je=l(Re);{var Be=se=>{var z=Nn(),Me=l(z),we=l(Me);s(Me);var st=a(Me,2),xe=l(st),Z=a(l(xe),2),u=l(Z,!0);s(Z),s(xe);var lt=a(xe,2),Oe=a(l(lt),2),O=l(Oe,!0);s(Oe),s(lt),s(st);var Se=a(st,2);{var Ye=he=>{var Le=Un();Ct(Le,5,()=>e(T),jt,(Ue,ft)=>{let J=()=>e(ft).level,ze=()=>e(ft).slots;const dt=yt(()=>(t(),J(),ze(),n(()=>t().classFeatures.spellSlotsByLevel?.[J()]||Array(ze()).fill(!1))));var b=En(),N=l(b),oe=l(N);s(N);var ne=a(N,2);Ct(ne,5,()=>e(dt),jt,(le,Te,at)=>{{let Fe=yt(()=>(I(e(dt)),n(()=>e(dt)[at]||!1)));Fs(le,{get checked(){return e(Fe)},$$events:{change:re=>{pe.update(q=>(q.classFeatures.spellSlotsByLevel||(q.classFeatures.spellSlotsByLevel={}),q.classFeatures.spellSlotsByLevel[J()]||(q.classFeatures.spellSlotsByLevel[J()]=Array(ze()).fill(!1)),q.classFeatures.spellSlotsByLevel[J()][at]=re.detail.checked,q))}}})}}),s(ne),s(b),L(()=>$(oe,`${J()===1?"1st":J()===2?"2nd":J()===3?"3rd":`${J()}th`} Level Spell Slots`)),o(Ue,b)}),s(Le),o(he,Le)};m(Se,he=>{e(T),n(()=>e(T).length>0)&&he(Ye)})}var gt=a(Se,2),it=a(l(gt),2);ja(it),s(gt),s(z),L(he=>{$(we,`Spellcasting (${he??""})`),$(u,e(ge)),$(O,e(Ge))},[()=>(e(x),n(()=>e(x).spellcastingAbility?.toUpperCase()))]),Ve(it,()=>t().classFeatures.preparedSpells,he=>Gt(pe,n(t).classFeatures.preparedSpells=he,n(t))),o(se,z)};m(je,se=>{e(x),n(()=>e(x)?.spellcaster)&&se(Be)})}var k=a(je,2);Ct(k,1,()=>e(M),jt,(se,z)=>{const Me=yt(()=>(e(z),n(()=>A(e(z))))),we=yt(()=>(I(e(Me)),n(()=>e(Me).replace(/\s+/g,"")))),st=yt(()=>(t(),I(e(we)),n(()=>t().classFeatures.features[e(we)]))),xe=yt(()=>typeof e(st)=="number");var Z=Wn(),u=l(Z),lt=l(u);{var Oe=Le=>{var Ue=Tt("Channel Divinity:");o(Le,Ue)};m(lt,Le=>{e(z),n(()=>e(z).type==="channelDivinity")&&Le(Oe)})}var O=a(lt);s(u);var Se=a(u,2),Ye=l(Se,!0);s(Se);var gt=a(Se,2);{var it=Le=>{const Ue=yt(()=>(e(z),n(()=>ce(e(z))))),ft=yt(()=>(I(e(st)),I(e(Ue)),n(()=>Array.isArray(e(st))?e(st):Array(e(Ue)).fill(!1))));var J=Gn(),ze=l(J);{var dt=N=>{var oe=Hn();o(N,oe)},b=N=>{var oe=On(),ne=Ce(oe);Ct(ne,5,()=>e(ft),jt,(nt,be,te)=>{Fs(nt,{get checked(){return e(be)},index:te,$$events:{change:fe=>{pe.update(Xe=>(Xe.classFeatures.features[e(we)]||(Xe.classFeatures.features[e(we)]=Array(e(Ue)).fill(!1)),Xe.classFeatures.features[e(we)][te]=fe.detail.checked,Xe))}}})}),s(ne);var le=a(ne,2),Te=l(le),at=l(Te);s(Te),s(le);var Fe=a(le,2),re=l(Fe),q=l(re);s(re),s(Fe),L(nt=>{Te.disabled=nt,$(at,`Use ${e(Me)??""}`),$(q,`Resets on ${e(z),n(()=>e(z).resetOn==="short"?"Short Rest":"Long Rest")??""}`)},[()=>(I(e(ft)),n(()=>e(ft).filter(nt=>!nt).length<=0))]),B("click",Te,()=>{pe.update(nt=>{nt.classFeatures.features[e(we)]||(nt.classFeatures.features[e(we)]=Array(e(Ue)).fill(!1));const be=nt.classFeatures.features[e(we)],te=be.findIndex(fe=>!fe);return te!==-1&&(be[te]=!0),nt})}),o(N,oe)};m(ze,N=>{e(Ue)===1/0?N(dt):N(b,!1)})}s(J),o(Le,J)},he=Le=>{var Ue=$t(),ft=Ce(Ue);{var J=ze=>{const dt=yt(()=>(e(z),n(()=>qe(e(z)))));var b=qn(),N=l(b);$e(N);var oe=a(N,2),ne=l(oe);s(oe);var le=a(oe,2),Te=l(le,!0);s(le),s(b),L(()=>{Ra(N,e(xe)&&e(st)!==void 0?e(st):e(dt)),vt(N,"max",e(dt)),$(ne,`/ ${e(dt)??""}`),$(Te,(e(z),n(()=>e(z).resetOn==="short"?"Short Rest":"Long Rest")))}),B("input",N,at=>{pe.update(Fe=>(Fe.classFeatures.features[e(we)]=parseInt(at.currentTarget.value)||0,Fe))}),B("click",le,()=>De(e(we),e(dt))),o(ze,b)};m(ft,ze=>{e(z),n(()=>e(z).type==="pool")&&ze(J)},!0)}o(Le,Ue)};m(gt,Le=>{e(z),n(()=>e(z).type==="uses")?Le(it):Le(he,!1)})}s(Z),L(Le=>{$(O,` ${e(Me)??""}`),$(Ye,Le)},[()=>(e(z),n(()=>V(e(z))))]),o(se,Z)}),s(Re),o(G,Q)};m(C,G=>{e(y),n(()=>e(y).length===0)?G(K):G(j,!1)},!0)}o(Dt,Bt)};m(Ze,Dt=>{t(),n(()=>!t().class)?Dt(tt):Dt(mt,!1)})}o(h,P)};m(Ee,h=>{p(),n(()=>!p().classFeatures)&&h(Ae)})}s(_e),L(()=>Ie=Ut(_e,1,"class-features svelte-1kpvv0n",null,Ie,{hidden:!e(F)})),o(i,_e),ea(),S()}var Yn=d('<textarea placeholder="Enter features, traits, and special abilities..." class="svelte-wttn0l"></textarea> <h3 class="svelte-wttn0l">Equipment</h3> <textarea placeholder="List your equipment and inventory..." class="svelte-wttn0l"></textarea> <h3 class="svelte-wttn0l">Notes</h3> <textarea placeholder="Additional notes..." class="svelte-wttn0l"></textarea>',1),Qn=d("<section><!> <!></section>");function Xn(i,c){Zt(c,!1);const t=()=>_t(xa,"$searchFilter",p),v=()=>_t(pe,"$character",p),f=()=>_t(ia,"$collapsedStates",p),[p,g]=da(),S=w();function x(){ia.update(ee=>({...ee,notes:!ee.notes}))}Qe(()=>(t(),v()),()=>{r(S,!t()||"features".includes(t().toLowerCase())||"traits".includes(t().toLowerCase())||"equipment".includes(t().toLowerCase())||"notes".includes(t().toLowerCase())||v().features.toLowerCase().includes(t().toLowerCase())||v().equipment.toLowerCase().includes(t().toLowerCase())||v().notes.toLowerCase().includes(t().toLowerCase()))}),ma(),Xt();var y=Qn();let E;var T=l(y);{let ee=yt(()=>(f(),n(()=>f().notes?"Expand":"Collapse")));Da(T,{title:"Features & Traits",get collapsed(){return f(),n(()=>f().notes)},get ariaLabel(){return e(ee)},onToggle:x})}var X=a(T,2);{var Y=ee=>{var U=Yn(),M=Ce(U);ja(M);var F=a(M,4);ja(F);var ie=a(F,4);ja(ie),Ve(M,()=>v().features,ge=>Gt(pe,n(v).features=ge,n(v))),Ve(F,()=>v().equipment,ge=>Gt(pe,n(v).equipment=ge,n(v))),Ve(ie,()=>v().notes,ge=>Gt(pe,n(v).notes=ge,n(v))),o(ee,U)};m(X,ee=>{f(),n(()=>!f().notes)&&ee(Y)})}s(y),L(()=>E=Ut(y,1,"notes svelte-wttn0l",null,E,{hidden:!e(S)})),o(i,y),ea(),g()}var Zn=d(" <!> <!> <!> <!> <!>",1),er=d('<div class="color-picker-section svelte-1r90jgp"><h3 class="svelte-1r90jgp">Dice Colors</h3> <div class="color-inputs svelte-1r90jgp"><div class="color-input-group svelte-1r90jgp"><label for="dice-color" class="svelte-1r90jgp">Dice Color</label> <input type="color" id="dice-color" class="svelte-1r90jgp"/></div> <div class="color-input-group svelte-1r90jgp"><label for="label-color" class="svelte-1r90jgp">Label Color</label> <input type="color" id="label-color" class="svelte-1r90jgp"/></div> <div class="color-input-group svelte-1r90jgp"><label for="desk-color" class="svelte-1r90jgp">Background Color</label> <input type="color" id="desk-color" class="svelte-1r90jgp"/></div></div></div>'),tr=d('<div class="loading svelte-1r90jgp"><p class="svelte-1r90jgp">Loading 3D dice...</p></div>'),ar=d('<div class="custom-dice-selector svelte-1r90jgp"><h3 class="svelte-1r90jgp">Choose Dice to Roll</h3> <div class="dice-inputs svelte-1r90jgp"><div class="dice-input-group svelte-1r90jgp"><label for="d4" class="svelte-1r90jgp">d4</label> <input class="use-enabled svelte-1r90jgp" type="number" id="d4" min="0" max="10"/></div> <div class="dice-input-group svelte-1r90jgp"><label for="d6" class="svelte-1r90jgp">d6</label> <input class="use-enabled svelte-1r90jgp" type="number" id="d6" min="0" max="10"/></div> <div class="dice-input-group svelte-1r90jgp"><label for="d8" class="svelte-1r90jgp">d8</label> <input class="use-enabled svelte-1r90jgp" type="number" id="d8" min="0" max="10"/></div> <div class="dice-input-group svelte-1r90jgp"><label for="d10" class="svelte-1r90jgp">d10</label> <input class="use-enabled svelte-1r90jgp" type="number" id="d10" min="0" max="10"/></div> <div class="dice-input-group svelte-1r90jgp"><label for="d12" class="svelte-1r90jgp">d12</label> <input class="use-enabled svelte-1r90jgp" type="number" id="d12" min="0" max="10"/></div> <div class="dice-input-group svelte-1r90jgp"><label for="d20" class="svelte-1r90jgp">d20</label> <input class="use-enabled svelte-1r90jgp" type="number" id="d20" min="0" max="10"/></div></div> <div class="dice-controls svelte-1r90jgp"><button class="btn btn-primary use-enabled svelte-1r90jgp"> </button> <button class="btn btn-secondary use-enabled svelte-1r90jgp">Reset</button></div></div>'),sr=d('<h3 class="svelte-1r90jgp"> </h3>'),lr=d('<h3 class="svelte-1r90jgp"> </h3>'),ir=d('<h3 class="svelte-1r90jgp"> </h3>'),nr=d('<h3 class="svelte-1r90jgp"> </h3>'),rr=d('<span class="crit-badge svelte-1r90jgp">CRITICAL HIT!</span>'),or=d('<span class="crit-badge crit-fail svelte-1r90jgp">CRITICAL MISS!</span>'),cr=d('<div class="bonus-item svelte-1r90jgp"><span class="bonus-value svelte-1r90jgp"> </span> <span class="bonus-source svelte-1r90jgp"> </span></div>'),vr=d('<div class="bonus-breakdown svelte-1r90jgp"></div>'),dr=d('<p class="modifier-text svelte-1r90jgp"> </p>'),ur=d('<div class="svelte-1r90jgp"><em class="svelte-1r90jgp">No damage is dealt on a critical miss.</em></div>'),fr=d('<button class="btn btn-follow-up svelte-1r90jgp"> </button>'),pr=d('<button class="btn btn-guided-strike svelte-1r90jgp">‚ö° Use Guided Strike (+10)</button>'),mr=d('<div class="follow-up-actions svelte-1r90jgp"><!> <!></div>'),gr=d('<div class="result-header svelte-1r90jgp"><!> <!> <!></div> <div class="result-total svelte-1r90jgp"> </div> <div class="result-details svelte-1r90jgp"><!></div> <!> <!>',1),br=d('<div role="button" tabindex="-1"><div class="modal-content svelte-1r90jgp" role="dialog" tabindex="0"><div class="modal-header svelte-1r90jgp"><h2 class="svelte-1r90jgp"><!></h2> <div class="header-buttons svelte-1r90jgp"><button class="color-btn svelte-1r90jgp" title="Customize dice colors">üé®</button> <button class="close-btn svelte-1r90jgp">√ó</button></div></div> <!> <!> <div class="dice-main-area svelte-1r90jgp"><div class="dice-container svelte-1r90jgp"></div> <!></div> <div><!></div></div></div>');function hr(i,c){Zt(c,!1);const t=()=>_t(pe,"$character",v),[v,f]=da(),p=w(),g=w(),S=w(),x=ka();let y=At(c,"notation",12,""),E=At(c,"visible",8,!1),T=At(c,"damageNotation",12,""),X=At(c,"damageType",8,""),Y=At(c,"attackName",12,""),ee=At(c,"applyHalfDamage",8,!1),U=At(c,"bonusBreakdown",28,()=>[]),M=At(c,"rollType",12,"other"),F=At(c,"damageBreakdown",24,()=>[]),ie=null,ge=w(void 0),Ge=w(!1),De=w(""),ve=w(null),ce=w("");function ye(){return e(ve)?.resultTotal??null}function qe(b,N,oe){const ne=[];if(!b||!b.result)return ne;const le=N.match(/([+-]?\d*d\d+|[+-]?\d+)/g)||[];let Te=0;const at=new Set;let Fe=!0;for(const re of le){const q=re.trim();if(!q)continue;const nt=q.match(/([+-]?)(\d*)d(\d+)/);if(nt){const be=parseInt(nt[2]||"1"),te=`${be}d${nt[3]}`,fe=oe.findIndex((ot,ae)=>!at.has(ae)&&typeof ot.value=="string"&&ot.value===te),Xe=[];for(let ot=0;ot<be&&Te<b.result.length;ot++)Xe.push(b.result[Te++]);let kt;fe>=0?(kt=oe[fe].source,at.add(fe)):kt="base";for(const ot of Xe)ne.push({display:`${ot}`,source:kt});Fe=!1}}for(let re=0;re<oe.length;re++)if(!at.has(re)&&typeof oe[re].value=="number"){const q=oe[re].value;ne.push({display:q>=0?`+${q}`:`${q}`,source:oe[re].source})}return ne}let V=w(0),A=w(0),_=w(0),H=w(0),W=w(0),me=w(0),_e=w(0),Ie=w([]),Je=w(!1),Ee=w(!1),Ae=w(!1),h=w("#051e0a"),P=w("#ffffff"),de=w("#3a2004"),Ze=w(!1);function tt(b){return b.length===9&&b.startsWith("#")?b.substring(0,7):b}function mt(b,N="ff"){return b.length===7&&b.startsWith("#")?b+N:b}function Dt(){if(window.DICE&&e(ge))try{ie&&e(ge)&&ha(ge,e(ge).innerHTML="");const b=e(ge).clientWidth||500,N=e(ge).clientHeight||300;ie=new window.DICE.dice_box(e(ge),{w:b,h:N}),r(Ge,!0)}catch(b){console.error("Error initializing dice box:",b)}}Ca(()=>{const b=ne=>new Promise((le,Te)=>{if(document.querySelector(`script[src="${ne}"]`)){le(null);return}const Fe=document.createElement("script");Fe.src=ne,Fe.onload=()=>{le(null)},Fe.onerror=()=>{console.error(`Failed to load: ${ne}`),Te(new Error(`Failed to load ${ne}`))},document.head.appendChild(Fe)});setTimeout(()=>{b(`${Ia}/libs/three.min.js`).then(()=>b(`${Ia}/libs/cannon.min.js`)).then(()=>b(`${Ia}/libs/teal.js`)).then(()=>b(`${Ia}/dice.js`)).then(()=>{if(window.DICE){const ne=window.DICE.getColors();r(h,tt(ne.dice_color)),r(P,tt(ne.label_color)),r(de,tt(ne.desk_color))}Dt()}).catch(ne=>{console.error("Failed to load dice libraries:",ne)})},100);const N=()=>{e(Ge)&&Dt()},oe=ne=>{E()&&ne.key==="Escape"&&Re()};return window.addEventListener("resize",N),window.addEventListener("keydown",oe),()=>{window.removeEventListener("resize",N),window.removeEventListener("keydown",oe)}});function Bt(b,N="other"){if(!ie||!e(Ge))return;r(ve,null),r(Ie,[]),r(Je,!1),r(Ee,!1),M(N),r(Ae,!1),r(ce,b),ie.diceToRoll=b;const oe=le=>null,ne=le=>{let Te=le.resultTotal,at=le.resultString;if(ee()&&(Te=Math.floor(Te/2),at=at+" (halved)"),r(ve,{...le,resultTotal:Te,resultString:at}),N==="attack"&&le.result&&le.result.length>0){const Fe=le.result[0];r(Je,Fe===20),r(Ee,Fe===1)}if(r(Ie,[]),N==="attack"){if(T())if(e(Je)){const Fe=j(T()),re=F().map(q=>{if(typeof q.value=="string"&&q.value.match(/^\d+d\d+$/)){const nt=j(q.value);return{...q,value:nt}}return q});e(Ie).push({label:`Roll Critical Damage (${Fe})`,notation:Fe,breakdown:re})}else e(Ee)||e(Ie).push({label:`Roll Damage (${T()})`,notation:T(),breakdown:F()});if(Y()&&T()&&t().class?.toLowerCase()==="rogue"&&t().features?.toLowerCase?.().includes("sneak attack")){const Fe=`${T()}+3d6`,re=[...F(),{value:"3d6",source:"Sneak Attack"}];e(Ie).push({label:`Roll Damage + Sneak Attack (${Fe})`,notation:Fe,breakdown:re})}}};ie.start_throw(oe,ne)}function C(){const b=[];e(V)>0&&b.push(`${e(V)}d4`),e(A)>0&&b.push(`${e(A)}d6`),e(_)>0&&b.push(`${e(_)}d8`),e(H)>0&&b.push(`${e(H)}d10`),e(W)>0&&b.push(`${e(W)}d12`),e(me)>0&&b.push(`${e(me)}d20`);let N=b.join("+")||"1d20";return e(_e)!==0&&(N+=e(_e)>=0?`+${e(_e)}`:`${e(_e)}`),N}function K(){const b=C();Bt(b)}function j(b){return b.replace(/(\d+)d(\d+)/g,(N,oe,ne)=>`${parseInt(oe)*2}d${ne}`)}function G(){r(V,0),r(A,0),r(_,0),r(H,0),r(W,0),r(me,0),r(_e,0),r(ve,null),r(Ie,[]),r(Je,!1),r(Ee,!1),M("other"),r(Ae,!1)}function Q(){window.DICE&&(window.DICE.setColors({dice_color:mt(e(h),"ff"),label_color:mt(e(P),"ff"),desk_color:e(de)}),ie&&(ie.updateDeskColor(e(de)),ie.updateDiceColors()))}function ue(){r(Ze,!e(Ze))}function He(){!e(ve)||e(g)<=0||e(Ae)||(r(ve,{...e(ve),resultTotal:e(ve).resultTotal+10,resultString:e(ve).resultString+" + 10 (Guided Strike)"}),U([...U(),{value:10,source:"Guided Strike"}]),pe.update(b=>{const N="ChannelDivinity",oe=b.classFeatures.features[N];return typeof oe=="number"&&oe>0&&(b.classFeatures.features[N]=oe-1),b}),r(Ae,!0))}function Re(){x("close"),y(""),T(""),Y(""),r(De,""),r(ve,null),r(Ae,!1),r(Je,!1),r(Ee,!1),G()}Qe(()=>(t(),Ta),()=>{r(p,t().class?Ta(t().class,t().level,t().subclass).some(N=>N.name==="Guided Strike"):!1)}),Qe(()=>t(),()=>{r(g,(()=>{const N=t().classFeatures.features["ChannelDivinity"];return typeof N=="number"?N:0})())}),Qe(()=>(e(V),e(A),e(_),e(H),e(W),e(me),e(_e)),()=>{r(S,(()=>{const b=[];e(V)>0&&b.push(`${e(V)}d4`),e(A)>0&&b.push(`${e(A)}d6`),e(_)>0&&b.push(`${e(_)}d8`),e(H)>0&&b.push(`${e(H)}d10`),e(W)>0&&b.push(`${e(W)}d12`),e(me)>0&&b.push(`${e(me)}d20`);let N=b.join("+")||"1d20";return e(_e)!==0&&(N+=e(_e)>=0?`+${e(_e)}`:`${e(_e)}`),N})())}),Qe(()=>(I(y()),e(Ge),I(E()),e(De),I(M())),()=>{y()&&e(Ge)&&E()&&y()!==e(De)&&(r(De,y()),r(ve,null),r(Ie,[]),r(Je,!1),r(Ee,!1),r(Ae,!1),setTimeout(()=>Bt(y(),M()),200))}),ma();var je={getLastRollTotal:ye};Xt();var Be=br();let k;var se=l(Be),z=l(se),Me=l(z),we=l(Me);{var st=b=>{var N=Zn(),oe=Ce(N),ne=a(oe);{var le=fe=>{var Xe=Tt("- Attack Roll");o(fe,Xe)};m(ne,fe=>{M()==="attack"&&fe(le)})}var Te=a(ne,2);{var at=fe=>{var Xe=Tt("- Damage Roll");o(fe,Xe)};m(Te,fe=>{M()==="damage"&&fe(at)})}var Fe=a(Te,2);{var re=fe=>{var Xe=Tt("- Healing Roll");o(fe,Xe)};m(Fe,fe=>{M()==="healing"&&fe(re)})}var q=a(Fe,2);{var nt=fe=>{var Xe=Tt("- Ability Check");o(fe,Xe)};m(q,fe=>{M()==="check"&&fe(nt)})}var be=a(q,2);{var te=fe=>{var Xe=Tt("- Saving Throw");o(fe,Xe)};m(be,fe=>{M()==="save"&&fe(te)})}L(()=>$(oe,`${Y()??""} `)),o(b,N)},xe=b=>{var N=Tt("Dice Roller");o(b,N)};m(we,b=>{Y()?b(st):b(xe,!1)})}s(Me);var Z=a(Me,2),u=l(Z),lt=a(u,2);s(Z),s(z);var Oe=a(z,2);{var O=b=>{var N=er(),oe=a(l(N),2),ne=l(oe),le=a(l(ne),2);$e(le),s(ne);var Te=a(ne,2),at=a(l(Te),2);$e(at),s(Te);var Fe=a(Te,2),re=a(l(Fe),2);$e(re),s(Fe),s(oe),s(N),Ve(le,()=>e(h),q=>r(h,q)),B("change",le,Q),Ve(at,()=>e(P),q=>r(P,q)),B("change",at,Q),Ve(re,()=>e(de),q=>r(de,q)),B("change",re,Q),o(b,N)};m(Oe,b=>{e(Ze)&&b(O)})}var Se=a(Oe,2);{var Ye=b=>{var N=tr();o(b,N)};m(Se,b=>{e(Ge)||b(Ye)})}var gt=a(Se,2),it=l(gt);Ua(it,b=>r(ge,b),()=>e(ge));var he=a(it,2);{var Le=b=>{var N=ar(),oe=a(l(N),2),ne=l(oe),le=a(l(ne),2);$e(le),s(ne);var Te=a(ne,2),at=a(l(Te),2);$e(at),s(Te);var Fe=a(Te,2),re=a(l(Fe),2);$e(re),s(Fe);var q=a(Fe,2),nt=a(l(q),2);$e(nt),s(q);var be=a(q,2),te=a(l(be),2);$e(te),s(be);var fe=a(be,2),Xe=a(l(fe),2);$e(Xe),s(fe),s(oe);var kt=a(oe,2),ot=l(kt),ae=l(ot);s(ot);var qt=a(ot,2);s(kt),s(N),L(()=>{ot.disabled=!e(Ge),$(ae,`Roll ${e(S)??""}`)}),Ve(le,()=>e(V),Ne=>r(V,Ne)),Ve(at,()=>e(A),Ne=>r(A,Ne)),Ve(re,()=>e(_),Ne=>r(_,Ne)),Ve(nt,()=>e(H),Ne=>r(H,Ne)),Ve(te,()=>e(W),Ne=>r(W,Ne)),Ve(Xe,()=>e(me),Ne=>r(me,Ne)),B("click",ot,K),B("click",qt,G),o(b,N)};m(he,b=>{y()||b(Le)})}s(gt);var Ue=a(gt,2);let ft;var J=l(Ue);{var ze=b=>{var N=gr(),oe=Ce(N),ne=l(oe);{var le=Ne=>{var xt=sr(),na=l(xt,!0);s(xt),L(()=>$(na,Y()?`${Y()} - Healing`:"Healing")),o(Ne,xt)},Te=Ne=>{var xt=$t(),na=Ce(xt);{var ta=D=>{var ke=lr(),et=l(ke,!0);s(ke),L(()=>$(et,Y()?`${Y()} - ${X()} Damage`:`${X()} Damage`)),o(D,ke)},Ot=D=>{var ke=$t(),et=Ce(ke);{var We=ut=>{var rt=ir(),wt=l(rt,!0);s(rt),L(()=>$(wt,Y()?`${Y()} - Damage`:"Damage")),o(ut,rt)},R=ut=>{var rt=nr(),wt=l(rt,!0);s(rt),L(()=>$(wt,Y()?`${Y()} - Result`:"Result")),o(ut,rt)};m(et,ut=>{M()==="damage"?ut(We):ut(R,!1)},!0)}o(D,ke)};m(na,D=>{M()==="damage"&&X()?D(ta):D(Ot,!1)},!0)}o(Ne,xt)};m(ne,Ne=>{M()==="damage"&&X()==="Healing"?Ne(le):Ne(Te,!1)})}var at=a(ne,2);{var Fe=Ne=>{var xt=rr();o(Ne,xt)};m(at,Ne=>{e(Je)&&Ne(Fe)})}var re=a(at,2);{var q=Ne=>{var xt=or();o(Ne,xt)};m(re,Ne=>{e(Ee)&&Ne(q)})}s(oe);var nt=a(oe,2),be=l(nt,!0);s(nt);var te=a(nt,2),fe=l(te);{var Xe=Ne=>{var xt=$t(),na=Ce(xt);{var ta=D=>{var ke=vr();Ct(ke,5,()=>(e(ve),e(ce),I(U()),n(()=>qe(e(ve),e(ce),U()))),jt,(et,We)=>{var R=cr(),ut=l(R),rt=l(ut,!0);s(ut);var wt=a(ut,2),Pe=l(wt);s(wt),s(R),L(()=>{$(rt,(e(We),n(()=>e(We).display))),$(Pe,`(${e(We),n(()=>e(We).source)??""})`)}),o(et,R)}),s(ke),o(D,ke)},Ot=D=>{var ke=$t(),et=Ce(ke);{var We=R=>{var ut=dr(),rt=l(ut);s(ut),L(()=>$(rt,`Modifier: ${e(ve),n(()=>e(ve).constant>=0?"+":"")??""}${e(ve),n(()=>e(ve).constant)??""}`)),o(R,ut)};m(et,R=>{e(ve),n(()=>e(ve).constant)&&R(We)},!0)}o(D,ke)};m(na,D=>{I(U()),n(()=>U().length>0)?D(ta):D(Ot,!1)})}o(Ne,xt)};m(fe,Ne=>{e(ve),I(U()),n(()=>e(ve).constant||U().length>0)&&Ne(Xe)})}s(te);var kt=a(te,2);{var ot=Ne=>{var xt=ur();o(Ne,xt)};m(kt,Ne=>{e(Ee)&&Ne(ot)})}var ae=a(kt,2);{var qt=Ne=>{var xt=mr(),na=l(xt);Ct(na,1,()=>e(Ie),jt,(D,ke)=>{var et=fr(),We=l(et,!0);s(et),L(()=>$(We,(e(ke),n(()=>e(ke).label)))),B("click",et,()=>{U(e(ke).breakdown||[]),Bt(e(ke).notation,"damage")}),o(D,et)});var ta=a(na,2);{var Ot=D=>{var ke=pr();L(()=>{ke.disabled=e(g)<=0,vt(ke,"title",e(g)<=0?"No Channel Divinity uses remaining":"Use Channel Divinity to add +10 to this attack roll")}),B("click",ke,He),o(D,ke)};m(ta,D=>{e(p)&&M()==="attack"&&!e(Ae)&&e(g)>0&&!e(Ee)&&D(Ot)})}s(xt),o(Ne,xt)};m(ae,Ne=>{e(Ie),e(p),I(M()),e(Ae),e(g),n(()=>e(Ie).length>0||e(p)&&M()==="attack"&&!e(Ae)&&e(g)>0)&&Ne(qt)})}L(()=>$(be,(e(ve),n(()=>e(ve).resultTotal)))),o(b,N)};m(J,b=>{e(ve)&&b(ze)})}s(Ue),s(se),s(Be),L(()=>{k=Ut(Be,1,"modal-overlay svelte-1r90jgp",null,k,{hidden:!E()}),ft=Ut(Ue,1,"roll-result svelte-1r90jgp",null,ft,{"has-result":e(ve)})}),B("click",u,ue),B("click",lt,Re),B("click",se,ks(function(b){Ma.call(this,c,b)})),B("keydown",se,function(b){Ma.call(this,c,b)}),B("click",Be,Re),B("keydown",Be,b=>b.key==="Escape"&&Re()),o(i,Be),Dl(c,"getLastRollTotal",ye);var dt=ea(je);return f(),dt}const ts="https://api.github.com/gists";async function _r(i,c,t){if(!c)throw new Error("GitHub token is required");const v=JSON.stringify(i,null,2),f=`${i.name||"character"}_dnd.json`,p={description:t||`D&D Character: ${i.name}`,public:!1,files:{[f]:{content:v}}},g=await fetch(ts,{method:"POST",headers:{Authorization:`token ${c}`,"Content-Type":"application/json"},body:JSON.stringify(p)});if(!g.ok)throw new Error(`Failed to create gist: ${g.statusText}`);return(await g.json()).id}async function yr(i,c,t){if(!c||!t)throw new Error("GitHub token and Gist ID are required");const v=JSON.stringify(i,null,2),p={files:{[`${i.name||"character"}_dnd.json`]:{content:v}}},g=await fetch(`${ts}/${t}`,{method:"PATCH",headers:{Authorization:`token ${c}`,"Content-Type":"application/json"},body:JSON.stringify(p)});if(!g.ok)throw new Error(`Failed to update gist: ${g.statusText}`)}async function xr(i,c){if(!i)throw new Error("Gist ID is required");const t={"Content-Type":"application/json"};c&&(t.Authorization=`token ${c}`);const v=await fetch(`${ts}/${i}`,{method:"GET",headers:t});if(!v.ok)throw new Error(`Failed to load gist: ${v.statusText}`);const f=await v.json(),p=Object.values(f.files);if(p.length===0)throw new Error("No files found in gist");const S=p[0].content;try{const x=JSON.parse(S);return x.attacks&&Array.isArray(x.attacks)&&(x.attacks=x.attacks.map(y=>({...y,id:y.id||crypto.randomUUID()}))),x.classFeatures?(x.classFeatures.features||(x.classFeatures.features={}),x.classFeatures.spellSlots||(x.classFeatures.spellSlots=[]),x.classFeatures.preparedSpells===void 0&&(x.classFeatures.preparedSpells="")):x.classFeatures={features:{},spellSlots:[],preparedSpells:""},x}catch{throw new Error("Invalid character data in gist")}}function Ps(i){typeof window<"u"&&localStorage.setItem("dnd_gist_config",JSON.stringify(i))}function kr(){if(typeof window<"u"){const i=localStorage.getItem("dnd_gist_config");if(i)return JSON.parse(i)}return{}}async function $r(i,c=30){if(!i)throw new Error("GitHub token is required to list gists");const t=await fetch(`${ts}?per_page=${c}`,{method:"GET",headers:{Authorization:`token ${i}`,"Content-Type":"application/json"}});if(!t.ok)throw new Error(`Failed to list gists: ${t.statusText}`);return await t.json()}var wr=d('<div class="error-message svelte-1jb5ckg"> </div>'),Sr=d('<div class="toggle-container svelte-1jb5ckg"><button type="button" class="toggle-btn svelte-1jb5ckg"> </button></div>'),Cr=d('<div class="form-group svelte-1jb5ckg"><label for="gistId" class="svelte-1jb5ckg">Gist ID (leave empty to create new)</label> <input type="text" id="gistId" placeholder="Optional: existing Gist ID to update" class="svelte-1jb5ckg"/></div>'),Dr=d('<div class="loading-message svelte-1jb5ckg">Loading your gists...</div>'),Lr=d('<button type="button"><div class="gist-item-header svelte-1jb5ckg"><span class="gist-description svelte-1jb5ckg"> </span> <span class="gist-visibility svelte-1jb5ckg"> </span></div> <div class="gist-item-meta svelte-1jb5ckg"><span class="gist-id svelte-1jb5ckg"> </span> <span class="gist-date svelte-1jb5ckg"> </span></div></button>'),Ar=d('<div class="form-group svelte-1jb5ckg"><div class="gist-list-label svelte-1jb5ckg">Select a Gist to Update (or leave unselected to create new)</div> <div class="gist-list svelte-1jb5ckg"></div></div>'),jr=d('<div class="info-message svelte-1jb5ckg">No gists found. A new one will be created.</div>'),Br=d('<!> <div class="form-group svelte-1jb5ckg"><label for="description" class="svelte-1jb5ckg"> </label> <input type="text" id="description" placeholder="D&amp;D Character Sheet" class="svelte-1jb5ckg"/></div>',1),Rr=d('<div class="form-group svelte-1jb5ckg"><label for="gistId" class="svelte-1jb5ckg">Gist ID *</label> <input type="text" id="gistId" placeholder="Enter Gist ID (for public or your private gists)" required class="svelte-1jb5ckg"/></div>'),Mr=d('<div class="loading-message svelte-1jb5ckg">Loading your gists...</div>'),Tr=d('<button type="button"><div class="gist-item-header svelte-1jb5ckg"><span class="gist-description svelte-1jb5ckg"> </span> <span class="gist-visibility svelte-1jb5ckg"> </span></div> <div class="gist-item-meta svelte-1jb5ckg"><span class="gist-id svelte-1jb5ckg"> </span> <span class="gist-date svelte-1jb5ckg"> </span></div></button>'),Fr=d('<div class="form-group svelte-1jb5ckg"><div class="gist-list-label svelte-1jb5ckg">Select a Gist to Load</div> <div class="gist-list svelte-1jb5ckg"></div></div>'),Pr=d('<div class="info-message svelte-1jb5ckg">No gists found. Enter a Gist ID manually or create a new one in Save mode.</div>'),Ir=d('<div class="modal-overlay svelte-1jb5ckg" role="button" tabindex="-1"><div class="modal-content svelte-1jb5ckg" role="dialog" tabindex="0"><div class="modal-header svelte-1jb5ckg"><h2 class="svelte-1jb5ckg"> </h2> <button class="close-btn svelte-1jb5ckg">√ó</button></div> <div class="modal-body svelte-1jb5ckg"><!> <div class="form-group svelte-1jb5ckg"><label for="token" class="svelte-1jb5ckg"> <a href="https://github.com/settings/tokens" target="_blank" rel="noopener" class="svelte-1jb5ckg">Get token</a></label> <input type="password" id="token" placeholder="ghp_xxxxxxxxxxxxx" class="svelte-1jb5ckg"/></div> <!> <!> <div class="modal-actions svelte-1jb5ckg"><button class="btn btn-primary svelte-1jb5ckg"><!></button> <button class="btn btn-secondary svelte-1jb5ckg">Cancel</button></div></div></div></div>');function Er(i,c){Zt(c,!1);const t=()=>_t(pe,"$character",v),[v,f]=da(),p=ka();let g=At(c,"mode",8,"save"),S=w(""),x=w(""),y=w(""),E=w(!1),T=w(""),X=w(!1),Y=w(!1),ee=w([]),U=w(null);const M=kr();M.token&&r(S,M.token),M.gistId&&r(x,M.gistId),Ca(async()=>{e(S)&&!e(X)&&await F()});async function F(){if(e(S)){r(Y,!0),r(T,"");try{r(ee,await $r(e(S))),e(x)&&r(U,e(ee).find(j=>j.id===e(x))||null)}catch(j){r(T,j.message||"Failed to load gists"),r(ee,[])}finally{r(Y,!1)}}}function ie(j){e(U)?.id===j.id?(r(U,null),r(x,"")):(r(U,j),r(x,j.id))}function ge(){r(X,!e(X)),r(T,""),!e(X)&&e(S)&&F()}async function Ge(){if(!e(S)){r(T,"GitHub token is required");return}const j=e(U)?.id||e(x);r(E,!0),r(T,"");try{if(j)await yr(t(),e(S),j),r(x,j),Ht.add("Character updated in Gist successfully!","success");else{const G=await _r(t(),e(S),e(y));r(x,G),Ht.add(`Character saved to Gist! ID: ${G}`,"success")}Ps({token:e(S),gistId:e(x)}),p("close")}catch(G){r(T,G.message||"Failed to save to Gist")}finally{r(E,!1)}}async function De(){const j=e(U)?.id||e(x);if(!j){r(T,"Please select a gist or enter a Gist ID");return}r(E,!0),r(T,"");try{const G=await xr(j,e(S)||void 0);pe.set(G),r(x,j),Ps({token:e(S),gistId:e(x)}),Ht.add("Character loaded from Gist successfully!","success"),p("close")}catch(G){r(T,G.message||"Failed to load from Gist")}finally{r(E,!1)}}function ve(){p("close")}Xt();var ce=Ir(),ye=l(ce),qe=l(ye),V=l(qe),A=l(V,!0);s(V);var _=a(V,2);s(qe);var H=a(qe,2),W=l(H);{var me=j=>{var G=wr(),Q=l(G,!0);s(G),L(()=>$(Q,e(T))),o(j,G)};m(W,j=>{e(T)&&j(me)})}var _e=a(W,2),Ie=l(_e),Je=l(Ie);sa(),s(Ie);var Ee=a(Ie,2);$e(Ee),s(_e);var Ae=a(_e,2);{var h=j=>{var G=Sr(),Q=l(G),ue=l(Q,!0);s(Q),s(G),L(()=>{Q.disabled=e(E),$(ue,e(X)?"üìã Show My Gists":"‚úèÔ∏è Enter Gist ID Manually")}),B("click",Q,ge),o(j,G)};m(Ae,j=>{(g()==="load"||g()==="save"&&e(S))&&j(h)})}var P=a(Ae,2);{var de=j=>{var G=Br(),Q=Ce(G);{var ue=se=>{var z=Cr(),Me=a(l(z),2);$e(Me),s(z),L(()=>Me.disabled=e(E)),Ve(Me,()=>e(x),we=>r(x,we)),o(se,z)},He=se=>{var z=$t(),Me=Ce(z);{var we=xe=>{var Z=Dr();o(xe,Z)},st=xe=>{var Z=$t(),u=Ce(Z);{var lt=O=>{var Se=Ar(),Ye=a(l(Se),2);Ct(Ye,5,()=>e(ee),jt,(gt,it)=>{var he=Lr();let Le;var Ue=l(he),ft=l(Ue),J=l(ft,!0);s(ft);var ze=a(ft,2),dt=l(ze,!0);s(ze),s(Ue);var b=a(Ue,2),N=l(b),oe=l(N);s(N);var ne=a(N,2),le=l(ne);s(ne),s(b),s(he),L(Te=>{Le=Ut(he,1,"gist-item svelte-1jb5ckg",null,Le,{selected:e(U)?.id===e(it).id}),he.disabled=e(E),$(J,(e(it),n(()=>e(it).description||"Untitled"))),$(dt,(e(it),n(()=>e(it).public?"üåê Public":"üîí Private"))),$(oe,`ID: ${e(it),n(()=>e(it).id)??""}`),$(le,`Updated: ${Te??""}`)},[()=>(e(it),n(()=>new Date(e(it).updated_at).toLocaleDateString()))]),B("click",he,()=>ie(e(it))),o(gt,he)}),s(Ye),s(Se),o(O,Se)},Oe=O=>{var Se=$t(),Ye=Ce(Se);{var gt=it=>{var he=jr();o(it,he)};m(Ye,it=>{e(S)&&it(gt)},!0)}o(O,Se)};m(u,O=>{e(ee),n(()=>e(ee).length>0)?O(lt):O(Oe,!1)},!0)}o(xe,Z)};m(Me,xe=>{e(Y)?xe(we):xe(st,!1)},!0)}o(se,z)};m(Q,se=>{e(X)||!e(S)?se(ue):se(He,!1)})}var Re=a(Q,2),je=l(Re),Be=l(je);s(je);var k=a(je,2);$e(k),s(Re),L(()=>{$(Be,`Description ${e(x)?"(optional)":""}`),k.disabled=e(E)}),Ve(k,()=>e(y),se=>r(y,se)),o(j,G)},Ze=j=>{var G=$t(),Q=Ce(G);{var ue=Re=>{var je=Rr(),Be=a(l(je),2);$e(Be),s(je),L(()=>Be.disabled=e(E)),Ve(Be,()=>e(x),k=>r(x,k)),o(Re,je)},He=Re=>{var je=$t(),Be=Ce(je);{var k=z=>{var Me=Mr();o(z,Me)},se=z=>{var Me=$t(),we=Ce(Me);{var st=Z=>{var u=Fr(),lt=a(l(u),2);Ct(lt,5,()=>e(ee),jt,(Oe,O)=>{var Se=Tr();let Ye;var gt=l(Se),it=l(gt),he=l(it,!0);s(it);var Le=a(it,2),Ue=l(Le,!0);s(Le),s(gt);var ft=a(gt,2),J=l(ft),ze=l(J);s(J);var dt=a(J,2),b=l(dt);s(dt),s(ft),s(Se),L(N=>{Ye=Ut(Se,1,"gist-item svelte-1jb5ckg",null,Ye,{selected:e(U)?.id===e(O).id}),Se.disabled=e(E),$(he,(e(O),n(()=>e(O).description||"Untitled"))),$(Ue,(e(O),n(()=>e(O).public?"üåê Public":"üîí Private"))),$(ze,`ID: ${e(O),n(()=>e(O).id)??""}`),$(b,`Updated: ${N??""}`)},[()=>(e(O),n(()=>new Date(e(O).updated_at).toLocaleDateString()))]),B("click",Se,()=>ie(e(O))),o(Oe,Se)}),s(lt),s(u),o(Z,u)},xe=Z=>{var u=$t(),lt=Ce(u);{var Oe=O=>{var Se=Pr();o(O,Se)};m(lt,O=>{e(S)&&O(Oe)},!0)}o(Z,u)};m(we,Z=>{e(ee),n(()=>e(ee).length>0)?Z(st):Z(xe,!1)},!0)}o(z,Me)};m(Be,z=>{e(Y)?z(k):z(se,!1)},!0)}o(Re,je)};m(Q,Re=>{e(X)||!e(S)?Re(ue):Re(He,!1)},!0)}o(j,G)};m(P,j=>{g()==="save"?j(de):j(Ze,!1)})}var tt=a(P,2),mt=l(tt),Dt=l(mt);{var Bt=j=>{var G=Tt();L(()=>$(G,g()==="save"?"Saving...":"Loading...")),o(j,G)},C=j=>{var G=Tt();L(()=>$(G,g()==="save"?"Save":"Load")),o(j,G)};m(Dt,j=>{e(E)?j(Bt):j(C,!1)})}s(mt);var K=a(mt,2);s(tt),s(H),s(ye),s(ce),L(()=>{$(A,g()==="save"?"Save to GitHub Gist":"Load from GitHub Gist"),$(Je,`GitHub Token ${g()==="load"?"(optional for public gists)":"(required)"} `),Ee.disabled=e(E),mt.disabled=e(E),K.disabled=e(E)}),B("click",_,ve),Ve(Ee,()=>e(S),j=>r(S,j)),B("blur",Ee,()=>{e(S)&&!e(X)&&F()}),B("click",mt,function(...j){(g()==="save"?Ge:De)?.apply(this,j)}),B("click",K,ve),B("click",ye,ks(function(j){Ma.call(this,c,j)})),B("keydown",ye,function(j){Ma.call(this,c,j)}),B("click",ce,ve),B("keydown",ce,j=>j.key==="Escape"&&ve()),o(i,ce),ea(),f()}var Ur=d('<div class="loading svelte-1ngjemu">Loading D&D data...</div>'),Nr=d("<option> </option>"),Hr=d('<select class="level-filter svelte-1ngjemu"><option>All Levels</option><option>Cantrip</option><!></select>'),Or=d('<div class="no-results svelte-1ngjemu"> </div>'),Gr=d('<div class="item-meta svelte-1ngjemu"> </div>'),qr=d('<div class="item-meta svelte-1ngjemu"> </div>'),Wr=d('<button><div class="item-name svelte-1ngjemu"> </div> <!></button>'),zr=d('<p class="higher-levels"><strong>At Higher Levels:</strong> </p>'),Kr=d('<p class="cantrip-upgrade"><strong>Cantrip Upgrade:</strong> </p>'),Vr=d('<h3 class="svelte-1ngjemu"> </h3> <p class="spell-meta svelte-1ngjemu"><!> <!></p> <p class="spell-classes"><strong>Classes:</strong> </p> <div class="spell-stats svelte-1ngjemu"><div><strong>Casting Time:</strong> </div> <div><strong>Range:</strong> </div> <div><strong>Components:</strong> <!></div> <div><strong>Duration:</strong> <!> </div></div> <p class="description svelte-1ngjemu"> </p> <!> <!>',1),Jr=d('<p class="prerequisite svelte-1ngjemu"><strong>Prerequisite:</strong> </p>'),Yr=d('<h3 class="svelte-1ngjemu"> </h3> <!> <p class="description svelte-1ngjemu"> </p> <a target="_blank" rel="noopener" class="source-link svelte-1ngjemu">View Full Details ‚Üí</a>',1),Qr=d('<div class="item-details svelte-1ngjemu"><!></div>'),Xr=d('<div class="controls svelte-1ngjemu"><div class="tabs svelte-1ngjemu"><button> </button> <button> </button></div> <div class="search-controls svelte-1ngjemu"><input type="text" placeholder="Search by name or description..." class="search-input svelte-1ngjemu"/> <!></div></div> <div class="content-container svelte-1ngjemu"><div class="items-list svelte-1ngjemu"><!></div> <!></div>',1),Zr=d('<div class="modal-backdrop svelte-1ngjemu" role="presentation"><div class="modal svelte-1ngjemu" role="dialog" aria-modal="true" tabindex="-1"><div class="modal-header svelte-1ngjemu"><h2 class="svelte-1ngjemu">Browse D&D Spells & Feats</h2> <button class="close-btn svelte-1ngjemu" aria-label="Close">&times;</button></div> <div class="modal-body svelte-1ngjemu"><!></div> <div class="modal-footer svelte-1ngjemu"><button class="btn-secondary svelte-1ngjemu">Cancel</button> <button class="btn-primary svelte-1ngjemu">Add to Character Sheet</button></div></div></div>');function eo(i,c){Zt(c,!1);const t=w(),v=w(),f=w();let p=At(c,"onClose",8),g=w("spell"),S=w(!0),x=w(""),y=w(null),E=w([]),T=w([]),X=w(null);Ca(async()=>{r(S,!0);try{r(E,await zs()),r(T,await pi())}catch(_){console.error("Failed to load data:",_)}finally{r(S,!1)}});function Y(_){r(X,_)}function ee(_){const H=_.match(/(\d+d\d+(?:\s*\+\s*\d+)?)/i);return H?H[1]:""}function U(_){const H=_.split(/\.( |$)/)[0].trim(),W=Array.from(_.matchAll(/\*\*(.*?)\*\*/g)).map(_e=>_e[1].replace(/\.$/,""));let me=H;return W.length&&(me+=" | Effects: "+W.join(", ")),me}function M(){if(e(X)){if(e(g)==="spell"){const _=e(X);pe.update(H=>{const me=[];_.range&&me.push(`Range: ${_.range}`),_.castingTime&&me.push(`Cast: ${_.castingTime}`),_.duration&&me.push(`Duration: ${_.duration}`),_.actionType==="Save"&&me.push("Saving throw spell"),_.components&&_.components.length>0&&me.push(`Components: ${_.components.join(", ")}`),_.material&&me.push(`Material: ${_.material}`);const _e=me.join(" | "),Ie=U(_.description),Je={id:crypto.randomUUID(),name:`${_.name}${_.concentration?" (C)":""}${_.ritual?" (R)":""}`,bonus:_.actionType==="Attack"?5:0,damage:ee(_.description),damageType:`${_.school} (Lvl ${_.level})`,spellRef:_.name,infoNotes:_e,generalNotes:Ie,castAtLevel:_.level};return H.attacks=[...H.attacks,Je],H})}else if(e(g)==="feat"){const _=e(X);pe.update(H=>{const W=`${_.name}${_.prerequisite?` (Req: ${_.prerequisite})`:""}
${_.description}
`;return H.features=H.features?`${H.features}
${W}`:W,H})}r(X,null),p()()}}Qe(()=>(e(y),e(E),e(x)),()=>{r(t,e(y)!==null?mi(Ts(e(E),e(x)),e(y)):Ts(e(E),e(x)))}),Qe(()=>(e(T),e(x)),()=>{r(v,gi(e(T),e(x)))}),Qe(()=>(e(g),e(t),e(v)),()=>{r(f,e(g)==="spell"?e(t):e(v))}),ma(),Xt();var F=Zr(),ie=l(F),ge=l(ie),Ge=a(l(ge),2);s(ge);var De=a(ge,2),ve=l(De);{var ce=_=>{var H=Ur();o(_,H)},ye=_=>{var H=Xr(),W=Ce(H),me=l(W),_e=l(me);let Ie;var Je=l(_e);s(_e);var Ee=a(_e,2);let Ae;var h=l(Ee);s(Ee),s(me);var P=a(me,2),de=l(P);$e(de);var Ze=a(de,2);{var tt=Q=>{var ue=Hr();L(()=>{e(y),Jt(()=>{})});var He=l(ue);He.value=(He.__value=null)??"";var Re=a(He);Re.value=Re.__value=0;var je=a(Re);Ct(je,0,()=>[1,2,3,4,5,6,7,8,9],jt,(Be,k)=>{var se=Nr(),z=l(se);s(se);var Me={};L(()=>{$(z,`Level ${k??""}`),Me!==(Me=k)&&(se.value=(se.__value=k)??"")}),o(Be,se)}),s(ue),Na(ue,()=>e(y),Be=>r(y,Be)),o(Q,ue)};m(Ze,Q=>{e(g)==="spell"&&Q(tt)})}s(P),s(W);var mt=a(W,2),Dt=l(mt),Bt=l(Dt);{var C=Q=>{var ue=Or(),He=l(ue);s(ue),L(()=>$(He,`No ${e(g)??""}s found`)),o(Q,ue)},K=Q=>{var ue=$t(),He=Ce(ue);Ct(He,1,()=>e(f),jt,(Re,je)=>{var Be=Wr();let k;var se=l(Be),z=l(se,!0);s(se);var Me=a(se,2);{var we=xe=>{const Z=yt(()=>e(je));var u=Gr(),lt=l(u);s(u),L(()=>$(lt,`Level ${I(e(Z)),n(()=>e(Z).level)??""} ‚Ä¢ ${I(e(Z)),n(()=>e(Z).school)??""}`)),o(xe,u)},st=xe=>{const Z=yt(()=>e(je));var u=$t(),lt=Ce(u);{var Oe=O=>{var Se=qr(),Ye=l(Se,!0);s(Se),L(()=>$(Ye,(I(e(Z)),n(()=>e(Z).prerequisite)))),o(O,Se)};m(lt,O=>{I(e(Z)),n(()=>e(Z).prerequisite)&&O(Oe)})}o(xe,u)};m(Me,xe=>{e(g)==="spell"?xe(we):xe(st,!1)})}s(Be),L(()=>{k=Ut(Be,1,"item-card svelte-1ngjemu",null,k,{selected:e(X)?.name===e(je).name}),$(z,(e(je),n(()=>e(je).name)))}),B("click",Be,()=>Y(e(je))),o(Re,Be)}),o(Q,ue)};m(Bt,Q=>{e(f),n(()=>e(f).length===0)?Q(C):Q(K,!1)})}s(Dt);var j=a(Dt,2);{var G=Q=>{var ue=Qr(),He=l(ue);{var Re=Be=>{const k=yt(()=>e(X));var se=Vr(),z=Ce(se),Me=l(z,!0);s(z);var we=a(z,2),st=l(we);{var xe=re=>{var q=Tt();L(()=>$(q,`${I(e(k)),n(()=>e(k).school)??""} cantrip`)),o(re,q)},Z=re=>{var q=Tt();L(()=>$(q,`Level ${I(e(k)),n(()=>e(k).level)??""} ${I(e(k)),n(()=>e(k).school)??""}`)),o(re,q)};m(st,re=>{I(e(k)),n(()=>e(k).level===0)?re(xe):re(Z,!1)})}var u=a(st,2);{var lt=re=>{var q=Tt("(ritual)");o(re,q)};m(u,re=>{I(e(k)),n(()=>e(k).ritual)&&re(lt)})}s(we);var Oe=a(we,2),O=a(l(Oe));s(Oe);var Se=a(Oe,2),Ye=l(Se),gt=a(l(Ye));s(Ye);var it=a(Ye,2),he=a(l(it));s(it);var Le=a(it,2),Ue=a(l(Le)),ft=a(Ue);{var J=re=>{var q=Tt();L(()=>$(q,`(${I(e(k)),n(()=>e(k).material)??""})`)),o(re,q)};m(ft,re=>{I(e(k)),n(()=>e(k).material)&&re(J)})}s(Le);var ze=a(Le,2),dt=a(l(ze),2);{var b=re=>{var q=Tt("Concentration,");o(re,q)};m(dt,re=>{I(e(k)),n(()=>e(k).concentration)&&re(b)})}var N=a(dt,1,!0);s(ze),s(Se);var oe=a(Se,2),ne=l(oe,!0);s(oe);var le=a(oe,2);{var Te=re=>{var q=zr(),nt=a(l(q));s(q),L(()=>$(nt,` ${I(e(k)),n(()=>e(k).higherLevelSlot)??""}`)),o(re,q)};m(le,re=>{I(e(k)),n(()=>e(k).higherLevelSlot)&&re(Te)})}var at=a(le,2);{var Fe=re=>{var q=Kr(),nt=a(l(q));s(q),L(()=>$(nt,` ${I(e(k)),n(()=>e(k).cantripUpgrade)??""}`)),o(re,q)};m(at,re=>{I(e(k)),n(()=>e(k).cantripUpgrade)&&re(Fe)})}L((re,q)=>{$(Me,(I(e(k)),n(()=>e(k).name))),$(O,` ${re??""}`),$(gt,` ${I(e(k)),n(()=>e(k).castingTime||e(k).actionType)??""}`),$(he,` ${I(e(k)),n(()=>e(k).range)??""}`),$(Ue,` ${q??""}`),$(N,(I(e(k)),n(()=>e(k).duration))),$(ne,(I(e(k)),n(()=>e(k).description)))},[()=>(I(e(k)),n(()=>e(k).classes.join(", "))),()=>(I(e(k)),n(()=>e(k).components.join(", ").toUpperCase()))]),o(Be,se)},je=Be=>{const k=yt(()=>e(X));var se=Yr(),z=Ce(se),Me=l(z,!0);s(z);var we=a(z,2);{var st=lt=>{var Oe=Jr(),O=a(l(Oe));s(Oe),L(()=>$(O,` ${I(e(k)),n(()=>e(k).prerequisite)??""}`)),o(lt,Oe)};m(we,lt=>{I(e(k)),n(()=>e(k).prerequisite)&&lt(st)})}var xe=a(we,2),Z=l(xe,!0);s(xe);var u=a(xe,2);L(()=>{$(Me,(I(e(k)),n(()=>e(k).name))),$(Z,(I(e(k)),n(()=>e(k).description))),vt(u,"href",(I(e(k)),n(()=>e(k).source)))}),o(Be,se)};m(He,Be=>{e(g)==="spell"?Be(Re):Be(je,!1)})}s(ue),o(Q,ue)};m(j,Q=>{e(X)&&Q(G)})}s(mt),L(()=>{Ie=Ut(_e,1,"tab svelte-1ngjemu",null,Ie,{active:e(g)==="spell"}),$(Je,`üìú Spells (${e(E),n(()=>e(E).length)??""})`),Ae=Ut(Ee,1,"tab svelte-1ngjemu",null,Ae,{active:e(g)==="feat"}),$(h,`‚≠ê Feats (${e(T),n(()=>e(T).length)??""})`)}),B("click",_e,()=>{r(g,"spell"),r(X,null),r(x,"")}),B("click",Ee,()=>{r(g,"feat"),r(X,null),r(x,"")}),Ve(de,()=>e(x),Q=>r(x,Q)),o(_,H)};m(ve,_=>{e(S)?_(ce):_(ye,!1)})}s(De);var qe=a(De,2),V=l(qe),A=a(V,2);s(qe),s(ie),s(F),L(()=>A.disabled=!e(X)),B("click",Ge,function(..._){p()?.apply(this,_)}),B("click",V,function(..._){p()?.apply(this,_)}),B("click",A,M),B("click",ie,ks(function(_){Ma.call(this,c,_)})),B("keydown",ie,function(_){Ma.call(this,c,_)}),B("click",F,function(..._){p()?.apply(this,_)}),B("keydown",F,_=>_.key==="Escape"&&p()()),o(i,F),ea()}var to=d('<span class="resistance-tag svelte-gdwwx1"> <button type="button" class="tag-remove svelte-gdwwx1">√ó</button></span>'),ao=d('<div class="resistance-list svelte-gdwwx1"></div>'),so=d('<p class="ability-meta svelte-gdwwx1"> <!></p>'),lo=d('<p class="ability-meta svelte-gdwwx1">Requires Reaction</p>'),io=d('<div class="ability-card svelte-gdwwx1"><div class="ability-header svelte-gdwwx1"><strong class="svelte-gdwwx1"> </strong> <button type="button" class="ability-remove svelte-gdwwx1">√ó</button></div> <p class="ability-description svelte-gdwwx1"> </p> <!></div>'),no=d('<div class="abilities-list svelte-gdwwx1"></div>'),ro=d(`<div class="modal-backdrop svelte-gdwwx1" role="presentation"><div class="modal-content svelte-gdwwx1" role="dialog" aria-modal="true" aria-labelledby="modal-title"><div class="modal-header svelte-gdwwx1"><h3 id="modal-title" class="svelte-gdwwx1">Add Custom Condition</h3> <button class="btn-close svelte-gdwwx1" aria-label="Close">√ó</button></div> <div class="modal-body svelte-gdwwx1"><div class="form-group svelte-gdwwx1"><label for="conditionName" class="svelte-gdwwx1">Condition Name*</label> <input type="text" id="conditionName" placeholder="e.g., Cazna's Mark" class="svelte-gdwwx1"/></div> <div class="form-group svelte-gdwwx1"><label for="description" class="svelte-gdwwx1">Description</label> <textarea id="description" placeholder="Describe the condition..." rows="3" class="svelte-gdwwx1"></textarea></div> <div class="form-row svelte-gdwwx1"><div class="form-group svelte-gdwwx1"><label for="attackBonus" class="svelte-gdwwx1">Attack Bonus</label> <input type="text" id="attackBonus" placeholder="0 or 1d4" class="svelte-gdwwx1"/></div> <div class="form-group svelte-gdwwx1"><label for="damageBonus" class="svelte-gdwwx1">Damage Bonus</label> <input type="text" id="damageBonus" placeholder="0 or 1d6" class="svelte-gdwwx1"/></div> <div class="form-group svelte-gdwwx1"><label for="acBonus" class="svelte-gdwwx1">AC Bonus</label> <input type="number" id="acBonus" placeholder="0" class="svelte-gdwwx1"/></div></div> <div class="form-group svelte-gdwwx1"><label for="darkvision" class="svelte-gdwwx1">Darkvision (feet)</label> <input type="number" id="darkvision" placeholder="0" min="0" step="30" class="svelte-gdwwx1"/> <small class="help-text svelte-gdwwx1">Grant or extend darkvision (e.g., 60 for 60 feet)</small></div> <div class="form-group svelte-gdwwx1"><label class="svelte-gdwwx1">Damage Resistances</label> <div class="resistance-input-group svelte-gdwwx1"><input type="text" placeholder="e.g., cold, fire, poison" class="svelte-gdwwx1"/> <button type="button" class="btn-add svelte-gdwwx1">Add</button></div> <!></div> <div class="form-group svelte-gdwwx1"><label class="svelte-gdwwx1">Special Abilities</label> <div class="ability-form svelte-gdwwx1"><input type="text" placeholder="Ability name (e.g., Flicker of Deceit)" class="ability-name-input svelte-gdwwx1"/> <textarea placeholder="Ability description..." rows="2" class="ability-desc-input svelte-gdwwx1"></textarea> <div class="ability-options svelte-gdwwx1"><div class="ability-option svelte-gdwwx1"><label for="abilityUses" class="svelte-gdwwx1">Uses per rest</label> <input type="number" id="abilityUses" min="0" class="svelte-gdwwx1"/></div> <div class="ability-option svelte-gdwwx1"><label for="restType" class="svelte-gdwwx1">Rest type</label> <select id="restType" class="svelte-gdwwx1"><option>Short</option><option>Long</option></select></div> <div class="ability-option svelte-gdwwx1"><label class="svelte-gdwwx1"><input type="checkbox" class="svelte-gdwwx1"/> Requires Reaction</label></div></div> <button type="button" class="btn-add svelte-gdwwx1">Add Ability</button></div> <!></div></div> <div class="modal-footer svelte-gdwwx1"><button class="btn btn-secondary svelte-gdwwx1">Cancel</button> <button class="btn btn-primary svelte-gdwwx1">Add Condition</button></div></div></div>`);function oo(i,c){Zt(c,!1);let t=At(c,"show",8,!1),v=At(c,"onSave",8),f=At(c,"onCancel",8),p=w(""),g=w(""),S=w(0),x=w(0),y=w(0),E=w(0),T=w([]),X=w(""),Y=w([]),ee=w(""),U=w(""),M=w(0),F=w("short"),ie=w(!1);function ge(){r(p,""),r(g,""),r(S,0),r(x,0),r(y,0),r(E,0),r(T,[]),r(X,""),r(Y,[]),r(ee,""),r(U,""),r(M,0),r(F,"short"),r(ie,!1)}function Ge(){e(X).trim()&&(r(T,[...e(T),e(X).trim()]),r(X,""))}function De(W){r(T,e(T).filter((me,_e)=>_e!==W))}function ve(){if(e(ee).trim()&&e(U).trim()){const W={name:e(ee).trim(),description:e(U).trim(),requiresReaction:e(ie)};e(M)>0&&(W.usesPerRest=e(M),W.currentUses=e(M),W.restType=e(F)),r(Y,[...e(Y),W]),r(ee,""),r(U,""),r(M,0),r(F,"short"),r(ie,!1)}}function ce(W){r(Y,e(Y).filter((me,_e)=>_e!==W))}function ye(){if(!e(p).trim()){alert("Please enter a condition name");return}const W={name:e(p).trim(),description:e(g).trim()||"Custom condition",attackBonus:e(S)||0,damageBonus:e(x)||0,target:"self"};e(y)!==0&&(W.acBonus=e(y)),e(E)>0&&(W.darkvision=e(E)),e(T).length>0&&(W.resistances=e(T)),e(Y).length>0&&(W.abilities=e(Y)),v()(W),ge()}function qe(){ge(),f()()}function V(W){W.target===W.currentTarget&&qe()}Xt();var A=$t(),_=Ce(A);{var H=W=>{var me=ro(),_e=l(me),Ie=l(_e),Je=a(l(Ie),2);s(Ie);var Ee=a(Ie,2),Ae=l(Ee),h=a(l(Ae),2);$e(h),s(Ae);var P=a(Ae,2),de=a(l(P),2);ja(de),s(P);var Ze=a(P,2),tt=l(Ze),mt=a(l(tt),2);$e(mt),s(tt);var Dt=a(tt,2),Bt=a(l(Dt),2);$e(Bt),s(Dt);var C=a(Dt,2),K=a(l(C),2);$e(K),s(C),s(Ze);var j=a(Ze,2),G=a(l(j),2);$e(G),sa(2),s(j);var Q=a(j,2),ue=a(l(Q),2),He=l(ue);$e(He);var Re=a(He,2);s(ue);var je=a(ue,2);{var Be=J=>{var ze=ao();Ct(ze,5,()=>e(T),jt,(dt,b,N)=>{var oe=to(),ne=l(oe),le=a(ne);s(oe),L(()=>{$(ne,`${e(b)??""} `),vt(le,"aria-label",`Remove ${e(b)??""}`)}),B("click",le,()=>De(N)),o(dt,oe)}),s(ze),o(J,ze)};m(je,J=>{e(T),n(()=>e(T).length>0)&&J(Be)})}s(Q);var k=a(Q,2),se=a(l(k),2),z=l(se);$e(z);var Me=a(z,2);ja(Me);var we=a(Me,2),st=l(we),xe=a(l(st),2);$e(xe),s(st);var Z=a(st,2),u=a(l(Z),2);L(()=>{e(F),Jt(()=>{})});var lt=l(u);lt.value=lt.__value="short";var Oe=a(lt);Oe.value=Oe.__value="long",s(u),s(Z);var O=a(Z,2),Se=l(O),Ye=l(Se);$e(Ye),sa(),s(Se),s(O),s(we);var gt=a(we,2);s(se);var it=a(se,2);{var he=J=>{var ze=no();Ct(ze,5,()=>e(Y),jt,(dt,b,N)=>{var oe=io(),ne=l(oe),le=l(ne),Te=l(le,!0);s(le);var at=a(le,2);s(ne);var Fe=a(ne,2),re=l(Fe,!0);s(Fe);var q=a(Fe,2);{var nt=te=>{var fe=so(),Xe=l(fe),kt=a(Xe);{var ot=ae=>{var qt=Tt("‚Ä¢ Requires Reaction");o(ae,qt)};m(kt,ae=>{e(b),n(()=>e(b).requiresReaction)&&ae(ot)})}s(fe),L(()=>$(Xe,`${e(b),n(()=>e(b).usesPerRest)??""} use${e(b),n(()=>e(b).usesPerRest>1?"s":"")??""} per ${e(b),n(()=>e(b).restType)??""}
                      rest `)),o(te,fe)},be=te=>{var fe=$t(),Xe=Ce(fe);{var kt=ot=>{var ae=lo();o(ot,ae)};m(Xe,ot=>{e(b),n(()=>e(b).requiresReaction)&&ot(kt)},!0)}o(te,fe)};m(q,te=>{e(b),n(()=>e(b).usesPerRest)?te(nt):te(be,!1)})}s(oe),L(()=>{$(Te,(e(b),n(()=>e(b).name))),vt(at,"aria-label",`Remove ${e(b),n(()=>e(b).name)??""}`),$(re,(e(b),n(()=>e(b).description)))}),B("click",at,()=>ce(N)),o(dt,oe)}),s(ze),o(J,ze)};m(it,J=>{e(Y),n(()=>e(Y).length>0)&&J(he)})}s(k),s(Ee);var Le=a(Ee,2),Ue=l(Le),ft=a(Ue,2);s(Le),s(_e),s(me),B("click",Je,qe),Ve(h,()=>e(p),J=>r(p,J)),Ve(de,()=>e(g),J=>r(g,J)),Ve(mt,()=>e(S),J=>r(S,J)),Ve(Bt,()=>e(x),J=>r(x,J)),Ve(K,()=>e(y),J=>r(y,J)),Ve(G,()=>e(E),J=>r(E,J)),Ve(He,()=>e(X),J=>r(X,J)),B("keydown",He,J=>J.key==="Enter"&&Ge()),B("click",Re,Ge),Ve(z,()=>e(ee),J=>r(ee,J)),Ve(Me,()=>e(U),J=>r(U,J)),Ve(xe,()=>e(M),J=>r(M,J)),Na(u,()=>e(F),J=>r(F,J)),wa(Ye,()=>e(ie),J=>r(ie,J)),B("click",gt,ve),B("click",Ue,qe),B("click",ft,ye),B("click",me,V),o(W,me)};m(_,W=>{t()&&W(H)})}o(i,A),ea()}var co=d("<option></option>"),vo=d("<button> </button>"),uo=d('<div class="input-field svelte-uvfntf"><label class="svelte-uvfntf"><input type="checkbox"/> Uncanny Dodge (When an attacker that you can see hits you with an attack roll, you can take a Reaction to halve the attack‚Äôs damage against you.)</label></div>'),fo=d('<div class="adjustment-msg svelte-uvfntf"> </div>'),po=d('<div class="calculation-result svelte-uvfntf"><div class="result-header svelte-uvfntf"><h4 class="svelte-uvfntf">Damage Calculation</h4></div> <div class="result-content svelte-uvfntf"><div class="damage-breakdown svelte-uvfntf"><div class="damage-row svelte-uvfntf"><span class="label svelte-uvfntf">Original Damage:</span> <span class="value svelte-uvfntf"> </span></div> <div class="adjustments svelte-uvfntf"></div> <div class="damage-row final svelte-uvfntf"><span class="label svelte-uvfntf">Final Damage:</span> <span class="value damage-value svelte-uvfntf"> </span></div></div></div> <div class="result-actions svelte-uvfntf"><button class="btn btn-primary apply-btn use-enabled svelte-uvfntf">Apply Damage</button> <button class="btn btn-secondary cancel-btn use-enabled svelte-uvfntf">Cancel</button></div></div>'),mo=d('<div class="damage-form svelte-uvfntf"><div class="input-group svelte-uvfntf"><div class="input-field svelte-uvfntf"><label for="damageAmount" class="svelte-uvfntf">Damage Amount</label> <input type="number" id="damageAmount" min="0" placeholder="0" class="damage-input-field use-enabled svelte-uvfntf"/></div> <div class="input-field svelte-uvfntf"><label for="damageType" class="svelte-uvfntf">Damage Type</label> <input type="text" id="damageType" list="damageTypes" placeholder="e.g., fire, cold" class="damage-input-field use-enabled svelte-uvfntf"/> <datalist id="damageTypes"></datalist></div></div> <div class="quick-types svelte-uvfntf"><span class="quick-types-label svelte-uvfntf">Quick Select:</span> <!></div> <!> <!></div>'),go=d("<section><!> <!></section>");function bo(i,c){Zt(c,!1);const t=()=>_t(pe,"$character",p),v=()=>_t(xa,"$searchFilter",p),f=()=>_t(ia,"$collapsedStates",p),[p,g]=da(),S=w(),x=w();ka();let y=w(0),E=w(""),T=w(0),X=w([]),Y=w(!1);const ee=["slashing","piercing","bludgeoning","fire","cold","lightning","thunder","acid","poison","necrotic","radiant","psychic","force"],U={slashing:"üó°Ô∏è",piercing:"üèπ",bludgeoning:"üî®",fire:"üî•",cold:"‚ùÑÔ∏è",lightning:"‚ö°",thunder:"üí•",acid:"üß™",poison:"‚ò†Ô∏è",necrotic:"üíÄ",radiant:"‚ú®",psychic:"üß†",force:"üå™Ô∏è"};function M(){pe.update(ce=>Kl(ce,e(T))),Ht.add(`Applied ${e(T)} damage to character (${e(E)})`,"info"),r(y,0),r(E,""),r(T,0),r(X,[])}function F(){r(y,0),r(E,""),r(T,0),r(X,[])}Qe(()=>t(),()=>{r(S,t()?.features?.toLowerCase?.().includes("uncanny dodge"))}),Qe(()=>(e(y),e(E),t(),e(Y)),()=>{if(e(y)>=0&&e(E).trim()){const ce=zl(e(y),e(E),t());let ye=ce.finalDamage,qe=[...ce.adjustments];e(Y)&&(ye=Math.floor(ye/2),qe.push("Uncanny Dodge: Halved final damage")),r(T,ye),r(X,qe)}else r(T,0),r(X,[])}),Qe(()=>v(),()=>{r(x,!v()||"damage".includes(v().toLowerCase())||"resistance".includes(v().toLowerCase())||"immune".includes(v().toLowerCase()))}),ma(),Xt();var ie=go();let ge;var Ge=l(ie);{let ce=yt(()=>(f(),n(()=>f().damageInput?"Expand":"Collapse")));Da(Ge,{title:"Apply Damage",get collapsed(){return f(),n(()=>f().damageInput)},get ariaLabel(){return e(ce)},onToggle:()=>ia.update(ye=>({...ye,damageInput:!ye.damageInput}))})}var De=a(Ge,2);{var ve=ce=>{var ye=mo(),qe=l(ye),V=l(qe),A=a(l(V),2);$e(A),s(V);var _=a(V,2),H=a(l(_),2);$e(H);var W=a(H,2);Ct(W,5,()=>ee,jt,(h,P)=>{var de=co(),Ze={};L(()=>{Ze!==(Ze=e(P))&&(de.value=(de.__value=e(P))??"")}),o(h,de)}),s(W),s(_),s(qe);var me=a(qe,2),_e=a(l(me),2);Ct(_e,1,()=>ee,jt,(h,P)=>{var de=vo();let Ze;var tt=l(de);s(de),L(()=>{Ze=Ut(de,1,"quick-type-btn use-enabled svelte-uvfntf",null,Ze,{active:e(E)===e(P)}),$(tt,`${e(P),n(()=>U[e(P)])??""} ${e(P)??""}`)}),B("click",de,()=>r(E,e(P))),o(h,de)}),s(me);var Ie=a(me,2);{var Je=h=>{var P=uo(),de=l(P),Ze=l(de);$e(Ze),sa(),s(de),s(P),wa(Ze,()=>e(Y),tt=>r(Y,tt)),o(h,P)};m(Ie,h=>{e(S)&&h(Je)})}var Ee=a(Ie,2);{var Ae=h=>{var P=po(),de=a(l(P),2),Ze=l(de),tt=l(Ze),mt=a(l(tt),2),Dt=l(mt);s(mt),s(tt);var Bt=a(tt,2);Ct(Bt,5,()=>e(X),jt,(He,Re)=>{var je=fo(),Be=l(je,!0);s(je),L(()=>$(Be,e(Re))),o(He,je)}),s(Bt);var C=a(Bt,2),K=a(l(C),2),j=l(K,!0);s(K),s(C),s(Ze),s(de);var G=a(de,2),Q=l(G),ue=a(Q,2);s(G),s(P),L(()=>{$(Dt,`${e(y)??""} ${e(E),n(()=>U[e(E)]||"")??""} ${e(E)??""}`),$(j,e(T))}),B("click",Q,M),B("click",ue,F),o(h,P)};m(Ee,h=>{e(y),e(E),n(()=>e(y)>=0&&e(E).trim())&&h(Ae)})}s(ye),Ve(A,()=>e(y),h=>r(y,h)),Ve(H,()=>e(E),h=>r(E,h)),o(ce,ye)};m(De,ce=>{f(),n(()=>!f().damageInput)&&ce(ve)})}s(ie),L(()=>ge=Ut(ie,1,"damage-input svelte-uvfntf",null,ge,{hidden:!e(x)})),o(i,ie),ea(),g()}var ho=d('<link rel="icon" type="image/png" href="favicon4.png"/> <meta name="viewport" content="width=device-width, initial-scale=1"/>',1),_o=d('<span class="character-name svelte-1uha8ag"> </span>'),yo=d("<span> </span>"),xo=d('<div class="spell-slots-header svelte-1uha8ag"></div>'),ko=d("<span> </span><br/>",1),$o=d("<span> </span><br/>",1),wo=d("<span> </span><br/>",1),So=d("<span> </span><br/>",1),Co=d("<span> </span><br/>",1),Do=d("<span> </span><br/>",1),Lo=d("<br/><em> <!>)</em>",1),Ao=d("<br/><em>(requires reaction)</em>",1),jo=d('<div class="ability-detail"><strong> </strong> <!></div>'),Bo=d('<div class="abilities-section"><strong>Abilities:</strong><br/> <!></div>'),Ro=d('<span class="effect-tooltip"><strong> </strong><br/> <br/> <!> <!> <!> <!> <!> <!> <!></span>'),Mo=d('<button class="effect-remove-btn svelte-1uha8ag">√ó</button>'),To=d('<span class="effect-badge svelte-1uha8ag" tabindex="0"> <!> <!></span>'),Fo=d(`<div class="active-effects-header svelte-1uha8ag"></div> <style>.effect-badge {
              position: relative;
            }
            .effect-tooltip {
              position: absolute;
              top: 120%;
              left: 50%;
              transform: translateX(-50%);
              background: #fff;
              color: #222;
              border: 1px solid #a5b4fc;
              border-radius: 6px;
              padding: 8px 12px;
              font-size: 0.95em;
              box-shadow: 0 2px 8px rgba(0, 0, 0, 0.12);
              z-index: 10;
              min-width: 180px;
              max-width: 300px;
              white-space: normal;
              pointer-events: none;
              opacity: 1;
              transition: opacity 0.15s;
            }

            .abilities-section {
              margin-top: 8px;
              padding-top: 8px;
              border-top: 1px solid #e5e7eb;
            }

            .ability-detail {
              margin-top: 6px;
              padding: 4px;
              background: #f9fafb;
              border-radius: 4px;
              font-size: 0.9em;
            }

            .ability-detail strong {
              color: #6366f1;
            }

            .ability-detail em {
              font-size: 0.85em;
              color: #6b7280;
            }</style>`,1),Po=d('<div class="rest-menu svelte-1uha8ag"><button class="rest-option svelte-1uha8ag">‚òï Short Rest</button> <button class="rest-option svelte-1uha8ag">üõèÔ∏è Long Rest</button></div>'),Io=d('<div class="container svelte-1uha8ag"><header class="svelte-1uha8ag"><div class="header-top svelte-1uha8ag"><div class="header-title svelte-1uha8ag"><div class="title-row svelte-1uha8ag"><h1 class="svelte-1uha8ag">D&D Character Sheet</h1> <!></div> <!> <!></div> <div class="header-right svelte-1uha8ag"><div class="header-controls svelte-1uha8ag"><button class="btn btn-secondary use-enabled"><span class="btn-icon svelte-1uha8ag">üé≤</span><span class="btn-text svelte-1uha8ag">Roll Dice</span></button> <div class="rest-button-container svelte-1uha8ag"><button class="btn btn-secondary use-enabled"><span class="btn-icon svelte-1uha8ag">üò¥</span><span class="btn-text svelte-1uha8ag">Rest</span></button> <!></div> <button class="btn btn-secondary use-enabled" title="Add custom condition with effects"><span class="btn-icon svelte-1uha8ag">‚ú®</span><span class="btn-text svelte-1uha8ag">Add Condition</span></button> <div class="mode-toggle"><button><span class="btn-icon svelte-1uha8ag"> </span><span class="btn-text svelte-1uha8ag"> </span></button> <button class="btn btn-mode svelte-1uha8ag" title="Toggle dark mode"><span class="btn-icon svelte-1uha8ag"> </span> <span class="btn-text svelte-1uha8ag"> </span></button></div></div> <div class="header-search svelte-1uha8ag"><input type="text" placeholder="üîç Search..." class="search-input use-enabled svelte-1uha8ag"/></div></div></div> <div class="header-actions svelte-1uha8ag"><button class="btn btn-mode svelte-1uha8ag">üìö Browse Spells & Feats</button> <button class="btn btn-secondary">Save to Gist</button> <button class="btn btn-secondary">Load from Gist</button> <button class="btn btn-secondary">Export JSON</button> <button class="btn btn-secondary">Import JSON</button> <input type="file" accept=".json" style="display: none;"/></div></header> <main class="svelte-1uha8ag"><!> <!> <!> <!> <!> <!> <!> <!></main></div> <!> <!> <!> <!> <!>',1);function zo(i,c){Zt(c,!1);const t=()=>_t(pe,"$character",p),v=()=>_t(Sa,"$isEditMode",p),f=()=>_t(xa,"$searchFilter",p),[p,g]=da();let S=w(!1);function x(D){r(S,D),D?document.body.classList.add("dark-mode"):document.body.classList.remove("dark-mode"),localStorage.setItem("dnd-dark-mode",D?"true":"false")}function y(){x(!e(S))}Ca(()=>{const D=localStorage.getItem("dnd-dark-mode");x(D==="true")});function E(){const D=[],ke=t().classFeatures.spellSlotsByLevel||{};for(let et=1;et<=9;et++){const We=ke[et];if(We&&We.length>0){const R=We.length,ut=We.filter(rt=>rt).length;D.push({level:et,available:R-ut,total:R})}}return D}let T=w(!1),X=w(!1),Y=w(!1),ee=w(!1),U=w("save"),M=w(void 0),F=w(""),ie=w(""),ge=w(""),Ge=w(!1),De=w([]),ve=w([]),ce=w("other"),ye=w(),qe=!1,V=1,A=w(!1),_=w(null);function H(D){r(_,D)}function W(){r(_,null)}function me(D){r(_,e(_)===D?null:D)}function _e(D){pe.update(ke=>(ke.activeStates||(ke.activeStates=[]),ke.activeStates=[...ke.activeStates,D],ke)),r(ee,!1),Ht.add(`Added condition: ${D.name}`,"success")}function Ie(){r(ee,!1)}function Je(){const D=[];pe.update(R=>{const ut=R.hitDice.current;R.hitDice.current=Math.min(R.hitDice.max,R.hitDice.current+Math.max(1,Math.floor(R.hitDice.max/2)));const rt=R.hitDice.current-ut;if(rt>0&&D.push(`${rt} hit ${rt===1?"die":"dice"}`),R.class){const wt=Ta(R.class,R.level,R.subclass);R.classFeatures.features||(R.classFeatures.features={}),wt.forEach(Pe=>{if(Pe.resetOn==="short"){const ct=typeof Pe.name=="function"?Pe.name(R.level):Pe.name,bt=ct.replace(/\s+/g,"");if(Pe.type==="uses"){const Pt=typeof Pe.maxUses=="function"?Pe.maxUses(R.level):Pe.maxUses;R.classFeatures.features[bt]=Array(Pt).fill(!1),D.push(ct)}else if(Pe.type==="pool"){const Pt=typeof Pe.maxPool=="function"?Pe.maxPool(R.level):Pe.maxPool;Pt!==void 0&&(R.classFeatures.features[bt]=Pt,D.push(ct))}}})}return R.activeStates&&R.activeStates.forEach(wt=>{wt.abilities&&wt.abilities.forEach(Pe=>{if(Pe.restType==="short"&&Pe.usesPerRest){const ct=Pe.usesPerRest-(Pe.currentUses||0)>0;Pe.currentUses=Pe.usesPerRest,ct&&D.push(`${wt.name}: ${Pe.name}`)}})}),R}),Cs("short"),Ds(t().race,t().level).some(R=>R.restType==="short"&&R.usesPerRest)&&D.push("racial traits"),r(A,!1);const We=D.length>0?`Short rest taken! Restored: ${D.join(", ")}`:"Short rest taken!";Ht.add(We,"success")}function Ee(){const D=[];pe.update(R=>{const ut=R.maxHP-R.currentHP;ut>0&&D.push(`${ut} HP`),R.currentHP=R.maxHP,R.tempHP=0;const rt=R.hitDice.max-R.hitDice.current;rt>0&&D.push(`${rt} hit ${rt===1?"die":"dice"}`),R.hitDice.current=R.hitDice.max;let wt=0;if(R.classFeatures.spellSlotsByLevel&&Object.keys(R.classFeatures.spellSlotsByLevel).forEach(Pe=>{const ct=R.classFeatures.spellSlotsByLevel[parseInt(Pe)];if(ct){const bt=ct.filter(Pt=>Pt).length;wt+=bt,R.classFeatures.spellSlotsByLevel[parseInt(Pe)]=Array(ct.length).fill(!1)}}),wt>0&&D.push(`${wt} spell ${wt===1?"slot":"slots"}`),R.class){const Pe=Ta(R.class,R.level,R.subclass);R.classFeatures.features||(R.classFeatures.features={});let ct=!1;Pe.forEach(bt=>{const Ft=(typeof bt.name=="function"?bt.name(R.level):bt.name).replace(/\s+/g,"");if(!(bt.type==="info"||bt.type==="channelDivinity")){if(bt.type==="uses"){const pt=typeof bt.maxUses=="function"?bt.maxUses(R.level):bt.maxUses;R.classFeatures.features[Ft]=Array(pt).fill(!1),ct=!0}else if(bt.type==="pool"){const pt=typeof bt.maxPool=="function"?bt.maxPool(R.level):bt.maxPool;pt!==void 0&&(R.classFeatures.features[Ft]=pt,ct=!0)}}}),ct&&D.push("all class features")}if(R.activeStates){let Pe=!1;R.activeStates.forEach(ct=>{ct.abilities&&ct.abilities.forEach(bt=>{if(bt.usesPerRest){const Pt=(bt.currentUses||0)<bt.usesPerRest;bt.currentUses=bt.usesPerRest,Pt&&(Pe=!0)}})}),Pe&&D.push("condition abilities")}return R}),Cs("long"),Ds(t().race,t().level).some(R=>R.usesPerRest)&&D.push("racial traits"),r(A,!1);const We=D.length>0?`Long rest taken! Restored: ${D.join(", ")}`:"Long rest taken! Fully rested.";Ht.add(We,"success")}function Ae(D){r(F,""),r(ie,""),r(ge,""),r(Ge,!1),r(De,[]),r(ve,[]),r(ce,"other"),qe=!1,typeof D=="string"?r(F,D):(r(F,D.notation),r(ie,D.damageNotation||""),r(ge,D.attackName||""),r(Ge,!!D.applyHalfDamage),r(De,D.bonusBreakdown||[]),r(ve,D.damageBreakdown||[]),r(ce,D.rollType||"other")),r(T,!0)}function h(D){const{notation:ke,count:et,bonusBreakdown:We}=D.detail;r(F,""),qe=!0,V=et||1,setTimeout(()=>{r(F,ke),r(ie,""),r(ge,"Hit Die"),r(De,We||[]),r(ce,"other")},0),r(T,!0)}function P(D){const{notation:ke,bonusBreakdown:et}=D.detail;r(F,""),setTimeout(()=>{r(F,ke),r(ie,""),r(ge,"Initiative"),r(De,et||[]),r(ce,"check")},0),r(T,!0)}function de(){if(r(T,!1),qe&&e(ye)){const D=e(ye).getLastRollTotal();if(D!==null){const ke=Math.max(1,D);pe.update(et=>(et.hitDice.current=Math.max(0,et.hitDice.current-V),et.currentHP=Math.min(et.maxHP,et.currentHP+ke),et))}qe=!1}}function Ze(){Sa.update(D=>!D)}function tt(D){D.target.closest(".rest-button-container")||r(A,!1)}Ca(()=>{const D=Sa.subscribe(ke=>{ke?document.body.classList.remove("use-mode"):document.body.classList.add("use-mode")});return document.addEventListener("click",tt),()=>{D(),document.removeEventListener("click",tt)}});function mt(){hl(t())}function Dt(){e(M)?.click()}async function Bt(D){const et=D.target.files?.[0];if(et)try{const We=await _l(et);pe.set(We),alert("Character imported successfully!")}catch{alert("Failed to import character file")}}Xt();var C=Io();gl("1uha8ag",D=>{var ke=ho();sa(2),Us(()=>{ul.title="D&D Character Sheet"}),o(D,ke)});var K=Ce(C),j=l(K),G=l(j),Q=l(G),ue=l(Q),He=a(l(ue),2);{var Re=D=>{var ke=_o(),et=l(ke);s(ke),L(()=>$(et,`${t().name??""} (${t().level??""})`)),o(D,ke)};m(He,D=>{t().name&&D(Re)})}s(ue);var je=a(ue,2);{var Be=D=>{var ke=xo();Ct(ke,5,E,jt,(et,We)=>{var R=yo();let ut;var rt=l(R);s(R),L(()=>{ut=Ut(R,1,"slot-badge svelte-1uha8ag",null,ut,{depleted:e(We).available===0}),$(rt,`Lv${e(We).level??""}: ${e(We).available??""}/${e(We).total??""}`)}),o(et,R)}),s(ke),o(D,ke)};m(je,D=>{E().length>0&&D(Be)})}var k=a(je,2);{var se=D=>{var ke=Fo(),et=Ce(ke);Ct(et,5,()=>t().activeStates,jt,(We,R,ut)=>{var rt=To(),wt=l(rt),Pe=a(wt);{var ct=Ft=>{var pt=Ro(),Ke=l(pt),Rt=l(Ke,!0);s(Ke);var Yt=a(Ke,2),Wt=a(Yt,3);{var ua=ht=>{var St=ko(),Mt=Ce(St),It=l(Mt);s(Mt),sa(),L(()=>$(It,`Attack Bonus: ${typeof e(R).attackBonus=="number"&&e(R).attackBonus>0?"+":""}${e(R).attackBonus??""}`)),o(ht,St)};m(Wt,ht=>{e(R).attackBonus&&ht(ua)})}var ca=a(Wt,2);{var fa=ht=>{var St=$o(),Mt=Ce(St),It=l(Mt);s(Mt),sa(),L(()=>$(It,`Damage Bonus: ${typeof e(R).damageBonus=="number"&&e(R).damageBonus>0?"+":""}${e(R).damageBonus??""}`)),o(ht,St)};m(ca,ht=>{e(R).damageBonus&&ht(fa)})}var zt=a(ca,2);{var la=ht=>{var St=wo(),Mt=Ce(St),It=l(Mt);s(Mt),sa(),L(()=>$(It,`AC Bonus: ${e(R).acBonus>0?"+":""}${e(R).acBonus??""}`)),o(ht,St)};m(zt,ht=>{e(R).acBonus&&ht(la)})}var Kt=a(zt,2);{var Nt=ht=>{var St=So(),Mt=Ce(St),It=l(Mt);s(Mt),sa(),L(()=>$(It,`Darkvision: ${e(R).darkvision??""} feet`)),o(ht,St)};m(Kt,ht=>{e(R).darkvision&&ht(Nt)})}var ra=a(Kt,2);{var ga=ht=>{var St=Co(),Mt=Ce(St),It=l(Mt);s(Mt),sa(),L(Et=>$(It,`Resistances: ${Et??""}`),[()=>e(R).resistances.join(", ")]),o(ht,St)};m(ra,ht=>{e(R).resistances&&e(R).resistances.length>0&&ht(ga)})}var ba=a(ra,2);{var Vt=ht=>{var St=Do(),Mt=Ce(St),It=l(Mt);s(Mt),sa(),L(Et=>$(It,`Immunities: ${Et??""}`),[()=>e(R).immunities.join(", ")]),o(ht,St)};m(ba,ht=>{e(R).immunities&&e(R).immunities.length>0&&ht(Vt)})}var oa=a(ba,2);{var Qt=ht=>{var St=Bo(),Mt=a(l(St),3);Ct(Mt,1,()=>e(R).abilities,jt,(It,Et)=>{var Lt=jo(),aa=l(Lt),Ba=l(aa);s(aa);var Oa=a(aa),as=a(Oa);{var ss=pa=>{var La=Lo(),Ga=a(Ce(La)),qa=l(Ga),Fa=a(qa);{var ls=is=>{var Ks=Tt(", requires reaction");o(is,Ks)};m(Fa,is=>{e(Et).requiresReaction&&is(ls)})}sa(),s(Ga),L(()=>$(qa,`(${(e(Et).currentUses||0)??""}/${e(Et).usesPerRest??""} uses per ${e(Et).restType??""}
                                rest`)),o(pa,La)},ya=pa=>{var La=$t(),Ga=Ce(La);{var qa=Fa=>{var ls=Ao();sa(),o(Fa,ls)};m(Ga,Fa=>{e(Et).requiresReaction&&Fa(qa)},!0)}o(pa,La)};m(as,pa=>{e(Et).usesPerRest?pa(ss):pa(ya,!1)})}s(Lt),L(()=>{$(Ba,`${e(Et).name??""}:`),$(Oa,` ${e(Et).description??""} `)}),o(It,Lt)}),s(St),o(ht,St)};m(oa,ht=>{e(R).abilities&&e(R).abilities.length>0&&ht(Qt)})}s(pt),L(()=>{$(Rt,e(R).name),$(Yt,` ${e(R).description??""}`)}),o(Ft,pt)};m(Pe,Ft=>{e(_)===ut&&Ft(ct)})}var bt=a(Pe,2);{var Pt=Ft=>{var pt=Mo();L(()=>vt(pt,"title",`End ${e(R).name??""}`)),B("click",pt,()=>{pe.update(Ke=>{if(Ke.activeStates){const Rt=Ke.activeStates[ut];Rt?.hpBonus&&Rt.target!=="other"&&(Ke.maxHP-=Rt.hpBonus,Ke.currentHP=Math.max(1,Math.min(Ke.currentHP-Rt.hpBonus,Ke.maxHP))),Ke.activeStates=Ke.activeStates.filter((Yt,Wt)=>Wt!==ut)}return Ke})}),o(Ft,pt)};m(bt,Ft=>{v()||Ft(Pt)})}s(rt),L(()=>{vt(rt,"aria-label",e(R).name),$(wt,`‚ú® ${e(R).name??""} `)}),B("mouseenter",rt,()=>H(ut)),B("mouseleave",rt,W),B("focus",rt,()=>H(ut)),B("blur",rt,W),B("click",rt,()=>me(ut)),o(We,rt)}),s(et),sa(2),o(D,ke)};m(k,D=>{t().activeStates&&t().activeStates.length>0&&D(se)})}s(Q);var z=a(Q,2),Me=l(z),we=l(Me),st=a(we,2),xe=l(st),Z=a(xe,2);{var u=D=>{var ke=Po(),et=l(ke),We=a(et,2);s(ke),B("click",et,Je),B("click",We,Ee),o(D,ke)};m(Z,D=>{e(A)&&D(u)})}s(st);var lt=a(st,2),Oe=a(lt,2),O=l(Oe);let Se;var Ye=l(O),gt=l(Ye,!0);s(Ye);var it=a(Ye),he=l(it,!0);s(it),s(O);var Le=a(O,2),Ue=l(Le),ft=l(Ue,!0);s(Ue);var J=a(Ue,2),ze=l(J,!0);s(J),s(Le),s(Oe),s(Me);var dt=a(Me,2),b=l(dt);$e(b),s(dt),s(z),s(G);var N=a(G,2),oe=l(N),ne=a(oe,2),le=a(ne,2),Te=a(le,2),at=a(Te,2),Fe=a(at,2);Ua(Fe,D=>r(M,D),()=>e(M)),s(N),s(j);var re=a(j,2),q=l(re);Il(q,{});var nt=a(q,2);Hl(nt,{$$events:{roll:D=>Ae(D.detail)}});var be=a(nt,2);oi(be,{$$events:{roll:D=>Ae(D.detail)}});var te=a(be,2);li(te,{$$events:{rollHitDice:h,rollInitiative:P}});var fe=a(te,2);bo(fe,{});var Xe=a(fe,2);yn(Xe,{$$events:{roll:D=>Ae(D.detail)}});var kt=a(Xe,2);Jn(kt,{$$events:{roll:D=>Ae(D.detail)}});var ot=a(kt,2);Xn(ot,{}),s(re),s(K);var ae=a(K,2);Ua(hr(ae,{get notation(){return e(F)},get damageNotation(){return e(ie)},get attackName(){return e(ge)},get applyHalfDamage(){return e(Ge)},get bonusBreakdown(){return e(De)},get damageBreakdown(){return e(ve)},get rollType(){return e(ce)},get visible(){return e(T)},$$events:{close:de},$$legacy:!0}),D=>r(ye,D),()=>e(ye));var qt=a(ae,2);{var Ne=D=>{Er(D,{get mode(){return e(U)},$$events:{close:()=>r(X,!1)}})};m(qt,D=>{e(X)&&D(Ne)})}var xt=a(qt,2);{var na=D=>{eo(D,{onClose:()=>r(Y,!1)})};m(xt,D=>{e(Y)&&D(na)})}var ta=a(xt,2);oo(ta,{get show(){return e(ee)},onSave:_e,onCancel:Ie});var Ot=a(ta,2);bl(Ot,{}),L(()=>{Se=Ut(O,1,"btn btn-mode svelte-1uha8ag",null,Se,{"use-mode":!v()}),$(gt,v()?"üìù":"üé≤"),$(he,v()?"Edit Mode":"Use Mode"),$(ft,e(S)?"‚òÄÔ∏è":"üåô"),$(ze,e(S)?"Light Mode":"Dark Mode")}),B("click",we,()=>{r(De,[]),r(T,!0)}),B("click",xe,()=>r(A,!e(A))),B("click",lt,()=>r(ee,!0)),B("click",O,Ze),B("click",Le,y),Ve(b,f,D=>yl(xa,D)),B("click",oe,()=>r(Y,!0)),B("click",ne,()=>{r(U,"save"),r(X,!0)}),B("click",le,()=>{r(U,"load"),r(X,!0)}),B("click",Te,mt),B("click",at,Dt),B("change",Fe,Bt),o(i,C),ea(),g()}export{zo as component};
