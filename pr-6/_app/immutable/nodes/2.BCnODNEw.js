import{f as u,e as F,a as o,s as w,c as rt,t as wt}from"../chunks/DBs_ODQp.js";import{i as Ft}from"../chunks/BbaRvQ4Z.js";import{c as Zt,o as na,a as Ya}from"../chunks/CHX4V4AM.js";import{a7 as Ua,i as Na,aZ as Xa,a_ as Za,a$ as Da,K as Vt,e as Ga,b0 as Oa,T as ma,b1 as es,b2 as ts,b3 as as,q as ss,b4 as ls,b5 as rs,ab as is,d as i,r as qa,g as ns,C as Bt,F as A,G as Mt,H as r,I as l,J as s,b6 as Xe,b7 as Wt,s as c,a4 as B,f as e,m as st,E as Pe,A as H,b8 as fa,b9 as Lt,ba as ra,ao as pa,bb as os}from"../chunks/DwmZeGF1.js";import{c as Dt,a as X,e as ut,i as ft,u as Wa,s as Qt,b as pt,d as oa,f as ta,g as cs,t as Et,h as vs,T as ds,j as us,k as ps}from"../chunks/DQJFtNtV.js";import{i as y,s as Ut,a as Ze,b as ct,d as ca,e as fs}from"../chunks/0ovU14Ao.js";import{p as mt,b as $a}from"../chunks/CFUzmRYW.js";import{b as la,r as gs}from"../chunks/DjiURNdE.js";function ga(a,n,t=!1){if(a.multiple){if(n==null)return;if(!Na(n))return Xa();for(var d of a.options)d.selected=n.includes(ia(d));return}for(d of a.options){var p=ia(d);if(Za(p,n)){d.selected=!0;return}}(!t||n!==void 0)&&(a.selectedIndex=-1)}function xa(a){var n=new MutationObserver(()=>{ga(a,a.__value)});n.observe(a,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),Ua(()=>{n.disconnect()})}function za(a,n,t=n){var d=new WeakSet,p=!0;Da(a,"change",b=>{var x=b?"[selected]":":checked",D;if(a.multiple)D=[].map.call(a.querySelectorAll(x),ia);else{var k=a.querySelector(x)??a.querySelector("option:not([disabled])");D=k&&ia(k)}t(D),Vt!==null&&d.add(Vt)}),Ga(()=>{var b=n();if(a===document.activeElement){var x=Oa??Vt;if(d.has(x))return}if(ga(a,b,p),p&&b===void 0){var D=a.querySelector(":checked");D!==null&&(b=ia(D),t(b))}a.__value=b,p=!1}),xa(a)}function ia(a){return"__value"in a?a.__value:a.value}const bs=Symbol("is custom element"),ms=Symbol("is html");function we(a){if(ma){var n=!1,t=()=>{if(!n){if(n=!0,a.hasAttribute("value")){var d=a.value;ze(a,"value",null),a.value=d}if(a.hasAttribute("checked")){var p=a.checked;ze(a,"checked",null),a.checked=p}}};a.__on_r=t,ss(t),ls()}}function ba(a,n){var t=ja(a);t.value===(t.value=n??void 0)||a.value===n&&(n!==0||a.nodeName!=="PROGRESS")||(a.value=n??"")}function Ka(a,n){var t=ja(a);t.checked!==(t.checked=n??void 0)&&(a.checked=n)}function ze(a,n,t,d){var p=ja(a);ma&&(p[n]=a.getAttribute(n),n==="src"||n==="srcset"||n==="href"&&a.nodeName==="LINK")||p[n]!==(p[n]=t)&&(n==="loading"&&(a[es]=t),t==null?a.removeAttribute(n):typeof t!="string"&&hs(a).includes(n)?a[n]=t:a.setAttribute(n,t))}function ja(a){return a.__attributes??={[bs]:a.nodeName.includes("-"),[ms]:a.namespaceURI===ts}}var Fa=new Map;function hs(a){var n=a.getAttribute("is")||a.nodeName,t=Fa.get(n);if(t)return t;Fa.set(n,t=[]);for(var d,p=a,b=Element.prototype;b!==p;){d=rs(p);for(var x in d)d[x].set&&t.push(x);p=as(p)}return t}function Re(a,n,t=n){var d=new WeakSet;Da(a,"input",async p=>{var b=p?a.defaultValue:a.value;if(b=_a(a)?ya(b):b,t(b),Vt!==null&&d.add(Vt),await is(),b!==(b=n())){var x=a.selectionStart,D=a.selectionEnd,k=a.value.length;if(a.value=b??"",D!==null){var M=a.value.length;x===D&&D===k&&M>k?(a.selectionStart=M,a.selectionEnd=M):(a.selectionStart=x,a.selectionEnd=Math.min(D,M))}}}),(ma&&a.defaultValue!==a.value||i(n)==null&&a.value)&&(t(_a(a)?ya(a.value):a.value),Vt!==null&&d.add(Vt)),qa(()=>{var p=n();if(a===document.activeElement){var b=Oa??Vt;if(d.has(b))return}_a(a)&&p===ya(a.value)||a.type==="date"&&!p&&!a.value||p!==a.value&&(a.value=p??"")})}function Ca(a,n,t=n){Da(a,"change",d=>{var p=d?a.defaultChecked:a.checked;t(p)}),(ma&&a.defaultChecked!==a.checked||i(n)==null)&&t(a.checked),qa(()=>{var d=n();a.checked=!!d})}function _a(a){var n=a.type;return n==="number"||n==="range"}function ya(a){return a===""?null:+a}function _s(a,n,t){var d=ns(a,n);d&&d.set&&(a[n]=t,Ua(()=>{a[n]=null}))}function Aa(a){return function(...n){var t=n[0];return t.stopPropagation(),a?.apply(this,n)}}function aa(a,n){var t=a.$$events?.[n.type],d=Na(t)?t.slice():t==null?[]:[t];for(var p of d)p.call(this,n)}const ys="";function Ja(...a){return la+ys+gs(a[0],a[1])}const La={paladin:{name:"Paladin",hitDice:"d10",spellcaster:!0,spellcastingAbility:"charisma",spellSlotsByLevel:{1:0,2:2,3:3,4:3,5:4,6:4,7:4,8:4,9:4,10:4,11:4,12:4,13:4,14:4,15:4,16:4,17:4,18:4,19:4,20:4},features:[{name:"Divine Sense",type:"uses",maxUses:(a,n=1)=>1+Math.max(1,n),resetOn:"long",description:"Detect celestials, fiends, and undead within 60 feet",minLevel:1},{name:"Lay on Hands",type:"pool",maxPool:a=>a*5,resetOn:"long",description:"Heal wounds or cure disease",minLevel:1},{name:"Divine Smite",type:"spellSlot",description:"Expend spell slot to deal extra radiant damage",minLevel:2,rollable:!0},{name:"Channel Divinity",type:"pool",maxPool:a=>a>=18?3:a>=6?2:1,resetOn:"short",description:"Sacred Weapon or Turn Undead",minLevel:3}]},fighter:{name:"Fighter",hitDice:"d10",spellcaster:!1,features:[{name:"Second Wind",type:"uses",maxUses:1,resetOn:"short",description:"Regain 1d10 + fighter level HP as bonus action",minLevel:1,rollable:!0,rollFormula:a=>`1d10+${a}`},{name:"Action Surge",type:"uses",maxUses:a=>a>=17?2:1,resetOn:"short",description:"Take one additional action on your turn",minLevel:2},{name:"Indomitable",type:"uses",maxUses:a=>a>=17?3:a>=13?2:1,resetOn:"long",description:"Reroll a failed saving throw",minLevel:9}],subclasses:{champion:{name:"Champion",features:[{name:"Improved Critical",type:"info",description:"Critical hit on 19-20",minLevel:3},{name:"Remarkable Athlete",type:"info",description:"Add half proficiency to STR/DEX/CON checks, increase long jump distance",minLevel:7},{name:"Additional Fighting Style",type:"info",description:"Choose a second fighting style",minLevel:10},{name:"Superior Critical",type:"info",description:"Critical hit on 18-20",minLevel:15},{name:"Survivor",type:"info",description:"Regain 5 + CON mod HP at start of turn if below half HP",minLevel:18}]},battlemaster:{name:"Battle Master",features:[{name:"Combat Superiority",type:"uses",maxUses:a=>a>=15?6:a>=7?5:4,resetOn:"short",description:a=>`Use superiority dice (${a>=18?"d12":a>=10?"d10":"d8"}) for maneuvers`,minLevel:3},{name:"Know Your Enemy",type:"info",description:"Learn capabilities of creatures you observe",minLevel:7},{name:"Improved Combat Superiority",type:"info",description:"Superiority dice become d10",minLevel:10},{name:"Relentless",type:"info",description:"Regain 1 superiority die if you have none at start of turn",minLevel:15}]}}},rogue:{name:"Rogue",hitDice:"d8",spellcaster:!1,features:[{name:"Sneak Attack",type:"info",description:a=>`Deal ${Math.ceil(a/2)}d6 extra damage once per turn with advantage or ally nearby`,minLevel:1,rollable:!0,rollFormula:a=>`${Math.ceil(a/2)}d6`},{name:"Cunning Action",type:"info",description:"Dash, Disengage, or Hide as a bonus action",minLevel:2},{name:"Uncanny Dodge",type:"info",description:"Use reaction to halve damage from an attack",minLevel:5},{name:"Evasion",type:"info",description:"Take no damage on successful Dex save (half on fail)",minLevel:7}]},wizard:{name:"Wizard",hitDice:"d6",spellcaster:!0,spellcastingAbility:"intelligence",spellSlotsByLevel:{1:2,2:3,3:4,4:4,5:4,6:4,7:4,8:4,9:4,10:4,11:4,12:4,13:4,14:4,15:4,16:4,17:4,18:4,19:4,20:4},features:[{name:"Arcane Recovery",type:"uses",maxUses:1,resetOn:"long",description:a=>`Recover spell slots totaling up to ${Math.ceil(a/2)} levels during short rest`,minLevel:1},{name:"Spell Mastery",type:"info",description:"Cast one 1st-level and one 2nd-level spell at will",minLevel:18}]},cleric:{name:"Cleric",hitDice:"d8",spellcaster:!0,spellcastingAbility:"wisdom",spellSlotsByLevel:{1:2,2:3,3:4,4:4,5:4,6:4,7:4,8:4,9:4,10:4,11:4,12:4,13:4,14:4,15:4,16:4,17:4,18:4,19:4,20:4},features:[{name:"Channel Divinity",type:"pool",maxPool:a=>a>=18?3:a>=6?2:1,resetOn:"short",description:"Turn Undead or domain-specific ability",minLevel:2},{name:"Destroy Undead",type:"info",description:a=>`Channel Divinity destroys undead of CR ${a>=17?4:a>=14?3:a>=11?2:a>=8?1:.5} or lower`,minLevel:5},{name:"Divine Intervention",type:"uses",maxUses:1,resetOn:"long",description:a=>`${a}% chance to succeed, implore deity for aid`,minLevel:10}],subclasses:{war:{name:"War Domain",features:[{name:"War Priest",type:"uses",maxUses:(a,n=1)=>Math.max(1,n),resetOn:"long",description:"Make one weapon attack as a bonus action",minLevel:1},{name:"Guided Strike",type:"channelDivinity",description:"Use your Channel Divinity to gain +10 to an attack roll. Make this choice after you see the roll, but before the DM says whether the attack hits or misses.",minLevel:2,resetOn:"short"},{name:"War God's Blessing",type:"channelDivinity",description:"Use reaction to grant +10 to an ally's attack roll within 30 feet. Consumes one use of Channel Divinity.",minLevel:6,resetOn:"short"},{name:"Divine Strike",type:"info",description:a=>`Deal extra ${a>=14?"2d8":"1d8"} weapon damage once per turn`,minLevel:8,rollable:!0,rollFormula:a=>a>=14?"2d8":"1d8"},{name:"Avatar of Battle",type:"info",description:"Gain resistance to nonmagical weapon damage",minLevel:17}]},life:{name:"Life Domain",features:[{name:"Disciple of Life",type:"info",description:"Healing spells restore additional 2 + spell level HP",minLevel:1},{name:"Preserve Life",type:"pool",maxPool:a=>a*5,resetOn:"short",description:"Restore HP to creatures within 30 feet",minLevel:2},{name:"Blessed Healer",type:"info",description:"Regain 2 + spell level HP when you cast healing spell",minLevel:6},{name:"Divine Strike",type:"info",description:a=>`Deal extra ${a>=14?"2d8":"1d8"} radiant damage once per turn`,minLevel:8,rollable:!0,rollFormula:a=>a>=14?"2d8":"1d8"},{name:"Supreme Healing",type:"info",description:"Maximize healing dice instead of rolling",minLevel:17}]}}},barbarian:{name:"Barbarian",hitDice:"d12",spellcaster:!1,features:[{name:"Rage",type:"uses",maxUses:a=>a>=20?1/0:a>=17?6:a>=12?5:a>=6?4:a>=3?3:2,resetOn:"long",description:a=>`+${a>=16?4:a>=9?3:2} damage, resistance to physical damage`,minLevel:1},{name:"Reckless Attack",type:"info",description:"Gain advantage on melee attacks, enemies get advantage on you",minLevel:2},{name:"Danger Sense",type:"info",description:"Advantage on Dex saves against effects you can see",minLevel:2}],subclasses:{berserker:{name:"Path of the Berserker",features:[{name:"Frenzy",type:"info",description:"While raging, make melee attack as bonus action (gain 1 exhaustion after rage)",minLevel:3},{name:"Mindless Rage",type:"info",description:"Cannot be charmed or frightened while raging",minLevel:6},{name:"Intimidating Presence",type:"info",description:"Use action to frighten creature within 30 feet",minLevel:10},{name:"Retaliation",type:"info",description:"When damaged by creature within 5 feet, make melee attack as reaction",minLevel:14}]}}}};function Pt(a){const n=a.toLowerCase();return La[n]||null}function sa(a,n,t){const d=Pt(a);if(!d)return[];const p=d.features.filter(b=>!b.minLevel||b.minLevel<=n);if(t&&d.subclasses&&d.subclasses[t]){const b=d.subclasses[t].features.filter(x=>!x.minLevel||x.minLevel<=n);return[...p,...b]}return p}function Ba(a){const n=Pt(a);return!n||!n.subclasses?[]:Object.keys(n.subclasses).map(t=>({id:t,name:n.subclasses[t].name}))}function Ma(a,n){const t=Pt(a);return!t||!t.spellcaster||!t.spellSlotsByLevel?0:t.spellSlotsByLevel[n]||0}function Ra(a,n,t){const d=Pt(a);return!d||!d.spellcaster?0:Math.max(1,t+n)}function ks(a,n,t){const d=Pt(a);return!d||!d.spellcaster?null:8+n+t}function Ss(){return Object.keys(La).map(a=>({id:a,name:La[a].name}))}var $s=u('<div class="section-header svelte-ls99y2" role="button" tabindex="0"><h2 class="svelte-ls99y2"> </h2> <span class="collapse-btn svelte-ls99y2"> </span></div>');function ea(a,n){Bt(n,!1);let t=mt(n,"title",8),d=mt(n,"collapsed",8),p=mt(n,"ariaLabel",8,""),b=mt(n,"onToggle",8);Ft();var x=$s(),D=r(x),k=r(D,!0);l(D);var M=s(D,2),Z=r(M,!0);l(M),l(x),A(()=>{ze(x,"aria-expanded",!d()),ze(x,"aria-label",p()),w(k,t()),w(Z,d()?"â–¼":"â–²")}),F("click",x,function(...z){b()?.apply(this,z)}),F("keydown",x,z=>{(z.key==="Enter"||z.key===" ")&&b()()}),o(a,x),Mt()}var xs=u("<option> </option>"),Cs=u("<option> </option>"),Ls=u('<div class="form-group svelte-172i2fj"><label for="characterSubclass" class="svelte-172i2fj">Subclass</label> <select id="characterSubclass" class="svelte-172i2fj"><option>Select Subclass</option><!></select></div>'),ws=u('<div class="info-grid svelte-172i2fj"><div class="form-group svelte-172i2fj"><label for="characterName" class="svelte-172i2fj">Character Name</label> <input type="text" id="characterName" placeholder="Enter name" class="svelte-172i2fj"/></div> <div class="form-group svelte-172i2fj"><label for="characterClass" class="svelte-172i2fj">Class</label> <select id="characterClass" class="svelte-172i2fj"><option>Select Class</option><!></select></div> <!> <div class="form-group svelte-172i2fj"><label for="characterLevel" class="svelte-172i2fj">Level</label> <input type="number" id="characterLevel" min="1" max="20" class="svelte-172i2fj"/></div> <div class="form-group svelte-172i2fj"><label for="characterRace" class="svelte-172i2fj">Race</label> <input type="text" id="characterRace" placeholder="e.g., Human" class="svelte-172i2fj"/></div> <div class="form-group svelte-172i2fj"><label for="characterBackground" class="svelte-172i2fj">Background</label> <input type="text" id="characterBackground" placeholder="e.g., Soldier" class="svelte-172i2fj"/></div> <div class="form-group svelte-172i2fj"><label for="characterAlignment" class="svelte-172i2fj">Alignment</label> <input type="text" id="characterAlignment" placeholder="e.g., Lawful Good" class="svelte-172i2fj"/></div></div>'),Ds=u('<section class="character-info svelte-172i2fj"><!> <!></section>');function js(a,n){Bt(n,!1);const t=()=>Ze(X,"$character",p),d=()=>Ze(Dt,"$collapsedStates",p),[p,b]=Ut(),x=B(),D=Ss();function k(se){const pe=se.target;X.update(J=>(J.class=pe.value,J.subclass="",J))}function M(se){const pe=se.target;X.update(J=>(J.subclass=pe.value,J))}function Z(se){const pe=se.target;X.update(J=>(J.level=parseInt(pe.value)||1,J)),Wa()}Xe(()=>(t(),Ba),()=>{c(x,t().class?Ba(t().class):[])}),Wt(),Ft();var z=Ds(),U=r(z);{let se=st(()=>(d(),i(()=>d().characterInfo?"Expand":"Collapse")));ea(U,{title:"Character Info",get collapsed(){return d(),i(()=>d().characterInfo)},get ariaLabel(){return e(se)},onToggle:()=>Dt.update(pe=>({...pe,characterInfo:!pe.characterInfo}))})}var ke=s(U,2);{var be=se=>{var pe=ws(),J=r(pe),We=s(r(J),2);we(We),l(J);var K=s(J,2),re=s(r(K),2),ee=r(re);ee.value=ee.__value="";var le=s(ee);ut(le,1,()=>D,ft,(C,W)=>{var I=xs(),N=r(I,!0);l(I);var xe={};A(()=>{w(N,(e(W),i(()=>e(W).name))),xe!==(xe=(e(W),i(()=>e(W).id)))&&(I.value=(I.__value=(e(W),i(()=>e(W).id)))??"")}),o(C,I)}),l(re);var oe;xa(re),l(K);var Ie=s(K,2);{var Oe=C=>{var W=Ls(),I=s(r(W),2),N=r(I);N.value=N.__value="";var xe=s(N);ut(xe,1,()=>e(x),ft,(Y,Fe)=>{var Me=Cs(),Te=r(Me,!0);l(Me);var et={};A(()=>{w(Te,(e(Fe),i(()=>e(Fe).name))),et!==(et=(e(Fe),i(()=>e(Fe).id)))&&(Me.value=(Me.__value=(e(Fe),i(()=>e(Fe).id)))??"")}),o(Y,Me)}),l(I);var Ke;xa(I),l(W),A(()=>{Ke!==(Ke=(t(),i(()=>t().subclass)))&&(I.value=(I.__value=(t(),i(()=>t().subclass)))??"",ga(I,(t(),i(()=>t().subclass))))}),F("change",I,M),o(C,W)};y(Ie,C=>{e(x),i(()=>e(x).length>0)&&C(Oe)})}var Se=s(Ie,2),$e=s(r(Se),2);we($e),l(Se);var L=s(Se,2),ue=s(r(L),2);we(ue),l(L);var m=s(L,2),R=s(r(m),2);we(R),l(m);var ie=s(m,2),g=s(r(ie),2);we(g),l(ie),l(pe),A(()=>{oe!==(oe=(t(),i(()=>t().class)))&&(re.value=(re.__value=(t(),i(()=>t().class)))??"",ga(re,(t(),i(()=>t().class)))),ba($e,(t(),i(()=>t().level)))}),Re(We,()=>t().name,C=>ct(X,i(t).name=C,i(t))),F("change",re,k),F("change",$e,Z),Re(ue,()=>t().race,C=>ct(X,i(t).race=C,i(t))),Re(R,()=>t().background,C=>ct(X,i(t).background=C,i(t))),Re(g,()=>t().alignment,C=>ct(X,i(t).alignment=C,i(t))),o(se,pe)};y(ke,se=>{d(),i(()=>!d().characterInfo)&&se(be)})}l(z),o(a,z),Mt(),b()}var As=u('<div class="ability-card svelte-bbv1xt"><h3 class="svelte-bbv1xt"> </h3> <input type="number" class="ability-score svelte-bbv1xt" min="1" max="30"/> <div class="ability-modifier svelte-bbv1xt"> </div> <button class="roll-btn svelte-bbv1xt">Check</button> <div class="save-row svelte-bbv1xt"><input type="checkbox" class="svelte-bbv1xt"/> <label class="svelte-bbv1xt">Save</label> <button class="roll-btn-small svelte-bbv1xt">Roll</button></div></div>'),Fs=u('<div class="proficiency-bonus svelte-bbv1xt"><label for="profBonus">Proficiency Bonus</label> <input type="number" id="profBonus" class="prof-input svelte-bbv1xt"/></div> <div class="abilities-grid svelte-bbv1xt"></div>',1),Bs=u("<section><!> <!></section>");function Ms(a,n){Bt(n,!1);const t=()=>Ze(oa,"$abilityModifiers",x),d=()=>Ze(X,"$character",x),p=()=>Ze(Qt,"$searchFilter",x),b=()=>Ze(Dt,"$collapsedStates",x),[x,D]=Ut(),k=B(),M=B(),Z=Zt(),z=[{key:"strength",label:"Strength"},{key:"dexterity",label:"Dexterity"},{key:"constitution",label:"Constitution"},{key:"intelligence",label:"Intelligence"},{key:"wisdom",label:"Wisdom"},{key:"charisma",label:"Charisma"}];function U(){Wa()}function ke(re){const ee=t()[re],le=`1d20${ee>=0?"+":""}${ee}`;Z("roll",le)}function be(re){const ee=t()[re],le=d().saveProficiencies[re]?d().proficiencyBonus:0,oe=ee+le,Ie=`1d20${oe>=0?"+":""}${oe}`;Z("roll",Ie)}Xe(()=>p(),()=>{c(k,z.filter(({label:re})=>p()?re.toLowerCase().includes(p().toLowerCase()):!0))}),Xe(()=>(e(k),p()),()=>{c(M,e(k).length>0||!p()||p().toLowerCase().includes("proficiency"))}),Wt(),Ft();var se=Bs();let pe;var J=r(se);ea(J,{title:"Ability Scores",get collapsed(){return b(),i(()=>b().abilityScores)},ariaLabel:"Toggle Ability Scores Section",onToggle:()=>Dt.update(re=>({...re,abilityScores:!re.abilityScores}))});var We=s(J,2);{var K=re=>{var ee=Fs(),le=Pe(ee),oe=s(r(le),2);we(oe),l(le);var Ie=s(le,2);ut(Ie,5,()=>e(k),ft,(Oe,Se)=>{let $e=()=>e(Se).key,L=()=>e(Se).label;var ue=As(),m=r(ue),R=r(m,!0);l(m);var ie=s(m,2);we(ie);var g=s(ie,2),C=r(g);l(g);var W=s(g,2),I=s(W,2),N=r(I);we(N);var xe=s(N,2),Ke=s(xe,2);l(I),l(ue),A(Y=>{w(R,Y),w(C,`${t(),$e(),i(()=>t()[$e()]>=0?"+":"")??""}${t(),$e(),i(()=>t()[$e()])??""}`),ze(N,"id",`${$e()}-save`),ze(xe,"for",`${$e()}-save`)},[()=>(L(),i(()=>L().substring(0,3).toUpperCase()))]),Re(ie,()=>d().abilities[$e()],Y=>ct(X,i(d).abilities[$e()]=Y,i(d))),F("change",ie,U),F("click",W,()=>ke($e())),Ca(N,()=>d().saveProficiencies[$e()],Y=>ct(X,i(d).saveProficiencies[$e()]=Y,i(d))),F("click",Ke,()=>be($e())),o(Oe,ue)}),l(Ie),Re(oe,()=>d().proficiencyBonus,Oe=>ct(X,i(d).proficiencyBonus=Oe,i(d))),o(re,ee)};y(We,re=>{b(),i(()=>!b().abilityScores)&&re(K)})}l(se),A(()=>pe=pt(se,1,"ability-scores svelte-bbv1xt",null,pe,{hidden:!e(M)})),o(a,se),Mt(),D()}function wa(a,n){if(!a.class)return null;const t=Pt(a.class);if(!t||!t.spellcaster||!t.spellcastingAbility)return null;const d=n[t.spellcastingAbility];return 8+a.proficiencyBonus+d}function Ia(a,n){if(!a.class)return 0;const t=Pt(a.class);return!t||!t.spellcaster||!t.spellcastingAbility?0:n[t.spellcastingAbility]}var Rs=u('<input type="number" id="armorClass" class="stat-input svelte-1r5hyyb"/>'),Is=u('<input type="text" id="armorClass" readonly=""/>'),Es=u('<div class="stat-box svelte-1r5hyyb"><label for="spellSaveDC" class="svelte-1r5hyyb">Spell Save DC</label> <input type="number" id="spellSaveDC" class="stat-input svelte-1r5hyyb" readonly="" title="8 + Proficiency Bonus + Spellcasting Ability Modifier"/></div>'),Ps=u('<span class="hit-dice-type"> </span>'),Ts=u('<div class="stats-grid svelte-1r5hyyb"><div class="stat-box svelte-1r5hyyb"><label for="armorClass" class="svelte-1r5hyyb">Armor Class</label> <!></div> <div class="stat-box svelte-1r5hyyb"><label for="initiative" class="svelte-1r5hyyb">Initiative</label> <input type="number" id="initiative" class="stat-input svelte-1r5hyyb"/></div> <div class="stat-box svelte-1r5hyyb"><label for="speed" class="svelte-1r5hyyb">Speed</label> <input type="text" id="speed" class="stat-input svelte-1r5hyyb"/></div> <!></div> <div class="hp-section svelte-1r5hyyb"><h3 class="svelte-1r5hyyb">Hit Points</h3> <div class="hp-display svelte-1r5hyyb"><div class="hp-inputs svelte-1r5hyyb"><input type="number" class="hp-current svelte-1r5hyyb" min="0"/> <span class="hp-separator svelte-1r5hyyb">/</span> <input type="number" class="hp-max svelte-1r5hyyb" min="0"/></div> <div class="hp-controls svelte-1r5hyyb"><button class="hp-btn svelte-1r5hyyb">âˆ’</button> <button class="hp-btn svelte-1r5hyyb">+</button> <button class="hp-btn svelte-1r5hyyb">âˆ’5</button> <button class="hp-btn svelte-1r5hyyb">+5</button></div></div> <div class="temp-hp svelte-1r5hyyb"><label for="tempHP" class="svelte-1r5hyyb">Temp HP</label> <input type="number" id="tempHP" min="0" class="svelte-1r5hyyb"/></div></div> <div class="hit-dice-section svelte-1r5hyyb"><h3 class="svelte-1r5hyyb">Hit Dice</h3> <div class="hit-dice-display svelte-1r5hyyb"><input type="number" class="hit-dice-input svelte-1r5hyyb" min="0"/> <span>/</span> <input type="number" class="hit-dice-input svelte-1r5hyyb" min="0"/> <!></div> <div class="hit-dice-controls"><label for="hitDiceCount" class="svelte-1r5hyyb">Roll</label> <input type="number" id="hitDiceCount" class="hit-dice-count-input svelte-1r5hyyb" min="1" value="1"/> <button class="btn btn-primary roll-hit-dice use-enabled svelte-1r5hyyb">ðŸŽ² Roll</button></div></div>',1),Hs=u("<section><!> <!></section>");function Us(a,n){Bt(n,!1);const t=()=>Ze(X,"$character",D),d=()=>Ze(oa,"$abilityModifiers",D),p=()=>Ze(Qt,"$searchFilter",D),b=()=>Ze(Dt,"$collapsedStates",D),x=()=>Ze(ta,"$isEditMode",D),[D,k]=Ut(),M=B(),Z=B(),z=B(),U=Zt();function ke(re){X.update(ee=>(ee.currentHP=Math.max(0,Math.min(ee.maxHP,ee.currentHP+re)),ee))}function be(re=1){if(t().hitDice.current<=0){alert("No hit dice remaining!");return}if(!t().class){alert("Please select a class first!");return}const ee=Pt(t().class);if(!ee){alert("Invalid class configuration!");return}const le=Math.min(re,t().hitDice.current),oe=ee.hitDice,Ie=d().constitution,Oe=Ie>=0?`+${Ie}`:`${Ie}`,Se=`${le}${oe}${Oe}`;U("rollHitDice",{notation:Se,hitDie:oe,count:le})}Xe(()=>(t(),d()),()=>{c(M,wa(t(),d()))}),Xe(()=>t(),()=>{c(Z,t().activeStates&&t().activeStates.length>0?t().activeStates.reduce((re,ee)=>re+(ee.acBonus||0),0):0)}),Xe(()=>p(),()=>{c(z,!p()||"armor class".includes(p().toLowerCase())||"initiative".includes(p().toLowerCase())||"speed".includes(p().toLowerCase())||"hit points".includes(p().toLowerCase())||"hp".includes(p().toLowerCase())||"hit dice".includes(p().toLowerCase())||"spell save".includes(p().toLowerCase())||"combat".includes(p().toLowerCase()))}),Wt(),Ft();var se=Hs();let pe;var J=r(se);{let re=st(()=>(b(),i(()=>b().combatStats?"Expand":"Collapse")));ea(J,{title:"Combat Stats",get collapsed(){return b(),i(()=>b().combatStats)},get ariaLabel(){return e(re)},onToggle:()=>Dt.update(ee=>({...ee,combatStats:!ee.combatStats}))})}var We=s(J,2);{var K=re=>{var ee=Ts(),le=Pe(ee),oe=r(le),Ie=s(r(oe),2);{var Oe=T=>{var h=Rs();we(h),Re(h,()=>t().armorClass,fe=>ct(X,i(t).armorClass=fe,i(t))),o(T,h)},Se=T=>{var h=Is();we(h),A(()=>{ba(h,(e(Z),t(),i(()=>e(Z)!==0?`${t().armorClass} â†’ ${t().armorClass+e(Z)}`:`${t().armorClass}`))),pt(h,1,cs(e(Z)!==0?"stat-input ac-enhanced":"stat-input"),"svelte-1r5hyyb"),ze(h,"title",e(Z)!==0?"Base AC plus active effect bonuses":"Base Armor Class")}),o(T,h)};y(Ie,T=>{x()?T(Oe):T(Se,!1)})}l(oe);var $e=s(oe,2),L=s(r($e),2);we(L),l($e);var ue=s($e,2),m=s(r(ue),2);we(m),l(ue);var R=s(ue,2);{var ie=T=>{var h=Es(),fe=s(r(h),2);we(fe),l(h),A(()=>ba(fe,e(M))),o(T,h)};y(R,T=>{e(M)!==null&&T(ie)})}l(le);var g=s(le,2),C=s(r(g),2),W=r(C),I=r(W);we(I);var N=s(I,4);we(N),l(W);var xe=s(W,2),Ke=r(xe),Y=s(Ke,2),Fe=s(Y,2),Me=s(Fe,2);l(xe),l(C);var Te=s(C,2),et=s(r(Te),2);we(et),l(Te),l(g);var ot=s(g,2),te=s(r(ot),2),_=r(te);we(_);var v=s(_,4);we(v);var ce=s(v,2);{var ne=T=>{const h=st(()=>(H(Pt),t(),i(()=>Pt(t().class))));var fe=rt(),De=Pe(fe);{var qe=Qe=>{const _e=st(()=>(d(),i(()=>d().constitution)));var me=Ps(),Le=r(me);l(me),A(()=>w(Le,`(${H(e(h)),i(()=>e(h).hitDice)??""}${(e(_e)>=0?`+${e(_e)}`:e(_e))??""})`)),o(Qe,me)};y(De,Qe=>{e(h)&&Qe(qe)})}o(T,fe)};y(ce,T=>{t(),i(()=>t().class)&&T(ne)})}l(te);var Ce=s(te,2),Ee=s(r(Ce),2),He=s(Ee,2);l(Ce),l(ot),A(()=>{ze(I,"max",(t(),i(()=>t().maxHP))),ze(_,"max",(t(),i(()=>t().hitDice.max))),ze(Ee,"max",(t(),i(()=>t().hitDice.current))),He.disabled=(t(),i(()=>t().hitDice.current<=0||!t().class))}),Re(L,()=>t().initiative,T=>ct(X,i(t).initiative=T,i(t))),Re(m,()=>t().speed,T=>ct(X,i(t).speed=T,i(t))),Re(I,()=>t().currentHP,T=>ct(X,i(t).currentHP=T,i(t))),Re(N,()=>t().maxHP,T=>ct(X,i(t).maxHP=T,i(t))),F("click",Ke,()=>ke(-1)),F("click",Y,()=>ke(1)),F("click",Fe,()=>ke(-5)),F("click",Me,()=>ke(5)),Re(et,()=>t().tempHP,T=>ct(X,i(t).tempHP=T,i(t))),Re(_,()=>t().hitDice.current,T=>ct(X,i(t).hitDice.current=T,i(t))),Re(v,()=>t().hitDice.max,T=>ct(X,i(t).hitDice.max=T,i(t))),F("input",Ee,T=>{const h=T.target,fe=parseInt(h.value);fe>t().hitDice.current&&(h.value=String(t().hitDice.current)),fe<1&&(h.value="1")}),F("click",He,()=>{const T=document.getElementById("hitDiceCount"),h=parseInt(T?.value||"1");be(h)}),o(re,ee)};y(We,re=>{b(),i(()=>!b().combatStats)&&re(K)})}l(se),A(()=>pe=pt(se,1,"combat-stats svelte-1r5hyyb",null,pe,{hidden:!e(z)})),o(a,se),Mt(),k()}const ka={acrobatics:"dexterity",animalHandling:"wisdom",arcana:"intelligence",athletics:"strength",deception:"charisma",history:"intelligence",insight:"wisdom",intimidation:"charisma",investigation:"intelligence",medicine:"wisdom",nature:"intelligence",perception:"wisdom",performance:"charisma",persuasion:"charisma",religion:"intelligence",sleightOfHand:"dexterity",stealth:"dexterity",survival:"wisdom"};var Ns=u('<div class="skill-row svelte-1f1pl16"><input type="checkbox" class="svelte-1f1pl16"/> <label class="svelte-1f1pl16"> <span class="ability-tag svelte-1f1pl16"> </span></label> <span class="skill-modifier svelte-1f1pl16"> </span> <button class="roll-btn svelte-1f1pl16">Roll</button></div>'),Gs=u('<div class="skills-grid svelte-1f1pl16"></div>'),Os=u("<section><!> <!></section>");function qs(a,n){Bt(n,!1);const t=()=>Ze(X,"$character",x),d=()=>Ze(oa,"$abilityModifiers",x),p=()=>Ze(Qt,"$searchFilter",x),b=()=>Ze(Dt,"$collapsedStates",x),[x,D]=Ut(),k=B(),M=B(),Z=B(),z=B(),U=B(),ke=B(),be=Zt(),se=[{key:"acrobatics",label:"Acrobatics"},{key:"animalHandling",label:"Animal Handling"},{key:"arcana",label:"Arcana"},{key:"athletics",label:"Athletics"},{key:"deception",label:"Deception"},{key:"history",label:"History"},{key:"insight",label:"Insight"},{key:"intimidation",label:"Intimidation"},{key:"investigation",label:"Investigation"},{key:"medicine",label:"Medicine"},{key:"nature",label:"Nature"},{key:"perception",label:"Perception"},{key:"performance",label:"Performance"},{key:"persuasion",label:"Persuasion"},{key:"religion",label:"Religion"},{key:"sleightOfHand",label:"Sleight of Hand"},{key:"stealth",label:"Stealth"},{key:"survival",label:"Survival"}];function pe(le){const oe=e(k)[le],Ie=`1d20${oe>=0?"+":""}${oe}`;be("roll",Ie)}Xe(()=>{},()=>{c(k,{})}),Xe(()=>t(),()=>{c(M,t().skillProficiencies)}),Xe(()=>t(),()=>{c(Z,t().proficiencyBonus)}),Xe(()=>d(),()=>{c(z,d())}),Xe(()=>(e(z),e(M),e(Z)),()=>{for(const{key:le}of se){const oe=ka[le],Ie=e(z)[oe],Oe=e(M)[le]?e(Z):0;fa(k,e(k)[le]=Ie+Oe)}}),Xe(()=>p(),()=>{c(U,se.filter(({label:le})=>p()?le.toLowerCase().includes(p().toLowerCase()):!0))}),Xe(()=>e(U),()=>{c(ke,e(U).length>0)}),Wt(),Ft();var J=Os();let We;var K=r(J);{let le=st(()=>(b(),i(()=>b().skills?"Expand":"Collapse")));ea(K,{title:"Skills",get collapsed(){return b(),i(()=>b().skills)},get ariaLabel(){return e(le)},onToggle:()=>Dt.update(oe=>({...oe,skills:!oe.skills}))})}var re=s(K,2);{var ee=le=>{var oe=Gs();ut(oe,5,()=>e(U),ft,(Ie,Oe)=>{let Se=()=>e(Oe).key,$e=()=>e(Oe).label;var L=Ns(),ue=r(L);we(ue);var m=s(ue,2),R=r(m),ie=s(R),g=r(ie);l(ie),l(m);var C=s(m,2),W=r(C);l(C);var I=s(C,2);l(L),A(N=>{Ka(ue,(e(M),Se(),i(()=>e(M)[Se()]))),ze(ue,"id",Se()),ze(m,"for",Se()),w(R,`${$e()??""} `),w(g,`(${N??""})`),w(W,`${e(k),Se(),i(()=>e(k)[Se()]>=0?"+":"")??""}${e(k),Se(),i(()=>e(k)[Se()])??""}`)},[()=>(H(ka),Se(),i(()=>ka[Se()].substring(0,3).toUpperCase()))]),F("change",ue,N=>{console.log("Skill proficiency changed:",Se(),N.target.checked),X.update(xe=>({...xe,skillProficiencies:{...xe.skillProficiencies,[Se()]:N.target.checked}}))}),F("click",I,()=>pe(Se())),o(Ie,L)}),l(oe),o(le,oe)};y(re,le=>{b(),i(()=>!b().skills)&&le(ee)})}l(J),A(()=>We=pt(J,1,"skills svelte-1f1pl16",null,We,{hidden:!e(ke)})),o(a,J),Mt(),D()}let va=null,da=null;async function Va(){if(va)return va;try{return va=await(await fetch(Ja("/data/spells.json"))).json(),va||[]}catch(a){return console.error("Failed to load spells:",a),[]}}async function Ws(){if(da)return da;try{return da=await(await fetch(Ja("/data/feats.json"))).json(),da||[]}catch(a){return console.error("Failed to load feats:",a),[]}}function Ea(a,n){if(!n.trim())return a;const t=n.toLowerCase();return a.filter(d=>d.name.toLowerCase().includes(t)||d.school.toLowerCase().includes(t)||d.classes.some(p=>p.toLowerCase().includes(t))||d.description.toLowerCase().includes(t))}function zs(a,n){return n===null?a:a.filter(t=>t.level===n)}function Ks(a,n){if(!n.trim())return a;const t=n.toLowerCase();return a.filter(d=>d.name.toLowerCase().includes(t)||d.description.toLowerCase().includes(t))}function ua(a){const n=a.description,t=/\b(Strength|Dexterity|Constitution|Intelligence|Wisdom|Charisma)\s+saving\s+throw/i,d=n.match(t);if(!d)return null;const p=d[1].toLowerCase(),x=/half\s+(?:as\s+much\s+)?damage\s+on\s+a\s+successful(?:\s+save)?/i.test(n),k=/saving\s+throw\s+or\s+take.*?damage/i.test(n)&&!x;return{ability:p,halfDamageOnSave:x,noDamageOnSave:k}}function Js(a){const n=a.description;return/(plus|add)\s+your\s+spellcasting\s+(ability\s+)?modifier/i.test(n)}function Sa(a){const n=a.description.toLowerCase();return n.includes("ranged spell attack")||n.includes("melee spell attack")}function Pa(a){const n=a.description.toLowerCase();if(["Divine Favor","Bless","Aid","Command"].includes(a.name))return!0;const p=["takes","take","deals","deal","damage equal to","force damage","fire damage","cold damage","lightning damage","thunder damage","acid damage","poison damage","necrotic damage","radiant damage","psychic damage","regain","regains","hit point"].some(D=>n.includes(D));return["bonus to attack","bonus to damage","bonus to ac","gains a +","gain a +","+1 bonus","+2 bonus","+3 bonus","advantage on","becomes a magic weapon"].some(D=>n.includes(D))&&!p}function Vs(a){const n=a.description;let t=0,d=0,p=0,b="";const x=n.match(/\+(\d+)\s+bonus\s+to\s+attack\s+rolls\s+and\s+damage\s+rolls/i);if(x){const k=parseInt(x[1]);t=k,d=k,b=`+${k} to attack and damage rolls`}a.name==="Bless"&&(b="Add 1d4 to attack rolls and saves"),a.name==="Divine Favor"&&(b="Your weapon attacks deal an extra 1d4 radiant damage on a hit.",d="1d4");const D=n.match(/\+(\d+)\s+bonus\s+to\s+AC/i);return D&&(p=parseInt(D[1]),b=`+${p} to AC`),a.name==="Haste"&&(b="+2 AC, doubled speed, extra action",p=2),b||t!==0||d!==0||p!==0?{attackBonus:t,damageBonus:d,acBonus:p,description:b||a.description.substring(0,100),name:a.name}:null}var Qs=u('<button class="btn btn-secondary">Add Attack</button>'),Ys=u('<input type="text" placeholder="Attack name" class="attack-name svelte-14o91c5"/>'),Xs=u('<h4 class="attack-name-display svelte-14o91c5"> </h4>'),Zs=u('<button class="btn-remove svelte-14o91c5">Ã—</button>'),el=u('<div class="attack-field svelte-14o91c5"><label class="svelte-14o91c5">Bonus</label> <input type="number" class="attack-bonus svelte-14o91c5"/></div>'),tl=u('<div class="attack-field svelte-14o91c5"><label class="svelte-14o91c5">Damage</label> <input type="text" placeholder="e.g., 2d6+3" class="attack-damage svelte-14o91c5"/></div>'),al=u('<div class="spell-info-loading svelte-14o91c5">Loading spell info...</div>'),sl=u('<li class="svelte-14o91c5"><strong>At Higher Levels:</strong> </li>'),ll=u('<ul class="svelte-14o91c5"><li class="svelte-14o91c5"><strong>Level:</strong> </li> <li class="svelte-14o91c5"><strong>Casting Time:</strong> </li> <li class="svelte-14o91c5"><strong>Range:</strong> </li> <li class="svelte-14o91c5"><strong>Components:</strong> <!></li> <li class="svelte-14o91c5"><strong>Duration:</strong> <!> </li> <li class="svelte-14o91c5"><strong>Description:</strong> </li> <!></ul>'),rl=u('<span class="scaled-damage svelte-14o91c5" style="margin-left: 8px;"> </span>'),il=u('<span class="scaled-damage svelte-14o91c5">(Half damage)</span>'),nl=u('<span class="scaled-damage svelte-14o91c5">(No damage)</span>'),ol=u('<div class="target-condition svelte-14o91c5"><label class="svelte-14o91c5"><input type="checkbox" class="use-enabled svelte-14o91c5"/> <!> <!></label></div>'),cl=u("<option> </option>"),vl=u('<span class="scaled-damage svelte-14o91c5"><!> </span>'),dl=u('<span class="scaled-damage svelte-14o91c5"> </span>'),ul=u('<div class="target-condition svelte-14o91c5"><label class="svelte-14o91c5"><input type="checkbox" class="use-enabled svelte-14o91c5"/> Target is Fiend or Undead <!></label></div>'),pl=u('<div class="spell-level-selector svelte-14o91c5"><label class="svelte-14o91c5">Cast at Level:</label> <select class="spell-level-select use-enabled svelte-14o91c5"></select> <!></div> <!>',1),fl=u('<div class="spell-level-selector svelte-14o91c5"><span style="color: #dc3545; font-weight: bold;">No spell slots available!</span></div>'),gl=u('<div class="spell-info svelte-14o91c5"><div class="spell-info-header svelte-14o91c5" role="button" tabindex="0"><h4 class="svelte-14o91c5">Spell Info</h4> <button class="collapse-btn-small svelte-14o91c5"> </button></div> <!></div> <!> <!>',1),bl=u('<div class="spell-info-missing svelte-14o91c5">Spell info not found.</div>'),ml=u('<div class="attack-notes svelte-14o91c5"><label class="svelte-14o91c5">Notes</label> <textarea placeholder="e.g., DC 15 Dex save, Range 120 ft, Concentration" class="notes-input svelte-14o91c5" rows="2"></textarea></div>'),hl=u('<button class="btn btn-primary">Roll Attack</button>'),_l=u('<button class="btn btn-info">Cast Spell</button>'),yl=u("<button><!></button>"),kl=u('<button class="btn btn-primary">Roll Attack</button> <button class="btn btn-secondary">Roll Damage</button>',1),Sl=u('<div class="attack-card svelte-14o91c5"><div class="attack-header svelte-14o91c5"><!> <!></div> <div class="attack-details svelte-14o91c5"><!> <!> <div class="attack-field svelte-14o91c5"><label class="svelte-14o91c5">Type</label> <input type="text" placeholder="e.g., slashing" class="attack-type svelte-14o91c5"/></div></div> <!> <!> <div class="attack-actions svelte-14o91c5"><!></div></div>'),$l=u('<p class="no-attacks svelte-14o91c5">No attacks added yet. Click "Add Attack" to create one.</p>'),xl=u('<p class="no-attacks svelte-14o91c5">No attacks match your search.</p>'),Cl=u('<button class="btn-remove svelte-14o91c5">Ã—</button>'),Ll=u('<div class="state-card svelte-14o91c5"><div class="state-header svelte-14o91c5"><input type="text" placeholder="Effect name (e.g., Magic Weapon)" class="state-name svelte-14o91c5"/> <!></div> <div class="state-details svelte-14o91c5"><div class="state-field svelte-14o91c5"><label class="svelte-14o91c5">Attack Bonus</label> <input type="number" class="state-bonus svelte-14o91c5"/></div> <div class="state-field svelte-14o91c5"><label class="svelte-14o91c5">Damage Bonus</label> <input type="text" class="state-bonus svelte-14o91c5"/></div></div> <div class="state-description svelte-14o91c5"><label class="svelte-14o91c5">Description</label> <input type="text" placeholder="e.g., +1 to attack and damage rolls (Magic Weapon)" class="state-desc-input svelte-14o91c5"/></div></div>'),wl=u('<div class="states-list svelte-14o91c5"></div>'),Dl=u('<p class="no-states svelte-14o91c5">No active effects. Add spell effects that modify your attacks.</p>'),jl=u('<!> <div class="attacks-list svelte-14o91c5"><!> <!></div> <div class="active-states-section svelte-14o91c5"><h3 class="svelte-14o91c5">Active Spell Effects</h3> <p class="section-description svelte-14o91c5">Effects that modify attack and damage rolls (e.g., Magic Weapon, Bless)</p> <button class="btn btn-secondary">Add Effect</button> <!></div>',1),Al=u("<section><!> <!></section>");function Fl(a,n){Bt(n,!1);const t=()=>Ze(X,"$character",D),d=()=>Ze(oa,"$abilityModifiers",D),p=()=>Ze(Qt,"$searchFilter",D),b=()=>Ze(Dt,"$collapsedStates",D),x=()=>Ze(ta,"$isEditMode",D),[D,k]=Ut(),M=B(),Z=B(),z=Zt();let U=B({});function ke(g){fa(U,e(U)[g]=!e(U)[g]),c(U,{...e(U)})}function be(g){return g.description.toLowerCase().includes("regain")&&(g.description.toLowerCase().includes("hit point")||g.description.toLowerCase().includes("hp"))}function se(){X.update(g=>(g.attacks=[...g.attacks,{id:crypto.randomUUID(),name:"",bonus:0,damage:"",damageType:"",notes:""}],g))}function pe(g){X.update(C=>(C.attacks=C.attacks.filter(W=>W.id!==g),C))}function J(g){let C=g.damage,W=!1,I=!1;if(g.spellRef){const Y=ee(g.spellRef);if(Y&&(I=Sa(Y),Y.level>0)){const Fe=g.castAtLevel||Y.level;if(!le(Fe)){Et.add(`No level ${Fe} spell slots available!`,"error");return}const Te=ua(Y);Te&&g.targetSucceededSave&&Te.noDamageOnSave?C="0":(W=Te?.halfDamageOnSave&&g.targetSucceededSave||!1,C=oe(g,Y))}}else if(t().activeStates&&t().activeStates.length>0){let Y=0,Fe=[];for(const Me of t().activeStates)typeof Me.damageBonus=="string"?Fe.push(Me.damageBonus):typeof Me.damageBonus=="number"&&(Y+=Me.damageBonus);if((Y!==0||Fe.length>0)&&C){const Me=C.match(/(\d+d\d+)([+-]\d+)?/);if(Me){const[,Te,et]=Me,te=(et?parseInt(et):0)+Y;let _=`${Te}`;te!==0&&(_+=`${te>=0?"+":""}${te}`),Fe.length>0&&(_+=" + "+Fe.join(" + ")),C=_}}}const N=[];let xe=0;if(I){const Y=Ia(t(),d()),Fe=t().proficiencyBonus||0;N.push({value:Fe,source:"proficiency"}),N.push({value:Y,source:"spellcasting"}),xe=Fe+Y}else g.bonus!==0&&N.push({value:g.bonus,source:"base"}),xe=g.bonus;if(t().activeStates)for(const Y of t().activeStates)typeof Y.attackBonus=="number"&&Y.attackBonus!==0&&(N.push({value:Y.attackBonus,source:Y.name.toLowerCase()}),xe+=Y.attackBonus);let Ke;Ke=`1d20${xe>=0?"+":""}${xe}`,z("roll",{notation:Ke,damageNotation:C,attackName:g.name,applyHalfDamage:W,bonusBreakdown:N})}function We(g){if(!g.damage){Et.add(`${g.name}: No damage specified`,"error");return}let C=g.damage,W=!1;const I=[];if(g.spellRef){const N=ee(g.spellRef);if(N&&N.level>0){const xe=g.castAtLevel||N.level;if(!le(xe)){Et.add(`No level ${xe} spell slots available!`,"error");return}const Y=ua(N);Y&&g.targetSucceededSave&&Y.noDamageOnSave?C="0":(W=Y?.halfDamageOnSave&&g.targetSucceededSave||!1,C=oe(g,N))}}else{const N=C.match(/(\d+d\d+)([+-]\d+)?/);if(N){const[,xe,Ke]=N,Y=Ke?parseInt(Ke):0;if(Y!==0&&I.push({value:Y,source:"base"}),t().activeStates&&t().activeStates.length>0){let Fe=0,Me=[];for(const Te of t().activeStates)typeof Te.damageBonus=="string"?Me.push(Te.damageBonus):typeof Te.damageBonus=="number"&&Te.damageBonus!==0&&(I.push({value:Te.damageBonus,source:Te.name.toLowerCase()}),Fe+=Te.damageBonus);if(Fe!==0||Me.length>0){const Te=Y+Fe;let et=`${xe}`;Te!==0&&(et+=`${Te>=0?"+":""}${Te}`),Me.length>0&&(et+=" + "+Me.join(" + ")),C=et}}}}z("roll",{notation:C,attackName:g.name,applyHalfDamage:W,bonusBreakdown:I})}let K=B([]),re=B(!1);na(async()=>{c(K,await Va()),c(re,!0)});function ee(g){return e(K).find(C=>C.name===g)}function le(g){t().classFeatures.spellSlotsByLevel||ct(X,i(t).classFeatures.spellSlotsByLevel={},i(t)),t().classFeatures.spellSlotsByLevel[g]||ct(X,i(t).classFeatures.spellSlotsByLevel[g]=Array(2).fill(!1),i(t));const W=t().classFeatures.spellSlotsByLevel[g].findIndex(I=>!I);return W===-1?!1:(X.update(I=>(I.classFeatures.spellSlotsByLevel||(I.classFeatures.spellSlotsByLevel={}),I.classFeatures.spellSlotsByLevel[g]||(I.classFeatures.spellSlotsByLevel[g]=Array(2).fill(!1)),I.classFeatures.spellSlotsByLevel[g][W]=!0,I)),!0)}function oe(g,C){let W=g.damage,I=0,N=0;if(Js(C)&&(N+=Ia(t(),d())),t().activeStates)for(const te of t().activeStates)typeof te.damageBonus=="number"&&(N+=te.damageBonus);if(C.higherLevelSlot&&g.castAtLevel){const te=C.level,v=(g.castAtLevel||te)-te;if(v>0){const ce=C.higherLevelSlot.match(/(\d+)d(\d+)\s+for\s+each.*?level\s+above/i);if(ce){const[,ne]=ce;I+=v*parseInt(ne)}}}if(g.targetIsFiendOrUndead&&C.description.includes("Fiend or an Undead")){const te=C.description.match(/increases by (\d+)d(\d+) if.*?Fiend or.*?Undead/i);if(te){const[,_]=te;I+=parseInt(_)}}const xe=W.match(/(\d+)d(\d+)([+-]\d+)?/);if(!xe)return N!==0?N>=0?`${N}`:`${N}`:W||"0";const[,Ke,Y,Fe]=xe,Me=parseInt(Ke)+I,et=(Fe?parseInt(Fe):0)+N;let ot=`${Me}d${Y}`;return et!==0&&(ot+=et>=0?`+${et}`:`${et}`),ot}function Ie(g){const C=[];for(let I=g.level;I<=9;I++){const N=t().classFeatures.spellSlotsByLevel?.[I];N&&N.length>0&&C.push(I)}return C}function Oe(){X.update(g=>(g.activeStates||(g.activeStates=[]),g.activeStates=[...g.activeStates,{name:"",attackBonus:0,damageBonus:0,description:""}],g))}function Se(g){X.update(C=>(C.activeStates&&(C.activeStates=C.activeStates.filter((W,I)=>I!==g)),C))}function $e(g){const C=ee(g.spellRef);if(!C){Et.add("Spell not found","error");return}const W=g.castAtLevel||C.level;if(W>0&&!le(W)){Et.add(`No level ${W} spell slots available!`,"error");return}const I=Vs(C);if(!I){Et.add(`${C.name} cast! Check spell description for effects.`,"info");return}X.update(N=>(N.activeStates||(N.activeStates=[]),N.activeStates=N.activeStates.filter(xe=>xe.name!==C.name),N.activeStates=[...N.activeStates,{name:C.name,attackBonus:I.attackBonus,damageBonus:I.damageBonus,acBonus:I.acBonus,description:I.description}],N)),Et.add(`${C.name} cast! Effect added to Active Spell Effects.`,"success")}Xe(()=>(t(),e(U)),()=>{if(t()&&t().attacks)for(const g of t().attacks)g.spellRef&&e(U)[g.id]===void 0&&fa(U,e(U)[g.id]=!0)}),Xe(()=>(t(),p()),()=>{c(M,t().attacks.filter(g=>{if(!p())return!0;const C=p().toLowerCase();return g.name.toLowerCase().includes(C)||g.damageType.toLowerCase().includes(C)}).sort((g,C)=>!g.spellRef&&C.spellRef?-1:g.spellRef&&!C.spellRef?1:0))}),Xe(()=>(p(),e(M)),()=>{c(Z,!p()||e(M).length>0||"attack".includes(p().toLowerCase())||"spell".includes(p().toLowerCase()))}),Wt(),Ft();var L=Al();let ue;var m=r(L);{let g=st(()=>(b(),i(()=>b().attacks?"Expand":"Collapse")));ea(m,{title:"Attacks & Spells",get collapsed(){return b(),i(()=>b().attacks)},get ariaLabel(){return e(g)},onToggle:()=>Dt.update(C=>({...C,attacks:!C.attacks}))})}var R=s(m,2);{var ie=g=>{var C=jl(),W=Pe(C);{var I=_=>{var v=Qs();F("click",v,se),o(_,v)};y(W,_=>{x()&&_(I)})}var N=s(W,2),xe=r(N);ut(xe,1,()=>e(M),_=>_.id,(_,v,ce)=>{var ne=Sl(),Ce=r(ne),Ee=r(Ce);{var He=E=>{var P=Ys();we(P),Re(P,()=>e(v).name,he=>(e(v).name=he,Lt(()=>(e(M),t(),p())))),o(E,P)},T=E=>{var P=Xs(),he=r(P,!0);l(P),A(()=>w(he,(e(v),i(()=>e(v).name||"(Unnamed Attack)")))),o(E,P)};y(Ee,E=>{x()?E(He):E(T,!1)})}var h=s(Ee,2);{var fe=E=>{var P=Zs();F("click",P,()=>pe(e(v).id)),o(E,P)};y(h,E=>{x()&&E(fe)})}l(Ce);var De=s(Ce,2),qe=r(De);{var Qe=E=>{var P=el(),he=r(P),G=s(he,2);we(G),l(P),A(()=>{ze(he,"for",`attack-bonus-${e(v),i(()=>e(v).id)??""}`),ze(G,"id",`attack-bonus-${e(v),i(()=>e(v).id)??""}`)}),Re(G,()=>e(v).bonus,je=>(e(v).bonus=je,Lt(()=>(e(M),t(),p())))),o(E,P)};y(qe,E=>{e(v),i(()=>e(v).bonus!==0&&e(v).bonus!==void 0)&&E(Qe)})}var _e=s(qe,2);{var me=E=>{var P=tl(),he=r(P),G=s(he,2);we(G),l(P),A(()=>{ze(he,"for",`attack-damage-${e(v),i(()=>e(v).id)??""}`),ze(G,"id",`attack-damage-${e(v),i(()=>e(v).id)??""}`)}),Re(G,()=>e(v).damage,je=>(e(v).damage=je,Lt(()=>(e(M),t(),p())))),o(E,P)};y(_e,E=>{e(v),i(()=>e(v).damage&&e(v).damage.trim()!=="")&&E(me)})}var Le=s(_e,2),Ue=r(Le),Be=s(Ue,2);we(Be),l(Le),l(De);var Ne=s(De,2);{var ve=E=>{var P=rt(),he=Pe(P);{var G=Ae=>{var O=al();o(Ae,O)},je=Ae=>{const O=st(()=>(e(v),i(()=>ee(e(v).spellRef))));var lt=rt(),ht=Pe(lt);{var kt=$=>{const q=st(()=>(H(ua),H(e(O)),i(()=>ua(e(O)))));var f=gl(),ae=Pe(f),Q=r(ae),Je=s(r(Q),2),ye=r(Je,!0);l(Je),l(Q);var Ye=s(Q,2);{var Ve=it=>{var nt=ll(),Rt=r(nt),It=s(r(Rt));l(Rt);var Ht=s(Rt,2),zt=s(r(Ht));l(Ht);var $t=s(Ht,2),Nt=s(r($t));l($t);var gt=s($t,2),xt=s(r(gt)),at=s(xt);{var _t=bt=>{var yt=wt();A(()=>w(yt,`(${H(e(O)),i(()=>e(O).material)??""})`)),o(bt,yt)};y(at,bt=>{H(e(O)),i(()=>e(O).material)&&bt(_t)})}l(gt);var qt=s(gt,2),Kt=s(r(qt),2);{var Yt=bt=>{var yt=wt("Concentration,");o(bt,yt)};y(Kt,bt=>{H(e(O)),i(()=>e(O).concentration)&&bt(Yt)})}var St=s(Kt,1,!0);l(qt);var At=s(qt,2),Ct=s(r(At));l(At);var Gt=s(At,2);{var Jt=bt=>{var yt=sl(),Ot=s(r(yt));l(yt),A(()=>w(Ot,` ${H(e(O)),i(()=>e(O).higherLevelSlot)??""}`)),o(bt,yt)};y(Gt,bt=>{H(e(O)),i(()=>e(O).higherLevelSlot)&&bt(Jt)})}l(nt),A(bt=>{w(It,` ${H(e(O)),i(()=>e(O).level)??""}`),w(zt,` ${H(e(O)),i(()=>e(O).castingTime||e(O).actionType)??""}`),w(Nt,` ${H(e(O)),i(()=>e(O).range)??""}`),w(xt,` ${bt??""}`),w(St,(H(e(O)),i(()=>e(O).duration))),w(Ct,` ${H(e(O)),i(()=>e(O).description)??""}`)},[()=>(H(e(O)),i(()=>e(O).components.join(", ")))]),o(it,nt)};y(Ye,it=>{e(U),e(v),i(()=>!e(U)[e(v).id])&&it(Ve)})}l(ae);var tt=s(ae,2);{var vt=it=>{var nt=ol(),Rt=r(nt),It=r(Rt);we(It);var Ht=s(It),zt=s(Ht);{var $t=at=>{var _t=rl(),qt=r(_t);l(_t),A(Kt=>w(qt,`(Spell Save DC: ${Kt??""})`),[()=>(H(wa),t(),d(),i(()=>wa(t(),d())))]),o(at,_t)};y(zt,at=>{t(),i(()=>t().class)&&at($t)})}var Nt=s(zt,2);{var gt=at=>{var _t=il();o(at,_t)},xt=at=>{var _t=rt(),qt=Pe(_t);{var Kt=Yt=>{var St=nl();o(Yt,St)};y(qt,Yt=>{e(v),H(e(q)),i(()=>e(v).targetSucceededSave&&e(q).noDamageOnSave)&&Yt(Kt)},!0)}o(at,_t)};y(Nt,at=>{e(v),H(e(q)),i(()=>e(v).targetSucceededSave&&e(q).halfDamageOnSave)?at(gt):at(xt,!1)})}l(Rt),l(nt),A(at=>w(Ht,` Target succeeded on ${at??""} save `),[()=>(H(e(q)),i(()=>e(q).ability.charAt(0).toUpperCase()+e(q).ability.slice(1)))]),Ca(It,()=>e(v).targetSucceededSave,at=>(e(v).targetSucceededSave=at,Lt(()=>(e(M),t(),p())))),o(it,nt)};y(tt,it=>{e(q)&&it(vt)})}var Tt=s(tt,2);{var jt=it=>{const nt=st(()=>(H(e(O)),i(()=>Ie(e(O)))));var Rt=rt(),It=Pe(Rt);{var Ht=$t=>{var Nt=pl(),gt=Pe(Nt),xt=r(gt),at=s(xt,2);A(()=>{e(v),Lt(()=>{e(nt)})}),ut(at,5,()=>e(nt),ft,(St,At)=>{var Ct=cl(),Gt=r(Ct);l(Ct);var Jt={};A(()=>{w(Gt,`Level ${e(At)??""}`),Jt!==(Jt=e(At))&&(Ct.value=(Ct.__value=e(At))??"")}),o(St,Ct)}),l(at);var _t=s(at,2);{var qt=St=>{const At=st(()=>(e(v),H(e(O)),i(()=>oe(e(v),e(O)))));var Ct=vl(),Gt=r(Ct);{var Jt=Ot=>{var Xt=wt("Healing");o(Ot,Xt)},bt=Ot=>{var Xt=wt("Damage");o(Ot,Xt)};y(Gt,Ot=>{H(e(O)),i(()=>be(e(O)))?Ot(Jt):Ot(bt,!1)})}var yt=s(Gt);l(Ct),A(()=>w(yt,` ${e(At)??""}`)),o(St,Ct)};y(_t,St=>{e(v),H(e(O)),i(()=>e(v).castAtLevel&&e(v).castAtLevel>e(O).level)&&St(qt)})}l(gt);var Kt=s(gt,2);{var Yt=St=>{var At=ul(),Ct=r(At),Gt=r(Ct);we(Gt);var Jt=s(Gt,2);{var bt=yt=>{const Ot=st(()=>(e(v),H(e(O)),i(()=>oe(e(v),e(O)))));var Xt=dl(),Qa=r(Xt);l(Xt),A(()=>w(Qa,`(+1d8, total: ${e(Ot)??""})`)),o(yt,Xt)};y(Jt,yt=>{e(v),i(()=>e(v).targetIsFiendOrUndead)&&yt(bt)})}l(Ct),l(At),Ca(Gt,()=>e(v).targetIsFiendOrUndead,yt=>(e(v).targetIsFiendOrUndead=yt,Lt(()=>(e(M),t(),p())))),o(St,At)};y(Kt,St=>{H(e(O)),i(()=>e(O).description.includes("Fiend or an Undead"))&&St(Yt)})}A(()=>{ze(xt,"for",`castLevel-${e(v),i(()=>e(v).id)??""}`),ze(at,"id",`castLevel-${e(v),i(()=>e(v).id)??""}`)}),za(at,()=>e(v).castAtLevel,St=>(e(v).castAtLevel=St,Lt(()=>(e(M),t(),p())))),o($t,Nt)},zt=$t=>{var Nt=fl();o($t,Nt)};y(It,$t=>{H(e(nt)),i(()=>e(nt).length>0)?$t(Ht):$t(zt,!1)})}o(it,Rt)};y(Tt,it=>{H(e(O)),i(()=>e(O).higherLevelSlot&&e(O).level>0)&&it(jt)})}A(()=>{ze(Je,"aria-label",(e(U),e(v),i(()=>e(U)[e(v).id]?"Expand":"Collapse"))),w(ye,(e(U),e(v),i(()=>e(U)[e(v).id]?"â–¼":"â–²")))}),F("click",Q,()=>ke(e(v).id)),F("keydown",Q,it=>it.key==="Enter"&&ke(e(v).id)),o($,f)},dt=$=>{var q=bl();o($,q)};y(ht,$=>{e(O)?$(kt):$(dt,!1)})}o(Ae,lt)};y(he,Ae=>{e(K),i(()=>e(K).length===0)?Ae(G):Ae(je,!1)})}o(E,P)};y(Ne,E=>{e(v),i(()=>e(v).spellRef)&&E(ve)})}var V=s(Ne,2);{var Ge=E=>{var P=ml(),he=r(P),G=s(he,2);ra(G),l(P),A(()=>{ze(he,"for",`attack-notes-${e(v),i(()=>e(v).id)??""}`),ze(G,"id",`attack-notes-${e(v),i(()=>e(v).id)??""}`)}),Re(G,()=>e(v).notes,je=>(e(v).notes=je,Lt(()=>(e(M),t(),p())))),o(E,P)};y(V,E=>{e(v),i(()=>!e(v).spellRef)&&E(Ge)})}var S=s(V,2),j=r(S);{var de=E=>{const P=st(()=>(e(v),i(()=>ee(e(v).spellRef))));var he=rt(),G=Pe(he);{var je=Ae=>{var O=rt(),lt=Pe(O);{var ht=dt=>{var $=hl();F("click",$,()=>J(e(v))),o(dt,$)},kt=dt=>{var $=rt(),q=Pe($);{var f=Q=>{var Je=_l();F("click",Je,()=>$e(e(v))),o(Q,Je)},ae=Q=>{var Je=yl(),ye=r(Je);{var Ye=tt=>{var vt=wt("Roll Healing");o(tt,vt)},Ve=tt=>{var vt=wt("Roll Damage");o(tt,vt)};y(ye,tt=>{H(e(P)),i(()=>be(e(P)))?tt(Ye):tt(Ve,!1)})}l(Je),A(tt=>pt(Je,1,`btn ${tt??""}`),[()=>(H(e(P)),i(()=>be(e(P))?"btn-success":"btn-secondary"))]),F("click",Je,()=>We(e(v))),o(Q,Je)};y(q,Q=>{H(Pa),H(e(P)),i(()=>Pa(e(P)))?Q(f):Q(ae,!1)},!0)}o(dt,$)};y(lt,dt=>{H(Sa),H(e(P)),i(()=>Sa(e(P)))?dt(ht):dt(kt,!1)})}o(Ae,O)};y(G,Ae=>{e(P)&&Ae(je)})}o(E,he)},ge=E=>{var P=rt(),he=Pe(P);{var G=je=>{var Ae=kl(),O=Pe(Ae),lt=s(O,2);F("click",O,()=>J(e(v))),F("click",lt,()=>We(e(v))),o(je,Ae)};y(he,je=>{e(v),i(()=>!e(v).spellRef)&&je(G)},!0)}o(E,P)};y(j,E=>{e(v),e(re),i(()=>e(v).spellRef&&e(re))?E(de):E(ge,!1)})}l(S),l(ne),A(()=>{ze(Ue,"for",`attack-type-${e(v),i(()=>e(v).id)??""}`),ze(Be,"id",`attack-type-${e(v),i(()=>e(v).id)??""}`)}),Re(Be,()=>e(v).damageType,E=>(e(v).damageType=E,Lt(()=>(e(M),t(),p())))),o(_,ne)});var Ke=s(xe,2);{var Y=_=>{var v=$l();o(_,v)},Fe=_=>{var v=rt(),ce=Pe(v);{var ne=Ce=>{var Ee=xl();o(Ce,Ee)};y(ce,Ce=>{e(M),i(()=>e(M).length===0)&&Ce(ne)},!0)}o(_,v)};y(Ke,_=>{t(),i(()=>t().attacks.length===0)?_(Y):_(Fe,!1)})}l(N);var Me=s(N,2),Te=s(r(Me),4),et=s(Te,2);{var ot=_=>{var v=wl();ut(v,5,()=>(t(),i(()=>t().activeStates)),ft,(ce,ne,Ce)=>{var Ee=Ll(),He=r(Ee),T=r(He);we(T);var h=s(T,2);{var fe=V=>{var Ge=Cl();F("click",Ge,()=>Se(Ce)),o(V,Ge)};y(h,V=>{x()&&V(fe)})}l(He);var De=s(He,2),qe=r(De),Qe=r(qe);ze(Qe,"for",`state-attack-bonus-${Ce}`);var _e=s(Qe,2);we(_e),ze(_e,"id",`state-attack-bonus-${Ce}`),l(qe);var me=s(qe,2),Le=r(me);ze(Le,"for",`state-damage-bonus-${Ce}`);var Ue=s(Le,2);we(Ue),ze(Ue,"id",`state-damage-bonus-${Ce}`),l(me),l(De);var Be=s(De,2),Ne=r(Be);ze(Ne,"for",`state-desc-${Ce}`);var ve=s(Ne,2);we(ve),ze(ve,"id",`state-desc-${Ce}`),l(Be),l(Ee),Re(T,()=>e(ne).name,V=>(e(ne).name=V,Lt(()=>t()),ca(D,"$character"))),Re(_e,()=>e(ne).attackBonus,V=>(e(ne).attackBonus=V,Lt(()=>t()),ca(D,"$character"))),Re(Ue,()=>e(ne).damageBonus,V=>(e(ne).damageBonus=V,Lt(()=>t()),ca(D,"$character"))),Re(ve,()=>e(ne).description,V=>(e(ne).description=V,Lt(()=>t()),ca(D,"$character"))),o(ce,Ee)}),l(v),o(_,v)},te=_=>{var v=Dl();o(_,v)};y(et,_=>{t(),i(()=>t().activeStates&&t().activeStates.length>0)?_(ot):_(te,!1)})}l(Me),F("click",Te,Oe),o(g,C)};y(R,g=>{b(),i(()=>!b().attacks)&&g(ie)})}l(L),A(()=>ue=pt(L,1,"attacks svelte-14o91c5",null,ue,{hidden:!e(Z)})),o(a,L),Mt(),k()}var Bl=u('<span class="slot-checkbox-x svelte-serp1j">&#8212;</span>'),Ml=u('<label><input type="checkbox" class="slot-checkbox-input svelte-serp1j"/> <span><!></span></label>');function Ta(a,n){Bt(n,!1);const t=()=>Ze(ta,"$isEditMode",d),[d,p]=Ut();let b=mt(n,"checked",8,!1),x=mt(n,"disabled",8,!1),D=mt(n,"className",8,""),k=mt(n,"index",8,void 0),M=mt(n,"ariaLabel",8,void 0);const Z=Zt();function z(J){Z("change",{checked:J.currentTarget.checked,index:k()})}Ft();var U=Ml(),ke=r(U);we(ke);var be=s(ke,2),se=r(be);{var pe=J=>{var We=Bl();o(J,We)};y(se,J=>{b()&&J(pe)})}l(be),l(U),A(()=>{pt(U,1,"slot-checkbox-label "+D()+(t()?"":" not-editable"),"svelte-serp1j"),Ka(ke,b()),ke.disabled=x()||!t(),ze(ke,"aria-label",M()),ze(ke,"tabindex",t()?0:-1),pt(be,1,`slot-checkbox-custom ${b()?"used":""} ${t()?"":"readonly"}`,"svelte-serp1j")}),F("change",ke,z),o(a,U),Mt(),p()}var Rl=u('<p class="no-features svelte-1kpvv0n">Select a class to see available features</p>'),Il=u('<p class="no-features svelte-1kpvv0n">No class features available at this level</p>'),El=u('<div class="spell-slots svelte-1kpvv0n"><label class="svelte-1kpvv0n"> </label> <div class="slots-tracker svelte-1kpvv0n"></div></div>'),Pl=u('<div class="all-spell-slots"></div>'),Tl=u('<div class="feature-box spellcasting svelte-1kpvv0n"><h3 class="svelte-1kpvv0n"> </h3> <div class="spell-stats svelte-1kpvv0n"><div class="spell-stat svelte-1kpvv0n"><label class="svelte-1kpvv0n">Spell Save DC</label> <div class="spell-value svelte-1kpvv0n"> </div></div> <div class="spell-stat svelte-1kpvv0n"><label class="svelte-1kpvv0n">Prepared Spells</label> <div class="spell-value svelte-1kpvv0n"> </div></div></div> <!> <div class="prepared-spells svelte-1kpvv0n"><label class="svelte-1kpvv0n">Prepared Spells</label> <textarea placeholder="List your prepared spells..." class="svelte-1kpvv0n"></textarea></div></div>'),Hl=u('<p class="unlimited svelte-1kpvv0n">Unlimited Uses</p>'),Ul=u('<div class="slots-tracker svelte-1kpvv0n"></div> <div class="uses-actions-row"><button class="btn btn-primary use-enabled"> </button></div> <div class="uses-info svelte-1kpvv0n"><span class="reset-info svelte-1kpvv0n"> </span></div>',1),Nl=u('<div class="uses-tracker svelte-1kpvv0n"><!></div>'),Gl=u('<div class="pool-tracker svelte-1kpvv0n"><input type="number" min="0" class="pool-input svelte-1kpvv0n"/> <span> </span> <button class="btn-small svelte-1kpvv0n"> </button></div>'),Ol=u('<p class="no-uses svelte-1kpvv0n">No Channel Divinity uses remaining</p>'),ql=u('<div class="channel-divinity-option svelte-1kpvv0n"><button class="btn btn-primary use-enabled svelte-1kpvv0n">Use Channel Divinity</button> <div class="uses-info svelte-1kpvv0n"><span class="reset-info svelte-1kpvv0n"> </span></div> <!></div>'),Wl=u('<div class="feature-box svelte-1kpvv0n"><h3 class="svelte-1kpvv0n"><!> </h3> <p class="feature-description svelte-1kpvv0n"> </p> <!></div>'),zl=u('<div class="features-grid svelte-1kpvv0n"><!> <!></div>'),Kl=u("<section><!> <!></section>");function Jl(a,n){Bt(n,!1);const t=()=>Ze(X,"$character",x),d=()=>Ze(oa,"$abilityModifiers",x),p=()=>Ze(Qt,"$searchFilter",x),b=()=>Ze(Dt,"$collapsedStates",x),[x,D]=Ut(),k=B(),M=B(),Z=B(),z=B(),U=B(),ke=B(),be=B();let se=B(0),pe=B(0);function J(m,R){X.update(ie=>(ie.classFeatures.features[m]=R,ie))}function We(){X.update(m=>(m.classFeatures.spellSlotsByLevel||(m.classFeatures.spellSlotsByLevel={}),e(z).forEach(({level:R,slots:ie})=>{m.classFeatures.spellSlotsByLevel[R]||(m.classFeatures.spellSlotsByLevel[R]=Array(ie).fill(!1))}),m))}function K(m){if(typeof m.maxUses=="function"){if((m.name==="Divine Sense"||m.name==="War Priest")&&e(k)?.spellcastingAbility){const R=d()[e(k).spellcastingAbility];return m.maxUses(t().level,R)}return m.maxUses(t().level)}return m.maxUses||0}function re(m,R){X.update(ie=>((!ie.classFeatures.features[m]||!Array.isArray(ie.classFeatures.features[m])||ie.classFeatures.features[m].length!==R)&&(ie.classFeatures.features[m]=Array(R).fill(!1)),ie))}Ya(()=>{e(ke)&&t()&&t().classFeatures&&t().classFeatures.features&&e(ke).forEach(m=>{if(m.type==="uses"){const R=m.name.replace(/\s+/g,""),ie=K(m),g=t().classFeatures.features[R];(!Array.isArray(g)||g.length!==ie)&&re(R,ie)}})});function ee(m){return typeof m.maxPool=="function"?m.maxPool(t().level):m.maxPool||0}function le(m){return typeof m.description=="function"?m.description(t().level):m.description}function oe(){const m="ChannelDivinity";X.update(R=>{const ie=R.classFeatures.features[m];return typeof ie=="number"&&ie>0&&(R.classFeatures.features[m]=ie-1),R})}function Ie(){Dt.update(m=>({...m,classFeatures:!m.classFeatures}))}Xe(()=>(t(),Pt),()=>{c(k,t().class?Pt(t().class):null)}),Xe(()=>(t(),sa),()=>{c(M,t().class?sa(t().class,t().level,t().subclass):[])}),Xe(()=>(t(),Ma),()=>{c(Z,t().class?Ma(t().class,t().level):0)}),Xe(()=>(e(k),t()),()=>{c(z,(()=>{if(!e(k)?.spellcaster)return[];const m=t().level,R=[];return m>=1&&R.push({level:1,slots:Math.min(4,2+Math.floor(m/3))}),m>=3&&R.push({level:2,slots:Math.min(3,2+Math.floor((m-3)/4))}),m>=5&&R.push({level:3,slots:Math.min(3,2+Math.floor((m-5)/5))}),m>=7&&R.push({level:4,slots:Math.min(3,1+Math.floor((m-7)/6))}),m>=9&&R.push({level:5,slots:Math.min(2,1+Math.floor((m-9)/8))}),m>=11&&R.push({level:6,slots:1}),m>=13&&R.push({level:7,slots:1}),m>=15&&R.push({level:8,slots:1}),m>=17&&R.push({level:9,slots:1}),R})())}),Xe(()=>(e(k),d(),t(),Ra),()=>{if(e(k)?.spellcaster&&e(k).spellcastingAbility){const m=d()[e(k).spellcastingAbility];c(se,ks(t().class,m,t().proficiencyBonus)||0),c(pe,Ra(t().class,t().level,m))}}),Xe(()=>(t(),e(k),e(z)),()=>{t().class&&e(k)?.spellcaster&&e(z).length>0&&We()}),Xe(()=>t(),()=>{c(U,(()=>{const R=t().classFeatures.features["ChannelDivinity"];return typeof R=="number"?R:0})())}),Xe(()=>(e(M),p()),()=>{c(ke,e(M).filter(m=>{if(!p())return!0;const R=p().toLowerCase();return m.name.toLowerCase().includes(R)||le(m).toLowerCase().includes(R)}))}),Xe(()=>(p(),t(),e(ke)),()=>{c(be,!p()||t().class||"class features".includes(p().toLowerCase())||"spellcasting".includes(p().toLowerCase())||e(ke).length>0)}),Wt(),Ft();var Oe=Kl();let Se;var $e=r(Oe);{let m=st(()=>(b(),i(()=>b().classFeatures?"Expand":"Collapse")));ea($e,{title:"Class Features",get collapsed(){return b(),i(()=>b().classFeatures)},get ariaLabel(){return e(m)},onToggle:Ie})}var L=s($e,2);{var ue=m=>{var R=rt(),ie=Pe(R);{var g=W=>{var I=Rl();o(W,I)},C=W=>{var I=rt(),N=Pe(I);{var xe=Y=>{var Fe=Il();o(Y,Fe)},Ke=Y=>{var Fe=zl(),Me=r(Fe);{var Te=ot=>{var te=Tl(),_=r(te),v=r(_);l(_);var ce=s(_,2),ne=r(ce),Ce=s(r(ne),2),Ee=r(Ce,!0);l(Ce),l(ne);var He=s(ne,2),T=s(r(He),2),h=r(T,!0);l(T),l(He),l(ce);var fe=s(ce,2);{var De=_e=>{var me=Pl();ut(me,5,()=>e(z),ft,(Le,Ue)=>{let Be=()=>e(Ue).level,Ne=()=>e(Ue).slots;const ve=st(()=>(t(),Be(),Ne(),i(()=>t().classFeatures.spellSlotsByLevel?.[Be()]||Array(Ne()).fill(!1))));var V=El(),Ge=r(V),S=r(Ge);l(Ge);var j=s(Ge,2);ut(j,5,()=>e(ve),ft,(de,ge,E)=>{{let P=st(()=>(H(e(ve)),i(()=>e(ve)[E]||!1)));Ta(de,{get checked(){return e(P)},$$events:{change:he=>{X.update(G=>(G.classFeatures.spellSlotsByLevel||(G.classFeatures.spellSlotsByLevel={}),G.classFeatures.spellSlotsByLevel[Be()]||(G.classFeatures.spellSlotsByLevel[Be()]=Array(Ne()).fill(!1)),G.classFeatures.spellSlotsByLevel[Be()][E]=he.detail.checked,G))}}})}}),l(j),l(V),A(()=>w(S,`${Be()===1?"1st":Be()===2?"2nd":Be()===3?"3rd":`${Be()}th`} Level Spell Slots`)),o(Le,V)}),l(me),o(_e,me)};y(fe,_e=>{e(z),i(()=>e(z).length>0)&&_e(De)})}var qe=s(fe,2),Qe=s(r(qe),2);ra(Qe),l(qe),l(te),A(_e=>{w(v,`Spellcasting (${_e??""})`),w(Ee,e(se)),w(h,e(pe))},[()=>(e(k),i(()=>e(k).spellcastingAbility?.toUpperCase()))]),Re(Qe,()=>t().classFeatures.preparedSpells,_e=>ct(X,i(t).classFeatures.preparedSpells=_e,i(t))),o(ot,te)};y(Me,ot=>{e(k),i(()=>e(k)?.spellcaster)&&ot(Te)})}var et=s(Me,2);ut(et,1,()=>e(ke),ft,(ot,te)=>{const _=st(()=>(e(te),i(()=>e(te).name.replace(/\s+/g,"")))),v=st(()=>(t(),H(e(_)),i(()=>t().classFeatures.features[e(_)]))),ce=st(()=>typeof e(v)=="number");var ne=Wl(),Ce=r(ne),Ee=r(Ce);{var He=_e=>{var me=wt("Channel Divinity:");o(_e,me)};y(Ee,_e=>{e(te),i(()=>e(te).type==="channelDivinity")&&_e(He)})}var T=s(Ee);l(Ce);var h=s(Ce,2),fe=r(h,!0);l(h);var De=s(h,2);{var qe=_e=>{const me=st(()=>(e(te),i(()=>K(e(te))))),Le=st(()=>(H(e(v)),H(e(me)),i(()=>Array.isArray(e(v))?e(v):Array(e(me)).fill(!1))));var Ue=Nl(),Be=r(Ue);{var Ne=V=>{var Ge=Hl();o(V,Ge)},ve=V=>{var Ge=Ul(),S=Pe(Ge);ut(S,5,()=>e(Le),ft,(G,je,Ae)=>{Ta(G,{get checked(){return e(je)},index:Ae,$$events:{change:O=>{X.update(lt=>(lt.classFeatures.features[e(_)]||(lt.classFeatures.features[e(_)]=Array(e(me)).fill(!1)),lt.classFeatures.features[e(_)][Ae]=O.detail.checked,lt))}}})}),l(S);var j=s(S,2),de=r(j),ge=r(de);l(de),l(j);var E=s(j,2),P=r(E),he=r(P);l(P),l(E),A(G=>{de.disabled=G,w(ge,`Use ${e(te),i(()=>e(te).name)??""}`),w(he,`Resets on ${e(te),i(()=>e(te).resetOn==="short"?"Short Rest":"Long Rest")??""}`)},[()=>(H(e(Le)),i(()=>e(Le).filter(G=>!G).length<=0))]),F("click",de,()=>{X.update(G=>{G.classFeatures.features[e(_)]||(G.classFeatures.features[e(_)]=Array(e(me)).fill(!1));const je=G.classFeatures.features[e(_)],Ae=je.findIndex(O=>!O);return Ae!==-1&&(je[Ae]=!0),G})}),o(V,Ge)};y(Be,V=>{e(me)===1/0?V(Ne):V(ve,!1)})}l(Ue),o(_e,Ue)},Qe=_e=>{var me=rt(),Le=Pe(me);{var Ue=Ne=>{const ve=st(()=>(e(te),i(()=>ee(e(te)))));var V=Gl(),Ge=r(V);we(Ge);var S=s(Ge,2),j=r(S);l(S);var de=s(S,2),ge=r(de,!0);l(de),l(V),A(()=>{ba(Ge,e(ce)&&e(v)!==void 0?e(v):e(ve)),ze(Ge,"max",e(ve)),w(j,`/ ${e(ve)??""}`),w(ge,(e(te),i(()=>e(te).resetOn==="short"?"Short Rest":"Long Rest")))}),F("input",Ge,E=>{X.update(P=>(P.classFeatures.features[e(_)]=parseInt(E.currentTarget.value)||0,P))}),F("click",de,()=>J(e(_),e(ve))),o(Ne,V)},Be=Ne=>{var ve=rt(),V=Pe(ve);{var Ge=S=>{var j=ql(),de=r(j),ge=s(de,2),E=r(ge),P=r(E);l(E),l(ge);var he=s(ge,2);{var G=je=>{var Ae=Ol();o(je,Ae)};y(he,je=>{e(U)<=0&&je(G)})}l(j),A(()=>{de.disabled=e(U)<=0,w(P,`Resets on ${e(te),i(()=>e(te).resetOn==="short"?"Short Rest":"Long Rest")??""}`)}),F("click",de,oe),o(S,j)};y(V,S=>{e(te),i(()=>e(te).type==="channelDivinity")&&S(Ge)},!0)}o(Ne,ve)};y(Le,Ne=>{e(te),i(()=>e(te).type==="pool")?Ne(Ue):Ne(Be,!1)},!0)}o(_e,me)};y(De,_e=>{e(te),i(()=>e(te).type==="uses")?_e(qe):_e(Qe,!1)})}l(ne),A(_e=>{w(T,` ${e(te),i(()=>e(te).name)??""}`),w(fe,_e)},[()=>(e(te),i(()=>le(e(te))))]),o(ot,ne)}),l(Fe),o(Y,Fe)};y(N,Y=>{e(M),i(()=>e(M).length===0)?Y(xe):Y(Ke,!1)},!0)}o(W,I)};y(ie,W=>{t(),i(()=>!t().class)?W(g):W(C,!1)})}o(m,R)};y(L,m=>{b(),i(()=>!b().classFeatures)&&m(ue)})}l(Oe),A(()=>Se=pt(Oe,1,"class-features svelte-1kpvv0n",null,Se,{hidden:!e(be)})),o(a,Oe),Mt(),D()}var Vl=u('<textarea placeholder="Enter features, traits, and special abilities..." class="svelte-wttn0l"></textarea> <h3 class="svelte-wttn0l">Equipment</h3> <textarea placeholder="List your equipment and inventory..." class="svelte-wttn0l"></textarea> <h3 class="svelte-wttn0l">Notes</h3> <textarea placeholder="Additional notes..." class="svelte-wttn0l"></textarea>',1),Ql=u("<section><!> <!></section>");function Yl(a,n){Bt(n,!1);const t=()=>Ze(Qt,"$searchFilter",b),d=()=>Ze(X,"$character",b),p=()=>Ze(Dt,"$collapsedStates",b),[b,x]=Ut(),D=B();function k(){Dt.update(be=>({...be,notes:!be.notes}))}Xe(()=>(t(),d()),()=>{c(D,!t()||"features".includes(t().toLowerCase())||"traits".includes(t().toLowerCase())||"equipment".includes(t().toLowerCase())||"notes".includes(t().toLowerCase())||d().features.toLowerCase().includes(t().toLowerCase())||d().equipment.toLowerCase().includes(t().toLowerCase())||d().notes.toLowerCase().includes(t().toLowerCase()))}),Wt(),Ft();var M=Ql();let Z;var z=r(M);{let be=st(()=>(p(),i(()=>p().notes?"Expand":"Collapse")));ea(z,{title:"Features & Traits",get collapsed(){return p(),i(()=>p().notes)},get ariaLabel(){return e(be)},onToggle:k})}var U=s(z,2);{var ke=be=>{var se=Vl(),pe=Pe(se);ra(pe);var J=s(pe,4);ra(J);var We=s(J,4);ra(We),Re(pe,()=>d().features,K=>ct(X,i(d).features=K,i(d))),Re(J,()=>d().equipment,K=>ct(X,i(d).equipment=K,i(d))),Re(We,()=>d().notes,K=>ct(X,i(d).notes=K,i(d))),o(be,se)};y(U,be=>{p(),i(()=>!p().notes)&&be(ke)})}l(M),A(()=>Z=pt(M,1,"notes svelte-wttn0l",null,Z,{hidden:!e(D)})),o(a,M),Mt(),x()}var Xl=u('<div class="color-picker-section svelte-1r90jgp"><h3 class="svelte-1r90jgp">Dice Colors</h3> <div class="color-inputs svelte-1r90jgp"><div class="color-input-group svelte-1r90jgp"><label for="dice-color" class="svelte-1r90jgp">Dice Color</label> <input type="color" id="dice-color" class="svelte-1r90jgp"/></div> <div class="color-input-group svelte-1r90jgp"><label for="label-color" class="svelte-1r90jgp">Label Color</label> <input type="color" id="label-color" class="svelte-1r90jgp"/></div> <div class="color-input-group svelte-1r90jgp"><label for="desk-color" class="svelte-1r90jgp">Background Color</label> <input type="color" id="desk-color" class="svelte-1r90jgp"/></div></div></div>'),Zl=u('<div class="loading svelte-1r90jgp"><p class="svelte-1r90jgp">Loading 3D dice...</p></div>'),er=u('<div class="custom-dice-selector svelte-1r90jgp"><h3 class="svelte-1r90jgp">Choose Dice to Roll</h3> <div class="dice-inputs svelte-1r90jgp"><div class="dice-input-group svelte-1r90jgp"><label for="d4" class="svelte-1r90jgp">d4</label> <input class="use-enabled svelte-1r90jgp" type="number" id="d4" min="0" max="10"/></div> <div class="dice-input-group svelte-1r90jgp"><label for="d6" class="svelte-1r90jgp">d6</label> <input class="use-enabled svelte-1r90jgp" type="number" id="d6" min="0" max="10"/></div> <div class="dice-input-group svelte-1r90jgp"><label for="d8" class="svelte-1r90jgp">d8</label> <input class="use-enabled svelte-1r90jgp" type="number" id="d8" min="0" max="10"/></div> <div class="dice-input-group svelte-1r90jgp"><label for="d10" class="svelte-1r90jgp">d10</label> <input class="use-enabled svelte-1r90jgp" type="number" id="d10" min="0" max="10"/></div> <div class="dice-input-group svelte-1r90jgp"><label for="d12" class="svelte-1r90jgp">d12</label> <input class="use-enabled svelte-1r90jgp" type="number" id="d12" min="0" max="10"/></div> <div class="dice-input-group svelte-1r90jgp"><label for="d20" class="svelte-1r90jgp">d20</label> <input class="use-enabled svelte-1r90jgp" type="number" id="d20" min="0" max="10"/></div></div> <div class="dice-controls svelte-1r90jgp"><button class="btn btn-primary use-enabled svelte-1r90jgp"> </button> <button class="btn btn-secondary use-enabled svelte-1r90jgp">Reset</button></div></div>'),tr=u('<span class="crit-badge svelte-1r90jgp">CRITICAL!</span>'),ar=u('<p class="svelte-1r90jgp"> </p>'),sr=u('<div class="bonus-item svelte-1r90jgp"><span class="bonus-value svelte-1r90jgp"> </span> <span class="bonus-source svelte-1r90jgp"> </span></div>'),lr=u('<div class="bonus-breakdown svelte-1r90jgp"></div>'),rr=u('<p class="modifier-text svelte-1r90jgp"> </p>'),ir=u('<button class="btn btn-follow-up svelte-1r90jgp"> </button>'),nr=u('<button class="btn btn-guided-strike svelte-1r90jgp">âš¡ Use Guided Strike (+10)</button>'),or=u('<div class="follow-up-actions svelte-1r90jgp"><!> <!></div>'),cr=u('<div class="result-header svelte-1r90jgp"><h3 class="svelte-1r90jgp"> </h3> <!></div> <div class="result-total svelte-1r90jgp"> </div> <div class="result-details svelte-1r90jgp"><!> <!></div> <!>',1),vr=u('<div role="button" tabindex="-1"><div class="modal-content svelte-1r90jgp" role="dialog" tabindex="0"><div class="modal-header svelte-1r90jgp"><h2 class="svelte-1r90jgp">Dice Roller</h2> <div class="header-buttons svelte-1r90jgp"><button class="color-btn svelte-1r90jgp" title="Customize dice colors">ðŸŽ¨</button> <button class="close-btn svelte-1r90jgp">Ã—</button></div></div> <!> <!> <div class="dice-main-area svelte-1r90jgp"><div class="dice-container svelte-1r90jgp"></div> <!></div> <div><!></div></div></div>');function dr(a,n){Bt(n,!1);const t=()=>Ze(X,"$character",d),[d,p]=Ut(),b=B(),x=B(),D=B(),k=Zt();let M=mt(n,"notation",12,""),Z=mt(n,"visible",8,!1),z=mt(n,"damageNotation",12,""),U=mt(n,"attackName",12,""),ke=mt(n,"applyHalfDamage",8,!1),be=mt(n,"bonusBreakdown",28,()=>[]),se=null,pe=B(void 0),J=B(!1),We=B(""),K=B(null);function re(){return e(K)?.resultTotal??null}let ee=B(0),le=B(0),oe=B(0),Ie=B(0),Oe=B(0),Se=B(0),$e=B(0),L=B([]),ue=B(!1),m=B("other"),R=B(!1),ie=B("#051e0a"),g=B("#ffffff"),C=B("#3a2004"),W=B(!1);function I(S){return S.length===9&&S.startsWith("#")?S.substring(0,7):S}function N(S,j="ff"){return S.length===7&&S.startsWith("#")?S+j:S}function xe(){if(window.DICE&&e(pe))try{se&&e(pe)&&fa(pe,e(pe).innerHTML="");const S=e(pe).clientWidth||500,j=e(pe).clientHeight||300;se=new window.DICE.dice_box(e(pe),{w:S,h:j}),c(J,!0)}catch(S){console.error("Error initializing dice box:",S)}}na(()=>{const S=ge=>new Promise((E,P)=>{if(document.querySelector(`script[src="${ge}"]`)){E(null);return}const G=document.createElement("script");G.src=ge,G.onload=()=>{E(null)},G.onerror=()=>{console.error(`Failed to load: ${ge}`),P(new Error(`Failed to load ${ge}`))},document.head.appendChild(G)});setTimeout(()=>{S(`${la}/libs/three.min.js`).then(()=>S(`${la}/libs/cannon.min.js`)).then(()=>S(`${la}/libs/teal.js`)).then(()=>S(`${la}/dice.js`)).then(()=>{if(window.DICE){const ge=window.DICE.getColors();c(ie,I(ge.dice_color)),c(g,I(ge.label_color)),c(C,I(ge.desk_color))}xe()}).catch(ge=>{console.error("Failed to load dice libraries:",ge)})},100);const j=()=>{e(J)&&xe()},de=ge=>{Z()&&ge.key==="Escape"&&_()};return window.addEventListener("resize",j),window.addEventListener("keydown",de),()=>{window.removeEventListener("resize",j),window.removeEventListener("keydown",de)}});function Ke(S,j="other"){if(!se||!e(J))return;c(K,null),c(L,[]),c(ue,!1),j==="damage"&&be([]),c(m,j),c(R,!1),se.diceToRoll=S;const de=E=>null,ge=E=>{let P=E.resultTotal,he=E.resultString;if(ke()&&(P=Math.floor(P/2),he=he+" (halved)"),c(K,{...E,resultTotal:P,resultString:he}),j==="attack"||j==="check"||j==="save"){const G=E.result?.filter(je=>je===20)||[];if(G.length>0){const je=G[0];c(ue,je===20)}}if(c(L,[]),console.log("Setting up follow-up actions. Type:",j,"damageNotation:",z(),"isCritical:",e(ue)),j==="attack"&&z())if(e(ue)){const G=Me(z());e(L).push({label:`Roll Critical Damage (${G})`,notation:G})}else e(L).push({label:`Roll Damage (${z()})`,notation:z()})};se.start_throw(de,ge)}function Y(){const S=[];e(ee)>0&&S.push(`${e(ee)}d4`),e(le)>0&&S.push(`${e(le)}d6`),e(oe)>0&&S.push(`${e(oe)}d8`),e(Ie)>0&&S.push(`${e(Ie)}d10`),e(Oe)>0&&S.push(`${e(Oe)}d12`),e(Se)>0&&S.push(`${e(Se)}d20`);let j=S.join("+")||"1d20";return e($e)!==0&&(j+=e($e)>=0?`+${e($e)}`:`${e($e)}`),j}function Fe(){const S=Y();Ke(S)}function Me(S){return S.replace(/(\d+)d(\d+)/g,(j,de,ge)=>`${parseInt(de)*2}d${ge}`)}function Te(){c(ee,0),c(le,0),c(oe,0),c(Ie,0),c(Oe,0),c(Se,0),c($e,0),c(K,null),c(L,[]),c(ue,!1),c(m,"other"),c(R,!1)}function et(){window.DICE&&(window.DICE.setColors({dice_color:N(e(ie),"ff"),label_color:N(e(g),"ff"),desk_color:e(C)}),se&&(se.updateDeskColor(e(C)),se.updateDiceColors()))}function ot(){c(W,!e(W))}function te(){!e(K)||e(x)<=0||e(R)||(c(K,{...e(K),resultTotal:e(K).resultTotal+10,resultString:e(K).resultString+" + 10 (Guided Strike)"}),X.update(S=>{const j="ChannelDivinity",de=S.classFeatures.features[j];return typeof de=="number"&&de>0&&(S.classFeatures.features[j]=de-1),S}),c(R,!0))}function _(){k("close"),M(""),z(""),U(""),c(We,""),c(K,null),c(R,!1),Te()}Xe(()=>(t(),sa),()=>{c(b,t().class?sa(t().class,t().level,t().subclass).some(j=>j.name==="Guided Strike"):!1)}),Xe(()=>t(),()=>{c(x,(()=>{const j=t().classFeatures.features["ChannelDivinity"];return typeof j=="number"?j:0})())}),Xe(()=>(e(ee),e(le),e(oe),e(Ie),e(Oe),e(Se),e($e)),()=>{c(D,(()=>{const S=[];e(ee)>0&&S.push(`${e(ee)}d4`),e(le)>0&&S.push(`${e(le)}d6`),e(oe)>0&&S.push(`${e(oe)}d8`),e(Ie)>0&&S.push(`${e(Ie)}d10`),e(Oe)>0&&S.push(`${e(Oe)}d12`),e(Se)>0&&S.push(`${e(Se)}d20`);let j=S.join("+")||"1d20";return e($e)!==0&&(j+=e($e)>=0?`+${e($e)}`:`${e($e)}`),j})())}),Xe(()=>(H(M()),e(J),H(Z()),e(We),H(z()),H(U())),()=>{if(M()&&e(J)&&Z()&&M()!==e(We)){c(We,M()),c(K,null),c(L,[]),c(ue,!1),c(R,!1);const S=M().includes("1d20")?"attack":"other";console.log("Auto-roll triggered. notation:",M(),"damageNotation:",z(),"attackName:",U()),setTimeout(()=>Ke(M(),S),200)}}),Wt();var v={getLastRollTotal:re};Ft();var ce=vr();let ne;var Ce=r(ce),Ee=r(Ce),He=s(r(Ee),2),T=r(He),h=s(T,2);l(He),l(Ee);var fe=s(Ee,2);{var De=S=>{var j=Xl(),de=s(r(j),2),ge=r(de),E=s(r(ge),2);we(E),l(ge);var P=s(ge,2),he=s(r(P),2);we(he),l(P);var G=s(P,2),je=s(r(G),2);we(je),l(G),l(de),l(j),Re(E,()=>e(ie),Ae=>c(ie,Ae)),F("change",E,et),Re(he,()=>e(g),Ae=>c(g,Ae)),F("change",he,et),Re(je,()=>e(C),Ae=>c(C,Ae)),F("change",je,et),o(S,j)};y(fe,S=>{e(W)&&S(De)})}var qe=s(fe,2);{var Qe=S=>{var j=Zl();o(S,j)};y(qe,S=>{e(J)||S(Qe)})}var _e=s(qe,2),me=r(_e);$a(me,S=>c(pe,S),()=>e(pe));var Le=s(me,2);{var Ue=S=>{var j=er(),de=s(r(j),2),ge=r(de),E=s(r(ge),2);we(E),l(ge);var P=s(ge,2),he=s(r(P),2);we(he),l(P);var G=s(P,2),je=s(r(G),2);we(je),l(G);var Ae=s(G,2),O=s(r(Ae),2);we(O),l(Ae);var lt=s(Ae,2),ht=s(r(lt),2);we(ht),l(lt);var kt=s(lt,2),dt=s(r(kt),2);we(dt),l(kt),l(de);var $=s(de,2),q=r($),f=r(q);l(q);var ae=s(q,2);l($),l(j),A(()=>{q.disabled=!e(J),w(f,`Roll ${e(D)??""}`)}),Re(E,()=>e(ee),Q=>c(ee,Q)),Re(he,()=>e(le),Q=>c(le,Q)),Re(je,()=>e(oe),Q=>c(oe,Q)),Re(O,()=>e(Ie),Q=>c(Ie,Q)),Re(ht,()=>e(Oe),Q=>c(Oe,Q)),Re(dt,()=>e(Se),Q=>c(Se,Q)),F("click",q,Fe),F("click",ae,Te),o(S,j)};y(Le,S=>{M()||S(Ue)})}l(_e);var Be=s(_e,2);let Ne;var ve=r(Be);{var V=S=>{var j=cr(),de=Pe(j),ge=r(de),E=r(ge,!0);l(ge);var P=s(ge,2);{var he=q=>{var f=tr();o(q,f)};y(P,q=>{e(ue)&&q(he)})}l(de);var G=s(de,2),je=r(G,!0);l(G);var Ae=s(G,2),O=r(Ae);{var lt=q=>{var f=ar(),ae=r(f,!0);l(f),A(()=>w(ae,(e(K),i(()=>e(K).resultString)))),o(q,f)};y(O,q=>{e(K),i(()=>e(K).resultString)&&q(lt)})}var ht=s(O,2);{var kt=q=>{var f=rt(),ae=Pe(f);{var Q=ye=>{var Ye=lr();ut(Ye,5,be,ft,(Ve,tt)=>{var vt=sr(),Tt=r(vt),jt=r(Tt);l(Tt);var it=s(Tt,2),nt=r(it);l(it),l(vt),A(()=>{w(jt,`${e(tt),i(()=>e(tt).value>=0?"+":"")??""}${e(tt),i(()=>e(tt).value)??""}`),w(nt,`(${e(tt),i(()=>e(tt).source)??""})`)}),o(Ve,vt)}),l(Ye),o(ye,Ye)},Je=ye=>{var Ye=rt(),Ve=Pe(Ye);{var tt=vt=>{var Tt=rr(),jt=r(Tt);l(Tt),A(()=>w(jt,`Modifier: ${e(K),i(()=>e(K).constant>=0?"+":"")??""}${e(K),i(()=>e(K).constant)??""}`)),o(vt,Tt)};y(Ve,vt=>{e(K),i(()=>e(K).constant)&&vt(tt)},!0)}o(ye,Ye)};y(ae,ye=>{H(be()),i(()=>be().length>0)?ye(Q):ye(Je,!1)})}o(q,f)};y(ht,q=>{e(K),H(be()),i(()=>e(K).constant||be().length>0)&&q(kt)})}l(Ae);var dt=s(Ae,2);{var $=q=>{var f=or(),ae=r(f);ut(ae,1,()=>e(L),ft,(ye,Ye)=>{var Ve=ir(),tt=r(Ve,!0);l(Ve),A(()=>w(tt,(e(Ye),i(()=>e(Ye).label)))),F("click",Ve,()=>Ke(e(Ye).notation,"damage")),o(ye,Ve)});var Q=s(ae,2);{var Je=ye=>{var Ye=nr();A(()=>{Ye.disabled=e(x)<=0,ze(Ye,"title",e(x)<=0?"No Channel Divinity uses remaining":"Use Channel Divinity to add +10 to this attack roll")}),F("click",Ye,te),o(ye,Ye)};y(Q,ye=>{e(b)&&e(m)==="attack"&&!e(R)&&ye(Je)})}l(f),o(q,f)};y(dt,q=>{e(L),e(b),e(m),e(R),i(()=>e(L).length>0||e(b)&&e(m)==="attack"&&!e(R))&&q($)})}A(()=>{w(E,U()?`${U()} - Result`:"Result"),w(je,(e(K),i(()=>e(K).resultTotal)))}),o(S,j)};y(ve,S=>{e(K)&&S(V)})}l(Be),l(Ce),l(ce),A(()=>{ne=pt(ce,1,"modal-overlay svelte-1r90jgp",null,ne,{hidden:!Z()}),Ne=pt(Be,1,"roll-result svelte-1r90jgp",null,Ne,{"has-result":e(K)})}),F("click",T,ot),F("click",h,_),F("click",Ce,Aa(function(S){aa.call(this,n,S)})),F("keydown",Ce,function(S){aa.call(this,n,S)}),F("click",ce,_),F("keydown",ce,S=>S.key==="Escape"&&_()),o(a,ce),_s(n,"getLastRollTotal",re);var Ge=Mt(v);return p(),Ge}const ha="https://api.github.com/gists";async function ur(a,n,t){if(!n)throw new Error("GitHub token is required");const d=JSON.stringify(a,null,2),p=`${a.name||"character"}_dnd.json`,b={description:t||`D&D Character: ${a.name}`,public:!1,files:{[p]:{content:d}}},x=await fetch(ha,{method:"POST",headers:{Authorization:`token ${n}`,"Content-Type":"application/json"},body:JSON.stringify(b)});if(!x.ok)throw new Error(`Failed to create gist: ${x.statusText}`);return(await x.json()).id}async function pr(a,n,t){if(!n||!t)throw new Error("GitHub token and Gist ID are required");const d=JSON.stringify(a,null,2),b={files:{[`${a.name||"character"}_dnd.json`]:{content:d}}},x=await fetch(`${ha}/${t}`,{method:"PATCH",headers:{Authorization:`token ${n}`,"Content-Type":"application/json"},body:JSON.stringify(b)});if(!x.ok)throw new Error(`Failed to update gist: ${x.statusText}`)}async function fr(a,n){if(!a)throw new Error("Gist ID is required");const t={"Content-Type":"application/json"};n&&(t.Authorization=`token ${n}`);const d=await fetch(`${ha}/${a}`,{method:"GET",headers:t});if(!d.ok)throw new Error(`Failed to load gist: ${d.statusText}`);const p=await d.json(),b=Object.values(p.files);if(b.length===0)throw new Error("No files found in gist");const D=b[0].content;try{const k=JSON.parse(D);return k.attacks&&Array.isArray(k.attacks)&&(k.attacks=k.attacks.map(M=>({...M,id:M.id||crypto.randomUUID()}))),k.classFeatures?(k.classFeatures.features||(k.classFeatures.features={}),k.classFeatures.spellSlots||(k.classFeatures.spellSlots=[]),k.classFeatures.preparedSpells===void 0&&(k.classFeatures.preparedSpells="")):k.classFeatures={features:{},spellSlots:[],preparedSpells:""},k}catch{throw new Error("Invalid character data in gist")}}function Ha(a){typeof window<"u"&&localStorage.setItem("dnd_gist_config",JSON.stringify(a))}function gr(){if(typeof window<"u"){const a=localStorage.getItem("dnd_gist_config");if(a)return JSON.parse(a)}return{}}async function br(a,n=30){if(!a)throw new Error("GitHub token is required to list gists");const t=await fetch(`${ha}?per_page=${n}`,{method:"GET",headers:{Authorization:`token ${a}`,"Content-Type":"application/json"}});if(!t.ok)throw new Error(`Failed to list gists: ${t.statusText}`);return await t.json()}var mr=u('<div class="error-message svelte-1jb5ckg"> </div>'),hr=u('<div class="toggle-container svelte-1jb5ckg"><button type="button" class="toggle-btn svelte-1jb5ckg"> </button></div>'),_r=u('<div class="form-group svelte-1jb5ckg"><label for="gistId" class="svelte-1jb5ckg">Gist ID (leave empty to create new)</label> <input type="text" id="gistId" placeholder="Optional: existing Gist ID to update" class="svelte-1jb5ckg"/></div>'),yr=u('<div class="loading-message svelte-1jb5ckg">Loading your gists...</div>'),kr=u('<button type="button"><div class="gist-item-header svelte-1jb5ckg"><span class="gist-description svelte-1jb5ckg"> </span> <span class="gist-visibility svelte-1jb5ckg"> </span></div> <div class="gist-item-meta svelte-1jb5ckg"><span class="gist-id svelte-1jb5ckg"> </span> <span class="gist-date svelte-1jb5ckg"> </span></div></button>'),Sr=u('<div class="form-group svelte-1jb5ckg"><div class="gist-list-label svelte-1jb5ckg">Select a Gist to Update (or leave unselected to create new)</div> <div class="gist-list svelte-1jb5ckg"></div></div>'),$r=u('<div class="info-message svelte-1jb5ckg">No gists found. A new one will be created.</div>'),xr=u('<!> <div class="form-group svelte-1jb5ckg"><label for="description" class="svelte-1jb5ckg"> </label> <input type="text" id="description" placeholder="D&amp;D Character Sheet" class="svelte-1jb5ckg"/></div>',1),Cr=u('<div class="form-group svelte-1jb5ckg"><label for="gistId" class="svelte-1jb5ckg">Gist ID *</label> <input type="text" id="gistId" placeholder="Enter Gist ID (for public or your private gists)" required class="svelte-1jb5ckg"/></div>'),Lr=u('<div class="loading-message svelte-1jb5ckg">Loading your gists...</div>'),wr=u('<button type="button"><div class="gist-item-header svelte-1jb5ckg"><span class="gist-description svelte-1jb5ckg"> </span> <span class="gist-visibility svelte-1jb5ckg"> </span></div> <div class="gist-item-meta svelte-1jb5ckg"><span class="gist-id svelte-1jb5ckg"> </span> <span class="gist-date svelte-1jb5ckg"> </span></div></button>'),Dr=u('<div class="form-group svelte-1jb5ckg"><div class="gist-list-label svelte-1jb5ckg">Select a Gist to Load</div> <div class="gist-list svelte-1jb5ckg"></div></div>'),jr=u('<div class="info-message svelte-1jb5ckg">No gists found. Enter a Gist ID manually or create a new one in Save mode.</div>'),Ar=u('<div class="modal-overlay svelte-1jb5ckg" role="button" tabindex="-1"><div class="modal-content svelte-1jb5ckg" role="dialog" tabindex="0"><div class="modal-header svelte-1jb5ckg"><h2 class="svelte-1jb5ckg"> </h2> <button class="close-btn svelte-1jb5ckg">Ã—</button></div> <div class="modal-body svelte-1jb5ckg"><!> <div class="form-group svelte-1jb5ckg"><label for="token" class="svelte-1jb5ckg"> <a href="https://github.com/settings/tokens" target="_blank" rel="noopener" class="svelte-1jb5ckg">Get token</a></label> <input type="password" id="token" placeholder="ghp_xxxxxxxxxxxxx" class="svelte-1jb5ckg"/></div> <!> <!> <div class="modal-actions svelte-1jb5ckg"><button class="btn btn-primary svelte-1jb5ckg"><!></button> <button class="btn btn-secondary svelte-1jb5ckg">Cancel</button></div></div></div></div>');function Fr(a,n){Bt(n,!1);const t=()=>Ze(X,"$character",d),[d,p]=Ut(),b=Zt();let x=mt(n,"mode",8,"save"),D=B(""),k=B(""),M=B(""),Z=B(!1),z=B(""),U=B(!1),ke=B(!1),be=B([]),se=B(null);const pe=gr();pe.token&&c(D,pe.token),pe.gistId&&c(k,pe.gistId),na(async()=>{e(D)&&!e(U)&&await J()});async function J(){if(e(D)){c(ke,!0),c(z,"");try{c(be,await br(e(D))),e(k)&&c(se,e(be).find(_=>_.id===e(k))||null)}catch(_){c(z,_.message||"Failed to load gists"),c(be,[])}finally{c(ke,!1)}}}function We(_){c(se,_),c(k,_.id)}function K(){c(U,!e(U)),c(z,""),!e(U)&&e(D)&&J()}async function re(){if(!e(D)){c(z,"GitHub token is required");return}const _=e(se)?.id||e(k);c(Z,!0),c(z,"");try{if(_)await pr(t(),e(D),_),c(k,_),Et.add("Character updated in Gist successfully!","success");else{const v=await ur(t(),e(D),e(M));c(k,v),Et.add(`Character saved to Gist! ID: ${v}`,"success")}Ha({token:e(D),gistId:e(k)}),b("close")}catch(v){c(z,v.message||"Failed to save to Gist")}finally{c(Z,!1)}}async function ee(){const _=e(se)?.id||e(k);if(!_){c(z,"Please select a gist or enter a Gist ID");return}c(Z,!0),c(z,"");try{const v=await fr(_,e(D)||void 0);X.set(v),c(k,_),Ha({token:e(D),gistId:e(k)}),Et.add("Character loaded from Gist successfully!","success"),b("close")}catch(v){c(z,v.message||"Failed to load from Gist")}finally{c(Z,!1)}}function le(){b("close")}Ft();var oe=Ar(),Ie=r(oe),Oe=r(Ie),Se=r(Oe),$e=r(Se,!0);l(Se);var L=s(Se,2);l(Oe);var ue=s(Oe,2),m=r(ue);{var R=_=>{var v=mr(),ce=r(v,!0);l(v),A(()=>w(ce,e(z))),o(_,v)};y(m,_=>{e(z)&&_(R)})}var ie=s(m,2),g=r(ie),C=r(g);pa(),l(g);var W=s(g,2);we(W),l(ie);var I=s(ie,2);{var N=_=>{var v=hr(),ce=r(v),ne=r(ce,!0);l(ce),l(v),A(()=>{ce.disabled=e(Z),w(ne,e(U)?"ðŸ“‹ Show My Gists":"âœï¸ Enter Gist ID Manually")}),F("click",ce,K),o(_,v)};y(I,_=>{(x()==="load"||x()==="save"&&e(D))&&_(N)})}var xe=s(I,2);{var Ke=_=>{var v=xr(),ce=Pe(v);{var ne=fe=>{var De=_r(),qe=s(r(De),2);we(qe),l(De),A(()=>qe.disabled=e(Z)),Re(qe,()=>e(k),Qe=>c(k,Qe)),o(fe,De)},Ce=fe=>{var De=rt(),qe=Pe(De);{var Qe=me=>{var Le=yr();o(me,Le)},_e=me=>{var Le=rt(),Ue=Pe(Le);{var Be=ve=>{var V=Sr(),Ge=s(r(V),2);ut(Ge,5,()=>e(be),ft,(S,j)=>{var de=kr();let ge;var E=r(de),P=r(E),he=r(P,!0);l(P);var G=s(P,2),je=r(G,!0);l(G),l(E);var Ae=s(E,2),O=r(Ae),lt=r(O);l(O);var ht=s(O,2),kt=r(ht);l(ht),l(Ae),l(de),A(dt=>{ge=pt(de,1,"gist-item svelte-1jb5ckg",null,ge,{selected:e(se)?.id===e(j).id}),de.disabled=e(Z),w(he,(e(j),i(()=>e(j).description||"Untitled"))),w(je,(e(j),i(()=>e(j).public?"ðŸŒ Public":"ðŸ”’ Private"))),w(lt,`ID: ${e(j),i(()=>e(j).id)??""}`),w(kt,`Updated: ${dt??""}`)},[()=>(e(j),i(()=>new Date(e(j).updated_at).toLocaleDateString()))]),F("click",de,()=>We(e(j))),o(S,de)}),l(Ge),l(V),o(ve,V)},Ne=ve=>{var V=rt(),Ge=Pe(V);{var S=j=>{var de=$r();o(j,de)};y(Ge,j=>{e(D)&&j(S)},!0)}o(ve,V)};y(Ue,ve=>{e(be),i(()=>e(be).length>0)?ve(Be):ve(Ne,!1)},!0)}o(me,Le)};y(qe,me=>{e(ke)?me(Qe):me(_e,!1)},!0)}o(fe,De)};y(ce,fe=>{e(U)||!e(D)?fe(ne):fe(Ce,!1)})}var Ee=s(ce,2),He=r(Ee),T=r(He);l(He);var h=s(He,2);we(h),l(Ee),A(()=>{w(T,`Description ${e(k)?"(optional)":""}`),h.disabled=e(Z)}),Re(h,()=>e(M),fe=>c(M,fe)),o(_,v)},Y=_=>{var v=rt(),ce=Pe(v);{var ne=Ee=>{var He=Cr(),T=s(r(He),2);we(T),l(He),A(()=>T.disabled=e(Z)),Re(T,()=>e(k),h=>c(k,h)),o(Ee,He)},Ce=Ee=>{var He=rt(),T=Pe(He);{var h=De=>{var qe=Lr();o(De,qe)},fe=De=>{var qe=rt(),Qe=Pe(qe);{var _e=Le=>{var Ue=Dr(),Be=s(r(Ue),2);ut(Be,5,()=>e(be),ft,(Ne,ve)=>{var V=wr();let Ge;var S=r(V),j=r(S),de=r(j,!0);l(j);var ge=s(j,2),E=r(ge,!0);l(ge),l(S);var P=s(S,2),he=r(P),G=r(he);l(he);var je=s(he,2),Ae=r(je);l(je),l(P),l(V),A(O=>{Ge=pt(V,1,"gist-item svelte-1jb5ckg",null,Ge,{selected:e(se)?.id===e(ve).id}),V.disabled=e(Z),w(de,(e(ve),i(()=>e(ve).description||"Untitled"))),w(E,(e(ve),i(()=>e(ve).public?"ðŸŒ Public":"ðŸ”’ Private"))),w(G,`ID: ${e(ve),i(()=>e(ve).id)??""}`),w(Ae,`Updated: ${O??""}`)},[()=>(e(ve),i(()=>new Date(e(ve).updated_at).toLocaleDateString()))]),F("click",V,()=>We(e(ve))),o(Ne,V)}),l(Be),l(Ue),o(Le,Ue)},me=Le=>{var Ue=rt(),Be=Pe(Ue);{var Ne=ve=>{var V=jr();o(ve,V)};y(Be,ve=>{e(D)&&ve(Ne)},!0)}o(Le,Ue)};y(Qe,Le=>{e(be),i(()=>e(be).length>0)?Le(_e):Le(me,!1)},!0)}o(De,qe)};y(T,De=>{e(ke)?De(h):De(fe,!1)},!0)}o(Ee,He)};y(ce,Ee=>{e(U)||!e(D)?Ee(ne):Ee(Ce,!1)},!0)}o(_,v)};y(xe,_=>{x()==="save"?_(Ke):_(Y,!1)})}var Fe=s(xe,2),Me=r(Fe),Te=r(Me);{var et=_=>{var v=wt();A(()=>w(v,x()==="save"?"Saving...":"Loading...")),o(_,v)},ot=_=>{var v=wt();A(()=>w(v,x()==="save"?"Save":"Load")),o(_,v)};y(Te,_=>{e(Z)?_(et):_(ot,!1)})}l(Me);var te=s(Me,2);l(Fe),l(ue),l(Ie),l(oe),A(()=>{w($e,x()==="save"?"Save to GitHub Gist":"Load from GitHub Gist"),w(C,`GitHub Token ${x()==="load"?"(optional for public gists)":"(required)"} `),W.disabled=e(Z),Me.disabled=e(Z),te.disabled=e(Z)}),F("click",L,le),Re(W,()=>e(D),_=>c(D,_)),F("blur",W,()=>{e(D)&&!e(U)&&J()}),F("click",Me,function(..._){(x()==="save"?re:ee)?.apply(this,_)}),F("click",te,le),F("click",Ie,Aa(function(_){aa.call(this,n,_)})),F("keydown",Ie,function(_){aa.call(this,n,_)}),F("click",oe,le),F("keydown",oe,_=>_.key==="Escape"&&le()),o(a,oe),Mt(),p()}var Br=u('<div class="loading svelte-1ngjemu">Loading D&D data...</div>'),Mr=u("<option> </option>"),Rr=u('<select class="level-filter svelte-1ngjemu"><option>All Levels</option><option>Cantrip</option><!></select>'),Ir=u('<div class="no-results svelte-1ngjemu"> </div>'),Er=u('<div class="item-meta svelte-1ngjemu"> </div>'),Pr=u('<div class="item-meta svelte-1ngjemu"> </div>'),Tr=u('<button><div class="item-name svelte-1ngjemu"> </div> <!></button>'),Hr=u('<p class="higher-levels"><strong>At Higher Levels:</strong> </p>'),Ur=u('<p class="cantrip-upgrade"><strong>Cantrip Upgrade:</strong> </p>'),Nr=u('<h3 class="svelte-1ngjemu"> </h3> <p class="spell-meta svelte-1ngjemu"><!> <!></p> <p class="spell-classes"><strong>Classes:</strong> </p> <div class="spell-stats svelte-1ngjemu"><div><strong>Casting Time:</strong> </div> <div><strong>Range:</strong> </div> <div><strong>Components:</strong> <!></div> <div><strong>Duration:</strong> <!> </div></div> <p class="description svelte-1ngjemu"> </p> <!> <!>',1),Gr=u('<p class="prerequisite svelte-1ngjemu"><strong>Prerequisite:</strong> </p>'),Or=u('<h3 class="svelte-1ngjemu"> </h3> <!> <p class="description svelte-1ngjemu"> </p> <a target="_blank" rel="noopener" class="source-link svelte-1ngjemu">View Full Details â†’</a>',1),qr=u('<div class="item-details svelte-1ngjemu"><!></div>'),Wr=u('<div class="controls svelte-1ngjemu"><div class="tabs svelte-1ngjemu"><button> </button> <button> </button></div> <div class="search-controls svelte-1ngjemu"><input type="text" placeholder="Search by name or description..." class="search-input svelte-1ngjemu"/> <!></div></div> <div class="content-container svelte-1ngjemu"><div class="items-list svelte-1ngjemu"><!></div> <!></div>',1),zr=u('<div class="modal-backdrop svelte-1ngjemu" role="presentation"><div class="modal svelte-1ngjemu" role="dialog" aria-modal="true" tabindex="-1"><div class="modal-header svelte-1ngjemu"><h2 class="svelte-1ngjemu">Browse D&D Spells & Feats</h2> <button class="close-btn svelte-1ngjemu" aria-label="Close">&times;</button></div> <div class="modal-body svelte-1ngjemu"><!></div> <div class="modal-footer svelte-1ngjemu"><button class="btn-secondary svelte-1ngjemu">Cancel</button> <button class="btn-primary svelte-1ngjemu">Add to Character Sheet</button></div></div></div>');function Kr(a,n){Bt(n,!1);const t=B(),d=B(),p=B();let b=mt(n,"onClose",8),x=B("spell"),D=B(!0),k=B(""),M=B(null),Z=B([]),z=B([]),U=B(null);na(async()=>{c(D,!0);try{c(Z,await Va()),c(z,await Ws())}catch(L){console.error("Failed to load data:",L)}finally{c(D,!1)}});function ke(L){c(U,L)}function be(L){const ue=L.match(/(\d+d\d+(?:\s*\+\s*\d+)?)/i);return ue?ue[1]:""}function se(L){const ue=L.split(/\.( |$)/)[0].trim(),m=Array.from(L.matchAll(/\*\*(.*?)\*\*/g)).map(ie=>ie[1].replace(/\.$/,""));let R=ue;return m.length&&(R+=" | Effects: "+m.join(", ")),R}function pe(){if(e(U)){if(e(x)==="spell"){const L=e(U);X.update(ue=>{const R=[];L.range&&R.push(`Range: ${L.range}`),L.castingTime&&R.push(`Cast: ${L.castingTime}`),L.duration&&R.push(`Duration: ${L.duration}`),L.actionType==="Save"&&R.push("Saving throw spell"),L.components&&L.components.length>0&&R.push(`Components: ${L.components.join(", ")}`),L.material&&R.push(`Material: ${L.material}`);const ie=R.join(" | "),g=se(L.description),C={id:crypto.randomUUID(),name:`${L.name}${L.concentration?" (C)":""}${L.ritual?" (R)":""}`,bonus:L.actionType==="Attack"?5:0,damage:be(L.description),damageType:`${L.school} (Lvl ${L.level})`,spellRef:L.name,infoNotes:ie,generalNotes:g,castAtLevel:L.level};return ue.attacks=[...ue.attacks,C],ue})}else if(e(x)==="feat"){const L=e(U);X.update(ue=>{const m=`${L.name}${L.prerequisite?` (Req: ${L.prerequisite})`:""}
${L.description}
`;return ue.features=ue.features?`${ue.features}
${m}`:m,ue})}c(U,null),b()()}}Xe(()=>(e(M),e(Z),e(k)),()=>{c(t,e(M)!==null?zs(Ea(e(Z),e(k)),e(M)):Ea(e(Z),e(k)))}),Xe(()=>(e(z),e(k)),()=>{c(d,Ks(e(z),e(k)))}),Xe(()=>(e(x),e(t),e(d)),()=>{c(p,e(x)==="spell"?e(t):e(d))}),Wt(),Ft();var J=zr(),We=r(J),K=r(We),re=s(r(K),2);l(K);var ee=s(K,2),le=r(ee);{var oe=L=>{var ue=Br();o(L,ue)},Ie=L=>{var ue=Wr(),m=Pe(ue),R=r(m),ie=r(R);let g;var C=r(ie);l(ie);var W=s(ie,2);let I;var N=r(W);l(W),l(R);var xe=s(R,2),Ke=r(xe);we(Ke);var Y=s(Ke,2);{var Fe=ce=>{var ne=Rr();A(()=>{e(M),Lt(()=>{})});var Ce=r(ne);Ce.value=(Ce.__value=null)??"";var Ee=s(Ce);Ee.value=Ee.__value=0;var He=s(Ee);ut(He,0,()=>[1,2,3,4,5,6,7,8,9],ft,(T,h)=>{var fe=Mr(),De=r(fe);l(fe);var qe={};A(()=>{w(De,`Level ${h??""}`),qe!==(qe=h)&&(fe.value=(fe.__value=h)??"")}),o(T,fe)}),l(ne),za(ne,()=>e(M),T=>c(M,T)),o(ce,ne)};y(Y,ce=>{e(x)==="spell"&&ce(Fe)})}l(xe),l(m);var Me=s(m,2),Te=r(Me),et=r(Te);{var ot=ce=>{var ne=Ir(),Ce=r(ne);l(ne),A(()=>w(Ce,`No ${e(x)??""}s found`)),o(ce,ne)},te=ce=>{var ne=rt(),Ce=Pe(ne);ut(Ce,1,()=>e(p),ft,(Ee,He)=>{var T=Tr();let h;var fe=r(T),De=r(fe,!0);l(fe);var qe=s(fe,2);{var Qe=me=>{const Le=st(()=>e(He));var Ue=Er(),Be=r(Ue);l(Ue),A(()=>w(Be,`Level ${H(e(Le)),i(()=>e(Le).level)??""} â€¢ ${H(e(Le)),i(()=>e(Le).school)??""}`)),o(me,Ue)},_e=me=>{const Le=st(()=>e(He));var Ue=rt(),Be=Pe(Ue);{var Ne=ve=>{var V=Pr(),Ge=r(V,!0);l(V),A(()=>w(Ge,(H(e(Le)),i(()=>e(Le).prerequisite)))),o(ve,V)};y(Be,ve=>{H(e(Le)),i(()=>e(Le).prerequisite)&&ve(Ne)})}o(me,Ue)};y(qe,me=>{e(x)==="spell"?me(Qe):me(_e,!1)})}l(T),A(()=>{h=pt(T,1,"item-card svelte-1ngjemu",null,h,{selected:e(U)?.name===e(He).name}),w(De,(e(He),i(()=>e(He).name)))}),F("click",T,()=>ke(e(He))),o(Ee,T)}),o(ce,ne)};y(et,ce=>{e(p),i(()=>e(p).length===0)?ce(ot):ce(te,!1)})}l(Te);var _=s(Te,2);{var v=ce=>{var ne=qr(),Ce=r(ne);{var Ee=T=>{const h=st(()=>e(U));var fe=Nr(),De=Pe(fe),qe=r(De,!0);l(De);var Qe=s(De,2),_e=r(Qe);{var me=f=>{var ae=wt();A(()=>w(ae,`${H(e(h)),i(()=>e(h).school)??""} cantrip`)),o(f,ae)},Le=f=>{var ae=wt();A(()=>w(ae,`Level ${H(e(h)),i(()=>e(h).level)??""} ${H(e(h)),i(()=>e(h).school)??""}`)),o(f,ae)};y(_e,f=>{H(e(h)),i(()=>e(h).level===0)?f(me):f(Le,!1)})}var Ue=s(_e,2);{var Be=f=>{var ae=wt("(ritual)");o(f,ae)};y(Ue,f=>{H(e(h)),i(()=>e(h).ritual)&&f(Be)})}l(Qe);var Ne=s(Qe,2),ve=s(r(Ne));l(Ne);var V=s(Ne,2),Ge=r(V),S=s(r(Ge));l(Ge);var j=s(Ge,2),de=s(r(j));l(j);var ge=s(j,2),E=s(r(ge)),P=s(E);{var he=f=>{var ae=wt();A(()=>w(ae,`(${H(e(h)),i(()=>e(h).material)??""})`)),o(f,ae)};y(P,f=>{H(e(h)),i(()=>e(h).material)&&f(he)})}l(ge);var G=s(ge,2),je=s(r(G),2);{var Ae=f=>{var ae=wt("Concentration,");o(f,ae)};y(je,f=>{H(e(h)),i(()=>e(h).concentration)&&f(Ae)})}var O=s(je,1,!0);l(G),l(V);var lt=s(V,2),ht=r(lt,!0);l(lt);var kt=s(lt,2);{var dt=f=>{var ae=Hr(),Q=s(r(ae));l(ae),A(()=>w(Q,` ${H(e(h)),i(()=>e(h).higherLevelSlot)??""}`)),o(f,ae)};y(kt,f=>{H(e(h)),i(()=>e(h).higherLevelSlot)&&f(dt)})}var $=s(kt,2);{var q=f=>{var ae=Ur(),Q=s(r(ae));l(ae),A(()=>w(Q,` ${H(e(h)),i(()=>e(h).cantripUpgrade)??""}`)),o(f,ae)};y($,f=>{H(e(h)),i(()=>e(h).cantripUpgrade)&&f(q)})}A((f,ae)=>{w(qe,(H(e(h)),i(()=>e(h).name))),w(ve,` ${f??""}`),w(S,` ${H(e(h)),i(()=>e(h).castingTime||e(h).actionType)??""}`),w(de,` ${H(e(h)),i(()=>e(h).range)??""}`),w(E,` ${ae??""}`),w(O,(H(e(h)),i(()=>e(h).duration))),w(ht,(H(e(h)),i(()=>e(h).description)))},[()=>(H(e(h)),i(()=>e(h).classes.join(", "))),()=>(H(e(h)),i(()=>e(h).components.join(", ").toUpperCase()))]),o(T,fe)},He=T=>{const h=st(()=>e(U));var fe=Or(),De=Pe(fe),qe=r(De,!0);l(De);var Qe=s(De,2);{var _e=Be=>{var Ne=Gr(),ve=s(r(Ne));l(Ne),A(()=>w(ve,` ${H(e(h)),i(()=>e(h).prerequisite)??""}`)),o(Be,Ne)};y(Qe,Be=>{H(e(h)),i(()=>e(h).prerequisite)&&Be(_e)})}var me=s(Qe,2),Le=r(me,!0);l(me);var Ue=s(me,2);A(()=>{w(qe,(H(e(h)),i(()=>e(h).name))),w(Le,(H(e(h)),i(()=>e(h).description))),ze(Ue,"href",(H(e(h)),i(()=>e(h).source)))}),o(T,fe)};y(Ce,T=>{e(x)==="spell"?T(Ee):T(He,!1)})}l(ne),o(ce,ne)};y(_,ce=>{e(U)&&ce(v)})}l(Me),A(()=>{g=pt(ie,1,"tab svelte-1ngjemu",null,g,{active:e(x)==="spell"}),w(C,`ðŸ“œ Spells (${e(Z),i(()=>e(Z).length)??""})`),I=pt(W,1,"tab svelte-1ngjemu",null,I,{active:e(x)==="feat"}),w(N,`â­ Feats (${e(z),i(()=>e(z).length)??""})`)}),F("click",ie,()=>{c(x,"spell"),c(U,null),c(k,"")}),F("click",W,()=>{c(x,"feat"),c(U,null),c(k,"")}),Re(Ke,()=>e(k),ce=>c(k,ce)),o(L,ue)};y(le,L=>{e(D)?L(oe):L(Ie,!1)})}l(ee);var Oe=s(ee,2),Se=r(Oe),$e=s(Se,2);l(Oe),l(We),l(J),A(()=>$e.disabled=!e(U)),F("click",re,function(...L){b()?.apply(this,L)}),F("click",Se,function(...L){b()?.apply(this,L)}),F("click",$e,pe),F("click",We,Aa(function(L){aa.call(this,n,L)})),F("keydown",We,function(L){aa.call(this,n,L)}),F("click",J,function(...L){b()?.apply(this,L)}),F("keydown",J,L=>L.key==="Escape"&&b()()),o(a,J),Mt()}var Jr=u('<link rel="icon" type="image/png" href="favicon4.png"/> <meta name="viewport" content="width=device-width, initial-scale=1"/>',1),Vr=u('<span class="character-name svelte-1uha8ag"> </span>'),Qr=u("<span> </span>"),Yr=u('<div class="spell-slots-header svelte-1uha8ag"></div>'),Xr=u("<span> </span><br/>",1),Zr=u("<span> </span>"),ei=u('<span class="effect-tooltip"><strong> </strong><br/> <br/> <!> <!></span>'),ti=u('<button class="effect-remove-btn svelte-1uha8ag">Ã—</button>'),ai=u('<span class="effect-badge svelte-1uha8ag" tabindex="0"> <!> <!></span>'),si=u(`<div class="active-effects-header svelte-1uha8ag"></div> <style>.effect-badge {
              position: relative;
            }
            .effect-tooltip {
              position: absolute;
              top: 120%;
              left: 50%;
              transform: translateX(-50%);
              background: #fff;
              color: #222;
              border: 1px solid #a5b4fc;
              border-radius: 6px;
              padding: 8px 12px;
              font-size: 0.95em;
              box-shadow: 0 2px 8px rgba(0, 0, 0, 0.12);
              z-index: 10;
              min-width: 180px;
              max-width: 260px;
              white-space: normal;
              pointer-events: none;
              opacity: 1;
              transition: opacity 0.15s;
            }</style>`,1),li=u('<div class="rest-menu svelte-1uha8ag"><button class="rest-option svelte-1uha8ag">â˜• Short Rest</button> <button class="rest-option svelte-1uha8ag">ðŸ›ï¸ Long Rest</button></div>'),ri=u('<div class="container svelte-1uha8ag"><header class="svelte-1uha8ag"><div class="header-top svelte-1uha8ag"><div class="header-title svelte-1uha8ag"><div class="title-row svelte-1uha8ag"><h1 class="svelte-1uha8ag">D&D Character Sheet</h1> <!></div> <!> <!></div> <div class="header-right svelte-1uha8ag"><div class="header-controls svelte-1uha8ag"><button class="btn btn-secondary use-enabled"><span class="btn-icon svelte-1uha8ag">ðŸŽ²</span><span class="btn-text svelte-1uha8ag">Roll Dice</span></button> <div class="rest-button-container svelte-1uha8ag"><button class="btn btn-secondary use-enabled"><span class="btn-icon svelte-1uha8ag">ðŸ˜´</span><span class="btn-text svelte-1uha8ag">Rest</span></button> <!></div> <div class="mode-toggle"><button><span class="btn-icon svelte-1uha8ag"> </span><span class="btn-text svelte-1uha8ag"> </span></button></div></div> <div class="header-search svelte-1uha8ag"><input type="text" placeholder="ðŸ” Search..." class="search-input use-enabled svelte-1uha8ag"/></div></div></div> <div class="header-actions svelte-1uha8ag"><button class="btn btn-mode svelte-1uha8ag">ðŸ“š Browse Spells & Feats</button> <button class="btn btn-secondary">Save to Gist</button> <button class="btn btn-secondary">Load from Gist</button> <button class="btn btn-secondary">Export JSON</button> <button class="btn btn-secondary">Import JSON</button> <input type="file" accept=".json" style="display: none;"/></div></header> <main class="svelte-1uha8ag"><!> <!> <!> <!> <!> <!> <!></main></div> <!> <!> <!> <!>',1);function fi(a,n){Bt(n,!1);const t=()=>Ze(X,"$character",b),d=()=>Ze(ta,"$isEditMode",b),p=()=>Ze(Qt,"$searchFilter",b),[b,x]=Ut();function D(){const $=[],q=t().classFeatures.spellSlotsByLevel||{};for(let f=1;f<=9;f++){const ae=q[f];if(ae&&ae.length>0){const Q=ae.length,Je=ae.filter(ye=>ye).length;$.push({level:f,available:Q-Je,total:Q})}}return $}let k=B(!1),M=B(!1),Z=B(!1),z=B("save"),U=B(void 0),ke=B(""),be=B(""),se=B(""),pe=B(!1),J=B([]),We=B(),K=!1,re=B(!1),ee=B(null);function le($){c(ee,$)}function oe(){c(ee,null)}function Ie($){c(ee,e(ee)===$?null:$)}function Oe(){const $=[];X.update(f=>{const ae=f.hitDice.current;f.hitDice.current=Math.min(f.hitDice.max,f.hitDice.current+Math.max(1,Math.floor(f.hitDice.max/2)));const Q=f.hitDice.current-ae;if(Q>0&&$.push(`${Q} hit ${Q===1?"die":"dice"}`),f.class){const Je=sa(f.class,f.level,f.subclass);f.classFeatures.features||(f.classFeatures.features={}),Je.forEach(ye=>{if(ye.resetOn==="short"){const Ye=ye.name.replace(/\s+/g,"");if(ye.type==="uses"){const Ve=typeof ye.maxUses=="function"?ye.maxUses(f.level):ye.maxUses;f.classFeatures.features[Ye]=Array(Ve).fill(!1),$.push(ye.name)}else if(ye.type==="pool"){const Ve=typeof ye.maxPool=="function"?ye.maxPool(f.level):ye.maxPool;Ve!==void 0&&(f.classFeatures.features[Ye]=Ve,$.push(ye.name))}}})}return f}),c(re,!1);const q=$.length>0?`Short rest taken! Restored: ${$.join(", ")}`:"Short rest taken!";Et.add(q,"success")}function Se(){const $=[];X.update(f=>{const ae=f.maxHP-f.currentHP;ae>0&&$.push(`${ae} HP`),f.currentHP=f.maxHP,f.tempHP=0;const Q=f.hitDice.max-f.hitDice.current;Q>0&&$.push(`${Q} hit ${Q===1?"die":"dice"}`),f.hitDice.current=f.hitDice.max;let Je=0;if(f.classFeatures.spellSlotsByLevel&&Object.keys(f.classFeatures.spellSlotsByLevel).forEach(ye=>{const Ye=f.classFeatures.spellSlotsByLevel[parseInt(ye)];if(Ye){const Ve=Ye.filter(tt=>tt).length;Je+=Ve,f.classFeatures.spellSlotsByLevel[parseInt(ye)]=Array(Ye.length).fill(!1)}}),Je>0&&$.push(`${Je} spell ${Je===1?"slot":"slots"}`),f.class){const ye=sa(f.class,f.level,f.subclass);f.classFeatures.features||(f.classFeatures.features={});let Ye=!1;ye.forEach(Ve=>{const tt=Ve.name.replace(/\s+/g,"");if(!(Ve.type==="info"||Ve.type==="channelDivinity")){if(Ve.type==="uses"){const vt=typeof Ve.maxUses=="function"?Ve.maxUses(f.level):Ve.maxUses;f.classFeatures.features[tt]=Array(vt).fill(!1),Ye=!0}else if(Ve.type==="pool"){const vt=typeof Ve.maxPool=="function"?Ve.maxPool(f.level):Ve.maxPool;vt!==void 0&&(f.classFeatures.features[tt]=vt,Ye=!0)}}}),Ye&&$.push("all class features")}return f}),c(re,!1);const q=$.length>0?`Long rest taken! Restored: ${$.join(", ")}`:"Long rest taken! Fully rested.";Et.add(q,"success")}function $e($){c(ke,""),c(be,""),c(se,""),c(pe,!1),c(J,[]),K=!1,typeof $=="string"?c(ke,$):(c(ke,$.notation),c(be,$.damageNotation||""),c(se,$.attackName||""),c(pe,!!$.applyHalfDamage),c(J,$.bonusBreakdown||[])),c(k,!0)}function L($){const{notation:q}=$.detail;c(ke,""),K=!0,setTimeout(()=>{c(ke,q),c(be,""),c(se,"Hit Die")},0),c(k,!0)}function ue(){if(c(k,!1),K&&e(We)){const $=e(We).getLastRollTotal();if($!==null){const q=Math.max(1,$);X.update(f=>(f.hitDice.current=Math.max(0,f.hitDice.current-1),f.currentHP=Math.min(f.maxHP,f.currentHP+q),f))}K=!1}}function m(){ta.update($=>!$)}function R($){$.target.closest(".rest-button-container")||c(re,!1)}na(()=>{const $=ta.subscribe(q=>{q?document.body.classList.remove("use-mode"):document.body.classList.add("use-mode")});return document.addEventListener("click",R),()=>{$(),document.removeEventListener("click",R)}});function ie(){us(t())}function g(){e(U)?.click()}async function C($){const f=$.target.files?.[0];if(f)try{const ae=await ps(f);X.set(ae),alert("Character imported successfully!")}catch{alert("Failed to import character file")}}Ft();var W=ri();vs("1uha8ag",$=>{var q=Jr();pa(2),Ga(()=>{os.title="D&D Character Sheet"}),o($,q)});var I=Pe(W),N=r(I),xe=r(N),Ke=r(xe),Y=r(Ke),Fe=s(r(Y),2);{var Me=$=>{var q=Vr(),f=r(q);l(q),A(()=>w(f,`${t().name??""} (${t().level??""})`)),o($,q)};y(Fe,$=>{t().name&&$(Me)})}l(Y);var Te=s(Y,2);{var et=$=>{var q=Yr();ut(q,5,D,ft,(f,ae)=>{var Q=Qr();let Je;var ye=r(Q);l(Q),A(()=>{Je=pt(Q,1,"slot-badge svelte-1uha8ag",null,Je,{depleted:e(ae).available===0}),w(ye,`Lv${e(ae).level??""}: ${e(ae).available??""}/${e(ae).total??""}`)}),o(f,Q)}),l(q),o($,q)};y(Te,$=>{D().length>0&&$(et)})}var ot=s(Te,2);{var te=$=>{var q=si(),f=Pe(q);ut(f,5,()=>t().activeStates,ft,(ae,Q,Je)=>{var ye=ai(),Ye=r(ye),Ve=s(Ye);{var tt=jt=>{var it=ei(),nt=r(it),Rt=r(nt,!0);l(nt);var It=s(nt,2),Ht=s(It,3);{var zt=gt=>{var xt=Xr(),at=Pe(xt),_t=r(at);l(at),pa(),A(()=>w(_t,`Attack Bonus: ${e(Q).attackBonus>0?"+":""}${e(Q).attackBonus??""}`)),o(gt,xt)};y(Ht,gt=>{e(Q).attackBonus&&gt(zt)})}var $t=s(Ht,2);{var Nt=gt=>{var xt=Zr(),at=r(xt);l(xt),A(_t=>w(at,`Damage Bonus: ${_t??""}${e(Q).damageBonus??""}`),[()=>Number(e(Q).damageBonus)>0?"+":""]),o(gt,xt)};y($t,gt=>{e(Q).damageBonus&&gt(Nt)})}l(it),A(()=>{w(Rt,e(Q).name),w(It,` ${e(Q).description??""}`)}),o(jt,it)};y(Ve,jt=>{e(ee)===Je&&jt(tt)})}var vt=s(Ve,2);{var Tt=jt=>{var it=ti();A(()=>ze(it,"title",`End ${e(Q).name??""}`)),F("click",it,()=>{X.update(nt=>(nt.activeStates&&(nt.activeStates=nt.activeStates.filter((Rt,It)=>It!==Je)),nt))}),o(jt,it)};y(vt,jt=>{d()||jt(Tt)})}l(ye),A(()=>{ze(ye,"aria-label",e(Q).name),w(Ye,`âœ¨ ${e(Q).name??""} `)}),F("mouseenter",ye,()=>le(Je)),F("mouseleave",ye,oe),F("focus",ye,()=>le(Je)),F("blur",ye,oe),F("click",ye,()=>Ie(Je)),o(ae,ye)}),l(f),pa(2),o($,q)};y(ot,$=>{t().activeStates&&t().activeStates.length>0&&$(te)})}l(Ke);var _=s(Ke,2),v=r(_),ce=r(v),ne=s(ce,2),Ce=r(ne),Ee=s(Ce,2);{var He=$=>{var q=li(),f=r(q),ae=s(f,2);l(q),F("click",f,Oe),F("click",ae,Se),o($,q)};y(Ee,$=>{e(re)&&$(He)})}l(ne);var T=s(ne,2),h=r(T);let fe;var De=r(h),qe=r(De,!0);l(De);var Qe=s(De),_e=r(Qe,!0);l(Qe),l(h),l(T),l(v);var me=s(v,2),Le=r(me);we(Le),l(me),l(_),l(xe);var Ue=s(xe,2),Be=r(Ue),Ne=s(Be,2),ve=s(Ne,2),V=s(ve,2),Ge=s(V,2),S=s(Ge,2);$a(S,$=>c(U,$),()=>e(U)),l(Ue),l(N);var j=s(N,2),de=r(j);js(de,{});var ge=s(de,2);Ms(ge,{$$events:{roll:$=>$e($.detail)}});var E=s(ge,2);qs(E,{$$events:{roll:$=>$e($.detail)}});var P=s(E,2);Us(P,{$$events:{rollHitDice:L}});var he=s(P,2);Fl(he,{$$events:{roll:$=>$e($.detail)}});var G=s(he,2);Jl(G,{});var je=s(G,2);Yl(je,{}),l(j),l(I);var Ae=s(I,2);$a(dr(Ae,{get notation(){return e(ke)},get damageNotation(){return e(be)},get attackName(){return e(se)},get applyHalfDamage(){return e(pe)},get bonusBreakdown(){return e(J)},get visible(){return e(k)},$$events:{close:ue},$$legacy:!0}),$=>c(We,$),()=>e(We));var O=s(Ae,2);{var lt=$=>{Fr($,{get mode(){return e(z)},$$events:{close:()=>c(M,!1)}})};y(O,$=>{e(M)&&$(lt)})}var ht=s(O,2);{var kt=$=>{Kr($,{onClose:()=>c(Z,!1)})};y(ht,$=>{e(Z)&&$(kt)})}var dt=s(ht,2);ds(dt,{}),A(()=>{fe=pt(h,1,"btn btn-mode svelte-1uha8ag",null,fe,{"use-mode":!d()}),w(qe,d()?"ðŸ“":"ðŸŽ²"),w(_e,d()?"Edit Mode":"Use Mode")}),F("click",ce,()=>c(k,!0)),F("click",Ce,()=>c(re,!e(re))),F("click",h,m),Re(Le,p,$=>fs(Qt,$)),F("click",Be,()=>c(Z,!0)),F("click",Ne,()=>{c(z,"save"),c(M,!0)}),F("click",ve,()=>{c(z,"load"),c(M,!0)}),F("click",V,ie),F("click",Ge,g),F("change",S,C),o(a,W),Mt(),x()}export{fi as component};
