import{f as b,e as F,a as c,s as y,c as it,t as ht}from"../chunks/BmKkCgmR.js";import{i as yt}from"../chunks/AFJ5q3G2.js";import{c as Mt,o as zt}from"../chunks/BwhX61NF.js";import{a6 as ma,i as _a,b1 as Aa,b2 as Ra,b3 as va,J as jt,e as ya,b4 as ka,aa as Ia,b as i,r as xa,R as $a,g as Ma,B as kt,b5 as Xe,b6 as Lt,E as M,F as xt,s as n,a3 as I,G as l,I as a,H as s,d as e,C as ze,k as tt,z as B,b7 as St,b8 as Nt,b9 as Ca,an as Sa,ba as Ea}from"../chunks/CmcvLP-Y.js";import{s as st,c as X,a as ut,r as we,e as ot,i as dt,b as La,u as Pa,d as wt,f as ct,g as Xt,j as Kt,k as Ba,t as Gt,h as Ua,T as Ha,l as Ta,m as Na}from"../chunks/BH0g7pxY.js";import{i as j,s as Ct,a as We,b as at,d as Ga}from"../chunks/BibxXT0t.js";import{p as Rt,b as na}from"../chunks/BNYf2NzH.js";import{b as Tt,r as Oa}from"../chunks/BgMjFchL.js";function Qt(r,d,t=!1){if(r.multiple){if(d==null)return;if(!_a(d))return Aa();for(var v of r.options)v.selected=d.includes(Ot(v));return}for(v of r.options){var $=Ot(v);if(Ra($,d)){v.selected=!0;return}}(!t||d!==void 0)&&(r.selectedIndex=-1)}function oa(r){var d=new MutationObserver(()=>{Qt(r,r.__value)});d.observe(r,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),ma(()=>{d.disconnect()})}function ja(r,d,t=d){var v=new WeakSet,$=!0;va(r,"change",k=>{var w=k?"[selected]":":checked",G;if(r.multiple)G=[].map.call(r.querySelectorAll(w),Ot);else{var f=r.querySelector(w)??r.querySelector("option:not([disabled])");G=f&&Ot(f)}t(G),jt!==null&&v.add(jt)}),ya(()=>{var k=d();if(r===document.activeElement){var w=ka??jt;if(v.has(w))return}if(Qt(r,k,$),$&&k===void 0){var G=r.querySelector(":checked");G!==null&&(k=Ot(G),t(k))}r.__value=k,$=!1}),oa(r)}function Ot(r){return"__value"in r?r.__value:r.value}function Fe(r,d,t=d){var v=new WeakSet;va(r,"input",async $=>{var k=$?r.defaultValue:r.value;if(k=la(r)?ia(k):k,t(k),jt!==null&&v.add(jt),await Ia(),k!==(k=d())){var w=r.selectionStart,G=r.selectionEnd,f=r.value.length;if(r.value=k??"",G!==null){var z=r.value.length;w===G&&G===f&&z>f?(r.selectionStart=z,r.selectionEnd=z):(r.selectionStart=w,r.selectionEnd=Math.min(G,z))}}}),($a&&r.defaultValue!==r.value||i(d)==null&&r.value)&&(t(la(r)?ia(r.value):r.value),jt!==null&&v.add(jt)),xa(()=>{var $=d();if(r===document.activeElement){var k=ka??jt;if(v.has(k))return}la(r)&&$===ia(r.value)||r.type==="date"&&!$&&!r.value||$!==r.value&&(r.value=$??"")})}function da(r,d,t=d){va(r,"change",v=>{var $=v?r.defaultChecked:r.checked;t($)}),($a&&r.defaultChecked!==r.checked||i(d)==null)&&t(r.checked),xa(()=>{var v=d();r.checked=!!v})}function la(r){var d=r.type;return d==="number"||d==="range"}function ia(r){return r===""?null:+r}function qa(r,d,t){var v=Ma(r,d);v&&v.set&&(r[d]=t,ma(()=>{r[d]=null}))}function ua(r){return function(...d){var t=d[0];return t.stopPropagation(),r?.apply(this,d)}}function It(r,d){var t=r.$$events?.[d.type],v=_a(t)?t.slice():t==null?[]:[t];for(var $ of v)$.call(this,d)}const za="";function wa(...r){return Tt+za+Oa(r[0],r[1])}const ca={paladin:{name:"Paladin",hitDice:"d10",spellcaster:!0,spellcastingAbility:"charisma",spellSlotsByLevel:{1:0,2:2,3:3,4:3,5:4,6:4,7:4,8:4,9:4,10:4,11:4,12:4,13:4,14:4,15:4,16:4,17:4,18:4,19:4,20:4},features:[{name:"Divine Sense",type:"uses",maxUses:(r,d=1)=>1+Math.max(1,d),resetOn:"long",description:"Detect celestials, fiends, and undead within 60 feet",minLevel:1},{name:"Lay on Hands",type:"pool",maxPool:r=>r*5,resetOn:"long",description:"Heal wounds or cure disease",minLevel:1},{name:"Divine Smite",type:"spellSlot",description:"Expend spell slot to deal extra radiant damage",minLevel:2,rollable:!0},{name:"Channel Divinity",type:"pool",maxPool:r=>r>=18?3:r>=6?2:1,resetOn:"short",description:"Sacred Weapon or Turn Undead",minLevel:3}]},fighter:{name:"Fighter",hitDice:"d10",spellcaster:!1,features:[{name:"Second Wind",type:"uses",maxUses:1,resetOn:"short",description:"Regain 1d10 + fighter level HP as bonus action",minLevel:1,rollable:!0,rollFormula:r=>`1d10+${r}`},{name:"Action Surge",type:"uses",maxUses:r=>r>=17?2:1,resetOn:"short",description:"Take one additional action on your turn",minLevel:2},{name:"Indomitable",type:"uses",maxUses:r=>r>=17?3:r>=13?2:1,resetOn:"long",description:"Reroll a failed saving throw",minLevel:9}],subclasses:{champion:{name:"Champion",features:[{name:"Improved Critical",type:"info",description:"Critical hit on 19-20",minLevel:3},{name:"Remarkable Athlete",type:"info",description:"Add half proficiency to STR/DEX/CON checks, increase long jump distance",minLevel:7},{name:"Additional Fighting Style",type:"info",description:"Choose a second fighting style",minLevel:10},{name:"Superior Critical",type:"info",description:"Critical hit on 18-20",minLevel:15},{name:"Survivor",type:"info",description:"Regain 5 + CON mod HP at start of turn if below half HP",minLevel:18}]},battlemaster:{name:"Battle Master",features:[{name:"Combat Superiority",type:"uses",maxUses:r=>r>=15?6:r>=7?5:4,resetOn:"short",description:r=>`Use superiority dice (${r>=18?"d12":r>=10?"d10":"d8"}) for maneuvers`,minLevel:3},{name:"Know Your Enemy",type:"info",description:"Learn capabilities of creatures you observe",minLevel:7},{name:"Improved Combat Superiority",type:"info",description:"Superiority dice become d10",minLevel:10},{name:"Relentless",type:"info",description:"Regain 1 superiority die if you have none at start of turn",minLevel:15}]}}},rogue:{name:"Rogue",hitDice:"d8",spellcaster:!1,features:[{name:"Sneak Attack",type:"info",description:r=>`Deal ${Math.ceil(r/2)}d6 extra damage once per turn with advantage or ally nearby`,minLevel:1,rollable:!0,rollFormula:r=>`${Math.ceil(r/2)}d6`},{name:"Cunning Action",type:"info",description:"Dash, Disengage, or Hide as a bonus action",minLevel:2},{name:"Uncanny Dodge",type:"info",description:"Use reaction to halve damage from an attack",minLevel:5},{name:"Evasion",type:"info",description:"Take no damage on successful Dex save (half on fail)",minLevel:7}]},wizard:{name:"Wizard",hitDice:"d6",spellcaster:!0,spellcastingAbility:"intelligence",spellSlotsByLevel:{1:2,2:3,3:4,4:4,5:4,6:4,7:4,8:4,9:4,10:4,11:4,12:4,13:4,14:4,15:4,16:4,17:4,18:4,19:4,20:4},features:[{name:"Arcane Recovery",type:"uses",maxUses:1,resetOn:"long",description:r=>`Recover spell slots totaling up to ${Math.ceil(r/2)} levels during short rest`,minLevel:1},{name:"Spell Mastery",type:"info",description:"Cast one 1st-level and one 2nd-level spell at will",minLevel:18}]},cleric:{name:"Cleric",hitDice:"d8",spellcaster:!0,spellcastingAbility:"wisdom",spellSlotsByLevel:{1:2,2:3,3:4,4:4,5:4,6:4,7:4,8:4,9:4,10:4,11:4,12:4,13:4,14:4,15:4,16:4,17:4,18:4,19:4,20:4},features:[{name:"Channel Divinity",type:"pool",maxPool:r=>r>=18?3:r>=6?2:1,resetOn:"short",description:"Turn Undead or domain-specific ability",minLevel:2},{name:"Destroy Undead",type:"info",description:r=>`Channel Divinity destroys undead of CR ${r>=17?4:r>=14?3:r>=11?2:r>=8?1:.5} or lower`,minLevel:5},{name:"Divine Intervention",type:"uses",maxUses:1,resetOn:"long",description:r=>`${r}% chance to succeed, implore deity for aid`,minLevel:10}],subclasses:{war:{name:"War Domain",features:[{name:"War Priest",type:"uses",maxUses:(r,d=1)=>Math.max(1,d),resetOn:"long",description:"Make one weapon attack as a bonus action",minLevel:1},{name:"Guided Strike",type:"channelDivinity",description:"Use your Channel Divinity to gain +10 to an attack roll. Make this choice after you see the roll, but before the DM says whether the attack hits or misses.",minLevel:2,resetOn:"short"},{name:"War God's Blessing",type:"channelDivinity",description:"Use reaction to grant +10 to an ally's attack roll within 30 feet. Consumes one use of Channel Divinity.",minLevel:6,resetOn:"short"},{name:"Divine Strike",type:"info",description:r=>`Deal extra ${r>=14?"2d8":"1d8"} weapon damage once per turn`,minLevel:8,rollable:!0,rollFormula:r=>r>=14?"2d8":"1d8"},{name:"Avatar of Battle",type:"info",description:"Gain resistance to nonmagical weapon damage",minLevel:17}]},life:{name:"Life Domain",features:[{name:"Disciple of Life",type:"info",description:"Healing spells restore additional 2 + spell level HP",minLevel:1},{name:"Preserve Life",type:"pool",maxPool:r=>r*5,resetOn:"short",description:"Restore HP to creatures within 30 feet",minLevel:2},{name:"Blessed Healer",type:"info",description:"Regain 2 + spell level HP when you cast healing spell",minLevel:6},{name:"Divine Strike",type:"info",description:r=>`Deal extra ${r>=14?"2d8":"1d8"} radiant damage once per turn`,minLevel:8,rollable:!0,rollFormula:r=>r>=14?"2d8":"1d8"},{name:"Supreme Healing",type:"info",description:"Maximize healing dice instead of rolling",minLevel:17}]}}},barbarian:{name:"Barbarian",hitDice:"d12",spellcaster:!1,features:[{name:"Rage",type:"uses",maxUses:r=>r>=20?1/0:r>=17?6:r>=12?5:r>=6?4:r>=3?3:2,resetOn:"long",description:r=>`+${r>=16?4:r>=9?3:2} damage, resistance to physical damage`,minLevel:1},{name:"Reckless Attack",type:"info",description:"Gain advantage on melee attacks, enemies get advantage on you",minLevel:2},{name:"Danger Sense",type:"info",description:"Advantage on Dex saves against effects you can see",minLevel:2}],subclasses:{berserker:{name:"Path of the Berserker",features:[{name:"Frenzy",type:"info",description:"While raging, make melee attack as bonus action (gain 1 exhaustion after rage)",minLevel:3},{name:"Mindless Rage",type:"info",description:"Cannot be charmed or frightened while raging",minLevel:6},{name:"Intimidating Presence",type:"info",description:"Use action to frighten creature within 30 feet",minLevel:10},{name:"Retaliation",type:"info",description:"When damaged by creature within 5 feet, make melee attack as reaction",minLevel:14}]}}}};function _t(r){const d=r.toLowerCase();return ca[d]||null}function qt(r,d,t){const v=_t(r);if(!v)return[];const $=v.features.filter(k=>!k.minLevel||k.minLevel<=d);if(t&&v.subclasses&&v.subclasses[t]){const k=v.subclasses[t].features.filter(w=>!w.minLevel||w.minLevel<=d);return[...$,...k]}return $}function pa(r){const d=_t(r);return!d||!d.subclasses?[]:Object.keys(d.subclasses).map(t=>({id:t,name:d.subclasses[t].name}))}function fa(r,d){const t=_t(r);return!t||!t.spellcaster||!t.spellSlotsByLevel?0:t.spellSlotsByLevel[d]||0}function ba(r,d,t){const v=_t(r);return!v||!v.spellcaster?0:Math.max(1,t+d)}function Wa(r,d,t){const v=_t(r);return!v||!v.spellcaster?null:8+d+t}function Va(){return Object.keys(ca).map(r=>({id:r,name:ca[r].name}))}var Ja=b("<option> </option>"),Ka=b("<option> </option>"),Qa=b('<div class="form-group svelte-172i2fj"><label for="characterSubclass" class="svelte-172i2fj">Subclass</label> <select id="characterSubclass" class="svelte-172i2fj"><option>Select Subclass</option><!></select></div>'),Xa=b('<div class="info-grid svelte-172i2fj"><div class="form-group svelte-172i2fj"><label for="characterName" class="svelte-172i2fj">Character Name</label> <input type="text" id="characterName" placeholder="Enter name" class="svelte-172i2fj"/></div> <div class="form-group svelte-172i2fj"><label for="characterClass" class="svelte-172i2fj">Class</label> <select id="characterClass" class="svelte-172i2fj"><option>Select Class</option><!></select></div> <!> <div class="form-group svelte-172i2fj"><label for="characterLevel" class="svelte-172i2fj">Level</label> <input type="number" id="characterLevel" min="1" max="20" class="svelte-172i2fj"/></div> <div class="form-group svelte-172i2fj"><label for="characterRace" class="svelte-172i2fj">Race</label> <input type="text" id="characterRace" placeholder="e.g., Human" class="svelte-172i2fj"/></div> <div class="form-group svelte-172i2fj"><label for="characterBackground" class="svelte-172i2fj">Background</label> <input type="text" id="characterBackground" placeholder="e.g., Soldier" class="svelte-172i2fj"/></div> <div class="form-group svelte-172i2fj"><label for="characterAlignment" class="svelte-172i2fj">Alignment</label> <input type="text" id="characterAlignment" placeholder="e.g., Lawful Good" class="svelte-172i2fj"/></div></div>'),Ya=b('<section class="character-info svelte-172i2fj"><div class="header svelte-172i2fj"><h2 class="svelte-172i2fj">Character Info</h2> <button class="collapse-btn svelte-172i2fj"> </button></div> <!></section>');function Za(r,d){kt(d,!1);const t=()=>We(X,"$character",$),v=()=>We(ut,"$collapsedStates",$),[$,k]=Ct(),w=I(),G=Va();function f(oe){const ue=oe.target;X.update(Y=>(Y.class=ue.value,Y.subclass="",Y))}function z(oe){const ue=oe.target;X.update(Y=>(Y.subclass=ue.value,Y))}function le(oe){const ue=oe.target;X.update(Y=>(Y.level=parseInt(ue.value)||1,Y)),Pa()}function H(){ut.update(oe=>({...oe,characterInfo:!oe.characterInfo}))}Xe(()=>(t(),pa),()=>{n(w,t().class?pa(t().class):[])}),Lt(),yt();var V=Ya(),be=l(V),de=a(l(be),2),xe=l(de,!0);s(de),s(be);var me=a(be,2);{var O=oe=>{var ue=Xa(),Y=l(ue),ce=a(l(Y),2);we(ce),s(Y);var Z=a(Y,2),P=a(l(Z),2),ve=l(P);ve.value=ve.__value="";var fe=a(ve);ot(fe,1,()=>G,dt,(re,Pe)=>{var Le=Ja(),Ve=l(Le,!0);s(Le);var pe={};M(()=>{y(Ve,(e(Pe),i(()=>e(Pe).name))),pe!==(pe=(e(Pe),i(()=>e(Pe).id)))&&(Le.value=(Le.__value=(e(Pe),i(()=>e(Pe).id)))??"")}),c(re,Le)}),s(P);var ee;oa(P),s(Z);var He=a(Z,2);{var C=re=>{var Pe=Qa(),Le=a(l(Pe),2),Ve=l(Le);Ve.value=Ve.__value="";var pe=a(Ve);ot(pe,1,()=>e(w),dt,(Te,Oe)=>{var qe=Ka(),Ye=l(qe,!0);s(qe);var g={};M(()=>{y(Ye,(e(Oe),i(()=>e(Oe).name))),g!==(g=(e(Oe),i(()=>e(Oe).id)))&&(qe.value=(qe.__value=(e(Oe),i(()=>e(Oe).id)))??"")}),c(Te,qe)}),s(Le);var m;oa(Le),s(Pe),M(()=>{m!==(m=(t(),i(()=>t().subclass)))&&(Le.value=(Le.__value=(t(),i(()=>t().subclass)))??"",Qt(Le,(t(),i(()=>t().subclass))))}),F("change",Le,z),c(re,Pe)};j(He,re=>{e(w),i(()=>e(w).length>0)&&re(C)})}var J=a(He,2),ie=a(l(J),2);we(ie),s(J);var h=a(J,2),R=a(l(h),2);we(R),s(h);var p=a(h,2),N=a(l(p),2);we(N),s(p);var K=a(p,2),U=a(l(K),2);we(U),s(K),s(ue),M(()=>{ee!==(ee=(t(),i(()=>t().class)))&&(P.value=(P.__value=(t(),i(()=>t().class)))??"",Qt(P,(t(),i(()=>t().class)))),La(ie,(t(),i(()=>t().level)))}),Fe(ce,()=>t().name,re=>at(X,i(t).name=re,i(t))),F("change",P,f),F("change",ie,le),Fe(R,()=>t().race,re=>at(X,i(t).race=re,i(t))),Fe(N,()=>t().background,re=>at(X,i(t).background=re,i(t))),Fe(U,()=>t().alignment,re=>at(X,i(t).alignment=re,i(t))),c(oe,ue)};j(me,oe=>{v(),i(()=>!v().characterInfo)&&oe(O)})}s(V),M(()=>{st(de,"aria-label",(v(),i(()=>v().characterInfo?"Expand":"Collapse"))),y(xe,(v(),i(()=>v().characterInfo?"â–¼":"â–²")))}),F("click",de,H),c(r,V),xt(),k()}var es=b('<div class="ability-card svelte-bbv1xt"><h3 class="svelte-bbv1xt"> </h3> <input type="number" class="ability-score svelte-bbv1xt" min="1" max="30"/> <div class="ability-modifier svelte-bbv1xt"> </div> <button class="roll-btn svelte-bbv1xt">Check</button> <div class="save-row svelte-bbv1xt"><input type="checkbox" class="svelte-bbv1xt"/> <label class="svelte-bbv1xt">Save</label> <button class="roll-btn-small svelte-bbv1xt">Roll</button></div></div>'),ts=b('<div class="proficiency-bonus svelte-bbv1xt"><label for="profBonus">Proficiency Bonus</label> <input type="number" id="profBonus" class="prof-input svelte-bbv1xt"/></div> <div class="abilities-grid svelte-bbv1xt"></div>',1),as=b('<section><div class="header svelte-bbv1xt"><h2 class="svelte-bbv1xt">Ability Scores</h2> <button class="collapse-btn svelte-bbv1xt"> </button></div> <!></section>');function ss(r,d){kt(d,!1);const t=()=>We(Xt,"$abilityModifiers",w),v=()=>We(X,"$character",w),$=()=>We(wt,"$searchFilter",w),k=()=>We(ut,"$collapsedStates",w),[w,G]=Ct(),f=I(),z=I(),le=Mt(),H=[{key:"strength",label:"Strength"},{key:"dexterity",label:"Dexterity"},{key:"constitution",label:"Constitution"},{key:"intelligence",label:"Intelligence"},{key:"wisdom",label:"Wisdom"},{key:"charisma",label:"Charisma"}];function V(){updateProficiencyBonus()}function be(P){const ve=t()[P],fe=`1d20${ve>=0?"+":""}${ve}`;le("roll",fe)}function de(P){const ve=t()[P],fe=v().saveProficiencies[P]?v().proficiencyBonus:0,ee=ve+fe,He=`1d20${ee>=0?"+":""}${ee}`;le("roll",He)}function xe(){ut.update(P=>({...P,abilityScores:!P.abilityScores}))}Xe(()=>$(),()=>{n(f,H.filter(({label:P})=>$()?P.toLowerCase().includes($().toLowerCase()):!0))}),Xe(()=>(e(f),$()),()=>{n(z,e(f).length>0||!$()||$().toLowerCase().includes("proficiency"))}),Lt(),yt();var me=as();let O;var oe=l(me),ue=a(l(oe),2),Y=l(ue,!0);s(ue),s(oe);var ce=a(oe,2);{var Z=P=>{var ve=ts(),fe=ze(ve),ee=a(l(fe),2);we(ee),s(fe);var He=a(fe,2);ot(He,5,()=>e(f),dt,(C,J)=>{let ie=()=>e(J).key,h=()=>e(J).label;var R=es(),p=l(R),N=l(p,!0);s(p);var K=a(p,2);we(K);var U=a(K,2),re=l(U);s(U);var Pe=a(U,2),Le=a(Pe,2),Ve=l(Le);we(Ve);var pe=a(Ve,2),m=a(pe,2);s(Le),s(R),M(Te=>{y(N,Te),y(re,`${t(),ie(),i(()=>t()[ie()]>=0?"+":"")??""}${t(),ie(),i(()=>t()[ie()])??""}`),st(Ve,"id",`${ie()}-save`),st(pe,"for",`${ie()}-save`)},[()=>(h(),i(()=>h().substring(0,3).toUpperCase()))]),Fe(K,()=>v().abilities[ie()],Te=>at(X,i(v).abilities[ie()]=Te,i(v))),F("change",K,V),F("click",Pe,()=>be(ie())),da(Ve,()=>v().saveProficiencies[ie()],Te=>at(X,i(v).saveProficiencies[ie()]=Te,i(v))),F("click",m,()=>de(ie())),c(C,R)}),s(He),Fe(ee,()=>v().proficiencyBonus,C=>at(X,i(v).proficiencyBonus=C,i(v))),c(P,ve)};j(ce,P=>{k(),i(()=>!k().abilityScores)&&P(Z)})}s(me),M(()=>{O=ct(me,1,"ability-scores svelte-bbv1xt",null,O,{hidden:!e(z)}),st(ue,"aria-label",(k(),i(()=>k().abilityScores?"Expand":"Collapse"))),y(Y,(k(),i(()=>k().abilityScores?"â–¼":"â–²")))}),F("click",ue,xe),c(r,me),xt(),G()}var ls=b('<span class="hit-dice-type"> </span>'),is=b('<div class="stats-grid svelte-1r5hyyb"><div class="stat-box svelte-1r5hyyb"><label for="armorClass" class="svelte-1r5hyyb">Armor Class</label> <input type="number" id="armorClass" class="stat-input svelte-1r5hyyb"/></div> <div class="stat-box svelte-1r5hyyb"><label for="initiative" class="svelte-1r5hyyb">Initiative</label> <input type="number" id="initiative" class="stat-input svelte-1r5hyyb"/></div> <div class="stat-box svelte-1r5hyyb"><label for="speed" class="svelte-1r5hyyb">Speed</label> <input type="text" id="speed" class="stat-input svelte-1r5hyyb"/></div></div> <div class="hp-section svelte-1r5hyyb"><h3 class="svelte-1r5hyyb">Hit Points</h3> <div class="hp-display svelte-1r5hyyb"><div class="hp-inputs svelte-1r5hyyb"><input type="number" class="hp-current svelte-1r5hyyb" min="0"/> <span class="hp-separator svelte-1r5hyyb">/</span> <input type="number" class="hp-max svelte-1r5hyyb" min="0"/></div> <div class="hp-controls svelte-1r5hyyb"><button class="hp-btn svelte-1r5hyyb">âˆ’</button> <button class="hp-btn svelte-1r5hyyb">+</button> <button class="hp-btn svelte-1r5hyyb">âˆ’5</button> <button class="hp-btn svelte-1r5hyyb">+5</button></div></div> <div class="temp-hp svelte-1r5hyyb"><label for="tempHP" class="svelte-1r5hyyb">Temp HP</label> <input type="number" id="tempHP" min="0" class="svelte-1r5hyyb"/></div></div> <div class="hit-dice-section svelte-1r5hyyb"><h3 class="svelte-1r5hyyb">Hit Dice</h3> <div class="hit-dice-display svelte-1r5hyyb"><input type="number" class="hit-dice-input svelte-1r5hyyb" min="0"/> <span>/</span> <input type="number" class="hit-dice-input svelte-1r5hyyb" min="0"/> <!></div> <div class="hit-dice-controls"><label for="hitDiceCount" class="svelte-1r5hyyb">Roll</label> <input type="number" id="hitDiceCount" class="hit-dice-count-input svelte-1r5hyyb" min="1" value="1"/> <button class="btn btn-primary roll-hit-dice use-enabled svelte-1r5hyyb">ðŸŽ² Roll</button></div></div>',1),rs=b('<section><div class="header svelte-1r5hyyb"><h2 class="svelte-1r5hyyb">Combat Stats</h2> <button class="collapse-btn svelte-1r5hyyb"> </button></div> <!></section>');function ns(r,d){kt(d,!1);const t=()=>We(X,"$character",w),v=()=>We(Xt,"$abilityModifiers",w),$=()=>We(wt,"$searchFilter",w),k=()=>We(ut,"$collapsedStates",w),[w,G]=Ct(),f=I(),z=Mt();function le(Y){X.update(ce=>(ce.currentHP=Math.max(0,Math.min(ce.maxHP,ce.currentHP+Y)),ce))}function H(Y=1){if(t().hitDice.current<=0){alert("No hit dice remaining!");return}if(!t().class){alert("Please select a class first!");return}const ce=_t(t().class);if(!ce){alert("Invalid class configuration!");return}const Z=Math.min(Y,t().hitDice.current),P=ce.hitDice,ve=v().constitution,fe=ve>=0?`+${ve}`:`${ve}`,ee=`${Z}${P}${fe}`;z("rollHitDice",{notation:ee,hitDie:P,count:Z})}function V(){ut.update(Y=>({...Y,combatStats:!Y.combatStats}))}Xe(()=>$(),()=>{n(f,!$()||"armor class".includes($().toLowerCase())||"initiative".includes($().toLowerCase())||"speed".includes($().toLowerCase())||"hit points".includes($().toLowerCase())||"hp".includes($().toLowerCase())||"hit dice".includes($().toLowerCase())||"combat".includes($().toLowerCase()))}),Lt(),yt();var be=rs();let de;var xe=l(be),me=a(l(xe),2),O=l(me,!0);s(me),s(xe);var oe=a(xe,2);{var ue=Y=>{var ce=is(),Z=ze(ce),P=l(Z),ve=a(l(P),2);we(ve),s(P);var fe=a(P,2),ee=a(l(fe),2);we(ee),s(fe);var He=a(fe,2),C=a(l(He),2);we(C),s(He),s(Z);var J=a(Z,2),ie=a(l(J),2),h=l(ie),R=l(h);we(R);var p=a(R,4);we(p),s(h);var N=a(h,2),K=l(N),U=a(K,2),re=a(U,2),Pe=a(re,2);s(N),s(ie);var Le=a(ie,2),Ve=a(l(Le),2);we(Ve),s(Le),s(J);var pe=a(J,2),m=a(l(pe),2),Te=l(m);we(Te);var Oe=a(Te,4);we(Oe);var qe=a(Oe,2);{var Ye=E=>{const Ae=tt(()=>(B(_t),t(),i(()=>_t(t().class))));var Ce=it(),Re=ze(Ce);{var $e=S=>{const _e=tt(()=>(v(),i(()=>v().constitution)));var ye=ls(),Ie=l(ye);s(ye),M(()=>y(Ie,`(${B(e(Ae)),i(()=>e(Ae).hitDice)??""}${(e(_e)>=0?`+${e(_e)}`:e(_e))??""})`)),c(S,ye)};j(Re,S=>{e(Ae)&&S($e)})}c(E,Ce)};j(qe,E=>{t(),i(()=>t().class)&&E(Ye)})}s(m);var g=a(m,2),W=a(l(g),2),Q=a(W,2);s(g),s(pe),M(()=>{st(R,"max",(t(),i(()=>t().maxHP))),st(Te,"max",(t(),i(()=>t().hitDice.max))),st(W,"max",(t(),i(()=>t().hitDice.current))),Q.disabled=(t(),i(()=>t().hitDice.current<=0||!t().class))}),Fe(ve,()=>t().armorClass,E=>at(X,i(t).armorClass=E,i(t))),Fe(ee,()=>t().initiative,E=>at(X,i(t).initiative=E,i(t))),Fe(C,()=>t().speed,E=>at(X,i(t).speed=E,i(t))),Fe(R,()=>t().currentHP,E=>at(X,i(t).currentHP=E,i(t))),Fe(p,()=>t().maxHP,E=>at(X,i(t).maxHP=E,i(t))),F("click",K,()=>le(-1)),F("click",U,()=>le(1)),F("click",re,()=>le(-5)),F("click",Pe,()=>le(5)),Fe(Ve,()=>t().tempHP,E=>at(X,i(t).tempHP=E,i(t))),Fe(Te,()=>t().hitDice.current,E=>at(X,i(t).hitDice.current=E,i(t))),Fe(Oe,()=>t().hitDice.max,E=>at(X,i(t).hitDice.max=E,i(t))),F("input",W,E=>{const Ae=E.target,Ce=parseInt(Ae.value);Ce>t().hitDice.current&&(Ae.value=String(t().hitDice.current)),Ce<1&&(Ae.value="1")}),F("click",Q,()=>{const E=document.getElementById("hitDiceCount"),Ae=parseInt(E?.value||"1");H(Ae)}),c(Y,ce)};j(oe,Y=>{k(),i(()=>!k().combatStats)&&Y(ue)})}s(be),M(()=>{de=ct(be,1,"combat-stats svelte-1r5hyyb",null,de,{hidden:!e(f)}),st(me,"aria-label",(k(),i(()=>k().combatStats?"Expand":"Collapse"))),y(O,(k(),i(()=>k().combatStats?"â–¼":"â–²")))}),F("click",me,V),c(r,be),xt(),G()}const ra={acrobatics:"dexterity",animalHandling:"wisdom",arcana:"intelligence",athletics:"strength",deception:"charisma",history:"intelligence",insight:"wisdom",intimidation:"charisma",investigation:"intelligence",medicine:"wisdom",nature:"intelligence",perception:"wisdom",performance:"charisma",persuasion:"charisma",religion:"intelligence",sleightOfHand:"dexterity",stealth:"dexterity",survival:"wisdom"};var os=b('<div class="skill-row svelte-1f1pl16"><input type="checkbox" class="svelte-1f1pl16"/> <label class="svelte-1f1pl16"> <span class="ability-tag svelte-1f1pl16"> </span></label> <span class="skill-modifier svelte-1f1pl16"> </span> <button class="roll-btn svelte-1f1pl16">Roll</button></div>'),cs=b('<div class="skills-grid svelte-1f1pl16"></div>'),vs=b('<section><div class="header svelte-1f1pl16"><h2 class="svelte-1f1pl16">Skills</h2> <button class="collapse-btn svelte-1f1pl16"> </button></div> <!></section>');function ds(r,d){kt(d,!1);const t=()=>We(Xt,"$abilityModifiers",w),v=()=>We(X,"$character",w),$=()=>We(wt,"$searchFilter",w),k=()=>We(ut,"$collapsedStates",w),[w,G]=Ct(),f=I(),z=I(),le=Mt(),H=[{key:"acrobatics",label:"Acrobatics"},{key:"animalHandling",label:"Animal Handling"},{key:"arcana",label:"Arcana"},{key:"athletics",label:"Athletics"},{key:"deception",label:"Deception"},{key:"history",label:"History"},{key:"insight",label:"Insight"},{key:"intimidation",label:"Intimidation"},{key:"investigation",label:"Investigation"},{key:"medicine",label:"Medicine"},{key:"nature",label:"Nature"},{key:"perception",label:"Perception"},{key:"performance",label:"Performance"},{key:"persuasion",label:"Persuasion"},{key:"religion",label:"Religion"},{key:"sleightOfHand",label:"Sleight of Hand"},{key:"stealth",label:"Stealth"},{key:"survival",label:"Survival"}];function V(Z){const P=ra[Z],ve=t()[P],fe=v().skillProficiencies[Z]?v().proficiencyBonus:0;return ve+fe}function be(Z){const P=V(Z),ve=`1d20${P>=0?"+":""}${P}`;le("roll",ve)}function de(){ut.update(Z=>({...Z,skills:!Z.skills}))}Xe(()=>$(),()=>{n(f,H.filter(({label:Z})=>$()?Z.toLowerCase().includes($().toLowerCase()):!0))}),Xe(()=>e(f),()=>{n(z,e(f).length>0)}),Lt(),yt();var xe=vs();let me;var O=l(xe),oe=a(l(O),2),ue=l(oe,!0);s(oe),s(O);var Y=a(O,2);{var ce=Z=>{var P=cs();ot(P,5,()=>e(f),dt,(ve,fe)=>{let ee=()=>e(fe).key,He=()=>e(fe).label;const C=tt(()=>(B(ra),ee(),i(()=>ra[ee()]))),J=tt(()=>(ee(),i(()=>V(ee()))));var ie=os(),h=l(ie);we(h);var R=a(h,2),p=l(R),N=a(p),K=l(N);s(N),s(R);var U=a(R,2),re=l(U);s(U);var Pe=a(U,2);s(ie),M(Le=>{st(h,"id",ee()),st(R,"for",ee()),y(p,`${He()??""} `),y(K,`(${Le??""})`),y(re,`${e(J)>=0?"+":""}${e(J)??""}`)},[()=>(B(e(C)),i(()=>e(C).substring(0,3).toUpperCase()))]),da(h,()=>v().skillProficiencies[ee()],Le=>at(X,i(v).skillProficiencies[ee()]=Le,i(v))),F("click",Pe,()=>be(ee())),c(ve,ie)}),s(P),c(Z,P)};j(Y,Z=>{k(),i(()=>!k().skills)&&Z(ce)})}s(xe),M(()=>{me=ct(xe,1,"skills svelte-1f1pl16",null,me,{hidden:!e(z)}),st(oe,"aria-label",(k(),i(()=>k().skills?"Expand":"Collapse"))),y(ue,(k(),i(()=>k().skills?"â–¼":"â–²")))}),F("click",oe,de),c(r,xe),xt(),G()}let Vt=null,Jt=null;async function Da(){if(Vt)return Vt;try{return Vt=await(await fetch(wa("/data/spells.json"))).json(),Vt||[]}catch(r){return console.error("Failed to load spells:",r),[]}}async function us(){if(Jt)return Jt;try{return Jt=await(await fetch(wa("/data/feats.json"))).json(),Jt||[]}catch(r){return console.error("Failed to load feats:",r),[]}}function ha(r,d){if(!d.trim())return r;const t=d.toLowerCase();return r.filter(v=>v.name.toLowerCase().includes(t)||v.school.toLowerCase().includes(t)||v.classes.some($=>$.toLowerCase().includes(t))||v.description.toLowerCase().includes(t))}function ps(r,d){return d===null?r:r.filter(t=>t.level===d)}function fs(r,d){if(!d.trim())return r;const t=d.toLowerCase();return r.filter(v=>v.name.toLowerCase().includes(t)||v.description.toLowerCase().includes(t))}var bs=b('<button class="btn-remove svelte-14o91c5">Ã—</button>'),hs=b('<div class="spell-info-loading svelte-14o91c5">Loading spell info...</div>'),gs=b('<div class="spell-notes svelte-14o91c5"><h4 class="svelte-14o91c5">General Notes</h4> <p> </p></div>'),ms=b('<li class="svelte-14o91c5"><strong>At Higher Levels:</strong> </li>'),_s=b('<ul class="svelte-14o91c5"><li class="svelte-14o91c5"><strong>Level:</strong> </li> <li class="svelte-14o91c5"><strong>Casting Time:</strong> </li> <li class="svelte-14o91c5"><strong>Range:</strong> </li> <li class="svelte-14o91c5"><strong>Components:</strong> <!></li> <li class="svelte-14o91c5"><strong>Duration:</strong> <!> </li> <li class="svelte-14o91c5"><strong>Description:</strong> </li> <!></ul>'),ys=b("<option> </option>"),ks=b('<span class="scaled-damage svelte-14o91c5"> </span>'),xs=b('<span class="scaled-damage svelte-14o91c5"> </span>'),$s=b('<div class="target-condition svelte-14o91c5"><label class="svelte-14o91c5"><input type="checkbox" class="use-enabled svelte-14o91c5"/> Target is Fiend or Undead <!></label></div>'),Cs=b('<div class="spell-level-selector svelte-14o91c5"><label class="svelte-14o91c5">Cast at Level:</label> <select class="spell-level-select use-enabled svelte-14o91c5"></select> <!></div> <!>',1),Ss=b('<div class="spell-level-selector svelte-14o91c5"><span style="color: #dc3545; font-weight: bold;">No spell slots available!</span></div>'),Ls=b('<!> <div class="spell-info svelte-14o91c5"><div class="spell-info-header svelte-14o91c5" role="button" tabindex="0"><h4 class="svelte-14o91c5">Spell Info</h4> <button class="collapse-btn-small svelte-14o91c5"> </button></div> <!></div> <!>',1),js=b('<div class="spell-info-missing svelte-14o91c5">Spell info not found.</div>'),ws=b('<div class="attack-notes svelte-14o91c5"><label class="svelte-14o91c5">Notes</label> <textarea placeholder="e.g., DC 15 Dex save, Range 120 ft, Concentration" class="notes-input svelte-14o91c5" rows="2"></textarea></div>'),Ds=b('<button class="btn btn-primary">Roll Attack</button>'),Fs=b('<button class="btn btn-secondary"><!></button>'),As=b('<button class="btn btn-secondary">Roll Damage</button>'),Rs=b('<div class="attack-card svelte-14o91c5"><div class="attack-header svelte-14o91c5"><input type="text" placeholder="Attack name" class="attack-name svelte-14o91c5"/> <!></div> <div class="attack-details svelte-14o91c5"><div class="attack-field svelte-14o91c5"><label class="svelte-14o91c5">Bonus</label> <input type="number" class="attack-bonus svelte-14o91c5"/></div> <div class="attack-field svelte-14o91c5"><label class="svelte-14o91c5">Damage</label> <input type="text" placeholder="e.g., 2d6+3" class="attack-damage svelte-14o91c5"/></div> <div class="attack-field svelte-14o91c5"><label class="svelte-14o91c5">Type</label> <input type="text" placeholder="e.g., slashing" class="attack-type svelte-14o91c5"/></div></div> <!> <!> <div class="attack-actions svelte-14o91c5"><!> <!></div></div>'),Is=b('<p class="no-attacks svelte-14o91c5">No attacks added yet. Click "Add Attack" to create one.</p>'),Ms=b('<p class="no-attacks svelte-14o91c5">No attacks match your search.</p>'),Es=b('<button class="btn btn-secondary">Add Attack</button> <div class="attacks-list svelte-14o91c5"><!> <!></div>',1),Ps=b('<section><div class="header svelte-14o91c5"><h2 class="svelte-14o91c5">Attacks & Spells</h2> <button class="collapse-btn svelte-14o91c5"> </button></div> <!></section>');function Bs(r,d){kt(d,!1);const t=()=>We(X,"$character",w),v=()=>We(wt,"$searchFilter",w),$=()=>We(ut,"$collapsedStates",w),k=()=>We(Kt,"$isEditMode",w),[w,G]=Ct(),f=I(),z=I(),le=Mt();let H=I({});function V(p){Ca(H,e(H)[p]=!e(H)[p]),n(H,{...e(H)})}function be(p){return p.description.toLowerCase().includes("regain")&&(p.description.toLowerCase().includes("hit point")||p.description.toLowerCase().includes("hp"))}function de(){X.update(p=>(p.attacks=[...p.attacks,{id:crypto.randomUUID(),name:"",bonus:0,damage:"",damageType:"",notes:""}],p))}function xe(p){X.update(N=>(N.attacks=N.attacks.filter(K=>K.id!==p),N))}function me(p){let N=p.damage;if(p.spellRef){const U=ce(p.spellRef);if(U&&U.level>0){const re=p.castAtLevel||U.level;if(!Z(re)){alert(`No level ${re} spell slots available!`);return}N=P(p,U)}}const K=`1d20${p.bonus>=0?"+":""}${p.bonus}`;le("roll",{notation:K,damageNotation:N,attackName:p.name})}function O(p){if(!p.damage){alert(`${p.name}: No damage specified`);return}let N=p.damage;if(p.spellRef){const K=ce(p.spellRef);if(K&&K.level>0){const U=p.castAtLevel||K.level;if(!Z(U)){alert(`No level ${U} spell slots available!`);return}N=P(p,K)}}le("roll",{notation:N,attackName:p.name})}function oe(){ut.update(p=>({...p,attacks:!p.attacks}))}let ue=I([]),Y=I(!1);zt(async()=>{n(ue,await Da()),n(Y,!0)});function ce(p){return e(ue).find(N=>N.name===p)}function Z(p){t().classFeatures.spellSlotsByLevel||at(X,i(t).classFeatures.spellSlotsByLevel={},i(t)),t().classFeatures.spellSlotsByLevel[p]||at(X,i(t).classFeatures.spellSlotsByLevel[p]=Array(2).fill(!1),i(t));const K=t().classFeatures.spellSlotsByLevel[p].findIndex(U=>!U);return K===-1?!1:(X.update(U=>(U.classFeatures.spellSlotsByLevel||(U.classFeatures.spellSlotsByLevel={}),U.classFeatures.spellSlotsByLevel[p]||(U.classFeatures.spellSlotsByLevel[p]=Array(2).fill(!1)),U.classFeatures.spellSlotsByLevel[p][K]=!0,U)),!0)}function P(p,N){let K=p.damage,U=0;if(N.higherLevelSlot&&p.castAtLevel){const pe=N.level,Te=(p.castAtLevel||pe)-pe;if(Te>0){const Oe=N.higherLevelSlot.match(/(\d+)d(\d+)\s+for\s+each.*?level\s+above/i);if(Oe){const[,qe]=Oe;U+=Te*parseInt(qe)}}}if(p.targetIsFiendOrUndead&&N.description.includes("Fiend or an Undead")){const pe=N.description.match(/increases by (\d+)d(\d+) if.*?Fiend or.*?Undead/i);if(pe){const[,m]=pe;U+=parseInt(m)}}const re=K.match(/(\d+)d(\d+)/);if(!re)return K;const[,Pe,Le]=re;return`${parseInt(Pe)+U}d${Le}`}function ve(p){const N=[];for(let U=p.level;U<=9;U++){const re=t().classFeatures.spellSlotsByLevel?.[U];re&&re.length>0&&N.push(U)}return N}function fe(p){const N=t().classFeatures.spellSlotsByLevel?.[p]||[],K=N.length,U=N.filter(re=>re).length;return{available:K-U,total:K}}Xe(()=>(t(),v()),()=>{n(f,t().attacks.filter(p=>{if(!v())return!0;const N=v().toLowerCase();return p.name.toLowerCase().includes(N)||p.damageType.toLowerCase().includes(N)}).sort((p,N)=>!p.spellRef&&N.spellRef?-1:p.spellRef&&!N.spellRef?1:0))}),Xe(()=>(v(),e(f)),()=>{n(z,!v()||e(f).length>0||"attack".includes(v().toLowerCase())||"spell".includes(v().toLowerCase()))}),Lt(),yt();var ee=Ps();let He;var C=l(ee),J=a(l(C),2),ie=l(J,!0);s(J),s(C);var h=a(C,2);{var R=p=>{var N=Es(),K=ze(N),U=a(K,2),re=l(U);ot(re,1,()=>e(f),pe=>pe.id,(pe,m,Te)=>{var Oe=Rs(),qe=l(Oe),Ye=l(qe);we(Ye);var g=a(Ye,2);{var W=A=>{var o=bs();F("click",o,()=>xe(e(m).id)),c(A,o)};j(g,A=>{k()&&A(W)})}s(qe);var Q=a(qe,2),E=l(Q),Ae=a(l(E),2);we(Ae),s(E);var Ce=a(E,2),Re=a(l(Ce),2);we(Re),s(Ce);var $e=a(Ce,2),S=a(l($e),2);we(S),s($e),s(Q);var _e=a(Q,2);{var ye=A=>{var o=it(),L=ze(o);{var q=T=>{var _=hs();c(T,_)},D=T=>{const _=tt(()=>(e(m),i(()=>ce(e(m).spellRef))));var he=it(),ke=ze(he);{var Ge=u=>{var ae=Ls(),x=ze(ae);{var ge=et=>{var rt=gs(),mt=a(l(rt),2),Et=l(mt,!0);s(mt),s(rt),M(()=>y(Et,(e(m),i(()=>e(m).generalNotes)))),c(et,rt)};j(x,et=>{e(m),i(()=>e(m).generalNotes)&&et(ge)})}var Be=a(x,2),Ue=l(Be),ne=a(l(Ue),2),Ee=l(ne,!0);s(ne),s(Ue);var Ke=a(Ue,2);{var se=et=>{var rt=_s(),mt=l(rt),Et=a(l(mt));s(mt);var Pt=a(mt,2),Zt=a(l(Pt));s(Pt);var $t=a(Pt,2),At=a(l($t));s($t);var Dt=a($t,2),Bt=a(l(Dt)),Ft=a(Bt);{var ea=lt=>{var vt=ht();M(()=>y(vt,`(${B(e(_)),i(()=>e(_).material)??""})`)),c(lt,vt)};j(Ft,lt=>{B(e(_)),i(()=>e(_).material)&&lt(ea)})}s(Dt);var Ut=a(Dt,2),Wt=a(l(Ut),2);{var ta=lt=>{var vt=ht("Concentration,");c(lt,vt)};j(Wt,lt=>{B(e(_)),i(()=>e(_).concentration)&&lt(ta)})}var pt=a(Wt,1,!0);s(Ut);var nt=a(Ut,2),ft=a(l(nt));s(nt);var bt=a(nt,2);{var Ht=lt=>{var vt=ms(),aa=a(l(vt));s(vt),M(()=>y(aa,` ${B(e(_)),i(()=>e(_).higherLevelSlot)??""}`)),c(lt,vt)};j(bt,lt=>{B(e(_)),i(()=>e(_).higherLevelSlot)&&lt(Ht)})}s(rt),M(lt=>{y(Et,` ${B(e(_)),i(()=>e(_).level)??""}`),y(Zt,` ${B(e(_)),i(()=>e(_).castingTime||e(_).actionType)??""}`),y(At,` ${B(e(_)),i(()=>e(_).range)??""}`),y(Bt,` ${lt??""}`),y(pt,(B(e(_)),i(()=>e(_).duration))),y(ft,` ${B(e(_)),i(()=>e(_).description)??""}`)},[()=>(B(e(_)),i(()=>e(_).components.join(", ")))]),c(et,rt)};j(Ke,et=>{e(H),e(m),i(()=>!e(H)[e(m).id])&&et(se)})}s(Be);var Qe=a(Be,2);{var gt=et=>{const rt=tt(()=>(B(e(_)),i(()=>ve(e(_)))));var mt=it(),Et=ze(mt);{var Pt=$t=>{var At=Cs(),Dt=ze(At),Bt=l(Dt),Ft=a(Bt,2);M(()=>{e(m),St(()=>{e(rt)})}),ot(Ft,5,()=>e(rt),dt,(pt,nt)=>{const ft=tt(()=>(e(nt),i(()=>fe(e(nt)))));var bt=ys(),Ht=l(bt);s(bt);var lt={};M(()=>{y(Ht,`Level ${e(nt)??""} (${B(e(ft)),i(()=>e(ft).available)??""}/${B(e(ft)),i(()=>e(ft).total)??""} slots)`),lt!==(lt=e(nt))&&(bt.value=(bt.__value=e(nt))??"")}),c(pt,bt)}),s(Ft);var ea=a(Ft,2);{var Ut=pt=>{const nt=tt(()=>(e(m),B(e(_)),i(()=>P(e(m),e(_)))));var ft=ks(),bt=l(ft);s(ft),M(()=>y(bt,`Damage: ${e(nt)??""}`)),c(pt,ft)};j(ea,pt=>{e(m),B(e(_)),i(()=>e(m).castAtLevel&&e(m).castAtLevel>e(_).level)&&pt(Ut)})}s(Dt);var Wt=a(Dt,2);{var ta=pt=>{var nt=$s(),ft=l(nt),bt=l(ft);we(bt);var Ht=a(bt,2);{var lt=vt=>{const aa=tt(()=>(e(m),B(e(_)),i(()=>P(e(m),e(_)))));var sa=xs(),Fa=l(sa);s(sa),M(()=>y(Fa,`(+1d8, total: ${e(aa)??""})`)),c(vt,sa)};j(Ht,vt=>{e(m),i(()=>e(m).targetIsFiendOrUndead)&&vt(lt)})}s(ft),s(nt),da(bt,()=>e(m).targetIsFiendOrUndead,vt=>(e(m).targetIsFiendOrUndead=vt,St(()=>(e(f),t(),v())))),c(pt,nt)};j(Wt,pt=>{B(e(_)),i(()=>e(_).description.includes("Fiend or an Undead"))&&pt(ta)})}M(()=>{st(Bt,"for",`castLevel-${e(m),i(()=>e(m).id)??""}`),st(Ft,"id",`castLevel-${e(m),i(()=>e(m).id)??""}`)}),ja(Ft,()=>e(m).castAtLevel,pt=>(e(m).castAtLevel=pt,St(()=>(e(f),t(),v())))),c($t,At)},Zt=$t=>{var At=Ss();c($t,At)};j(Et,$t=>{B(e(rt)),i(()=>e(rt).length>0)?$t(Pt):$t(Zt,!1)})}c(et,mt)};j(Qe,et=>{B(e(_)),i(()=>e(_).higherLevelSlot&&e(_).level>0)&&et(gt)})}M(()=>{st(ne,"aria-label",(e(H),e(m),i(()=>e(H)[e(m).id]?"Expand":"Collapse"))),y(Ee,(e(H),e(m),i(()=>e(H)[e(m).id]?"â–¼":"â–²")))}),F("click",Ue,()=>V(e(m).id)),F("keydown",Ue,et=>et.key==="Enter"&&V(e(m).id)),c(u,ae)},Me=u=>{var ae=js();c(u,ae)};j(ke,u=>{e(_)?u(Ge):u(Me,!1)})}c(T,he)};j(L,T=>{e(ue),i(()=>e(ue).length===0)?T(q):T(D,!1)})}c(A,o)};j(_e,A=>{e(m),i(()=>e(m).spellRef)&&A(ye)})}var Ie=a(_e,2);{var Je=A=>{var o=ws(),L=a(l(o),2);Nt(L),s(o),Fe(L,()=>e(m).notes,q=>(e(m).notes=q,St(()=>(e(f),t(),v())))),c(A,o)};j(Ie,A=>{e(m),i(()=>!e(m).spellRef)&&A(Je)})}var Ze=a(Ie,2),je=l(Ze);{var te=A=>{var o=Ds();F("click",o,()=>me(e(m))),c(A,o)};j(je,A=>{e(m),i(()=>e(m).bonus!==0||!e(m).spellRef)&&A(te)})}var Se=a(je,2);{var Ne=A=>{const o=tt(()=>(e(m),i(()=>ce(e(m).spellRef))));var L=Fs(),q=l(L);{var D=_=>{var he=ht("Roll Healing");c(_,he)},T=_=>{var he=ht("Roll Damage");c(_,he)};j(q,_=>{B(e(o)),i(()=>e(o)&&be(e(o)))?_(D):_(T,!1)})}s(L),F("click",L,()=>O(e(m))),c(A,L)},De=A=>{var o=As();F("click",o,()=>O(e(m))),c(A,o)};j(Se,A=>{e(m),e(Y),i(()=>e(m).spellRef&&e(Y))?A(Ne):A(De,!1)})}s(Ze),s(Oe),Fe(Ye,()=>e(m).name,A=>(e(m).name=A,St(()=>(e(f),t(),v())))),Fe(Ae,()=>e(m).bonus,A=>(e(m).bonus=A,St(()=>(e(f),t(),v())))),Fe(Re,()=>e(m).damage,A=>(e(m).damage=A,St(()=>(e(f),t(),v())))),Fe(S,()=>e(m).damageType,A=>(e(m).damageType=A,St(()=>(e(f),t(),v())))),c(pe,Oe)});var Pe=a(re,2);{var Le=pe=>{var m=Is();c(pe,m)},Ve=pe=>{var m=it(),Te=ze(m);{var Oe=qe=>{var Ye=Ms();c(qe,Ye)};j(Te,qe=>{e(f),i(()=>e(f).length===0)&&qe(Oe)},!0)}c(pe,m)};j(Pe,pe=>{t(),i(()=>t().attacks.length===0)?pe(Le):pe(Ve,!1)})}s(U),F("click",K,de),c(p,N)};j(h,p=>{$(),i(()=>!$().attacks)&&p(R)})}s(ee),M(()=>{He=ct(ee,1,"attacks svelte-14o91c5",null,He,{hidden:!e(z)}),st(J,"aria-label",($(),i(()=>$().attacks?"Expand":"Collapse"))),y(ie,($(),i(()=>$().attacks?"â–¼":"â–²")))}),F("click",J,oe),c(r,ee),xt(),G()}var Us=b('<p class="no-features svelte-1kpvv0n">Select a class to see available features</p>'),Hs=b('<p class="no-features svelte-1kpvv0n">No class features available at this level</p>'),Ts=b('<input type="checkbox" class="slot-checkbox svelte-1kpvv0n"/>'),Ns=b('<div class="spell-slots svelte-1kpvv0n"><label class="svelte-1kpvv0n"> </label> <div class="slots-tracker svelte-1kpvv0n"></div></div>'),Gs=b('<div class="all-spell-slots"></div>'),Os=b('<div class="feature-box spellcasting svelte-1kpvv0n"><h3 class="svelte-1kpvv0n"> </h3> <div class="spell-stats svelte-1kpvv0n"><div class="spell-stat svelte-1kpvv0n"><label class="svelte-1kpvv0n">Spell Save DC</label> <div class="spell-value svelte-1kpvv0n"> </div></div> <div class="spell-stat svelte-1kpvv0n"><label class="svelte-1kpvv0n">Prepared Spells</label> <div class="spell-value svelte-1kpvv0n"> </div></div></div> <!> <div class="prepared-spells svelte-1kpvv0n"><label class="svelte-1kpvv0n">Prepared Spells</label> <textarea placeholder="List your prepared spells..." class="svelte-1kpvv0n"></textarea></div></div>'),qs=b('<p class="unlimited svelte-1kpvv0n">Unlimited Uses</p>'),zs=b('<p class="no-uses svelte-1kpvv0n">No uses remaining</p>'),Ws=b('<div class="uses-with-button svelte-1kpvv0n"><button class="btn btn-primary use-enabled"> </button> <div class="uses-info svelte-1kpvv0n"><span class="uses-remaining svelte-1kpvv0n"> </span> <span class="reset-info svelte-1kpvv0n"> </span></div> <!></div>'),Vs=b('<div class="uses-tracker svelte-1kpvv0n"><!></div>'),Js=b('<div class="pool-tracker svelte-1kpvv0n"><input type="number" min="0" class="pool-input svelte-1kpvv0n"/> <span> </span> <button class="btn-small svelte-1kpvv0n"> </button></div>'),Ks=b('<p class="no-uses svelte-1kpvv0n">No Channel Divinity uses remaining</p>'),Qs=b('<div class="channel-divinity-option svelte-1kpvv0n"><button class="btn btn-primary use-enabled svelte-1kpvv0n">Use Channel Divinity</button> <div class="uses-info svelte-1kpvv0n"><span class="reset-info svelte-1kpvv0n"> </span></div> <!></div>'),Xs=b('<div class="feature-box svelte-1kpvv0n"><h3 class="svelte-1kpvv0n"><!> </h3> <p class="feature-description svelte-1kpvv0n"> </p> <!></div>'),Ys=b('<div class="features-grid svelte-1kpvv0n"><!> <!></div>'),Zs=b('<section><div class="header svelte-1kpvv0n"><h2 class="svelte-1kpvv0n">Class Features</h2> <button class="collapse-btn svelte-1kpvv0n"> </button></div> <!></section>');function el(r,d){kt(d,!1);const t=()=>We(X,"$character",w),v=()=>We(Xt,"$abilityModifiers",w),$=()=>We(wt,"$searchFilter",w),k=()=>We(ut,"$collapsedStates",w),[w,G]=Ct(),f=I(),z=I(),le=I(),H=I(),V=I(),be=I(),de=I();let xe=I(0),me=I(0);function O(h,R){X.update(p=>(p.classFeatures.features[h]=R,p))}function oe(){X.update(h=>(h.classFeatures.spellSlotsByLevel||(h.classFeatures.spellSlotsByLevel={}),e(H).forEach(({level:R,slots:p})=>{h.classFeatures.spellSlotsByLevel[R]||(h.classFeatures.spellSlotsByLevel[R]=Array(p).fill(!1))}),h))}function ue(h){if(typeof h.maxUses=="function"){if((h.name==="Divine Sense"||h.name==="War Priest")&&e(f)?.spellcastingAbility){const R=v()[e(f).spellcastingAbility];return h.maxUses(t().level,R)}return h.maxUses(t().level)}return h.maxUses||0}function Y(h){return typeof h.maxPool=="function"?h.maxPool(t().level):h.maxPool||0}function ce(h){return typeof h.description=="function"?h.description(t().level):h.description}function Z(){const h="ChannelDivinity";X.update(R=>{const p=R.classFeatures.features[h];return typeof p=="number"&&p>0&&(R.classFeatures.features[h]=p-1),R})}function P(){ut.update(h=>({...h,classFeatures:!h.classFeatures}))}Xe(()=>(t(),_t),()=>{n(f,t().class?_t(t().class):null)}),Xe(()=>(t(),qt),()=>{n(z,t().class?qt(t().class,t().level,t().subclass):[])}),Xe(()=>(t(),fa),()=>{n(le,t().class?fa(t().class,t().level):0)}),Xe(()=>(e(f),t()),()=>{n(H,(()=>{if(!e(f)?.spellcaster)return[];const h=t().level,R=[];return h>=1&&R.push({level:1,slots:Math.min(4,2+Math.floor(h/3))}),h>=3&&R.push({level:2,slots:Math.min(3,2+Math.floor((h-3)/4))}),h>=5&&R.push({level:3,slots:Math.min(3,2+Math.floor((h-5)/5))}),h>=7&&R.push({level:4,slots:Math.min(3,1+Math.floor((h-7)/6))}),h>=9&&R.push({level:5,slots:Math.min(2,1+Math.floor((h-9)/8))}),h>=11&&R.push({level:6,slots:1}),h>=13&&R.push({level:7,slots:1}),h>=15&&R.push({level:8,slots:1}),h>=17&&R.push({level:9,slots:1}),R})())}),Xe(()=>(e(f),v(),t(),ba),()=>{if(e(f)?.spellcaster&&e(f).spellcastingAbility){const h=v()[e(f).spellcastingAbility];n(xe,Wa(t().class,h,t().proficiencyBonus)||0),n(me,ba(t().class,t().level,h))}}),Xe(()=>(t(),e(f),e(H)),()=>{t().class&&e(f)?.spellcaster&&e(H).length>0&&oe()}),Xe(()=>t(),()=>{n(V,(()=>{const R=t().classFeatures.features["ChannelDivinity"];return typeof R=="number"?R:0})())}),Xe(()=>(e(z),$()),()=>{n(be,e(z).filter(h=>{if(!$())return!0;const R=$().toLowerCase();return h.name.toLowerCase().includes(R)||ce(h).toLowerCase().includes(R)}))}),Xe(()=>($(),t(),e(be)),()=>{n(de,!$()||t().class||"class features".includes($().toLowerCase())||"spellcasting".includes($().toLowerCase())||e(be).length>0)}),Lt(),yt();var ve=Zs();let fe;var ee=l(ve),He=a(l(ee),2),C=l(He,!0);s(He),s(ee);var J=a(ee,2);{var ie=h=>{var R=it(),p=ze(R);{var N=U=>{var re=Us();c(U,re)},K=U=>{var re=it(),Pe=ze(re);{var Le=pe=>{var m=Hs();c(pe,m)},Ve=pe=>{var m=Ys(),Te=l(m);{var Oe=Ye=>{var g=Os(),W=l(g),Q=l(W);s(W);var E=a(W,2),Ae=l(E),Ce=a(l(Ae),2),Re=l(Ce,!0);s(Ce),s(Ae);var $e=a(Ae,2),S=a(l($e),2),_e=l(S,!0);s(S),s($e),s(E);var ye=a(E,2);{var Ie=je=>{var te=Gs();ot(te,5,()=>e(H),dt,(Se,Ne)=>{let De=()=>e(Ne).level,A=()=>e(Ne).slots;const o=tt(()=>(t(),De(),A(),i(()=>t().classFeatures.spellSlotsByLevel?.[De()]||Array(A()).fill(!1))));var L=Ns(),q=l(L),D=l(q);s(q);var T=a(q,2);ot(T,5,()=>(A(),i(()=>Array(A()))),dt,(_,he,ke)=>{var Ge=Ts();we(Ge),M(()=>Ba(Ge,(B(e(o)),i(()=>e(o)[ke]||!1)))),F("change",Ge,Me=>{X.update(u=>(u.classFeatures.spellSlotsByLevel||(u.classFeatures.spellSlotsByLevel={}),u.classFeatures.spellSlotsByLevel[De()]||(u.classFeatures.spellSlotsByLevel[De()]=Array(A()).fill(!1)),u.classFeatures.spellSlotsByLevel[De()][ke]=Me.currentTarget.checked,u))}),c(_,Ge)}),s(T),s(L),M(()=>y(D,`${De()===1?"1st":De()===2?"2nd":De()===3?"3rd":`${De()}th`} Level Spell Slots`)),c(Se,L)}),s(te),c(je,te)};j(ye,je=>{e(H),i(()=>e(H).length>0)&&je(Ie)})}var Je=a(ye,2),Ze=a(l(Je),2);Nt(Ze),s(Je),s(g),M(je=>{y(Q,`Spellcasting (${je??""})`),y(Re,e(xe)),y(_e,e(me))},[()=>(e(f),i(()=>e(f).spellcastingAbility?.toUpperCase()))]),Fe(Ze,()=>t().classFeatures.preparedSpells,je=>at(X,i(t).classFeatures.preparedSpells=je,i(t))),c(Ye,g)};j(Te,Ye=>{e(f),i(()=>e(f)?.spellcaster)&&Ye(Oe)})}var qe=a(Te,2);ot(qe,1,()=>e(be),dt,(Ye,g)=>{const W=tt(()=>(e(g),i(()=>e(g).name.replace(/\s+/g,"")))),Q=tt(()=>(t(),B(e(W)),i(()=>t().classFeatures.features[e(W)]))),E=tt(()=>(B(e(Q)),i(()=>Array.isArray(e(Q))))),Ae=tt(()=>typeof e(Q)=="number");var Ce=Xs(),Re=l(Ce),$e=l(Re);{var S=te=>{var Se=ht("Channel Divinity:");c(te,Se)};j($e,te=>{e(g),i(()=>e(g).type==="channelDivinity")&&te(S)})}var _e=a($e);s(Re);var ye=a(Re,2),Ie=l(ye,!0);s(ye);var Je=a(ye,2);{var Ze=te=>{const Se=tt(()=>(e(g),i(()=>ue(e(g))))),Ne=tt(()=>(B(e(E)),B(e(Se)),B(e(Q)),i(()=>e(E)?e(Q).filter(D=>!D).length:e(Se))));var De=Vs(),A=l(De);{var o=q=>{var D=qs();c(q,D)},L=q=>{var D=Ws(),T=l(D),_=l(T);s(T);var he=a(T,2),ke=l(he),Ge=l(ke);s(ke);var Me=a(ke,2),u=l(Me);s(Me),s(he);var ae=a(he,2);{var x=ge=>{var Be=zs();c(ge,Be)};j(ae,ge=>{e(Ne)<=0&&ge(x)})}s(D),M(()=>{T.disabled=e(Ne)<=0,y(_,`Use ${e(g),i(()=>e(g).name)??""}`),y(Ge,`${e(Ne)??""} / ${e(Se)??""} uses`),y(u,`Resets on ${e(g),i(()=>e(g).resetOn==="short"?"Short Rest":"Long Rest")??""}`)}),F("click",T,()=>{X.update(ge=>{ge.classFeatures.features[e(W)]||(ge.classFeatures.features[e(W)]=Array(e(Se)).fill(!1));const Be=ge.classFeatures.features[e(W)],Ue=Be.findIndex(ne=>!ne);return Ue!==-1&&(Be[Ue]=!0),ge})}),c(q,D)};j(A,q=>{e(Se)===1/0?q(o):q(L,!1)})}s(De),c(te,De)},je=te=>{var Se=it(),Ne=ze(Se);{var De=o=>{const L=tt(()=>(e(g),i(()=>Y(e(g)))));var q=Js(),D=l(q);we(D);var T=a(D,2),_=l(T);s(T);var he=a(T,2),ke=l(he,!0);s(he),s(q),M(()=>{La(D,e(Ae)&&e(Q)!==void 0?e(Q):e(L)),st(D,"max",e(L)),y(_,`/ ${e(L)??""}`),y(ke,(e(g),i(()=>e(g).resetOn==="short"?"Short Rest":"Long Rest")))}),F("input",D,Ge=>{X.update(Me=>(Me.classFeatures.features[e(W)]=parseInt(Ge.currentTarget.value)||0,Me))}),F("click",he,()=>O(e(W),e(L))),c(o,q)},A=o=>{var L=it(),q=ze(L);{var D=T=>{var _=Qs(),he=l(_),ke=a(he,2),Ge=l(ke),Me=l(Ge);s(Ge),s(ke);var u=a(ke,2);{var ae=x=>{var ge=Ks();c(x,ge)};j(u,x=>{e(V)<=0&&x(ae)})}s(_),M(()=>{he.disabled=e(V)<=0,y(Me,`Resets on ${e(g),i(()=>e(g).resetOn==="short"?"Short Rest":"Long Rest")??""}`)}),F("click",he,Z),c(T,_)};j(q,T=>{e(g),i(()=>e(g).type==="channelDivinity")&&T(D)},!0)}c(o,L)};j(Ne,o=>{e(g),i(()=>e(g).type==="pool")?o(De):o(A,!1)},!0)}c(te,Se)};j(Je,te=>{e(g),i(()=>e(g).type==="uses")?te(Ze):te(je,!1)})}s(Ce),M(te=>{y(_e,` ${e(g),i(()=>e(g).name)??""}`),y(Ie,te)},[()=>(e(g),i(()=>ce(e(g))))]),c(Ye,Ce)}),s(m),c(pe,m)};j(Pe,pe=>{e(z),i(()=>e(z).length===0)?pe(Le):pe(Ve,!1)},!0)}c(U,re)};j(p,U=>{t(),i(()=>!t().class)?U(N):U(K,!1)})}c(h,R)};j(J,h=>{k(),i(()=>!k().classFeatures)&&h(ie)})}s(ve),M(()=>{fe=ct(ve,1,"class-features svelte-1kpvv0n",null,fe,{hidden:!e(de)}),st(He,"aria-label",(k(),i(()=>k().classFeatures?"Expand":"Collapse"))),y(C,(k(),i(()=>k().classFeatures?"â–¼":"â–²")))}),F("click",He,P),c(r,ve),xt(),G()}var tl=b('<textarea placeholder="Enter features, traits, and special abilities..." class="svelte-wttn0l"></textarea> <h3 class="svelte-wttn0l">Equipment</h3> <textarea placeholder="List your equipment and inventory..." class="svelte-wttn0l"></textarea> <h3 class="svelte-wttn0l">Notes</h3> <textarea placeholder="Additional notes..." class="svelte-wttn0l"></textarea>',1),al=b('<section><div class="header svelte-wttn0l"><h2 class="svelte-wttn0l">Features & Traits</h2> <button class="collapse-btn svelte-wttn0l"> </button></div> <!></section>');function sl(r,d){kt(d,!1);const t=()=>We(wt,"$searchFilter",k),v=()=>We(X,"$character",k),$=()=>We(ut,"$collapsedStates",k),[k,w]=Ct(),G=I();function f(){ut.update(me=>({...me,notes:!me.notes}))}Xe(()=>(t(),v()),()=>{n(G,!t()||"features".includes(t().toLowerCase())||"traits".includes(t().toLowerCase())||"equipment".includes(t().toLowerCase())||"notes".includes(t().toLowerCase())||v().features.toLowerCase().includes(t().toLowerCase())||v().equipment.toLowerCase().includes(t().toLowerCase())||v().notes.toLowerCase().includes(t().toLowerCase()))}),Lt(),yt();var z=al();let le;var H=l(z),V=a(l(H),2),be=l(V,!0);s(V),s(H);var de=a(H,2);{var xe=me=>{var O=tl(),oe=ze(O);Nt(oe);var ue=a(oe,4);Nt(ue);var Y=a(ue,4);Nt(Y),Fe(oe,()=>v().features,ce=>at(X,i(v).features=ce,i(v))),Fe(ue,()=>v().equipment,ce=>at(X,i(v).equipment=ce,i(v))),Fe(Y,()=>v().notes,ce=>at(X,i(v).notes=ce,i(v))),c(me,O)};j(de,me=>{$(),i(()=>!$().notes)&&me(xe)})}s(z),M(()=>{le=ct(z,1,"notes svelte-wttn0l",null,le,{hidden:!e(G)}),st(V,"aria-label",($(),i(()=>$().notes?"Expand":"Collapse"))),y(be,($(),i(()=>$().notes?"â–¼":"â–²")))}),F("click",V,f),c(r,z),xt(),w()}var ll=b('<div class="color-picker-section svelte-1r90jgp"><h3 class="svelte-1r90jgp">Dice Colors</h3> <div class="color-inputs svelte-1r90jgp"><div class="color-input-group svelte-1r90jgp"><label for="dice-color" class="svelte-1r90jgp">Dice Color</label> <input type="color" id="dice-color" class="svelte-1r90jgp"/></div> <div class="color-input-group svelte-1r90jgp"><label for="label-color" class="svelte-1r90jgp">Label Color</label> <input type="color" id="label-color" class="svelte-1r90jgp"/></div> <div class="color-input-group svelte-1r90jgp"><label for="desk-color" class="svelte-1r90jgp">Background Color</label> <input type="color" id="desk-color" class="svelte-1r90jgp"/></div></div></div>'),il=b('<div class="loading svelte-1r90jgp"><p class="svelte-1r90jgp">Loading 3D dice...</p></div>'),rl=b('<div class="custom-dice-selector svelte-1r90jgp"><h3 class="svelte-1r90jgp">Choose Dice to Roll</h3> <div class="dice-inputs svelte-1r90jgp"><div class="dice-input-group svelte-1r90jgp"><label for="d4" class="svelte-1r90jgp">d4</label> <input class="use-enabled svelte-1r90jgp" type="number" id="d4" min="0" max="10"/></div> <div class="dice-input-group svelte-1r90jgp"><label for="d6" class="svelte-1r90jgp">d6</label> <input class="use-enabled svelte-1r90jgp" type="number" id="d6" min="0" max="10"/></div> <div class="dice-input-group svelte-1r90jgp"><label for="d8" class="svelte-1r90jgp">d8</label> <input class="use-enabled svelte-1r90jgp" type="number" id="d8" min="0" max="10"/></div> <div class="dice-input-group svelte-1r90jgp"><label for="d10" class="svelte-1r90jgp">d10</label> <input class="use-enabled svelte-1r90jgp" type="number" id="d10" min="0" max="10"/></div> <div class="dice-input-group svelte-1r90jgp"><label for="d12" class="svelte-1r90jgp">d12</label> <input class="use-enabled svelte-1r90jgp" type="number" id="d12" min="0" max="10"/></div> <div class="dice-input-group svelte-1r90jgp"><label for="d20" class="svelte-1r90jgp">d20</label> <input class="use-enabled svelte-1r90jgp" type="number" id="d20" min="0" max="10"/></div></div> <div class="dice-controls svelte-1r90jgp"><button class="btn btn-primary use-enabled svelte-1r90jgp"> </button> <button class="btn btn-secondary use-enabled svelte-1r90jgp">Reset</button></div></div>'),nl=b('<span class="crit-badge svelte-1r90jgp">CRITICAL!</span>'),ol=b('<p class="svelte-1r90jgp"> </p>'),cl=b('<p class="modifier-text svelte-1r90jgp"> </p>'),vl=b('<button class="btn btn-follow-up svelte-1r90jgp"> </button>'),dl=b('<button class="btn btn-guided-strike svelte-1r90jgp">âš¡ Use Guided Strike (+10)</button>'),ul=b('<div class="follow-up-actions svelte-1r90jgp"><!> <!></div>'),pl=b('<div class="result-header svelte-1r90jgp"><h3 class="svelte-1r90jgp"> </h3> <!></div> <div class="result-total svelte-1r90jgp"> </div> <div class="result-details svelte-1r90jgp"><!> <!></div> <!>',1),fl=b('<div role="button" tabindex="-1"><div class="modal-content svelte-1r90jgp" role="dialog" tabindex="0"><div class="modal-header svelte-1r90jgp"><h2 class="svelte-1r90jgp">Dice Roller</h2> <div class="header-buttons svelte-1r90jgp"><button class="color-btn svelte-1r90jgp" title="Customize dice colors">ðŸŽ¨</button> <button class="close-btn svelte-1r90jgp">Ã—</button></div></div> <!> <!> <div class="dice-main-area svelte-1r90jgp"><div class="dice-container svelte-1r90jgp"></div> <!></div> <div><!></div></div></div>');function bl(r,d){kt(d,!1);const t=()=>We(X,"$character",v),[v,$]=Ct(),k=I(),w=I(),G=I(),f=Mt();let z=Rt(d,"notation",12,""),le=Rt(d,"visible",8,!1),H=Rt(d,"damageNotation",12,""),V=Rt(d,"attackName",12,""),be=null,de=I(void 0),xe=I(!1),me=I(""),O=I(null);function oe(){return e(O)?.resultTotal??null}let ue=I(0),Y=I(0),ce=I(0),Z=I(0),P=I(0),ve=I(0),fe=I(0),ee=I([]),He=I(!1),C=I("other"),J=I(!1),ie=I("#051e0a"),h=I("#ffffff"),R=I("#3a2004"),p=I(!1);function N(o){return o.length===9&&o.startsWith("#")?o.substring(0,7):o}function K(o,L="ff"){return o.length===7&&o.startsWith("#")?o+L:o}function U(){if(window.DICE&&e(de))try{be&&e(de)&&Ca(de,e(de).innerHTML="");const o=e(de).clientWidth||500,L=e(de).clientHeight||300;be=new window.DICE.dice_box(e(de),{w:o,h:L}),n(xe,!0)}catch(o){console.error("Error initializing dice box:",o)}}zt(()=>{const o=D=>new Promise((T,_)=>{if(document.querySelector(`script[src="${D}"]`)){console.log(`Script already loaded: ${D}`),T(null);return}const ke=document.createElement("script");ke.src=D,ke.onload=()=>{console.log(`Loaded: ${D}`),T(null)},ke.onerror=()=>{console.error(`Failed to load: ${D}`),_(new Error(`Failed to load ${D}`))},document.head.appendChild(ke)});setTimeout(()=>{o(`${Tt}/libs/three.min.js`).then(()=>o(`${Tt}/libs/cannon.min.js`)).then(()=>o(`${Tt}/libs/teal.js`)).then(()=>o(`${Tt}/dice.js`)).then(()=>{if(console.log("All scripts loaded, initializing dice box..."),console.log("DICE available:",!!window.DICE),console.log("Container available:",!!e(de)),window.DICE){const D=window.DICE.getColors();n(ie,N(D.dice_color)),n(h,N(D.label_color)),n(R,N(D.desk_color))}U()}).catch(D=>{console.error("Failed to load dice libraries:",D)})},100);const L=()=>{e(xe)&&(console.log("Window resized, reinitializing dice box..."),U())},q=D=>{le()&&D.key==="Escape"&&qe()};return window.addEventListener("resize",L),window.addEventListener("keydown",q),()=>{window.removeEventListener("resize",L),window.removeEventListener("keydown",q)}});function re(o,L="other"){if(!be||!e(xe))return;console.log("Rolling dice:",o,"type:",L),n(C,L),n(J,!1),be.diceToRoll=o;const q=T=>(console.log("Before roll:",T),null),D=T=>{if(console.log("After roll:",T),console.log("Result:",T.resultTotal),n(O,T),L==="attack"||L==="check"||L==="save"){const _=T.results?.filter(he=>he.sides===20)||[];if(_.length>0){const he=_[0].value;n(He,he===20)}}if(n(ee,[]),L==="attack"&&H())if(e(He)){const _=Ve(H());e(ee).push({label:`Roll Critical Damage (${_})`,notation:_})}else e(ee).push({label:`Roll Damage (${H()})`,notation:H()})};be.start_throw(q,D)}function Pe(){const o=[];e(ue)>0&&o.push(`${e(ue)}d4`),e(Y)>0&&o.push(`${e(Y)}d6`),e(ce)>0&&o.push(`${e(ce)}d8`),e(Z)>0&&o.push(`${e(Z)}d10`),e(P)>0&&o.push(`${e(P)}d12`),e(ve)>0&&o.push(`${e(ve)}d20`);let L=o.join("+")||"1d20";return e(fe)!==0&&(L+=e(fe)>=0?`+${e(fe)}`:`${e(fe)}`),L}function Le(){const o=Pe();re(o)}function Ve(o){return o.replace(/(\d+)d(\d+)/g,(L,q,D)=>`${parseInt(q)*2}d${D}`)}function pe(){n(ue,0),n(Y,0),n(ce,0),n(Z,0),n(P,0),n(ve,0),n(fe,0),n(O,null),n(ee,[]),n(He,!1),n(C,"other"),n(J,!1)}function m(){window.DICE&&(window.DICE.setColors({dice_color:K(e(ie),"ff"),label_color:K(e(h),"ff"),desk_color:e(R)}),be&&(be.updateDeskColor(e(R)),be.updateDiceColors()))}function Te(){n(p,!e(p))}function Oe(){!e(O)||e(w)<=0||e(J)||(n(O,{...e(O),resultTotal:e(O).resultTotal+10,resultString:e(O).resultString+" + 10 (Guided Strike)"}),X.update(o=>{const L="ChannelDivinity",q=o.classFeatures.features[L];return typeof q=="number"&&q>0&&(o.classFeatures.features[L]=q-1),o}),n(J,!0))}function qe(){f("close"),z(""),H(""),V(""),n(me,""),n(O,null),n(J,!1),pe()}Xe(()=>(t(),qt),()=>{n(k,t().class?qt(t().class,t().level,t().subclass).some(L=>L.name==="Guided Strike"):!1)}),Xe(()=>t(),()=>{n(w,(()=>{const L=t().classFeatures.features["ChannelDivinity"];return typeof L=="number"?L:0})())}),Xe(()=>(e(ue),e(Y),e(ce),e(Z),e(P),e(ve),e(fe)),()=>{n(G,(()=>{const o=[];e(ue)>0&&o.push(`${e(ue)}d4`),e(Y)>0&&o.push(`${e(Y)}d6`),e(ce)>0&&o.push(`${e(ce)}d8`),e(Z)>0&&o.push(`${e(Z)}d10`),e(P)>0&&o.push(`${e(P)}d12`),e(ve)>0&&o.push(`${e(ve)}d20`);let L=o.join("+")||"1d20";return e(fe)!==0&&(L+=e(fe)>=0?`+${e(fe)}`:`${e(fe)}`),L})())}),Xe(()=>(B(z()),e(xe),B(le()),e(me),B(H()),B(V())),()=>{if(z()&&e(xe)&&le()&&z()!==e(me)){n(me,z()),n(O,null),n(ee,[]),n(He,!1),n(J,!1);const o=z().includes("1d20")?"attack":"other";console.log("Auto-roll triggered. notation:",z(),"damageNotation:",H(),"attackName:",V()),setTimeout(()=>re(z(),o),200)}}),Lt();var Ye={getLastRollTotal:oe};yt();var g=fl();let W;var Q=l(g),E=l(Q),Ae=a(l(E),2),Ce=l(Ae),Re=a(Ce,2);s(Ae),s(E);var $e=a(E,2);{var S=o=>{var L=ll(),q=a(l(L),2),D=l(q),T=a(l(D),2);we(T),s(D);var _=a(D,2),he=a(l(_),2);we(he),s(_);var ke=a(_,2),Ge=a(l(ke),2);we(Ge),s(ke),s(q),s(L),Fe(T,()=>e(ie),Me=>n(ie,Me)),F("change",T,m),Fe(he,()=>e(h),Me=>n(h,Me)),F("change",he,m),Fe(Ge,()=>e(R),Me=>n(R,Me)),F("change",Ge,m),c(o,L)};j($e,o=>{e(p)&&o(S)})}var _e=a($e,2);{var ye=o=>{var L=il();c(o,L)};j(_e,o=>{e(xe)||o(ye)})}var Ie=a(_e,2),Je=l(Ie);na(Je,o=>n(de,o),()=>e(de));var Ze=a(Je,2);{var je=o=>{var L=rl(),q=a(l(L),2),D=l(q),T=a(l(D),2);we(T),s(D);var _=a(D,2),he=a(l(_),2);we(he),s(_);var ke=a(_,2),Ge=a(l(ke),2);we(Ge),s(ke);var Me=a(ke,2),u=a(l(Me),2);we(u),s(Me);var ae=a(Me,2),x=a(l(ae),2);we(x),s(ae);var ge=a(ae,2),Be=a(l(ge),2);we(Be),s(ge),s(q);var Ue=a(q,2),ne=l(Ue),Ee=l(ne);s(ne);var Ke=a(ne,2);s(Ue),s(L),M(()=>{ne.disabled=!e(xe),y(Ee,`Roll ${e(G)??""}`)}),Fe(T,()=>e(ue),se=>n(ue,se)),Fe(he,()=>e(Y),se=>n(Y,se)),Fe(Ge,()=>e(ce),se=>n(ce,se)),Fe(u,()=>e(Z),se=>n(Z,se)),Fe(x,()=>e(P),se=>n(P,se)),Fe(Be,()=>e(ve),se=>n(ve,se)),F("click",ne,Le),F("click",Ke,pe),c(o,L)};j(Ze,o=>{z()||o(je)})}s(Ie);var te=a(Ie,2);let Se;var Ne=l(te);{var De=o=>{var L=pl(),q=ze(L),D=l(q),T=l(D,!0);s(D);var _=a(D,2);{var he=ne=>{var Ee=nl();c(ne,Ee)};j(_,ne=>{e(He)&&ne(he)})}s(q);var ke=a(q,2),Ge=l(ke,!0);s(ke);var Me=a(ke,2),u=l(Me);{var ae=ne=>{var Ee=ol(),Ke=l(Ee,!0);s(Ee),M(()=>y(Ke,(e(O),i(()=>e(O).resultString)))),c(ne,Ee)};j(u,ne=>{e(O),i(()=>e(O).resultString)&&ne(ae)})}var x=a(u,2);{var ge=ne=>{var Ee=cl(),Ke=l(Ee);s(Ee),M(()=>y(Ke,`Modifier: ${e(O),i(()=>e(O).constant>=0?"+":"")??""}${e(O),i(()=>e(O).constant)??""}`)),c(ne,Ee)};j(x,ne=>{e(O),i(()=>e(O).constant)&&ne(ge)})}s(Me);var Be=a(Me,2);{var Ue=ne=>{var Ee=ul(),Ke=l(Ee);ot(Ke,1,()=>e(ee),dt,(gt,et)=>{var rt=vl(),mt=l(rt,!0);s(rt),M(()=>y(mt,(e(et),i(()=>e(et).label)))),F("click",rt,()=>re(e(et).notation,"damage")),c(gt,rt)});var se=a(Ke,2);{var Qe=gt=>{var et=dl();M(()=>{et.disabled=e(w)<=0,st(et,"title",e(w)<=0?"No Channel Divinity uses remaining":"Use Channel Divinity to add +10 to this attack roll")}),F("click",et,Oe),c(gt,et)};j(se,gt=>{e(k)&&e(C)==="attack"&&!e(J)&&gt(Qe)})}s(Ee),c(ne,Ee)};j(Be,ne=>{e(ee),e(k),e(C),e(J),i(()=>e(ee).length>0||e(k)&&e(C)==="attack"&&!e(J))&&ne(Ue)})}M(()=>{y(T,V()?`${V()} - Result`:"Result"),y(Ge,(e(O),i(()=>e(O).resultTotal)))}),c(o,L)};j(Ne,o=>{e(O)&&o(De)})}s(te),s(Q),s(g),M(()=>{W=ct(g,1,"modal-overlay svelte-1r90jgp",null,W,{hidden:!le()}),Se=ct(te,1,"roll-result svelte-1r90jgp",null,Se,{"has-result":e(O)})}),F("click",Ce,Te),F("click",Re,qe),F("click",Q,ua(function(o){It.call(this,d,o)})),F("keydown",Q,function(o){It.call(this,d,o)}),F("click",g,qe),F("keydown",g,o=>o.key==="Escape"&&qe()),c(r,g),qa(d,"getLastRollTotal",oe);var A=xt(Ye);return $(),A}const Yt="https://api.github.com/gists";async function hl(r,d,t){if(!d)throw new Error("GitHub token is required");const v=JSON.stringify(r,null,2),$=`${r.name||"character"}_dnd.json`,k={description:t||`D&D Character: ${r.name}`,public:!1,files:{[$]:{content:v}}},w=await fetch(Yt,{method:"POST",headers:{Authorization:`token ${d}`,"Content-Type":"application/json"},body:JSON.stringify(k)});if(!w.ok)throw new Error(`Failed to create gist: ${w.statusText}`);return(await w.json()).id}async function gl(r,d,t){if(!d||!t)throw new Error("GitHub token and Gist ID are required");const v=JSON.stringify(r,null,2),k={files:{[`${r.name||"character"}_dnd.json`]:{content:v}}},w=await fetch(`${Yt}/${t}`,{method:"PATCH",headers:{Authorization:`token ${d}`,"Content-Type":"application/json"},body:JSON.stringify(k)});if(!w.ok)throw new Error(`Failed to update gist: ${w.statusText}`)}async function ml(r,d){if(!r)throw new Error("Gist ID is required");const t={"Content-Type":"application/json"};d&&(t.Authorization=`token ${d}`);const v=await fetch(`${Yt}/${r}`,{method:"GET",headers:t});if(!v.ok)throw new Error(`Failed to load gist: ${v.statusText}`);const $=await v.json(),k=Object.values($.files);if(k.length===0)throw new Error("No files found in gist");const G=k[0].content;try{const f=JSON.parse(G);return f.attacks&&Array.isArray(f.attacks)&&(f.attacks=f.attacks.map(z=>({...z,id:z.id||crypto.randomUUID()}))),f.classFeatures?(f.classFeatures.features||(f.classFeatures.features={}),f.classFeatures.spellSlots||(f.classFeatures.spellSlots=[]),f.classFeatures.preparedSpells===void 0&&(f.classFeatures.preparedSpells="")):f.classFeatures={features:{},spellSlots:[],preparedSpells:""},f}catch{throw new Error("Invalid character data in gist")}}function ga(r){typeof window<"u"&&localStorage.setItem("dnd_gist_config",JSON.stringify(r))}function _l(){if(typeof window<"u"){const r=localStorage.getItem("dnd_gist_config");if(r)return JSON.parse(r)}return{}}async function yl(r,d=30){if(!r)throw new Error("GitHub token is required to list gists");const t=await fetch(`${Yt}?per_page=${d}`,{method:"GET",headers:{Authorization:`token ${r}`,"Content-Type":"application/json"}});if(!t.ok)throw new Error(`Failed to list gists: ${t.statusText}`);return await t.json()}var kl=b('<div class="error-message svelte-1jb5ckg"> </div>'),xl=b('<div class="toggle-container svelte-1jb5ckg"><button type="button" class="toggle-btn svelte-1jb5ckg"> </button></div>'),$l=b('<div class="form-group svelte-1jb5ckg"><label for="gistId" class="svelte-1jb5ckg">Gist ID (leave empty to create new)</label> <input type="text" id="gistId" placeholder="Optional: existing Gist ID to update" class="svelte-1jb5ckg"/></div>'),Cl=b('<div class="loading-message svelte-1jb5ckg">Loading your gists...</div>'),Sl=b('<button type="button"><div class="gist-item-header svelte-1jb5ckg"><span class="gist-description svelte-1jb5ckg"> </span> <span class="gist-visibility svelte-1jb5ckg"> </span></div> <div class="gist-item-meta svelte-1jb5ckg"><span class="gist-id svelte-1jb5ckg"> </span> <span class="gist-date svelte-1jb5ckg"> </span></div></button>'),Ll=b('<div class="form-group svelte-1jb5ckg"><div class="gist-list-label svelte-1jb5ckg">Select a Gist to Update (or leave unselected to create new)</div> <div class="gist-list svelte-1jb5ckg"></div></div>'),jl=b('<div class="info-message svelte-1jb5ckg">No gists found. A new one will be created.</div>'),wl=b('<!> <div class="form-group svelte-1jb5ckg"><label for="description" class="svelte-1jb5ckg"> </label> <input type="text" id="description" placeholder="D&amp;D Character Sheet" class="svelte-1jb5ckg"/></div>',1),Dl=b('<div class="form-group svelte-1jb5ckg"><label for="gistId" class="svelte-1jb5ckg">Gist ID *</label> <input type="text" id="gistId" placeholder="Enter Gist ID (for public or your private gists)" required class="svelte-1jb5ckg"/></div>'),Fl=b('<div class="loading-message svelte-1jb5ckg">Loading your gists...</div>'),Al=b('<button type="button"><div class="gist-item-header svelte-1jb5ckg"><span class="gist-description svelte-1jb5ckg"> </span> <span class="gist-visibility svelte-1jb5ckg"> </span></div> <div class="gist-item-meta svelte-1jb5ckg"><span class="gist-id svelte-1jb5ckg"> </span> <span class="gist-date svelte-1jb5ckg"> </span></div></button>'),Rl=b('<div class="form-group svelte-1jb5ckg"><div class="gist-list-label svelte-1jb5ckg">Select a Gist to Load</div> <div class="gist-list svelte-1jb5ckg"></div></div>'),Il=b('<div class="info-message svelte-1jb5ckg">No gists found. Enter a Gist ID manually or create a new one in Save mode.</div>'),Ml=b('<div class="modal-overlay svelte-1jb5ckg" role="button" tabindex="-1"><div class="modal-content svelte-1jb5ckg" role="dialog" tabindex="0"><div class="modal-header svelte-1jb5ckg"><h2 class="svelte-1jb5ckg"> </h2> <button class="close-btn svelte-1jb5ckg">Ã—</button></div> <div class="modal-body svelte-1jb5ckg"><!> <div class="form-group svelte-1jb5ckg"><label for="token" class="svelte-1jb5ckg"> <a href="https://github.com/settings/tokens" target="_blank" rel="noopener" class="svelte-1jb5ckg">Get token</a></label> <input type="password" id="token" placeholder="ghp_xxxxxxxxxxxxx" class="svelte-1jb5ckg"/></div> <!> <!> <div class="modal-actions svelte-1jb5ckg"><button class="btn btn-primary svelte-1jb5ckg"><!></button> <button class="btn btn-secondary svelte-1jb5ckg">Cancel</button></div></div></div></div>');function El(r,d){kt(d,!1);const t=()=>We(X,"$character",v),[v,$]=Ct(),k=Mt();let w=Rt(d,"mode",8,"save"),G=I(""),f=I(""),z=I(""),le=I(!1),H=I(""),V=I(!1),be=I(!1),de=I([]),xe=I(null);const me=_l();me.token&&n(G,me.token),me.gistId&&n(f,me.gistId),zt(async()=>{e(G)&&!e(V)&&await O()});async function O(){if(e(G)){n(be,!0),n(H,"");try{n(de,await yl(e(G))),e(f)&&n(xe,e(de).find(g=>g.id===e(f))||null)}catch(g){n(H,g.message||"Failed to load gists"),n(de,[])}finally{n(be,!1)}}}function oe(g){n(xe,g),n(f,g.id)}function ue(){n(V,!e(V)),n(H,""),!e(V)&&e(G)&&O()}async function Y(){if(!e(G)){n(H,"GitHub token is required");return}const g=e(xe)?.id||e(f);n(le,!0),n(H,"");try{if(g)await gl(t(),e(G),g),n(f,g),Gt.add("Character updated in Gist successfully!","success");else{const W=await hl(t(),e(G),e(z));n(f,W),Gt.add(`Character saved to Gist! ID: ${W}`,"success")}ga({token:e(G),gistId:e(f)}),k("close")}catch(W){n(H,W.message||"Failed to save to Gist")}finally{n(le,!1)}}async function ce(){const g=e(xe)?.id||e(f);if(!g){n(H,"Please select a gist or enter a Gist ID");return}n(le,!0),n(H,"");try{const W=await ml(g,e(G)||void 0);X.set(W),n(f,g),ga({token:e(G),gistId:e(f)}),Gt.add("Character loaded from Gist successfully!","success"),k("close")}catch(W){n(H,W.message||"Failed to load from Gist")}finally{n(le,!1)}}function Z(){k("close")}yt();var P=Ml(),ve=l(P),fe=l(ve),ee=l(fe),He=l(ee,!0);s(ee);var C=a(ee,2);s(fe);var J=a(fe,2),ie=l(J);{var h=g=>{var W=kl(),Q=l(W,!0);s(W),M(()=>y(Q,e(H))),c(g,W)};j(ie,g=>{e(H)&&g(h)})}var R=a(ie,2),p=l(R),N=l(p);Sa(),s(p);var K=a(p,2);we(K),s(R);var U=a(R,2);{var re=g=>{var W=xl(),Q=l(W),E=l(Q,!0);s(Q),s(W),M(()=>{Q.disabled=e(le),y(E,e(V)?"ðŸ“‹ Show My Gists":"âœï¸ Enter Gist ID Manually")}),F("click",Q,ue),c(g,W)};j(U,g=>{(w()==="load"||w()==="save"&&e(G))&&g(re)})}var Pe=a(U,2);{var Le=g=>{var W=wl(),Q=ze(W);{var E=_e=>{var ye=$l(),Ie=a(l(ye),2);we(Ie),s(ye),M(()=>Ie.disabled=e(le)),Fe(Ie,()=>e(f),Je=>n(f,Je)),c(_e,ye)},Ae=_e=>{var ye=it(),Ie=ze(ye);{var Je=je=>{var te=Cl();c(je,te)},Ze=je=>{var te=it(),Se=ze(te);{var Ne=A=>{var o=Ll(),L=a(l(o),2);ot(L,5,()=>e(de),dt,(q,D)=>{var T=Sl();let _;var he=l(T),ke=l(he),Ge=l(ke,!0);s(ke);var Me=a(ke,2),u=l(Me,!0);s(Me),s(he);var ae=a(he,2),x=l(ae),ge=l(x);s(x);var Be=a(x,2),Ue=l(Be);s(Be),s(ae),s(T),M(ne=>{_=ct(T,1,"gist-item svelte-1jb5ckg",null,_,{selected:e(xe)?.id===e(D).id}),T.disabled=e(le),y(Ge,(e(D),i(()=>e(D).description||"Untitled"))),y(u,(e(D),i(()=>e(D).public?"ðŸŒ Public":"ðŸ”’ Private"))),y(ge,`ID: ${e(D),i(()=>e(D).id)??""}`),y(Ue,`Updated: ${ne??""}`)},[()=>(e(D),i(()=>new Date(e(D).updated_at).toLocaleDateString()))]),F("click",T,()=>oe(e(D))),c(q,T)}),s(L),s(o),c(A,o)},De=A=>{var o=it(),L=ze(o);{var q=D=>{var T=jl();c(D,T)};j(L,D=>{e(G)&&D(q)},!0)}c(A,o)};j(Se,A=>{e(de),i(()=>e(de).length>0)?A(Ne):A(De,!1)},!0)}c(je,te)};j(Ie,je=>{e(be)?je(Je):je(Ze,!1)},!0)}c(_e,ye)};j(Q,_e=>{e(V)||!e(G)?_e(E):_e(Ae,!1)})}var Ce=a(Q,2),Re=l(Ce),$e=l(Re);s(Re);var S=a(Re,2);we(S),s(Ce),M(()=>{y($e,`Description ${e(f)?"(optional)":""}`),S.disabled=e(le)}),Fe(S,()=>e(z),_e=>n(z,_e)),c(g,W)},Ve=g=>{var W=it(),Q=ze(W);{var E=Ce=>{var Re=Dl(),$e=a(l(Re),2);we($e),s(Re),M(()=>$e.disabled=e(le)),Fe($e,()=>e(f),S=>n(f,S)),c(Ce,Re)},Ae=Ce=>{var Re=it(),$e=ze(Re);{var S=ye=>{var Ie=Fl();c(ye,Ie)},_e=ye=>{var Ie=it(),Je=ze(Ie);{var Ze=te=>{var Se=Rl(),Ne=a(l(Se),2);ot(Ne,5,()=>e(de),dt,(De,A)=>{var o=Al();let L;var q=l(o),D=l(q),T=l(D,!0);s(D);var _=a(D,2),he=l(_,!0);s(_),s(q);var ke=a(q,2),Ge=l(ke),Me=l(Ge);s(Ge);var u=a(Ge,2),ae=l(u);s(u),s(ke),s(o),M(x=>{L=ct(o,1,"gist-item svelte-1jb5ckg",null,L,{selected:e(xe)?.id===e(A).id}),o.disabled=e(le),y(T,(e(A),i(()=>e(A).description||"Untitled"))),y(he,(e(A),i(()=>e(A).public?"ðŸŒ Public":"ðŸ”’ Private"))),y(Me,`ID: ${e(A),i(()=>e(A).id)??""}`),y(ae,`Updated: ${x??""}`)},[()=>(e(A),i(()=>new Date(e(A).updated_at).toLocaleDateString()))]),F("click",o,()=>oe(e(A))),c(De,o)}),s(Ne),s(Se),c(te,Se)},je=te=>{var Se=it(),Ne=ze(Se);{var De=A=>{var o=Il();c(A,o)};j(Ne,A=>{e(G)&&A(De)},!0)}c(te,Se)};j(Je,te=>{e(de),i(()=>e(de).length>0)?te(Ze):te(je,!1)},!0)}c(ye,Ie)};j($e,ye=>{e(be)?ye(S):ye(_e,!1)},!0)}c(Ce,Re)};j(Q,Ce=>{e(V)||!e(G)?Ce(E):Ce(Ae,!1)})}c(g,W)};j(Pe,g=>{w()==="save"?g(Le):g(Ve,!1)})}var pe=a(Pe,2),m=l(pe),Te=l(m);{var Oe=g=>{var W=ht();M(()=>y(W,w()==="save"?"Saving...":"Loading...")),c(g,W)},qe=g=>{var W=ht();M(()=>y(W,w()==="save"?"Save":"Load")),c(g,W)};j(Te,g=>{e(le)?g(Oe):g(qe,!1)})}s(m);var Ye=a(m,2);s(pe),s(J),s(ve),s(P),M(()=>{y(He,w()==="save"?"Save to GitHub Gist":"Load from GitHub Gist"),y(N,`GitHub Token ${w()==="load"?"(optional for public gists)":"(required)"} `),K.disabled=e(le),m.disabled=e(le),Ye.disabled=e(le)}),F("click",C,Z),Fe(K,()=>e(G),g=>n(G,g)),F("blur",K,()=>{e(G)&&!e(V)&&O()}),F("click",m,function(...g){(w()==="save"?Y:ce)?.apply(this,g)}),F("click",Ye,Z),F("click",ve,ua(function(g){It.call(this,d,g)})),F("keydown",ve,function(g){It.call(this,d,g)}),F("click",P,Z),F("keydown",P,g=>g.key==="Escape"&&Z()),c(r,P),xt(),$()}var Pl=b('<div class="loading svelte-1ngjemu">Loading D&D data...</div>'),Bl=b("<option> </option>"),Ul=b('<select class="level-filter svelte-1ngjemu"><option>All Levels</option><option>Cantrip</option><!></select>'),Hl=b('<div class="no-results svelte-1ngjemu"> </div>'),Tl=b('<div class="item-meta svelte-1ngjemu"> </div>'),Nl=b('<div class="item-meta svelte-1ngjemu"> </div>'),Gl=b('<button><div class="item-name svelte-1ngjemu"> </div> <!></button>'),Ol=b('<p class="higher-levels"><strong>At Higher Levels:</strong> </p>'),ql=b('<p class="cantrip-upgrade"><strong>Cantrip Upgrade:</strong> </p>'),zl=b('<h3 class="svelte-1ngjemu"> </h3> <p class="spell-meta svelte-1ngjemu"><!> <!></p> <p class="spell-classes"><strong>Classes:</strong> </p> <div class="spell-stats svelte-1ngjemu"><div><strong>Casting Time:</strong> </div> <div><strong>Range:</strong> </div> <div><strong>Components:</strong> <!></div> <div><strong>Duration:</strong> <!> </div></div> <p class="description svelte-1ngjemu"> </p> <!> <!>',1),Wl=b('<p class="prerequisite svelte-1ngjemu"><strong>Prerequisite:</strong> </p>'),Vl=b('<h3 class="svelte-1ngjemu"> </h3> <!> <p class="description svelte-1ngjemu"> </p> <a target="_blank" rel="noopener" class="source-link svelte-1ngjemu">View Full Details â†’</a>',1),Jl=b('<div class="item-details svelte-1ngjemu"><!></div>'),Kl=b('<div class="controls svelte-1ngjemu"><div class="tabs svelte-1ngjemu"><button> </button> <button> </button></div> <div class="search-controls svelte-1ngjemu"><input type="text" placeholder="Search by name or description..." class="search-input svelte-1ngjemu"/> <!></div></div> <div class="content-container svelte-1ngjemu"><div class="items-list svelte-1ngjemu"><!></div> <!></div>',1),Ql=b('<div class="modal-backdrop svelte-1ngjemu" role="presentation"><div class="modal svelte-1ngjemu" role="dialog" aria-modal="true" tabindex="-1"><div class="modal-header svelte-1ngjemu"><h2 class="svelte-1ngjemu">Browse D&D Spells & Feats</h2> <button class="close-btn svelte-1ngjemu" aria-label="Close">&times;</button></div> <div class="modal-body svelte-1ngjemu"><!></div> <div class="modal-footer svelte-1ngjemu"><button class="btn-secondary svelte-1ngjemu">Cancel</button> <button class="btn-primary svelte-1ngjemu">Add to Character Sheet</button></div></div></div>');function Xl(r,d){kt(d,!1);const t=I(),v=I(),$=I();let k=Rt(d,"onClose",8),w=I("spell"),G=I(!0),f=I(""),z=I(null),le=I([]),H=I([]),V=I(null);zt(async()=>{n(G,!0);try{n(le,await Da()),n(H,await us())}catch(C){console.error("Failed to load data:",C)}finally{n(G,!1)}});function be(C){n(V,C)}function de(C){const J=C.match(/(\d+d\d+(?:\s*\+\s*\d+)?)/i);return J?J[1]:""}function xe(C){const J=C.split(/\.( |$)/)[0].trim(),ie=Array.from(C.matchAll(/\*\*(.*?)\*\*/g)).map(R=>R[1].replace(/\.$/,""));let h=J;return ie.length&&(h+=" | Effects: "+ie.join(", ")),h}function me(){if(e(V)){if(e(w)==="spell"){const C=e(V);X.update(J=>{const h=[];C.range&&h.push(`Range: ${C.range}`),C.castingTime&&h.push(`Cast: ${C.castingTime}`),C.duration&&h.push(`Duration: ${C.duration}`),C.actionType==="Save"&&h.push("Saving throw spell"),C.components&&C.components.length>0&&h.push(`Components: ${C.components.join(", ")}`),C.material&&h.push(`Material: ${C.material}`);const R=h.join(" | "),p=xe(C.description),N={id:crypto.randomUUID(),name:`${C.name}${C.concentration?" (C)":""}${C.ritual?" (R)":""}`,bonus:C.actionType==="Attack"?5:0,damage:de(C.description),damageType:`${C.school} (Lvl ${C.level})`,spellRef:C.name,infoNotes:R,generalNotes:p,castAtLevel:C.level};return J.attacks=[...J.attacks,N],J})}else if(e(w)==="feat"){const C=e(V);X.update(J=>{const ie=`${C.name}${C.prerequisite?` (Req: ${C.prerequisite})`:""}
${C.description}
`;return J.features=J.features?`${J.features}
${ie}`:ie,J})}n(V,null),k()()}}Xe(()=>(e(z),e(le),e(f)),()=>{n(t,e(z)!==null?ps(ha(e(le),e(f)),e(z)):ha(e(le),e(f)))}),Xe(()=>(e(H),e(f)),()=>{n(v,fs(e(H),e(f)))}),Xe(()=>(e(w),e(t),e(v)),()=>{n($,e(w)==="spell"?e(t):e(v))}),Lt(),yt();var O=Ql(),oe=l(O),ue=l(oe),Y=a(l(ue),2);s(ue);var ce=a(ue,2),Z=l(ce);{var P=C=>{var J=Pl();c(C,J)},ve=C=>{var J=Kl(),ie=ze(J),h=l(ie),R=l(h);let p;var N=l(R);s(R);var K=a(R,2);let U;var re=l(K);s(K),s(h);var Pe=a(h,2),Le=l(Pe);we(Le);var Ve=a(Le,2);{var pe=Q=>{var E=Ul();M(()=>{e(z),St(()=>{})});var Ae=l(E);Ae.value=(Ae.__value=null)??"";var Ce=a(Ae);Ce.value=Ce.__value=0;var Re=a(Ce);ot(Re,0,()=>[1,2,3,4,5,6,7,8,9],dt,($e,S)=>{var _e=Bl(),ye=l(_e);s(_e);var Ie={};M(()=>{y(ye,`Level ${S??""}`),Ie!==(Ie=S)&&(_e.value=(_e.__value=S)??"")}),c($e,_e)}),s(E),ja(E,()=>e(z),$e=>n(z,$e)),c(Q,E)};j(Ve,Q=>{e(w)==="spell"&&Q(pe)})}s(Pe),s(ie);var m=a(ie,2),Te=l(m),Oe=l(Te);{var qe=Q=>{var E=Hl(),Ae=l(E);s(E),M(()=>y(Ae,`No ${e(w)??""}s found`)),c(Q,E)},Ye=Q=>{var E=it(),Ae=ze(E);ot(Ae,1,()=>e($),dt,(Ce,Re)=>{var $e=Gl();let S;var _e=l($e),ye=l(_e,!0);s(_e);var Ie=a(_e,2);{var Je=je=>{const te=tt(()=>e(Re));var Se=Tl(),Ne=l(Se);s(Se),M(()=>y(Ne,`Level ${B(e(te)),i(()=>e(te).level)??""} â€¢ ${B(e(te)),i(()=>e(te).school)??""}`)),c(je,Se)},Ze=je=>{const te=tt(()=>e(Re));var Se=it(),Ne=ze(Se);{var De=A=>{var o=Nl(),L=l(o,!0);s(o),M(()=>y(L,(B(e(te)),i(()=>e(te).prerequisite)))),c(A,o)};j(Ne,A=>{B(e(te)),i(()=>e(te).prerequisite)&&A(De)})}c(je,Se)};j(Ie,je=>{e(w)==="spell"?je(Je):je(Ze,!1)})}s($e),M(()=>{S=ct($e,1,"item-card svelte-1ngjemu",null,S,{selected:e(V)?.name===e(Re).name}),y(ye,(e(Re),i(()=>e(Re).name)))}),F("click",$e,()=>be(e(Re))),c(Ce,$e)}),c(Q,E)};j(Oe,Q=>{e($),i(()=>e($).length===0)?Q(qe):Q(Ye,!1)})}s(Te);var g=a(Te,2);{var W=Q=>{var E=Jl(),Ae=l(E);{var Ce=$e=>{const S=tt(()=>e(V));var _e=zl(),ye=ze(_e),Ie=l(ye,!0);s(ye);var Je=a(ye,2),Ze=l(Je);{var je=se=>{var Qe=ht();M(()=>y(Qe,`${B(e(S)),i(()=>e(S).school)??""} cantrip`)),c(se,Qe)},te=se=>{var Qe=ht();M(()=>y(Qe,`Level ${B(e(S)),i(()=>e(S).level)??""} ${B(e(S)),i(()=>e(S).school)??""}`)),c(se,Qe)};j(Ze,se=>{B(e(S)),i(()=>e(S).level===0)?se(je):se(te,!1)})}var Se=a(Ze,2);{var Ne=se=>{var Qe=ht("(ritual)");c(se,Qe)};j(Se,se=>{B(e(S)),i(()=>e(S).ritual)&&se(Ne)})}s(Je);var De=a(Je,2),A=a(l(De));s(De);var o=a(De,2),L=l(o),q=a(l(L));s(L);var D=a(L,2),T=a(l(D));s(D);var _=a(D,2),he=a(l(_)),ke=a(he);{var Ge=se=>{var Qe=ht();M(()=>y(Qe,`(${B(e(S)),i(()=>e(S).material)??""})`)),c(se,Qe)};j(ke,se=>{B(e(S)),i(()=>e(S).material)&&se(Ge)})}s(_);var Me=a(_,2),u=a(l(Me),2);{var ae=se=>{var Qe=ht("Concentration,");c(se,Qe)};j(u,se=>{B(e(S)),i(()=>e(S).concentration)&&se(ae)})}var x=a(u,1,!0);s(Me),s(o);var ge=a(o,2),Be=l(ge,!0);s(ge);var Ue=a(ge,2);{var ne=se=>{var Qe=Ol(),gt=a(l(Qe));s(Qe),M(()=>y(gt,` ${B(e(S)),i(()=>e(S).higherLevelSlot)??""}`)),c(se,Qe)};j(Ue,se=>{B(e(S)),i(()=>e(S).higherLevelSlot)&&se(ne)})}var Ee=a(Ue,2);{var Ke=se=>{var Qe=ql(),gt=a(l(Qe));s(Qe),M(()=>y(gt,` ${B(e(S)),i(()=>e(S).cantripUpgrade)??""}`)),c(se,Qe)};j(Ee,se=>{B(e(S)),i(()=>e(S).cantripUpgrade)&&se(Ke)})}M((se,Qe)=>{y(Ie,(B(e(S)),i(()=>e(S).name))),y(A,` ${se??""}`),y(q,` ${B(e(S)),i(()=>e(S).castingTime||e(S).actionType)??""}`),y(T,` ${B(e(S)),i(()=>e(S).range)??""}`),y(he,` ${Qe??""}`),y(x,(B(e(S)),i(()=>e(S).duration))),y(Be,(B(e(S)),i(()=>e(S).description)))},[()=>(B(e(S)),i(()=>e(S).classes.join(", "))),()=>(B(e(S)),i(()=>e(S).components.join(", ").toUpperCase()))]),c($e,_e)},Re=$e=>{const S=tt(()=>e(V));var _e=Vl(),ye=ze(_e),Ie=l(ye,!0);s(ye);var Je=a(ye,2);{var Ze=Ne=>{var De=Wl(),A=a(l(De));s(De),M(()=>y(A,` ${B(e(S)),i(()=>e(S).prerequisite)??""}`)),c(Ne,De)};j(Je,Ne=>{B(e(S)),i(()=>e(S).prerequisite)&&Ne(Ze)})}var je=a(Je,2),te=l(je,!0);s(je);var Se=a(je,2);M(()=>{y(Ie,(B(e(S)),i(()=>e(S).name))),y(te,(B(e(S)),i(()=>e(S).description))),st(Se,"href",(B(e(S)),i(()=>e(S).source)))}),c($e,_e)};j(Ae,$e=>{e(w)==="spell"?$e(Ce):$e(Re,!1)})}s(E),c(Q,E)};j(g,Q=>{e(V)&&Q(W)})}s(m),M(()=>{p=ct(R,1,"tab svelte-1ngjemu",null,p,{active:e(w)==="spell"}),y(N,`ðŸ“œ Spells (${e(le),i(()=>e(le).length)??""})`),U=ct(K,1,"tab svelte-1ngjemu",null,U,{active:e(w)==="feat"}),y(re,`â­ Feats (${e(H),i(()=>e(H).length)??""})`)}),F("click",R,()=>{n(w,"spell"),n(V,null),n(f,"")}),F("click",K,()=>{n(w,"feat"),n(V,null),n(f,"")}),Fe(Le,()=>e(f),Q=>n(f,Q)),c(C,J)};j(Z,C=>{e(G)?C(P):C(ve,!1)})}s(ce);var fe=a(ce,2),ee=l(fe),He=a(ee,2);s(fe),s(oe),s(O),M(()=>He.disabled=!e(V)),F("click",Y,function(...C){k()?.apply(this,C)}),F("click",ee,function(...C){k()?.apply(this,C)}),F("click",He,me),F("click",oe,ua(function(C){It.call(this,d,C)})),F("keydown",oe,function(C){It.call(this,d,C)}),F("click",O,function(...C){k()?.apply(this,C)}),F("keydown",O,C=>C.key==="Escape"&&k()()),c(r,O),xt()}var Yl=b('<link rel="icon" type="image/png" href="/favicon.png"/> <meta name="viewport" content="width=device-width, initial-scale=1"/>',1),Zl=b('<span class="character-name svelte-1uha8ag"> </span>'),ei=b("<span> </span>"),ti=b('<div class="spell-slots-header svelte-1uha8ag"></div>'),ai=b('<div class="rest-menu svelte-1uha8ag"><button class="rest-option svelte-1uha8ag">â˜• Short Rest</button> <button class="rest-option svelte-1uha8ag">ðŸ›ï¸ Long Rest</button></div>'),si=b('<div class="container svelte-1uha8ag"><header class="svelte-1uha8ag"><div class="header-top svelte-1uha8ag"><div class="header-title svelte-1uha8ag"><div class="title-row svelte-1uha8ag"><h1 class="svelte-1uha8ag">D&D Character Sheet</h1> <!></div> <!></div> <div class="header-right svelte-1uha8ag"><div class="header-controls svelte-1uha8ag"><button class="btn btn-secondary use-enabled"><span class="btn-icon svelte-1uha8ag">ðŸŽ²</span><span class="btn-text svelte-1uha8ag">Roll Dice</span></button> <div class="rest-button-container svelte-1uha8ag"><button class="btn btn-secondary use-enabled"><span class="btn-icon svelte-1uha8ag">ðŸ˜´</span><span class="btn-text svelte-1uha8ag">Rest</span></button> <!></div> <div class="mode-toggle"><button><span class="btn-icon svelte-1uha8ag"> </span><span class="btn-text svelte-1uha8ag"> </span></button></div></div> <div class="header-search svelte-1uha8ag"><input type="text" placeholder="ðŸ” Search..." class="search-input use-enabled svelte-1uha8ag"/></div></div></div> <div class="header-actions svelte-1uha8ag"><button class="btn btn-mode svelte-1uha8ag">ðŸ“š Browse Spells & Feats</button> <button class="btn btn-secondary">Save to Gist</button> <button class="btn btn-secondary">Load from Gist</button> <button class="btn btn-secondary">Export JSON</button> <button class="btn btn-secondary">Import JSON</button> <input type="file" accept=".json" style="display: none;"/></div></header> <main class="svelte-1uha8ag"><!> <!> <!> <!> <!> <!> <!></main></div> <!> <!> <!> <!>',1);function ui(r,d){kt(d,!1);const t=()=>We(X,"$character",k),v=()=>We(Kt,"$isEditMode",k),$=()=>We(wt,"$searchFilter",k),[k,w]=Ct();function G(){const u=[],ae=t().classFeatures.spellSlotsByLevel||{};for(let x=1;x<=9;x++){const ge=ae[x];if(ge&&ge.length>0){const Be=ge.length,Ue=ge.filter(ne=>ne).length;u.push({level:x,available:Be-Ue,total:Be})}}return u}let f=I(!1),z=I(!1),le=I(!1),H=I("save"),V=I(void 0),be=I(""),de=I(""),xe=I(""),me=I(),O=!1,oe=I(!1);function ue(){const u=[];X.update(x=>{const ge=x.hitDice.current;x.hitDice.current=Math.min(x.hitDice.max,x.hitDice.current+Math.max(1,Math.floor(x.hitDice.max/2)));const Be=x.hitDice.current-ge;return Be>0&&u.push(`${Be} hit ${Be===1?"die":"dice"}`),x.classFeatures.features&&Object.keys(x.classFeatures.features).forEach(Ue=>{const ne=ce(Ue);if(ne?.resetOn==="short"){if(Array.isArray(x.classFeatures.features[Ue])){const Ee=ne.maxUses,Ke=typeof Ee=="function"?Ee(x.level):Ee;x.classFeatures.features[Ue]=Array(Ke).fill(!1),u.push(ne.name)}else if(typeof x.classFeatures.features[Ue]=="number"){const Ee=ne.maxPool,Ke=typeof Ee=="function"?Ee(x.level):Ee;Ke!==void 0&&(x.classFeatures.features[Ue]=Ke,u.push(ne.name))}}}),x}),n(oe,!1);const ae=u.length>0?`Short rest taken! Restored: ${u.join(", ")}`:"Short rest taken!";Gt.add(ae,"success")}function Y(){const u=[];X.update(x=>{const ge=x.maxHP-x.currentHP;ge>0&&u.push(`${ge} HP`),x.currentHP=x.maxHP,x.tempHP=0;const Be=x.hitDice.max-x.hitDice.current;Be>0&&u.push(`${Be} hit ${Be===1?"die":"dice"}`),x.hitDice.current=x.hitDice.max;let Ue=0;return x.classFeatures.spellSlotsByLevel&&Object.keys(x.classFeatures.spellSlotsByLevel).forEach(ne=>{const Ee=x.classFeatures.spellSlotsByLevel[parseInt(ne)];if(Ee){const Ke=Ee.filter(se=>se).length;Ue+=Ke,x.classFeatures.spellSlotsByLevel[parseInt(ne)]=Array(Ee.length).fill(!1)}}),Ue>0&&u.push(`${Ue} spell ${Ue===1?"slot":"slots"}`),x.classFeatures.features&&(Object.keys(x.classFeatures.features).forEach(ne=>{const Ee=ce(ne);if(Ee){if(Array.isArray(x.classFeatures.features[ne])){const Ke=Ee.maxUses,se=typeof Ke=="function"?Ke(x.level):Ke;x.classFeatures.features[ne]=Array(se).fill(!1)}else if(typeof x.classFeatures.features[ne]=="number"){const Ke=Ee.maxPool,se=typeof Ke=="function"?Ke(x.level):Ke;se!==void 0&&(x.classFeatures.features[ne]=se)}}}),Object.keys(x.classFeatures.features).length>0&&u.push("all class features")),x}),n(oe,!1);const ae=u.length>0?`Long rest taken! Restored: ${u.join(", ")}`:"Long rest taken! Fully rested.";Gt.add(ae,"success")}function ce(u){return(t().class?_t(t().class):null)?qt(t().class,t().level,t().subclass).find(ge=>ge.name.replace(/\s+/g,"")===u):null}function Z(u){n(be,""),n(de,""),n(xe,""),O=!1,typeof u=="string"?n(be,u):(n(be,u.notation),n(de,u.damageNotation||""),n(xe,u.attackName||"")),n(f,!0)}function P(u){const{notation:ae}=u.detail;n(be,""),O=!0,setTimeout(()=>{n(be,ae),n(de,""),n(xe,"Hit Die")},0),n(f,!0)}function ve(){if(n(f,!1),O&&e(me)){const u=e(me).getLastRollTotal();if(u!==null){const ae=Math.max(1,u);X.update(x=>(x.hitDice.current=Math.max(0,x.hitDice.current-1),x.currentHP=Math.min(x.maxHP,x.currentHP+ae),x))}O=!1}}function fe(){console.log("toggleMode called, current isEditMode:",v()),Kt.update(u=>(console.log("Updating isEditMode from",u,"to",!u),!u))}function ee(u){u.target.closest(".rest-button-container")||n(oe,!1)}zt(()=>{console.log("onMount - initial isEditMode:",v()),console.log("onMount - body classes:",document.body.className);const u=Kt.subscribe(ae=>{console.log("isEditMode subscription triggered, value:",ae),console.log("Body classes before:",document.body.className),ae?(document.body.classList.remove("use-mode"),console.log("Removed use-mode class (Edit Mode)")):(document.body.classList.add("use-mode"),console.log("Added use-mode class (Use Mode)")),console.log("Body classes after:",document.body.className)});return document.addEventListener("click",ee),()=>{u(),document.removeEventListener("click",ee)}});function He(){Ta(t())}function C(){e(V)?.click()}async function J(u){const x=u.target.files?.[0];if(x)try{const ge=await Na(x);X.set(ge),alert("Character imported successfully!")}catch{alert("Failed to import character file")}}yt();var ie=si();Ua("1uha8ag",u=>{var ae=Yl();Sa(2),ya(()=>{Ea.title="D&D Character Sheet"}),c(u,ae)});var h=ze(ie),R=l(h),p=l(R),N=l(p),K=l(N),U=a(l(K),2);{var re=u=>{var ae=Zl(),x=l(ae,!0);s(ae),M(()=>y(x,t().name)),c(u,ae)};j(U,u=>{t().name&&u(re)})}s(K);var Pe=a(K,2);{var Le=u=>{var ae=ti();ot(ae,5,G,dt,(x,ge)=>{var Be=ei();let Ue;var ne=l(Be);s(Be),M(()=>{Ue=ct(Be,1,"slot-badge svelte-1uha8ag",null,Ue,{depleted:e(ge).available===0}),y(ne,`Lv${e(ge).level??""}: ${e(ge).available??""}/${e(ge).total??""}`)}),c(x,Be)}),s(ae),c(u,ae)};j(Pe,u=>{G().length>0&&u(Le)})}s(N);var Ve=a(N,2),pe=l(Ve),m=l(pe),Te=a(m,2),Oe=l(Te),qe=a(Oe,2);{var Ye=u=>{var ae=ai(),x=l(ae),ge=a(x,2);s(ae),F("click",x,ue),F("click",ge,Y),c(u,ae)};j(qe,u=>{e(oe)&&u(Ye)})}s(Te);var g=a(Te,2),W=l(g);let Q;var E=l(W),Ae=l(E,!0);s(E);var Ce=a(E),Re=l(Ce,!0);s(Ce),s(W),s(g),s(pe);var $e=a(pe,2),S=l($e);we(S),s($e),s(Ve),s(p);var _e=a(p,2),ye=l(_e),Ie=a(ye,2),Je=a(Ie,2),Ze=a(Je,2),je=a(Ze,2),te=a(je,2);na(te,u=>n(V,u),()=>e(V)),s(_e),s(R);var Se=a(R,2),Ne=l(Se);Za(Ne,{});var De=a(Ne,2);ns(De,{$$events:{rollHitDice:P}});var A=a(De,2);ss(A,{$$events:{roll:u=>Z(u.detail)}});var o=a(A,2);ds(o,{$$events:{roll:u=>Z(u.detail)}});var L=a(o,2);Bs(L,{$$events:{roll:u=>Z(u.detail)}});var q=a(L,2);el(q,{});var D=a(q,2);sl(D,{}),s(Se),s(h);var T=a(h,2);na(bl(T,{get notation(){return e(be)},get damageNotation(){return e(de)},get attackName(){return e(xe)},get visible(){return e(f)},$$events:{close:ve},$$legacy:!0}),u=>n(me,u),()=>e(me));var _=a(T,2);{var he=u=>{El(u,{get mode(){return e(H)},$$events:{close:()=>n(z,!1)}})};j(_,u=>{e(z)&&u(he)})}var ke=a(_,2);{var Ge=u=>{Xl(u,{onClose:()=>n(le,!1)})};j(ke,u=>{e(le)&&u(Ge)})}var Me=a(ke,2);Ha(Me,{}),M(()=>{Q=ct(W,1,"btn btn-mode svelte-1uha8ag",null,Q,{"use-mode":!v()}),y(Ae,v()?"ðŸ“":"ðŸŽ²"),y(Re,v()?"Edit Mode":"Use Mode")}),F("click",m,()=>n(f,!0)),F("click",Oe,()=>n(oe,!e(oe))),F("click",W,fe),Fe(S,$,u=>Ga(wt,u)),F("click",ye,()=>n(le,!0)),F("click",Ie,()=>{n(H,"save"),n(z,!0)}),F("click",Je,()=>{n(H,"load"),n(z,!0)}),F("click",Ze,He),F("click",je,C),F("change",te,J),c(r,ie),xt(),w()}export{ui as component};
