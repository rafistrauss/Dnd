import{f as H,a as F,c as at,t as yt}from"../chunks/B_z_pdCz.js";import{i as Ce}from"../chunks/C6nJFxGc.js";import{w as Et,d as qt,c as Ve,o as Ft}from"../chunks/BIfMbnvC.js";import{a as ct,f as Jt,aP as Lt,k as st,h as we,g as Wt,T as Vt,z as t,a9 as Ee,V as Yt,W as Xt,X as _t,j as lt,e as Ye,C as Zt,aJ as Kt,au as kt,c as Oe,b as vt,s as Qt,$ as J,am as xt,aH as Mt,R as bt,aQ as Nt,aR as Rt,r as Tt,p as ea,aS as ta,aT as it,q as aa,aU as sa,i as la,aV as ia,aW as ra,aG as na,d as oa,a0 as ca,aX as va,aY as da,aZ as Pt,aN as ua,w as b,Z as Ht,a_ as fa,E as je,J as o,G as se,I as De,M as l,K as n,a$ as Xe,b0 as Ge,b1 as Ut,a2 as k,F as Pe,b2 as Qe,A as Be,b3 as pa,Y as ba,b4 as ma}from"../chunks/BMUXocL7.js";import{e as T,s as ee}from"../chunks/DuCnIS2G.js";import{s as ke,a as Fe,c as re,i as ce,d as Ze,p as Je,b as dt}from"../chunks/DK1cXCUg.js";import{r as q,a as Ot,s as Ue,b as $t,h as ha}from"../chunks/puCMm-MY.js";import{b as Ke}from"../chunks/DoctpTYP.js";function He(e,s){return s}function ga(e,s,a){for(var i=[],f=s.length,u=0;u<f;u++)ia(s[u].e,i,!0);ra(i,()=>{var r=i.length===0&&a!==null;if(r){var p=a,c=p.parentNode;na(c),c.append(p),e.items.clear(),Se(e,s[0].prev,s[f-1].next)}for(var y=0;y<f;y++){var m=s[y];r||(e.items.delete(m.k),Se(e,m.prev,m.next)),oa(m.e,!r)}e.first===s[0]&&(e.first=s[0].prev)})}function Me(e,s,a,i,f,u=null){var r=e,p=new Map,c=null,y=(s&Lt)!==0,m=(s&Nt)!==0,L=(s&Rt)!==0;if(y){var h=e;r=we?st(Wt(h)):h.appendChild(ct())}we&&Vt();var x=null,C=Ee(()=>{var S=a();return bt(S)?S:S==null?[]:Mt(S)}),w,v=!0;function d(){ya(I,w,r,s,i),x!==null&&(w.length===0?(x.fragment?(r.before(x.fragment),x.fragment=null):Tt(x.effect),P.first=x.effect):ea(x.effect,()=>{x=null}))}var P=Jt(()=>{w=t(C);var S=w.length;let _=!1;if(we){var N=Yt(r)===Xt;N!==(S===0)&&(r=_t(),st(r),lt(!1),_=!0)}for(var M=new Set,B=Oe,R=null,U=Qt(),j=0;j<S;j+=1){we&&Ye.nodeType===Zt&&Ye.data===Kt&&(r=Ye,_=!0,lt(!1));var X=w[j],Z=i(X,j),D=v?null:p.get(Z);D?(m&&kt(D.v,X),L?kt(D.i,j):D.i=j,U&&B.skipped_effects.delete(D.e)):(D=_a(v?r:null,R,X,Z,j,f,s,a),v&&(D.o=!0,R===null?c=D:R.next=D,R=D),p.set(Z,D)),M.add(Z)}if(S===0&&u&&!x)if(v)x={fragment:null,effect:vt(()=>u(r))};else{var Y=document.createDocumentFragment(),O=ct();Y.append(O),x={fragment:Y,effect:vt(()=>u(O))}}if(we&&S>0&&st(_t()),!v)if(U){for(const[W,ne]of p)M.has(W)||B.skipped_effects.add(ne.e);B.oncommit(d),B.ondiscard(()=>{})}else d();_&&lt(!0),t(C)}),I={effect:P,items:p,first:c};v=!1,we&&(r=Ye)}function ya(e,s,a,i,f){var u=(i&sa)!==0,r=s.length,p=e.items,c=e.first,y,m=null,L,h=[],x=[],C,w,v,d;if(u)for(d=0;d<r;d+=1)C=s[d],w=f(C,d),v=p.get(w),v.a?.measure(),(L??=new Set).add(v);for(d=0;d<r;d+=1){if(C=s[d],w=f(C,d),v=p.get(w),e.first??=v,!v.o){v.o=!0;var P=m?m.next:c;Se(e,m,v),Se(e,v,P),rt(v,P,a),m=v,h=[],x=[],c=m.next;continue}if((v.e.f&it)!==0&&(Tt(v.e),u&&(v.a?.unfix(),(L??=new Set).delete(v))),v!==c){if(y!==void 0&&y.has(v)){if(h.length<x.length){var I=x[0],S;m=I.prev;var _=h[0],N=h[h.length-1];for(S=0;S<h.length;S+=1)rt(h[S],I,a);for(S=0;S<x.length;S+=1)y.delete(x[S]);Se(e,_.prev,N.next),Se(e,m,_),Se(e,N,I),c=I,m=N,d-=1,h=[],x=[]}else y.delete(v),rt(v,c,a),Se(e,v.prev,v.next),Se(e,v,m===null?e.first:m.next),Se(e,m,v),m=v;continue}for(h=[],x=[];c!==null&&c.k!==w;)(c.e.f&it)===0&&(y??=new Set).add(c),x.push(c),c=c.next;if(c===null)continue;v=c}h.push(v),m=v,c=v.next}if(c!==null||y!==void 0){for(var M=y===void 0?[]:Mt(y);c!==null;)(c.e.f&it)===0&&M.push(c),c=c.next;var B=M.length;if(B>0){var R=(i&Lt)!==0&&r===0?a:null;if(u){for(d=0;d<B;d+=1)M[d].a?.measure();for(d=0;d<B;d+=1)M[d].a?.fix()}ga(e,M,R)}}u&&aa(()=>{if(L!==void 0)for(v of L)v.a?.apply()})}function _a(e,s,a,i,f,u,r,p){var c=(r&Nt)!==0,y=(r&ta)===0,m=c?y?J(a,!1,!1):xt(a):a,L=(r&Rt)===0?f:xt(f),h={i:L,v:m,k:i,a:null,e:null,o:!1,prev:s,next:null};try{if(e===null){var x=document.createDocumentFragment();x.append(e=ct())}return h.e=vt(()=>u(e,m,L,p)),s!==null&&(s.next=h),h}finally{}}function rt(e,s,a){for(var i=e.next?e.next.e.nodes_start:a,f=s?s.e.nodes_start:a,u=e.e.nodes_start;u!==null&&u!==i;){var r=la(u);f.before(u),u=r}}function Se(e,s,a){s===null?(e.first=a,e.effect.first=a&&a.e):(s.e.next&&(s.e.next.prev=null),s.next=a,s.e.next=a&&a.e),a===null?e.effect.last=s&&s.e:(a.e.prev&&(a.e.prev.next=null),a.prev=s,a.e.prev=s&&s.e)}const St=[...` 	
\r\fÂ \v\uFEFF`];function ka(e,s,a){var i=e==null?"":""+e;if(a){for(var f in a)if(a[f])i=i?i+" "+f:f;else if(i.length)for(var u=f.length,r=0;(r=i.indexOf(f,r))>=0;){var p=r+u;(r===0||St.includes(i[r-1]))&&(p===i.length||St.includes(i[p]))?i=(r===0?"":i.substring(0,r))+i.substring(p+1):r=p}}return i===""?null:i}function ut(e,s,a,i,f,u){var r=e.__className;if(we||r!==a||r===void 0){var p=ka(a,i,u);(!we||p!==e.getAttribute("class"))&&(p==null?e.removeAttribute("class"):e.className=p),e.__className=a}else if(u&&f!==u)for(var c in u){var y=!!u[c];(f==null||y!==!!f[c])&&e.classList.toggle(c,y)}return u}function Gt(e,s,a=!1){if(e.multiple){if(s==null)return;if(!bt(s))return va();for(var i of e.options)i.selected=s.includes(wt(i));return}for(i of e.options){var f=wt(i);if(da(f,s)){i.selected=!0;return}}(!a||s!==void 0)&&(e.selectedIndex=-1)}function xa(e){var s=new MutationObserver(()=>{Gt(e,e.__value)});s.observe(e,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),ca(()=>{s.disconnect()})}function wt(e){return"__value"in e?e.__value:e.value}function V(e,s,a=s){var i=new WeakSet;Pt(e,"input",async f=>{var u=f?e.defaultValue:e.value;if(u=nt(e)?ot(u):u,a(u),Oe!==null&&i.add(Oe),await ua(),u!==(u=s())){var r=e.selectionStart,p=e.selectionEnd,c=e.value.length;if(e.value=u??"",p!==null){var y=e.value.length;r===p&&p===c&&y>c?(e.selectionStart=y,e.selectionEnd=y):(e.selectionStart=r,e.selectionEnd=Math.min(p,y))}}}),(we&&e.defaultValue!==e.value||b(s)==null&&e.value)&&(a(nt(e)?ot(e.value):e.value),Oe!==null&&i.add(Oe)),Ht(()=>{var f=s();if(e===document.activeElement){var u=fa??Oe;if(i.has(u))return}nt(e)&&f===ot(e.value)||e.type==="date"&&!f&&!e.value||f!==e.value&&(e.value=f??"")})}function mt(e,s,a=s){Pt(e,"change",i=>{var f=i?e.defaultChecked:e.checked;a(f)}),(we&&e.defaultChecked!==e.checked||b(s)==null)&&a(e.checked),Ht(()=>{var i=s();e.checked=!!i})}function nt(e){var s=e.type;return s==="number"||s==="range"}function ot(e){return e===""?null:+e}function Bt(e){return function(...s){var a=s[0];return a.stopPropagation(),e?.apply(this,s)}}function et(e,s){var a=e.$$events?.[s.type],i=bt(a)?a.slice():a==null?[]:[a];for(var f of i)f.call(this,s)}const ft={name:"",class:"",level:1,race:"",background:"",alignment:"",armorClass:10,initiative:0,speed:"30 ft",currentHP:0,maxHP:0,tempHP:0,hitDice:{current:3,max:3},abilities:{strength:10,dexterity:10,constitution:10,intelligence:10,wisdom:10,charisma:10},proficiencyBonus:2,saveProficiencies:{strength:!1,dexterity:!1,constitution:!1,intelligence:!1,wisdom:!1,charisma:!1},skillProficiencies:{acrobatics:!1,animalHandling:!1,arcana:!1,athletics:!1,deception:!1,history:!1,insight:!1,intimidation:!1,investigation:!1,medicine:!1,nature:!1,perception:!1,performance:!1,persuasion:!1,religion:!1,sleightOfHand:!1,stealth:!1,survival:!1},attacks:[],features:"",equipment:"",notes:"",classFeatures:{features:{},spellSlots:[],preparedSpells:""}};function $a(){try{const e=localStorage.getItem("dndCharacter");if(e){const s={...ft,...JSON.parse(e)};return s.attacks&&Array.isArray(s.attacks)&&(s.attacks=s.attacks.map(a=>({...a,id:a.id||crypto.randomUUID()}))),s.classFeatures?(s.classFeatures.features||(s.classFeatures.features={}),s.classFeatures.spellSlots||(s.classFeatures.spellSlots=[]),s.classFeatures.preparedSpells===void 0&&(s.classFeatures.preparedSpells="")):s.classFeatures={features:{},spellSlots:[],preparedSpells:""},s}}catch(e){console.error("Failed to load character from storage:",e)}return ft}const E=Et($a());E.subscribe(e=>{try{localStorage.setItem("dndCharacter",JSON.stringify(e))}catch(s){console.error("Failed to save character to storage:",s)}});const We=Et(!0);{const e=localStorage.getItem("dndMode");We.set(e==="edit"),We.subscribe(s=>{localStorage.setItem("dndMode",s?"edit":"use")})}const ht=qt(E,e=>{const s=a=>Math.floor((a-10)/2);return{strength:s(e.abilities.strength),dexterity:s(e.abilities.dexterity),constitution:s(e.abilities.constitution),intelligence:s(e.abilities.intelligence),wisdom:s(e.abilities.wisdom),charisma:s(e.abilities.charisma)}});function Sa(e){return Math.ceil(e/4)+1}function zt(){E.update(e=>(e.proficiencyBonus=Sa(e.level),e))}function wa(e){const s=JSON.stringify(e,null,2),a="data:application/json;charset=utf-8,"+encodeURIComponent(s),i=`${e.name||"character"}_${new Date().toISOString().split("T")[0]}.json`,f=document.createElement("a");f.setAttribute("href",a),f.setAttribute("download",i),f.click()}function Ca(e){return new Promise((s,a)=>{const i=new FileReader;i.onload=f=>{try{const u=JSON.parse(f.target?.result),r={...ft,...u};r.attacks&&Array.isArray(r.attacks)&&(r.attacks=r.attacks.map(p=>({...p,id:p.id||crypto.randomUUID()}))),r.classFeatures?(r.classFeatures.features||(r.classFeatures.features={}),r.classFeatures.spellSlots||(r.classFeatures.spellSlots=[]),r.classFeatures.preparedSpells===void 0&&(r.classFeatures.preparedSpells="")):r.classFeatures={features:{},spellSlots:[],preparedSpells:""},s(r)}catch{a(new Error("Invalid character file"))}},i.onerror=()=>a(new Error("Failed to read file")),i.readAsText(e)})}const pt={paladin:{name:"Paladin",hitDice:"d10",spellcaster:!0,spellcastingAbility:"charisma",spellSlotsByLevel:{1:0,2:2,3:3,4:3,5:4,6:4,7:4,8:4,9:4,10:4,11:4,12:4,13:4,14:4,15:4,16:4,17:4,18:4,19:4,20:4},features:[{name:"Divine Sense",type:"uses",maxUses:(e,s=1)=>1+Math.max(1,s),resetOn:"long",description:"Detect celestials, fiends, and undead within 60 feet",minLevel:1},{name:"Lay on Hands",type:"pool",maxPool:e=>e*5,resetOn:"long",description:"Heal wounds or cure disease",minLevel:1},{name:"Divine Smite",type:"spellSlot",description:"Expend spell slot to deal extra radiant damage",minLevel:2,rollable:!0},{name:"Channel Divinity",type:"uses",maxUses:e=>e>=18?3:e>=6?2:1,resetOn:"short",description:"Sacred Weapon or Turn Undead",minLevel:3}]},fighter:{name:"Fighter",hitDice:"d10",spellcaster:!1,features:[{name:"Second Wind",type:"uses",maxUses:1,resetOn:"short",description:"Regain 1d10 + fighter level HP as bonus action",minLevel:1,rollable:!0,rollFormula:e=>`1d10+${e}`},{name:"Action Surge",type:"uses",maxUses:e=>e>=17?2:1,resetOn:"short",description:"Take one additional action on your turn",minLevel:2},{name:"Indomitable",type:"uses",maxUses:e=>e>=17?3:e>=13?2:1,resetOn:"long",description:"Reroll a failed saving throw",minLevel:9}]},rogue:{name:"Rogue",hitDice:"d8",spellcaster:!1,features:[{name:"Sneak Attack",type:"info",description:e=>`Deal ${Math.ceil(e/2)}d6 extra damage once per turn with advantage or ally nearby`,minLevel:1,rollable:!0,rollFormula:e=>`${Math.ceil(e/2)}d6`},{name:"Cunning Action",type:"info",description:"Dash, Disengage, or Hide as a bonus action",minLevel:2},{name:"Uncanny Dodge",type:"info",description:"Use reaction to halve damage from an attack",minLevel:5},{name:"Evasion",type:"info",description:"Take no damage on successful Dex save (half on fail)",minLevel:7}]},wizard:{name:"Wizard",hitDice:"d6",spellcaster:!0,spellcastingAbility:"intelligence",spellSlotsByLevel:{1:2,2:3,3:4,4:4,5:4,6:4,7:4,8:4,9:4,10:4,11:4,12:4,13:4,14:4,15:4,16:4,17:4,18:4,19:4,20:4},features:[{name:"Arcane Recovery",type:"uses",maxUses:1,resetOn:"long",description:e=>`Recover spell slots totaling up to ${Math.ceil(e/2)} levels during short rest`,minLevel:1},{name:"Spell Mastery",type:"info",description:"Cast one 1st-level and one 2nd-level spell at will",minLevel:18}]},cleric:{name:"Cleric",hitDice:"d8",spellcaster:!0,spellcastingAbility:"wisdom",spellSlotsByLevel:{1:2,2:3,3:4,4:4,5:4,6:4,7:4,8:4,9:4,10:4,11:4,12:4,13:4,14:4,15:4,16:4,17:4,18:4,19:4,20:4},features:[{name:"Channel Divinity",type:"uses",maxUses:e=>e>=18?3:e>=6?2:1,resetOn:"short",description:"Turn Undead or domain-specific ability",minLevel:2},{name:"Destroy Undead",type:"info",description:e=>`Channel Divinity destroys undead of CR ${e>=17?4:e>=14?3:e>=11?2:e>=8?1:.5} or lower`,minLevel:5},{name:"Divine Intervention",type:"uses",maxUses:1,resetOn:"long",description:e=>`${e}% chance to succeed, implore deity for aid`,minLevel:10}]},barbarian:{name:"Barbarian",hitDice:"d12",spellcaster:!1,features:[{name:"Rage",type:"uses",maxUses:e=>e>=20?1/0:e>=17?6:e>=12?5:e>=6?4:e>=3?3:2,resetOn:"long",description:e=>`+${e>=16?4:e>=9?3:2} damage, resistance to physical damage`,minLevel:1},{name:"Reckless Attack",type:"info",description:"Gain advantage on melee attacks, enemies get advantage on you",minLevel:2},{name:"Danger Sense",type:"info",description:"Advantage on Dex saves against effects you can see",minLevel:2}]}};function ze(e){const s=e.toLowerCase();return pt[s]||null}function Ct(e,s){const a=ze(e);return a?a.features.filter(i=>!i.minLevel||i.minLevel<=s):[]}function jt(e,s){const a=ze(e);return!a||!a.spellcaster||!a.spellSlotsByLevel?0:a.spellSlotsByLevel[s]||0}function Dt(e,s,a){const i=ze(e);return!i||!i.spellcaster?0:Math.max(1,a+s)}function ja(e,s,a){const i=ze(e);return!i||!i.spellcaster?null:8+s+a}function Da(){return Object.keys(pt).map(e=>({id:e,name:pt[e].name}))}var Aa=H("<option> </option>"),Ia=H('<section class="character-info svelte-172i2fj"><h2 class="svelte-172i2fj">Character Info</h2> <div class="info-grid svelte-172i2fj"><div class="form-group svelte-172i2fj"><label for="characterName" class="svelte-172i2fj">Character Name</label> <input type="text" id="characterName" placeholder="Enter name" class="svelte-172i2fj"/></div> <div class="form-group svelte-172i2fj"><label for="characterClass" class="svelte-172i2fj">Class</label> <select id="characterClass" class="svelte-172i2fj"><option>Select Class</option><!></select></div> <div class="form-group svelte-172i2fj"><label for="characterLevel" class="svelte-172i2fj">Level</label> <input type="number" id="characterLevel" min="1" max="20" class="svelte-172i2fj"/></div> <div class="form-group svelte-172i2fj"><label for="characterRace" class="svelte-172i2fj">Race</label> <input type="text" id="characterRace" placeholder="e.g., Human" class="svelte-172i2fj"/></div> <div class="form-group svelte-172i2fj"><label for="characterBackground" class="svelte-172i2fj">Background</label> <input type="text" id="characterBackground" placeholder="e.g., Soldier" class="svelte-172i2fj"/></div> <div class="form-group svelte-172i2fj"><label for="characterAlignment" class="svelte-172i2fj">Alignment</label> <input type="text" id="characterAlignment" placeholder="e.g., Lawful Good" class="svelte-172i2fj"/></div></div></section>');function Ea(e,s){je(s,!1);const a=()=>ke(E,"$character",i),[i,f]=Fe(),u=Da();function r(R){const U=R.target;E.update(j=>(j.class=U.value,j))}function p(R){const U=R.target;E.update(j=>(j.level=parseInt(U.value)||1,j)),zt()}Ce();var c=Ia(),y=l(o(c),2),m=o(y),L=l(o(m),2);q(L),n(m);var h=l(m,2),x=l(o(h),2),C=o(x);C.value=C.__value="";var w=l(C);Me(w,1,()=>u,He,(R,U)=>{var j=Aa(),X=o(j,!0);n(j);var Z={};se(()=>{ee(X,t(U).name),Z!==(Z=t(U).id)&&(j.value=(j.__value=t(U).id)??"")}),F(R,j)}),n(x);var v;xa(x),n(h);var d=l(h,2),P=l(o(d),2);q(P),n(d);var I=l(d,2),S=l(o(I),2);q(S),n(I);var _=l(I,2),N=l(o(_),2);q(N),n(_);var M=l(_,2),B=l(o(M),2);q(B),n(M),n(y),n(c),se(()=>{v!==(v=a().class)&&(x.value=(x.__value=a().class)??"",Gt(x,a().class)),Ot(P,a().level)}),V(L,()=>a().name,R=>re(E,b(a).name=R,b(a))),T("change",x,r),T("change",P,p),V(S,()=>a().race,R=>re(E,b(a).race=R,b(a))),V(N,()=>a().background,R=>re(E,b(a).background=R,b(a))),V(B,()=>a().alignment,R=>re(E,b(a).alignment=R,b(a))),F(e,c),De(),f()}var Fa=H('<div class="ability-card svelte-bbv1xt"><h3 class="svelte-bbv1xt"> </h3> <input type="number" class="ability-score svelte-bbv1xt" min="1" max="30"/> <div class="ability-modifier svelte-bbv1xt"> </div> <button class="roll-btn svelte-bbv1xt">Check</button> <div class="save-row svelte-bbv1xt"><input type="checkbox" class="svelte-bbv1xt"/> <label class="svelte-bbv1xt">Save</label> <button class="roll-btn-small svelte-bbv1xt">Roll</button></div></div>'),La=H('<section class="ability-scores svelte-bbv1xt"><h2 class="svelte-bbv1xt">Ability Scores</h2> <div class="proficiency-bonus svelte-bbv1xt"><label for="profBonus">Proficiency Bonus</label> <input type="number" id="profBonus" class="prof-input svelte-bbv1xt"/></div> <div class="abilities-grid svelte-bbv1xt"></div></section>');function Ma(e,s){je(s,!1);const a=()=>ke(ht,"$abilityModifiers",f),i=()=>ke(E,"$character",f),[f,u]=Fe(),r=Ve(),p=[{key:"strength",label:"Strength"},{key:"dexterity",label:"Dexterity"},{key:"constitution",label:"Constitution"},{key:"intelligence",label:"Intelligence"},{key:"wisdom",label:"Wisdom"},{key:"charisma",label:"Charisma"}];function c(){zt()}function y(w){const v=a()[w],d=`1d20${v>=0?"+":""}${v}`;r("roll",d)}function m(w){const v=a()[w],d=i().saveProficiencies[w]?i().proficiencyBonus:0,P=v+d,I=`1d20${P>=0?"+":""}${P}`;r("roll",I)}Ce();var L=La(),h=l(o(L),2),x=l(o(h),2);q(x),n(h);var C=l(h,2);Me(C,5,()=>p,He,(w,v)=>{let d=()=>t(v).key,P=()=>t(v).label;var I=Fa(),S=o(I),_=o(S,!0);n(S);var N=l(S,2);q(N);var M=l(N,2),B=o(M);n(M);var R=l(M,2),U=l(R,2),j=o(U);q(j);var X=l(j,2),Z=l(X,2);n(U),n(I),se(D=>{ee(_,D),ee(B,`${a()[d()]>=0?"+":""}${a()[d()]??""}`),Ue(j,"id",`${d()}-save`),Ue(X,"for",`${d()}-save`)},[()=>P().substring(0,3).toUpperCase()]),V(N,()=>i().abilities[d()],D=>re(E,b(i).abilities[d()]=D,b(i))),T("change",N,c),T("click",R,()=>y(d())),mt(j,()=>i().saveProficiencies[d()],D=>re(E,b(i).saveProficiencies[d()]=D,b(i))),T("click",Z,()=>m(d())),F(w,I)}),n(C),n(L),V(x,()=>i().proficiencyBonus,w=>re(E,b(i).proficiencyBonus=w,b(i))),F(e,L),De(),u()}var Na=H('<section class="combat-stats svelte-1r5hyyb"><h2 class="svelte-1r5hyyb">Combat Stats</h2> <div class="stats-grid svelte-1r5hyyb"><div class="stat-box svelte-1r5hyyb"><label for="armorClass" class="svelte-1r5hyyb">Armor Class</label> <input type="number" id="armorClass" class="stat-input svelte-1r5hyyb"/></div> <div class="stat-box svelte-1r5hyyb"><label for="initiative" class="svelte-1r5hyyb">Initiative</label> <input type="number" id="initiative" class="stat-input svelte-1r5hyyb"/></div> <div class="stat-box svelte-1r5hyyb"><label for="speed" class="svelte-1r5hyyb">Speed</label> <input type="text" id="speed" class="stat-input svelte-1r5hyyb"/></div></div> <div class="hp-section svelte-1r5hyyb"><h3 class="svelte-1r5hyyb">Hit Points</h3> <div class="hp-display svelte-1r5hyyb"><div class="hp-inputs svelte-1r5hyyb"><input type="number" class="hp-current svelte-1r5hyyb" min="0"/> <span class="hp-separator svelte-1r5hyyb">/</span> <input type="number" class="hp-max svelte-1r5hyyb" min="0"/></div> <div class="hp-controls svelte-1r5hyyb"><button class="hp-btn svelte-1r5hyyb">âˆ’</button> <button class="hp-btn svelte-1r5hyyb">+</button> <button class="hp-btn svelte-1r5hyyb">âˆ’5</button> <button class="hp-btn svelte-1r5hyyb">+5</button></div></div> <div class="temp-hp svelte-1r5hyyb"><label for="tempHP" class="svelte-1r5hyyb">Temp HP</label> <input type="number" id="tempHP" min="0" class="svelte-1r5hyyb"/></div></div> <div class="hit-dice-section svelte-1r5hyyb"><h3 class="svelte-1r5hyyb">Hit Dice</h3> <div class="hit-dice-display svelte-1r5hyyb"><input type="number" class="hit-dice-input svelte-1r5hyyb" min="0"/> <span>/</span> <input type="number" class="hit-dice-input svelte-1r5hyyb" min="0"/></div></div></section>');function Ra(e,s){je(s,!1);const a=()=>ke(E,"$character",i),[i,f]=Fe();function u(D){E.update(Y=>(Y.currentHP=Math.max(0,Math.min(Y.maxHP,Y.currentHP+D)),Y))}Ce();var r=Na(),p=l(o(r),2),c=o(p),y=l(o(c),2);q(y),n(c);var m=l(c,2),L=l(o(m),2);q(L),n(m);var h=l(m,2),x=l(o(h),2);q(x),n(h),n(p);var C=l(p,2),w=l(o(C),2),v=o(w),d=o(v);q(d);var P=l(d,4);q(P),n(v);var I=l(v,2),S=o(I),_=l(S,2),N=l(_,2),M=l(N,2);n(I),n(w);var B=l(w,2),R=l(o(B),2);q(R),n(B),n(C);var U=l(C,2),j=l(o(U),2),X=o(j);q(X);var Z=l(X,4);q(Z),n(j),n(U),n(r),se(()=>{Ue(d,"max",a().maxHP),Ue(X,"max",a().hitDice.max)}),V(y,()=>a().armorClass,D=>re(E,b(a).armorClass=D,b(a))),V(L,()=>a().initiative,D=>re(E,b(a).initiative=D,b(a))),V(x,()=>a().speed,D=>re(E,b(a).speed=D,b(a))),V(d,()=>a().currentHP,D=>re(E,b(a).currentHP=D,b(a))),V(P,()=>a().maxHP,D=>re(E,b(a).maxHP=D,b(a))),T("click",S,()=>u(-1)),T("click",_,()=>u(1)),T("click",N,()=>u(-5)),T("click",M,()=>u(5)),V(R,()=>a().tempHP,D=>re(E,b(a).tempHP=D,b(a))),V(X,()=>a().hitDice.current,D=>re(E,b(a).hitDice.current=D,b(a))),V(Z,()=>a().hitDice.max,D=>re(E,b(a).hitDice.max=D,b(a))),F(e,r),De(),f()}const At={acrobatics:"dexterity",animalHandling:"wisdom",arcana:"intelligence",athletics:"strength",deception:"charisma",history:"intelligence",insight:"wisdom",intimidation:"charisma",investigation:"intelligence",medicine:"wisdom",nature:"intelligence",perception:"wisdom",performance:"charisma",persuasion:"charisma",religion:"intelligence",sleightOfHand:"dexterity",stealth:"dexterity",survival:"wisdom"};var Ta=H('<div class="skill-row svelte-1f1pl16"><input type="checkbox" class="svelte-1f1pl16"/> <label class="svelte-1f1pl16"> <span class="ability-tag svelte-1f1pl16"> </span></label> <span class="skill-modifier svelte-1f1pl16"> </span> <button class="roll-btn svelte-1f1pl16">Roll</button></div>'),Pa=H('<section class="skills svelte-1f1pl16"><h2 class="svelte-1f1pl16">Skills</h2> <div class="skills-grid svelte-1f1pl16"></div></section>');function Ha(e,s){je(s,!1);const a=()=>ke(ht,"$abilityModifiers",f),i=()=>ke(E,"$character",f),[f,u]=Fe(),r=Ve(),p=[{key:"acrobatics",label:"Acrobatics"},{key:"animalHandling",label:"Animal Handling"},{key:"arcana",label:"Arcana"},{key:"athletics",label:"Athletics"},{key:"deception",label:"Deception"},{key:"history",label:"History"},{key:"insight",label:"Insight"},{key:"intimidation",label:"Intimidation"},{key:"investigation",label:"Investigation"},{key:"medicine",label:"Medicine"},{key:"nature",label:"Nature"},{key:"perception",label:"Perception"},{key:"performance",label:"Performance"},{key:"persuasion",label:"Persuasion"},{key:"religion",label:"Religion"},{key:"sleightOfHand",label:"Sleight of Hand"},{key:"stealth",label:"Stealth"},{key:"survival",label:"Survival"}];function c(h){const x=At[h],C=a()[x],w=i().skillProficiencies[h]?i().proficiencyBonus:0;return C+w}function y(h){const x=c(h),C=`1d20${x>=0?"+":""}${x}`;r("roll",C)}Ce();var m=Pa(),L=l(o(m),2);Me(L,5,()=>p,He,(h,x)=>{let C=()=>t(x).key,w=()=>t(x).label;const v=Ee(()=>At[C()]),d=Ee(()=>c(C()));var P=Ta(),I=o(P);q(I);var S=l(I,2),_=o(S),N=l(_),M=o(N);n(N),n(S);var B=l(S,2),R=o(B);n(B);var U=l(B,2);n(P),se(j=>{Ue(I,"id",C()),Ue(S,"for",C()),ee(_,`${w()??""} `),ee(M,`(${j??""})`),ee(R,`${t(d)>=0?"+":""}${t(d)??""}`)},[()=>t(v).substring(0,3).toUpperCase()]),mt(I,()=>i().skillProficiencies[C()],j=>re(E,b(i).skillProficiencies[C()]=j,b(i))),T("click",U,()=>y(C())),F(h,P)}),n(L),n(m),F(e,m),De(),u()}var Ua=H('<div class="attack-card svelte-14o91c5"><div class="attack-header svelte-14o91c5"><input type="text" placeholder="Attack name" class="attack-name svelte-14o91c5"/> <button class="btn-remove svelte-14o91c5">Ã—</button></div> <div class="attack-details svelte-14o91c5"><div class="attack-field svelte-14o91c5"><label class="svelte-14o91c5">Bonus</label> <input type="number" class="attack-bonus svelte-14o91c5"/></div> <div class="attack-field svelte-14o91c5"><label class="svelte-14o91c5">Damage</label> <input type="text" placeholder="e.g., 2d6+3" class="attack-damage svelte-14o91c5"/></div> <div class="attack-field svelte-14o91c5"><label class="svelte-14o91c5">Type</label> <input type="text" placeholder="e.g., slashing" class="attack-type svelte-14o91c5"/></div></div> <div class="attack-actions svelte-14o91c5"><button class="btn btn-primary">Roll Attack</button> <button class="btn btn-secondary">Roll Damage</button></div></div>'),Oa=H('<p class="no-attacks svelte-14o91c5">No attacks added yet. Click "Add Attack" to create one.</p>'),Ga=H('<section class="attacks svelte-14o91c5"><h2 class="svelte-14o91c5">Attacks & Spells</h2> <button class="btn btn-secondary">Add Attack</button> <div class="attacks-list svelte-14o91c5"><!> <!></div></section>');function Ba(e,s){je(s,!1);const a=()=>ke(E,"$character",i),[i,f]=Fe(),u=Ve();function r(){E.update(v=>(v.attacks=[...v.attacks,{id:crypto.randomUUID(),name:"",bonus:0,damage:"",damageType:""}],v))}function p(v){E.update(d=>(d.attacks=d.attacks.filter(P=>P.id!==v),d))}function c(v){const d=`1d20${v.bonus>=0?"+":""}${v.bonus}`;u("roll",{notation:d,damageNotation:v.damage,attackName:v.name})}function y(v){if(!v.damage){alert(`${v.name}: No damage specified`);return}u("roll",{notation:v.damage})}Ce();var m=Ga(),L=l(o(m),2),h=l(L,2),x=o(h);Me(x,1,()=>a().attacks,v=>v.id,(v,d,P)=>{var I=Ua(),S=o(I),_=o(S);q(_);var N=l(_,2);n(S);var M=l(S,2),B=o(M),R=l(o(B),2);q(R),n(B);var U=l(B,2),j=l(o(U),2);q(j),n(U);var X=l(U,2),Z=l(o(X),2);q(Z),n(X),n(M);var D=l(M,2),Y=o(D),O=l(Y,2);n(D),n(I),V(_,()=>t(d).name,W=>(t(d).name=W,Xe(()=>a()),Ze(i,"$character"))),T("click",N,()=>p(t(d).id)),V(R,()=>t(d).bonus,W=>(t(d).bonus=W,Xe(()=>a()),Ze(i,"$character"))),V(j,()=>t(d).damage,W=>(t(d).damage=W,Xe(()=>a()),Ze(i,"$character"))),V(Z,()=>t(d).damageType,W=>(t(d).damageType=W,Xe(()=>a()),Ze(i,"$character"))),T("click",Y,()=>c(t(d))),T("click",O,()=>y(t(d))),F(v,I)});var C=l(x,2);{var w=v=>{var d=Oa();F(v,d)};ce(C,v=>{a().attacks.length===0&&v(w)})}n(h),n(m),T("click",L,r),F(e,m),De(),f()}var za=H('<p class="no-features svelte-1kpvv0n">Select a class to see available features</p>'),qa=H('<p class="no-features svelte-1kpvv0n">No class features available at this level</p>'),Ja=H('<input type="checkbox" class="slot-checkbox svelte-1kpvv0n"/>'),Wa=H('<div class="spell-slots svelte-1kpvv0n"><label class="svelte-1kpvv0n">1st Level Spell Slots</label> <div class="slots-tracker svelte-1kpvv0n"><!> <button class="btn-small svelte-1kpvv0n">Long Rest</button></div></div>'),Va=H('<div class="feature-box spellcasting svelte-1kpvv0n"><h3 class="svelte-1kpvv0n"> </h3> <div class="spell-stats svelte-1kpvv0n"><div class="spell-stat svelte-1kpvv0n"><label class="svelte-1kpvv0n">Spell Save DC</label> <div class="spell-value svelte-1kpvv0n"> </div></div> <div class="spell-stat svelte-1kpvv0n"><label class="svelte-1kpvv0n">Prepared Spells</label> <div class="spell-value svelte-1kpvv0n"> </div></div></div> <!> <div class="prepared-spells svelte-1kpvv0n"><label class="svelte-1kpvv0n">Prepared Spells</label> <textarea placeholder="List your prepared spells..." class="svelte-1kpvv0n"></textarea></div></div>'),Ya=H('<p class="unlimited svelte-1kpvv0n">Unlimited Uses</p>'),Xa=H('<input type="checkbox" class="use-checkbox svelte-1kpvv0n"/>'),Za=H('<input type="checkbox" class="use-checkbox svelte-1kpvv0n"/>'),Ka=H('<!> <button class="btn-small svelte-1kpvv0n"> </button>',1),Qa=H('<div class="uses-tracker svelte-1kpvv0n"><!></div>'),es=H('<div class="pool-tracker svelte-1kpvv0n"><input type="number" min="0" class="pool-input svelte-1kpvv0n"/> <span> </span> <button class="btn-small svelte-1kpvv0n"> </button></div>'),ts=H('<div class="feature-box svelte-1kpvv0n"><h3 class="svelte-1kpvv0n"> </h3> <p class="feature-description svelte-1kpvv0n"> </p> <!></div>'),as=H('<div class="features-grid svelte-1kpvv0n"><!> <!></div>'),ss=H('<section class="class-features svelte-1kpvv0n"><h2 class="svelte-1kpvv0n">Class Features</h2> <!></section>');function ls(e,s){je(s,!1);const a=()=>ke(E,"$character",f),i=()=>ke(ht,"$abilityModifiers",f),[f,u]=Fe(),r=J(),p=J(),c=J();let y=J(0),m=J(0);function L(_,N){E.update(M=>(M.classFeatures.features[_]||(M.classFeatures.features[_]=[]),M.classFeatures.features[_]=Array(N).fill(!1),M))}function h(_,N){E.update(M=>(M.classFeatures.features[_]=N,M))}function x(){E.update(_=>(_.classFeatures.spellSlots=Array(t(c)).fill(!1),_))}function C(_){if(typeof _.maxUses=="function"){if(_.name==="Divine Sense"&&t(r)?.spellcastingAbility){const N=i()[t(r).spellcastingAbility];return _.maxUses(a().level,N)}return _.maxUses(a().level)}return _.maxUses||0}function w(_){return typeof _.maxPool=="function"?_.maxPool(a().level):_.maxPool||0}function v(_){return typeof _.description=="function"?_.description(a().level):_.description}Ge(()=>(a(),ze),()=>{k(r,a().class?ze(a().class):null)}),Ge(()=>(a(),Ct),()=>{k(p,a().class?Ct(a().class,a().level):[])}),Ge(()=>(a(),jt),()=>{k(c,a().class?jt(a().class,a().level):0)}),Ge(()=>(t(r),i(),a(),Dt),()=>{if(t(r)?.spellcaster&&t(r).spellcastingAbility){const _=i()[t(r).spellcastingAbility];k(y,ja(a().class,_,a().proficiencyBonus)||0),k(m,Dt(a().class,a().level,_))}}),Ut(),Ce();var d=ss(),P=l(o(d),2);{var I=_=>{var N=za();F(_,N)},S=_=>{var N=at(),M=Pe(N);{var B=U=>{var j=qa();F(U,j)},R=U=>{var j=as(),X=o(j);{var Z=Y=>{var O=Va(),W=o(O),ne=o(W);n(W);var ge=l(W,2),A=o(ge),K=l(o(A),2),oe=o(K,!0);n(K),n(A);var be=l(A,2),fe=l(o(be),2),xe=o(fe,!0);n(fe),n(be),n(ge);var ye=l(ge,2);{var Ne=G=>{var z=Wa(),te=l(o(z),2),le=o(te);Me(le,1,()=>(t(c),b(()=>Array(t(c)))),He,(Q,pe,de)=>{var me=Ja();q(me),mt(me,()=>a().classFeatures.spellSlots[de],_e=>re(E,b(a).classFeatures.spellSlots[de]=_e,b(a))),F(Q,me)});var ve=l(le,2);n(te),n(z),T("click",ve,x),F(G,z)};ce(ye,G=>{t(c)>0&&G(Ne)})}var $=l(ye,2),g=l(o($),2);Qe(g),n($),n(O),se(G=>{ee(ne,`Spellcasting (${G??""})`),ee(oe,t(y)),ee(xe,t(m))},[()=>(t(r),b(()=>t(r).spellcastingAbility?.toUpperCase()))]),V(g,()=>a().classFeatures.preparedSpells,G=>re(E,b(a).classFeatures.preparedSpells=G,b(a))),F(Y,O)};ce(X,Y=>{t(r),b(()=>t(r)?.spellcaster)&&Y(Z)})}var D=l(X,2);Me(D,1,()=>t(p),He,(Y,O)=>{const W=Ee(()=>(t(O),b(()=>t(O).name.replace(/\s+/g,"")))),ne=Ee(()=>(a(),Be(t(W)),b(()=>a().classFeatures.features[t(W)]))),ge=Ee(()=>(Be(t(ne)),b(()=>Array.isArray(t(ne))))),A=Ee(()=>typeof t(ne)=="number");var K=ts(),oe=o(K),be=o(oe,!0);n(oe);var fe=l(oe,2),xe=o(fe,!0);n(fe);var ye=l(fe,2);{var Ne=g=>{const G=Ee(()=>(t(O),b(()=>C(t(O)))));var z=Qa(),te=o(z);{var le=Q=>{var pe=Ya();F(Q,pe)},ve=Q=>{var pe=Ka(),de=Pe(pe);Me(de,1,()=>(Be(t(G)),b(()=>Array(t(G)))),He,(Le,Re,$e)=>{var Te=at(),ae=Pe(Te);{var ue=ie=>{var he=Xa();q(he),se(()=>$t(he,(Be(t(ne)),b(()=>t(ne)&&t(ne)[$e]||!1)))),T("change",he,qe=>{E.update(Ie=>{Ie.classFeatures.features[t(W)]||(Ie.classFeatures.features[t(W)]=[]);const tt=Ie.classFeatures.features[t(W)];return tt[$e]=qe.currentTarget.checked,Ie})}),F(ie,he)},Ae=ie=>{var he=Za();q(he),$t(he,!1),T("change",he,qe=>{E.update(Ie=>{Ie.classFeatures.features[t(W)]||(Ie.classFeatures.features[t(W)]=[]);const tt=Ie.classFeatures.features[t(W)];return tt[$e]=qe.currentTarget.checked,Ie})}),F(ie,he)};ce(ae,ie=>{t(ge)?ie(ue):ie(Ae,!1)})}F(Le,Te)});var me=l(de,2),_e=o(me,!0);n(me),se(()=>ee(_e,(t(O),b(()=>t(O).resetOn==="short"?"Short Rest":"Long Rest")))),T("click",me,()=>L(t(W),t(G))),F(Q,pe)};ce(te,Q=>{t(G)===1/0?Q(le):Q(ve,!1)})}n(z),F(g,z)},$=g=>{var G=at(),z=Pe(G);{var te=le=>{const ve=Ee(()=>(t(O),b(()=>w(t(O)))));var Q=es(),pe=o(Q);q(pe);var de=l(pe,2),me=o(de);n(de);var _e=l(de,2),Le=o(_e,!0);n(_e),n(Q),se(()=>{Ot(pe,t(A)&&t(ne)!==void 0?t(ne):t(ve)),Ue(pe,"max",t(ve)),ee(me,`/ ${t(ve)??""}`),ee(Le,(t(O),b(()=>t(O).resetOn==="short"?"Short Rest":"Long Rest")))}),T("input",pe,Re=>{E.update($e=>($e.classFeatures.features[t(W)]=parseInt(Re.currentTarget.value)||0,$e))}),T("click",_e,()=>h(t(W),t(ve))),F(le,Q)};ce(z,le=>{t(O),b(()=>t(O).type==="pool")&&le(te)},!0)}F(g,G)};ce(ye,g=>{t(O),b(()=>t(O).type==="uses")?g(Ne):g($,!1)})}n(K),se(g=>{ee(be,(t(O),b(()=>t(O).name))),ee(xe,g)},[()=>(t(O),b(()=>v(t(O))))]),F(Y,K)}),n(j),F(U,j)};ce(M,U=>{t(p),b(()=>t(p).length===0)?U(B):U(R,!1)},!0)}F(_,N)};ce(P,_=>{a(),b(()=>!a().class)?_(I):_(S,!1)})}n(d),F(e,d),De(),u()}var is=H('<section class="notes svelte-wttn0l"><h2 class="svelte-wttn0l">Features & Traits</h2> <textarea placeholder="Enter features, traits, and special abilities..." class="svelte-wttn0l"></textarea> <h2 class="svelte-wttn0l">Equipment</h2> <textarea placeholder="List your equipment and inventory..." class="svelte-wttn0l"></textarea> <h2 class="svelte-wttn0l">Notes</h2> <textarea placeholder="Additional notes..." class="svelte-wttn0l"></textarea></section>');function rs(e,s){je(s,!1);const a=()=>ke(E,"$character",i),[i,f]=Fe();Ce();var u=is(),r=l(o(u),2);Qe(r);var p=l(r,4);Qe(p);var c=l(p,4);Qe(c),n(u),V(r,()=>a().features,y=>re(E,b(a).features=y,b(a))),V(p,()=>a().equipment,y=>re(E,b(a).equipment=y,b(a))),V(c,()=>a().notes,y=>re(E,b(a).notes=y,b(a))),F(e,u),De(),f()}var ns=H('<div class="loading svelte-1r90jgp"><p class="svelte-1r90jgp">Loading 3D dice...</p></div>'),os=H('<div class="custom-dice-selector svelte-1r90jgp"><h3 class="svelte-1r90jgp">Choose Dice to Roll</h3> <div class="dice-inputs svelte-1r90jgp"><div class="dice-input-group svelte-1r90jgp"><label for="d4" class="svelte-1r90jgp">d4</label> <input class="use-enabled svelte-1r90jgp" type="number" id="d4" min="0" max="10"/></div> <div class="dice-input-group svelte-1r90jgp"><label for="d6" class="svelte-1r90jgp">d6</label> <input class="use-enabled svelte-1r90jgp" type="number" id="d6" min="0" max="10"/></div> <div class="dice-input-group svelte-1r90jgp"><label for="d8" class="svelte-1r90jgp">d8</label> <input class="use-enabled svelte-1r90jgp" type="number" id="d8" min="0" max="10"/></div> <div class="dice-input-group svelte-1r90jgp"><label for="d10" class="svelte-1r90jgp">d10</label> <input class="use-enabled svelte-1r90jgp" type="number" id="d10" min="0" max="10"/></div> <div class="dice-input-group svelte-1r90jgp"><label for="d12" class="svelte-1r90jgp">d12</label> <input class="use-enabled svelte-1r90jgp" type="number" id="d12" min="0" max="10"/></div> <div class="dice-input-group svelte-1r90jgp"><label for="d20" class="svelte-1r90jgp">d20</label> <input class="use-enabled svelte-1r90jgp" type="number" id="d20" min="0" max="10"/></div></div> <div class="dice-controls svelte-1r90jgp"><button class="btn btn-primary use-enabled svelte-1r90jgp"> </button> <button class="btn btn-secondary use-enabled svelte-1r90jgp">Reset</button></div></div>'),cs=H('<span class="crit-badge svelte-1r90jgp">CRITICAL!</span>'),vs=H('<p class="svelte-1r90jgp"> </p>'),ds=H('<p class="modifier-text svelte-1r90jgp"> </p>'),us=H('<button class="btn btn-follow-up svelte-1r90jgp"> </button>'),fs=H('<div class="follow-up-actions svelte-1r90jgp"></div>'),ps=H('<div class="result-header svelte-1r90jgp"><h3 class="svelte-1r90jgp"> </h3> <!></div> <div class="result-total svelte-1r90jgp"> </div> <div class="result-details svelte-1r90jgp"><!> <!></div> <!>',1),bs=H('<div role="button" tabindex="-1"><div class="modal-content svelte-1r90jgp" role="dialog" tabindex="0"><div class="modal-header svelte-1r90jgp"><h2 class="svelte-1r90jgp">Dice Roller</h2> <button class="close-btn svelte-1r90jgp">Ã—</button></div> <!> <div class="dice-main-area svelte-1r90jgp"><div class="dice-container svelte-1r90jgp"></div> <!></div> <div><!></div></div></div>');function ms(e,s){je(s,!1);const a=J(),i=Ve();let f=Je(s,"notation",12,""),u=Je(s,"visible",8,!1),r=Je(s,"damageNotation",12,""),p=Je(s,"attackName",12,""),c=null,y=J(void 0),m=J(!1),L=J(""),h=J(null),x=J(0),C=J(0),w=J(0),v=J(0),d=J(0),P=J(0),I=J(0),S=J([]),_=J(!1);function N(){if(window.DICE&&t(y))try{c&&t(y)&&pa(y,t(y).innerHTML="");const $=t(y).clientWidth||500,g=t(y).clientHeight||300;c=new window.DICE.dice_box(t(y),{w:$,h:g}),k(m,!0),console.log(`Dice box initialized with dimensions: ${$}x${g}`)}catch($){console.error("Error initializing dice box:",$)}}Ft(()=>{const $=z=>new Promise((te,le)=>{if(document.querySelector(`script[src="${z}"]`)){console.log(`Script already loaded: ${z}`),te(null);return}const Q=document.createElement("script");Q.src=z,Q.onload=()=>{console.log(`Loaded: ${z}`),te(null)},Q.onerror=()=>{console.error(`Failed to load: ${z}`),le(new Error(`Failed to load ${z}`))},document.head.appendChild(Q)});setTimeout(()=>{$(`${Ke}/libs/three.min.js`).then(()=>$(`${Ke}/libs/cannon.min.js`)).then(()=>$(`${Ke}/libs/teal.js`)).then(()=>$(`${Ke}/dice.js`)).then(()=>{console.log("All scripts loaded, initializing dice box..."),console.log("DICE available:",!!window.DICE),console.log("Container available:",!!t(y)),N()}).catch(z=>{console.error("Failed to load dice libraries:",z)})},100);const g=()=>{t(m)&&(console.log("Window resized, reinitializing dice box..."),N())},G=z=>{u()&&z.key==="Escape"&&X()};return window.addEventListener("resize",g),window.addEventListener("keydown",G),()=>{window.removeEventListener("resize",g),window.removeEventListener("keydown",G)}});function M($,g="other"){if(!c||!t(m))return;console.log("Rolling dice:",$,"type:",g),c.diceToRoll=$;const G=te=>(console.log("Before roll:",te),null),z=te=>{if(console.log("After roll:",te),console.log("Result:",te.resultTotal),k(h,te),g==="attack"||g==="check"||g==="save"){const le=te.results?.filter(ve=>ve.sides===20)||[];if(le.length>0){const ve=le[0].value;k(_,ve===20)}}if(k(S,[]),g==="attack"&&r())if(t(_)){const le=U(r());t(S).push({label:`Roll Critical Damage (${le})`,notation:le})}else t(S).push({label:`Roll Damage (${r()})`,notation:r()})};c.start_throw(G,z)}function B(){const $=[];t(x)>0&&$.push(`${t(x)}d4`),t(C)>0&&$.push(`${t(C)}d6`),t(w)>0&&$.push(`${t(w)}d8`),t(v)>0&&$.push(`${t(v)}d10`),t(d)>0&&$.push(`${t(d)}d12`),t(P)>0&&$.push(`${t(P)}d20`);let g=$.join("+")||"1d20";return t(I)!==0&&(g+=t(I)>=0?`+${t(I)}`:`${t(I)}`),g}function R(){const $=B();M($)}function U($){return $.replace(/(\d+)d(\d+)/g,(g,G,z)=>`${parseInt(G)*2}d${z}`)}function j(){k(x,0),k(C,0),k(w,0),k(v,0),k(d,0),k(P,0),k(I,0),k(h,null),k(S,[]),k(_,!1)}function X(){i("close"),f(""),r(""),p(""),k(L,""),k(h,null),j()}Ge(()=>(t(x),t(C),t(w),t(v),t(d),t(P),t(I)),()=>{k(a,(()=>{const $=[];t(x)>0&&$.push(`${t(x)}d4`),t(C)>0&&$.push(`${t(C)}d6`),t(w)>0&&$.push(`${t(w)}d8`),t(v)>0&&$.push(`${t(v)}d10`),t(d)>0&&$.push(`${t(d)}d12`),t(P)>0&&$.push(`${t(P)}d20`);let g=$.join("+")||"1d20";return t(I)!==0&&(g+=t(I)>=0?`+${t(I)}`:`${t(I)}`),g})())}),Ge(()=>(Be(f()),t(m),Be(u())),()=>{if(f()&&t(m)&&u()){k(L,f()),k(h,null),k(S,[]),k(_,!1);const $=f().includes("1d20")?"attack":"other";setTimeout(()=>M(f(),$),200)}}),Ut(),Ce();var Z=bs();let D;var Y=o(Z),O=o(Y),W=l(o(O),2);n(O);var ne=l(O,2);{var ge=$=>{var g=ns();F($,g)};ce(ne,$=>{t(m)||$(ge)})}var A=l(ne,2),K=o(A);dt(K,$=>k(y,$),()=>t(y));var oe=l(K,2);{var be=$=>{var g=os(),G=l(o(g),2),z=o(G),te=l(o(z),2);q(te),n(z);var le=l(z,2),ve=l(o(le),2);q(ve),n(le);var Q=l(le,2),pe=l(o(Q),2);q(pe),n(Q);var de=l(Q,2),me=l(o(de),2);q(me),n(de);var _e=l(de,2),Le=l(o(_e),2);q(Le),n(_e);var Re=l(_e,2),$e=l(o(Re),2);q($e),n(Re),n(G);var Te=l(G,2),ae=o(Te),ue=o(ae);n(ae);var Ae=l(ae,2);n(Te),n(g),se(()=>{ae.disabled=!t(m),ee(ue,`Roll ${t(a)??""}`)}),V(te,()=>t(x),ie=>k(x,ie)),V(ve,()=>t(C),ie=>k(C,ie)),V(pe,()=>t(w),ie=>k(w,ie)),V(me,()=>t(v),ie=>k(v,ie)),V(Le,()=>t(d),ie=>k(d,ie)),V($e,()=>t(P),ie=>k(P,ie)),T("click",ae,R),T("click",Ae,j),F($,g)};ce(oe,$=>{f()||$(be)})}n(A);var fe=l(A,2);let xe;var ye=o(fe);{var Ne=$=>{var g=ps(),G=Pe(g),z=o(G),te=o(z,!0);n(z);var le=l(z,2);{var ve=ae=>{var ue=cs();F(ae,ue)};ce(le,ae=>{t(_)&&ae(ve)})}n(G);var Q=l(G,2),pe=o(Q,!0);n(Q);var de=l(Q,2),me=o(de);{var _e=ae=>{var ue=vs(),Ae=o(ue,!0);n(ue),se(()=>ee(Ae,(t(h),b(()=>t(h).resultString)))),F(ae,ue)};ce(me,ae=>{t(h),b(()=>t(h).resultString)&&ae(_e)})}var Le=l(me,2);{var Re=ae=>{var ue=ds(),Ae=o(ue);n(ue),se(()=>ee(Ae,`Modifier: ${t(h),b(()=>t(h).constant>=0?"+":"")??""}${t(h),b(()=>t(h).constant)??""}`)),F(ae,ue)};ce(Le,ae=>{t(h),b(()=>t(h).constant)&&ae(Re)})}n(de);var $e=l(de,2);{var Te=ae=>{var ue=fs();Me(ue,5,()=>t(S),He,(Ae,ie)=>{var he=us(),qe=o(he,!0);n(he),se(()=>ee(qe,(t(ie),b(()=>t(ie).label)))),T("click",he,()=>M(t(ie).notation,"damage")),F(Ae,he)}),n(ue),F(ae,ue)};ce($e,ae=>{t(S),b(()=>t(S).length>0)&&ae(Te)})}se(()=>{ee(te,p()?`${p()} - Result`:"Result"),ee(pe,(t(h),b(()=>t(h).resultTotal)))}),F($,g)};ce(ye,$=>{t(h)&&$(Ne)})}n(fe),n(Y),n(Z),se(()=>{D=ut(Z,1,"modal-overlay svelte-1r90jgp",null,D,{hidden:!u()}),xe=ut(fe,1,"roll-result svelte-1r90jgp",null,xe,{"has-result":t(h)})}),T("click",W,X),T("click",Y,Bt(function($){et.call(this,s,$)})),T("keydown",Y,function($){et.call(this,s,$)}),T("click",Z,X),T("keydown",Z,$=>$.key==="Escape"&&X()),F(e,Z),De()}const gt="https://api.github.com/gists";async function hs(e,s,a){if(!s)throw new Error("GitHub token is required");const i=JSON.stringify(e,null,2),f=`${e.name||"character"}_dnd.json`,u={description:a||`D&D Character: ${e.name}`,public:!1,files:{[f]:{content:i}}},r=await fetch(gt,{method:"POST",headers:{Authorization:`token ${s}`,"Content-Type":"application/json"},body:JSON.stringify(u)});if(!r.ok)throw new Error(`Failed to create gist: ${r.statusText}`);return(await r.json()).id}async function gs(e,s,a){if(!s||!a)throw new Error("GitHub token and Gist ID are required");const i=JSON.stringify(e,null,2),u={files:{[`${e.name||"character"}_dnd.json`]:{content:i}}},r=await fetch(`${gt}/${a}`,{method:"PATCH",headers:{Authorization:`token ${s}`,"Content-Type":"application/json"},body:JSON.stringify(u)});if(!r.ok)throw new Error(`Failed to update gist: ${r.statusText}`)}async function ys(e,s){if(!e)throw new Error("Gist ID is required");const a={"Content-Type":"application/json"};s&&(a.Authorization=`token ${s}`);const i=await fetch(`${gt}/${e}`,{method:"GET",headers:a});if(!i.ok)throw new Error(`Failed to load gist: ${i.statusText}`);const f=await i.json(),u=Object.values(f.files);if(u.length===0)throw new Error("No files found in gist");const p=u[0].content;try{const c=JSON.parse(p);return c.attacks&&Array.isArray(c.attacks)&&(c.attacks=c.attacks.map(y=>({...y,id:y.id||crypto.randomUUID()}))),c.classFeatures?(c.classFeatures.features||(c.classFeatures.features={}),c.classFeatures.spellSlots||(c.classFeatures.spellSlots=[]),c.classFeatures.preparedSpells===void 0&&(c.classFeatures.preparedSpells="")):c.classFeatures={features:{},spellSlots:[],preparedSpells:""},c}catch{throw new Error("Invalid character data in gist")}}function It(e){typeof window<"u"&&localStorage.setItem("dnd_gist_config",JSON.stringify(e))}function _s(){if(typeof window<"u"){const e=localStorage.getItem("dnd_gist_config");if(e)return JSON.parse(e)}return{}}var ks=H('<div class="error-message svelte-1jb5ckg"> </div>'),xs=H('<div class="form-group svelte-1jb5ckg"><label for="gistId" class="svelte-1jb5ckg">Gist ID (leave empty to create new)</label> <input type="text" id="gistId" placeholder="Optional: existing Gist ID to update" class="svelte-1jb5ckg"/></div> <div class="form-group svelte-1jb5ckg"><label for="description" class="svelte-1jb5ckg">Description</label> <input type="text" id="description" placeholder="D&amp;D Character Sheet" class="svelte-1jb5ckg"/></div>',1),$s=H('<div class="form-group svelte-1jb5ckg"><label for="gistId" class="svelte-1jb5ckg">Gist ID *</label> <input type="text" id="gistId" placeholder="Enter Gist ID" required class="svelte-1jb5ckg"/></div>'),Ss=H('<div class="modal-overlay svelte-1jb5ckg" role="button" tabindex="-1"><div class="modal-content svelte-1jb5ckg" role="dialog" tabindex="0"><div class="modal-header svelte-1jb5ckg"><h2 class="svelte-1jb5ckg"> </h2> <button class="close-btn svelte-1jb5ckg">Ã—</button></div> <div class="modal-body svelte-1jb5ckg"><!> <div class="form-group svelte-1jb5ckg"><label for="token" class="svelte-1jb5ckg">GitHub Token (optional for public gists) <a href="https://github.com/settings/tokens" target="_blank" rel="noopener" class="svelte-1jb5ckg">Get token</a></label> <input type="password" id="token" placeholder="ghp_xxxxxxxxxxxxx" class="svelte-1jb5ckg"/></div> <!> <div class="modal-actions svelte-1jb5ckg"><button class="btn btn-primary svelte-1jb5ckg"><!></button> <button class="btn btn-secondary svelte-1jb5ckg">Cancel</button></div></div></div></div>');function ws(e,s){je(s,!1);const a=()=>ke(E,"$character",i),[i,f]=Fe(),u=Ve();let r=Je(s,"mode",8,"save"),p=J(""),c=J(""),y=J(""),m=J(!1),L=J("");const h=_s();h.token&&k(p,h.token),h.gistId&&k(c,h.gistId);async function x(){if(!t(p)){k(L,"GitHub token is required");return}k(m,!0),k(L,"");try{if(t(c))await gs(a(),t(p),t(c)),alert("Character updated in Gist successfully!");else{const A=await hs(a(),t(p),t(y));k(c,A),alert(`Character saved to Gist! ID: ${A}`)}It({token:t(p),gistId:t(c)}),u("close")}catch(A){k(L,A.message||"Failed to save to Gist")}finally{k(m,!1)}}async function C(){if(!t(c)){k(L,"Gist ID is required");return}k(m,!0),k(L,"");try{const A=await ys(t(c),t(p)||void 0);E.set(A),It({token:t(p),gistId:t(c)}),alert("Character loaded from Gist successfully!"),u("close")}catch(A){k(L,A.message||"Failed to load from Gist")}finally{k(m,!1)}}function w(){u("close")}Ce();var v=Ss(),d=o(v),P=o(d),I=o(P),S=o(I,!0);n(I);var _=l(I,2);n(P);var N=l(P,2),M=o(N);{var B=A=>{var K=ks(),oe=o(K,!0);n(K),se(()=>ee(oe,t(L))),F(A,K)};ce(M,A=>{t(L)&&A(B)})}var R=l(M,2),U=l(o(R),2);q(U),n(R);var j=l(R,2);{var X=A=>{var K=xs(),oe=Pe(K),be=l(o(oe),2);q(be),n(oe);var fe=l(oe,2),xe=l(o(fe),2);q(xe),n(fe),se(()=>{be.disabled=t(m),xe.disabled=t(m)}),V(be,()=>t(c),ye=>k(c,ye)),V(xe,()=>t(y),ye=>k(y,ye)),F(A,K)},Z=A=>{var K=$s(),oe=l(o(K),2);q(oe),n(K),se(()=>oe.disabled=t(m)),V(oe,()=>t(c),be=>k(c,be)),F(A,K)};ce(j,A=>{r()==="save"?A(X):A(Z,!1)})}var D=l(j,2),Y=o(D),O=o(Y);{var W=A=>{var K=yt();se(()=>ee(K,r()==="save"?"Saving...":"Loading...")),F(A,K)},ne=A=>{var K=yt();se(()=>ee(K,r()==="save"?"Save":"Load")),F(A,K)};ce(O,A=>{t(m)?A(W):A(ne,!1)})}n(Y);var ge=l(Y,2);n(D),n(N),n(d),n(v),se(()=>{ee(S,r()==="save"?"Save to GitHub Gist":"Load from GitHub Gist"),U.disabled=t(m),Y.disabled=t(m),ge.disabled=t(m)}),T("click",_,w),V(U,()=>t(p),A=>k(p,A)),T("click",Y,function(...A){(r()==="save"?x:C)?.apply(this,A)}),T("click",ge,w),T("click",d,Bt(function(A){et.call(this,s,A)})),T("keydown",d,function(A){et.call(this,s,A)}),T("click",v,w),T("keydown",v,A=>A.key==="Escape"&&w()),F(e,v),De(),f()}var Cs=H('<link rel="icon" type="image/png" href="/favicon.png"/>'),js=H('<div class="container svelte-1uha8ag"><header class="svelte-1uha8ag"><div class="header-top svelte-1uha8ag"><h1 class="svelte-1uha8ag">D&D Character Sheet</h1> <div class="mode-toggle"><button> </button></div></div> <div class="header-actions svelte-1uha8ag"><button class="btn btn-secondary use-enabled">ðŸŽ² Roll Dice</button> <button class="btn btn-secondary">Save to Gist</button> <button class="btn btn-secondary">Load from Gist</button> <button class="btn btn-secondary">Export JSON</button> <button class="btn btn-secondary">Import JSON</button> <input type="file" accept=".json" style="display: none;"/></div></header> <main class="svelte-1uha8ag"><!> <!> <!> <!> <!> <!> <!></main></div> <!> <!>',1);function Rs(e,s){je(s,!1);const a=()=>ke(We,"$isEditMode",f),i=()=>ke(E,"$character",f),[f,u]=Fe();let r=J(!1),p=J(!1),c=J("save"),y=J(void 0),m=J(""),L=J(""),h=J(""),x=J();function C(g){k(m,""),setTimeout(typeof g=="string"?()=>{k(m,g),k(L,""),k(h,"")}:()=>{k(m,g.notation),k(L,g.damageNotation||""),k(h,g.attackName||"")},0),k(r,!0)}function w(){console.log("toggleMode called, current isEditMode:",a()),We.update(g=>(console.log("Updating isEditMode from",g,"to",!g),!g))}Ft(()=>(console.log("onMount - initial isEditMode:",a()),console.log("onMount - body classes:",document.body.className),We.subscribe(G=>{console.log("isEditMode subscription triggered, value:",G),console.log("Body classes before:",document.body.className),G?(document.body.classList.remove("use-mode"),console.log("Removed use-mode class (Edit Mode)")):(document.body.classList.add("use-mode"),console.log("Added use-mode class (Use Mode)")),console.log("Body classes after:",document.body.className)})));function v(){wa(i())}function d(){t(y)?.click()}async function P(g){const z=g.target.files?.[0];if(z)try{const te=await Ca(z);E.set(te),alert("Character imported successfully!")}catch{alert("Failed to import character file")}}Ce();var I=js();ha("1uha8ag",g=>{var G=Cs();ba(()=>{ma.title="D&D Character Sheet"}),F(g,G)});var S=Pe(I),_=o(S),N=o(_),M=l(o(N),2),B=o(M);let R;var U=o(B,!0);n(B),n(M),n(N);var j=l(N,2),X=o(j),Z=l(X,2),D=l(Z,2),Y=l(D,2),O=l(Y,2),W=l(O,2);dt(W,g=>k(y,g),()=>t(y)),n(j),n(_);var ne=l(_,2),ge=o(ne);Ea(ge,{});var A=l(ge,2);Ra(A,{});var K=l(A,2);Ma(K,{$$events:{roll:g=>C(g.detail)}});var oe=l(K,2);Ha(oe,{$$events:{roll:g=>C(g.detail)}});var be=l(oe,2);Ba(be,{$$events:{roll:g=>C(g.detail)}});var fe=l(be,2);ls(fe,{});var xe=l(fe,2);rs(xe,{}),n(ne),n(S);var ye=l(S,2);dt(ms(ye,{get notation(){return t(m)},get damageNotation(){return t(L)},get attackName(){return t(h)},get visible(){return t(r)},$$events:{close:()=>k(r,!1)},$$legacy:!0}),g=>k(x,g),()=>t(x));var Ne=l(ye,2);{var $=g=>{ws(g,{get mode(){return t(c)},$$events:{close:()=>k(p,!1)}})};ce(Ne,g=>{t(p)&&g($)})}se(()=>{R=ut(B,1,"btn btn-mode svelte-1uha8ag",null,R,{"use-mode":!a()}),ee(U,a()?"ðŸ“ Edit Mode":"ðŸŽ² Use Mode")}),T("click",B,w),T("click",X,()=>k(r,!0)),T("click",Z,()=>{k(c,"save"),k(p,!0)}),T("click",D,()=>{k(c,"load"),k(p,!0)}),T("click",Y,v),T("click",O,d),T("change",W,P),F(e,I),De(),u()}export{Rs as component};
