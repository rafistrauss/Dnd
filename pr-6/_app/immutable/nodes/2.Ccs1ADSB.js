import{d as ks,g as Ks,f as u,e as B,a as o,s as $,c as $t,t as Tt}from"../chunks/BESELRjb.js";import{i as Yt}from"../chunks/JMgyEzd3.js";import{c as ka,o as Ca,a as Vs,b as Js}from"../chunks/CtPH092J.js";import{F as D,T as ya,Y as us,j as Ys,aZ as Qs,U as $s,ag as Xs,aD as Zs,aK as el,aE as tl,a1 as al,av as Ga,a7 as hs,i as Ps,a_ as sl,a$ as Is,b0 as Qa,K as $a,e as Es,b1 as Us,b2 as ll,b3 as rl,b4 as il,q as fs,b5 as nl,b6 as ol,ab as cl,d as i,r as _s,g as vl,C as Qt,G as Xt,H as l,I as s,J as a,b7 as Xe,b8 as ga,s as n,a4 as w,f as e,m as xt,E as De,b9 as Kt,ao as ta,A as U,ba as _a,bb as ja,bc as dl}from"../chunks/DyJ43TGI.js";import{t as ul,c as la,a as pe,e as Lt,i as Rt,u as Ns,s as xa,b as Et,d as Xa,f as Sa,g as Ja,j as fl,k as Ht,l as pl,m as ws,n as rs,h as ml,T as gl,o as bl,p as hl,r as Ss,q as Cs}from"../chunks/Fq0DehG0.js";import{i as m,s as fa,a as _t,b as Ot,d as Pa,e as _l}from"../chunks/CCL4udNy.js";import{p as Bt,b as Ua}from"../chunks/iXw84bXb.js";import{b as Ia,r as yl}from"../chunks/Du6-D4ON.js";function ps(r,c,t=!1,v=!1,f=!1){var p=r,g="";D(()=>{var S=Ys;if(g===(g=c()??"")){ya&&us();return}if(S.nodes_start!==null&&(Qs(S.nodes_start,S.nodes_end),S.nodes_start=S.nodes_end=null),g!==""){if(ya){$s.data;for(var y=us(),_=y;y!==null&&(y.nodeType!==Xs||y.data!=="");)_=y,y=Zs(y);if(y===null)throw el(),tl;ks($s,_),p=al(y);return}var N=g+"";t?N=`<svg>${N}</svg>`:v&&(N=`<math>${N}</math>`);var F=Ks(N);if((t||v)&&(F=Ga(F)),ks(Ga(F),F.lastChild),t||v)for(;Ga(F);)p.before(Ga(F));else p.before(F)}})}function xl(r,c,t,v,f){ya&&us();var p=c.$$slots?.[t],g=!1;p===!0&&(p=c[t],g=!0),p===void 0?f!==null&&f(r):p(r,g?()=>v:v)}function kl(r,c,t,v){var f=r.__style;if(ya||f!==c){var p=ul(c);(!ya||p!==r.getAttribute("style"))&&(p==null?r.removeAttribute("style"):r.style.cssText=p),r.__style=c}return v}function Ya(r,c,t=!1){if(r.multiple){if(c==null)return;if(!Ps(c))return sl();for(var v of r.options)v.selected=c.includes(Ea(v));return}for(v of r.options){var f=Ea(v);if(Is(f,c)){v.selected=!0;return}}(!t||c!==void 0)&&(r.selectedIndex=-1)}function ms(r){var c=new MutationObserver(()=>{Ya(r,r.__value)});c.observe(r,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),hs(()=>{c.disconnect()})}function Na(r,c,t=c){var v=new WeakSet,f=!0;Qa(r,"change",p=>{var g=p?"[selected]":":checked",S;if(r.multiple)S=[].map.call(r.querySelectorAll(g),Ea);else{var y=r.querySelector(g)??r.querySelector("option:not([disabled])");S=y&&Ea(y)}t(S),$a!==null&&v.add($a)}),Es(()=>{var p=c();if(r===document.activeElement){var g=Us??$a;if(v.has(g))return}if(Ya(r,p,f),f&&p===void 0){var S=r.querySelector(":checked");S!==null&&(p=Ea(S),t(p))}r.__value=p,f=!1}),ms(r)}function Ea(r){return"__value"in r?r.__value:r.value}const $l=Symbol("is custom element"),wl=Symbol("is html");function ke(r){if(ya){var c=!1,t=()=>{if(!c){if(c=!0,r.hasAttribute("value")){var v=r.value;ut(r,"value",null),r.value=v}if(r.hasAttribute("checked")){var f=r.checked;ut(r,"checked",null),r.checked=f}}};r.__on_r=t,fs(t),nl()}}function Ra(r,c){var t=ys(r);t.value===(t.value=c??void 0)||r.value===c&&(c!==0||r.nodeName!=="PROGRESS")||(r.value=c??"")}function Hs(r,c){var t=ys(r);t.checked!==(t.checked=c??void 0)&&(r.checked=c)}function ut(r,c,t,v){var f=ys(r);ya&&(f[c]=r.getAttribute(c),c==="src"||c==="srcset"||c==="href"&&r.nodeName==="LINK")||f[c]!==(f[c]=t)&&(c==="loading"&&(r[ll]=t),t==null?r.removeAttribute(c):typeof t!="string"&&Sl(r).includes(c)?r[c]=t:r.setAttribute(c,t))}function ys(r){return r.__attributes??={[$l]:r.nodeName.includes("-"),[wl]:r.namespaceURI===rl}}var Ds=new Map;function Sl(r){var c=r.getAttribute("is")||r.nodeName,t=Ds.get(c);if(t)return t;Ds.set(c,t=[]);for(var v,f=r,p=Element.prototype;p!==f;){v=ol(f);for(var g in v)v[g].set&&t.push(g);f=il(f)}return t}function ze(r,c,t=c){var v=new WeakSet;Qa(r,"input",async f=>{var p=f?r.defaultValue:r.value;if(p=ns(r)?os(p):p,t(p),$a!==null&&v.add($a),await cl(),p!==(p=c())){var g=r.selectionStart,S=r.selectionEnd,y=r.value.length;if(r.value=p??"",S!==null){var _=r.value.length;g===S&&S===y&&_>y?(r.selectionStart=_,r.selectionEnd=_):(r.selectionStart=g,r.selectionEnd=Math.min(S,_))}}}),(ya&&r.defaultValue!==r.value||i(c)==null&&r.value)&&(t(ns(r)?os(r.value):r.value),$a!==null&&v.add($a)),_s(()=>{var f=c();if(r===document.activeElement){var p=Us??$a;if(v.has(p))return}ns(r)&&f===os(r.value)||r.type==="date"&&!f&&!r.value||f!==r.value&&(r.value=f??"")})}const is=new Set;function Ls(r,c,t,v,f=v){var p=t.getAttribute("type")==="checkbox",g=r;let S=!1;if(c!==null)for(var y of c)g=g[y]??=[];g.push(t),Qa(t,"change",()=>{var _=t.__value;p&&(_=As(g,_,t.checked)),f(_)},()=>f(p?[]:null)),_s(()=>{var _=v();if(ya&&t.defaultChecked!==t.checked){S=!0;return}p?(_=_||[],t.checked=_.includes(t.__value)):t.checked=Is(t.__value,_)}),hs(()=>{var _=g.indexOf(t);_!==-1&&g.splice(_,1)}),is.has(g)||(is.add(g),fs(()=>{g.sort((_,N)=>_.compareDocumentPosition(N)===4?-1:1),is.delete(g)})),fs(()=>{if(S){var _;if(p)_=As(g,_,t.checked);else{var N=g.find(F=>F.checked);_=N?.__value}f(_)}})}function wa(r,c,t=c){Qa(r,"change",v=>{var f=v?r.defaultChecked:r.checked;t(f)}),(ya&&r.defaultChecked!==r.checked||i(c)==null)&&t(r.checked),_s(()=>{var v=c();r.checked=!!v})}function As(r,c,t){for(var v=new Set,f=0;f<r.length;f+=1)r[f].checked&&v.add(r[f].__value);return t||v.delete(c),Array.from(v)}function ns(r){var c=r.type;return c==="number"||c==="range"}function os(r){return r===""?null:+r}function Cl(r,c,t){var v=vl(r,c);v&&v.set&&(r[c]=t,hs(()=>{r[c]=null}))}function xs(r){return function(...c){var t=c[0];return t.stopPropagation(),r?.apply(this,c)}}function Ma(r,c){var t=r.$$events?.[c.type],v=Ps(t)?t.slice():t==null?[]:[t];for(var f of v)f.call(this,c)}const Dl="";function Os(...r){return Ia+Dl+yl(r[0],r[1])}const gs={paladin:{name:"Paladin",hitDice:"d10",spellcaster:!0,spellcastingAbility:"charisma",spellSlotsByLevel:{1:0,2:2,3:3,4:3,5:4,6:4,7:4,8:4,9:4,10:4,11:4,12:4,13:4,14:4,15:4,16:4,17:4,18:4,19:4,20:4},features:[{name:"Divine Sense",type:"uses",maxUses:(r,c=1)=>1+Math.max(1,c),resetOn:"long",description:"Detect celestials, fiends, and undead within 60 feet",minLevel:1},{name:"Lay on Hands",type:"pool",maxPool:r=>r*5,resetOn:"long",description:"Heal wounds or cure disease",minLevel:1},{name:"Divine Smite",type:"spellSlot",description:"Expend spell slot to deal extra radiant damage",minLevel:2,rollable:!0},{name:"Channel Divinity",type:"pool",maxPool:r=>r>=18?3:r>=6?2:1,resetOn:"short",description:"Sacred Weapon or Turn Undead",minLevel:3}]},fighter:{name:"Fighter",hitDice:"d10",spellcaster:!1,features:[{name:"Second Wind",type:"uses",maxUses:1,resetOn:"short",description:"Regain 1d10 + fighter level HP as bonus action",minLevel:1,rollable:!0,rollFormula:r=>`1d10+${r}`},{name:"Action Surge",type:"uses",maxUses:r=>r>=17?2:1,resetOn:"short",description:"Take one additional action on your turn",minLevel:2},{name:"Indomitable",type:"uses",maxUses:r=>r>=17?3:r>=13?2:1,resetOn:"long",description:"Reroll a failed saving throw",minLevel:9}],subclasses:{champion:{name:"Champion",features:[{name:"Improved Critical",type:"info",description:"Critical hit on 19-20",minLevel:3},{name:"Remarkable Athlete",type:"info",description:"Add half proficiency to STR/DEX/CON checks, increase long jump distance",minLevel:7},{name:"Additional Fighting Style",type:"info",description:"Choose a second fighting style",minLevel:10},{name:"Superior Critical",type:"info",description:"Critical hit on 18-20",minLevel:15},{name:"Survivor",type:"info",description:"Regain 5 + CON mod HP at start of turn if below half HP",minLevel:18}]},battlemaster:{name:"Battle Master",features:[{name:"Combat Superiority",type:"uses",maxUses:r=>r>=15?6:r>=7?5:4,resetOn:"short",description:r=>`Use superiority dice (${r>=18?"d12":r>=10?"d10":"d8"}) for maneuvers`,minLevel:3},{name:"Know Your Enemy",type:"info",description:"Learn capabilities of creatures you observe",minLevel:7},{name:"Improved Combat Superiority",type:"info",description:"Superiority dice become d10",minLevel:10},{name:"Relentless",type:"info",description:"Regain 1 superiority die if you have none at start of turn",minLevel:15}]}}},rogue:{name:"Rogue",hitDice:"d8",spellcaster:!1,features:[{name:"Sneak Attack",type:"info",description:r=>`Deal ${Math.ceil(r/2)}d6 extra damage once per turn with advantage or ally nearby`,minLevel:1,rollable:!0,rollFormula:r=>`${Math.ceil(r/2)}d6`},{name:"Cunning Action",type:"info",description:"Dash, Disengage, or Hide as a bonus action",minLevel:2},{name:"Uncanny Dodge",type:"info",description:"Use reaction to halve damage from an attack",minLevel:5},{name:"Evasion",type:"info",description:"Take no damage on successful Dex save (half on fail)",minLevel:7}]},wizard:{name:"Wizard",hitDice:"d6",spellcaster:!0,spellcastingAbility:"intelligence",spellSlotsByLevel:{1:2,2:3,3:4,4:4,5:4,6:4,7:4,8:4,9:4,10:4,11:4,12:4,13:4,14:4,15:4,16:4,17:4,18:4,19:4,20:4},features:[{name:"Arcane Recovery",type:"uses",maxUses:1,resetOn:"long",description:r=>`Recover spell slots totaling up to ${Math.ceil(r/2)} levels during short rest`,minLevel:1},{name:"Spell Mastery",type:"info",description:"Cast one 1st-level and one 2nd-level spell at will",minLevel:18}]},cleric:{name:"Cleric",hitDice:"d8",spellcaster:!0,spellcastingAbility:"wisdom",spellSlotsByLevel:{1:2,2:3,3:4,4:4,5:4,6:4,7:4,8:4,9:4,10:4,11:4,12:4,13:4,14:4,15:4,16:4,17:4,18:4,19:4,20:4},features:[{name:"Channel Divinity",type:"pool",maxPool:r=>r>=18?4:r>=6?3:2,resetOn:"short",description:"Turn Undead or domain-specific ability",minLevel:2},{name:r=>r>=5?"Sear Undead":"Turn Undead",subName:r=>r>=5?"Improved Turn Undead":null,type:"channelDivinity",description:(r,c=1)=>{let t="As a Magic action, you present your Holy Symbol and censure Undead creatures. Each Undead of your choice within 30 feet of you must make a Wisdom saving throw. If the creature fails its save, it has the Frightened and Incapacitated conditions for 1 minute. For that duration, it tries to move as far from you as it can on its turns. This effect ends early on the creature if it takes any damage, if you have the Incapacitated condition, or if you die.";if(r>=5){const v=Math.max(1,c);t+=` <br /><br />
            
          With Sear Undead, roll ${v}d8 radiant damage to turned undead.`}return t},minLevel:2,rollable:!0,rollFormula:(r,c=1)=>r>=5?`${Math.max(1,c)}d8`:""},{name:"Divine Intervention",type:"uses",maxUses:1,resetOn:"long",description:r=>`${r}% chance to succeed, implore deity for aid`,minLevel:10}],subclasses:{war:{name:"War Domain",features:[{name:"War Priest",type:"uses",maxUses:(r,c=1)=>Math.max(1,c),resetOn:"long",description:"Make one weapon attack as a bonus action",minLevel:1},{name:"Channel Divinity",type:"info",description:"Additional Channel Divinity options from War Domain",minLevel:2,subFeatures:[{name:"Guided Strike",type:"channelDivinity",description:"Use your Channel Divinity to gain +10 to an attack roll. Make this choice after you see the roll, but before the DM says whether the attack hits or misses.",minLevel:2},{name:"War God's Blessing",type:"channelDivinity",description:"Use reaction to grant +10 to an ally's attack roll within 30 feet. Consumes one use of Channel Divinity.",minLevel:6,resetOn:"short"}]},{name:"Divine Strike",type:"info",description:r=>`Deal extra ${r>=14?"2d8":"1d8"} weapon damage once per turn`,minLevel:8,rollable:!0,rollFormula:r=>r>=14?"2d8":"1d8"},{name:"Avatar of Battle",type:"info",description:"Gain resistance to nonmagical weapon damage",minLevel:17}]},life:{name:"Life Domain",features:[{name:"Disciple of Life",type:"info",description:"Healing spells restore additional 2 + spell level HP",minLevel:1},{name:"Preserve Life",type:"pool",maxPool:r=>r*5,resetOn:"short",description:"Restore HP to creatures within 30 feet",minLevel:2},{name:"Blessed Healer",type:"info",description:"Regain 2 + spell level HP when you cast healing spell",minLevel:6},{name:"Divine Strike",type:"info",description:r=>`Deal extra ${r>=14?"2d8":"1d8"} radiant damage once per turn`,minLevel:8,rollable:!0,rollFormula:r=>r>=14?"2d8":"1d8"},{name:"Supreme Healing",type:"info",description:"Maximize healing dice instead of rolling",minLevel:17}]}}},barbarian:{name:"Barbarian",hitDice:"d12",spellcaster:!1,features:[{name:"Rage",type:"uses",maxUses:r=>r>=20?1/0:r>=17?6:r>=12?5:r>=6?4:r>=3?3:2,resetOn:"long",description:r=>`+${r>=16?4:r>=9?3:2} damage, resistance to physical damage`,minLevel:1},{name:"Reckless Attack",type:"info",description:"Gain advantage on melee attacks, enemies get advantage on you",minLevel:2},{name:"Danger Sense",type:"info",description:"Advantage on Dex saves against effects you can see",minLevel:2}],subclasses:{berserker:{name:"Path of the Berserker",features:[{name:"Frenzy",type:"info",description:"While raging, make melee attack as bonus action (gain 1 exhaustion after rage)",minLevel:3},{name:"Mindless Rage",type:"info",description:"Cannot be charmed or frightened while raging",minLevel:6},{name:"Intimidating Presence",type:"info",description:"Use action to frighten creature within 30 feet",minLevel:10},{name:"Retaliation",type:"info",description:"When damaged by creature within 5 feet, make melee attack as reaction",minLevel:14}]}}}};function ua(r){const c=r.toLowerCase();return gs[c]||null}function Ta(r,c,t){const v=ua(r);if(!v)return[];const f=v.features.filter(p=>!p.minLevel||p.minLevel<=c);if(t&&v.subclasses&&v.subclasses[t]){const p=v.subclasses[t].features.filter(g=>!g.minLevel||g.minLevel<=c);return[...f,...p]}return f}function js(r){const c=ua(r);return!c||!c.subclasses?[]:Object.keys(c.subclasses).map(t=>({id:t,name:c.subclasses[t].name}))}function Bs(r,c){const t=ua(r);return!t||!t.spellcaster||!t.spellSlotsByLevel?0:t.spellSlotsByLevel[c]||0}function Rs(r,c,t){const v=ua(r);return!v||!v.spellcaster?0:Math.max(1,t+c)}function Ll(r,c,t){const v=ua(r);return!v||!v.spellcaster?null:8+c+t}function Al(){return Object.keys(gs).map(r=>({id:r,name:gs[r].name}))}var jl=u('<div class="section-header svelte-ls99y2" role="button" tabindex="0"><h2 class="svelte-ls99y2"> </h2> <span class="collapse-btn svelte-ls99y2"> </span></div>');function Da(r,c){Qt(c,!1);let t=Bt(c,"title",8),v=Bt(c,"collapsed",8),f=Bt(c,"ariaLabel",8,""),p=Bt(c,"onToggle",8);Yt();var g=jl(),S=l(g),y=l(S,!0);s(S);var _=a(S,2),N=l(_,!0);s(_),s(g),D(()=>{ut(g,"aria-expanded",!v()),ut(g,"aria-label",f()),$(y,t()),$(N,v()?"‚ñº":"‚ñ≤")}),B("click",g,function(...F){p()?.apply(this,F)}),B("keydown",g,F=>{(F.key==="Enter"||F.key===" ")&&p()()}),o(r,g),Xt()}var Bl=u("<option> </option>"),Rl=u("<option> </option>"),Ml=u('<div class="form-group svelte-172i2fj"><label for="characterSubclass" class="svelte-172i2fj">Subclass</label> <select id="characterSubclass" class="svelte-172i2fj"><option>Select Subclass</option><!></select></div>'),Tl=u('<div class="info-grid svelte-172i2fj"><div class="form-group svelte-172i2fj"><label for="characterName" class="svelte-172i2fj">Character Name</label> <input type="text" id="characterName" placeholder="Enter name" class="svelte-172i2fj"/></div> <div class="form-group svelte-172i2fj"><label for="characterClass" class="svelte-172i2fj">Class</label> <select id="characterClass" class="svelte-172i2fj"><option>Select Class</option><!></select></div> <!> <div class="form-group svelte-172i2fj"><label for="characterLevel" class="svelte-172i2fj">Level</label> <input type="number" id="characterLevel" min="1" max="20" class="svelte-172i2fj"/></div> <div class="form-group svelte-172i2fj"><label for="characterRace" class="svelte-172i2fj">Race</label> <input type="text" id="characterRace" placeholder="e.g., Human" class="svelte-172i2fj"/></div> <div class="form-group svelte-172i2fj"><label for="characterBackground" class="svelte-172i2fj">Background</label> <input type="text" id="characterBackground" placeholder="e.g., Soldier" class="svelte-172i2fj"/></div> <div class="form-group svelte-172i2fj"><label for="characterAlignment" class="svelte-172i2fj">Alignment</label> <input type="text" id="characterAlignment" placeholder="e.g., Lawful Good" class="svelte-172i2fj"/></div></div>'),Fl=u('<section class="character-info svelte-172i2fj"><!> <!></section>');function Pl(r,c){Qt(c,!1);const t=()=>_t(pe,"$character",f),v=()=>_t(la,"$collapsedStates",f),[f,p]=fa(),g=w(),S=Al();function y(H){const T=H.target;pe.update(I=>(I.class=T.value,I.subclass="",I))}function _(H){const T=H.target;pe.update(I=>(I.subclass=T.value,I))}function N(H){const T=H.target;pe.update(I=>(I.level=parseInt(T.value)||1,I)),Ns()}Xe(()=>(t(),js),()=>{n(g,t().class?js(t().class):[])}),ga(),Yt();var F=Fl(),Q=l(F);{let H=xt(()=>(v(),i(()=>v().characterInfo?"Expand":"Collapse")));Da(Q,{title:"Character Info",get collapsed(){return v(),i(()=>v().characterInfo)},get ariaLabel(){return e(H)},onToggle:()=>la.update(T=>({...T,characterInfo:!T.characterInfo}))})}var K=a(Q,2);{var ee=H=>{var T=Tl(),I=l(T),le=a(l(I),2);ke(le),s(I);var be=a(I,2),qe=a(l(be),2),$e=l(qe);$e.value=$e.__value="";var ue=a($e);Lt(ue,1,()=>S,Rt,(He,Pe)=>{var Ie=Bl(),h=l(Ie,!0);s(Ie);var P={};D(()=>{$(h,(e(Pe),i(()=>e(Pe).name))),P!==(P=(e(Pe),i(()=>e(Pe).id)))&&(Ie.value=(Ie.__value=(e(Pe),i(()=>e(Pe).id)))??"")}),o(He,Ie)}),s(qe);var ce;ms(qe),s(be);var ye=a(be,2);{var We=He=>{var Pe=Ml(),Ie=a(l(Pe),2),h=l(Ie);h.value=h.__value="";var P=a(h);Lt(P,1,()=>e(g),Rt,(et,lt)=>{var yt=Rl(),Dt=l(yt,!0);s(yt);var wt={};D(()=>{$(Dt,(e(lt),i(()=>e(lt).name))),wt!==(wt=(e(lt),i(()=>e(lt).id)))&&(yt.value=(yt.__value=(e(lt),i(()=>e(lt).id)))??"")}),o(et,yt)}),s(Ie);var oe;ms(Ie),s(Pe),D(()=>{oe!==(oe=(t(),i(()=>t().subclass)))&&(Ie.value=(Ie.__value=(t(),i(()=>t().subclass)))??"",Ya(Ie,(t(),i(()=>t().subclass))))}),B("change",Ie,_),o(He,Pe)};m(ye,He=>{e(g),i(()=>e(g).length>0)&&He(We)})}var R=a(ye,2),M=a(l(R),2);ke(M),s(R);var x=a(R,2),J=a(l(x),2);ke(J),s(x);var W=a(x,2),me=a(l(W),2);ke(me),s(W);var xe=a(W,2),Ne=a(l(xe),2);ke(Ne),s(xe),s(T),D(()=>{ce!==(ce=(t(),i(()=>t().class)))&&(qe.value=(qe.__value=(t(),i(()=>t().class)))??"",Ya(qe,(t(),i(()=>t().class)))),Ra(M,(t(),i(()=>t().level)))}),ze(le,()=>t().name,He=>Ot(pe,i(t).name=He,i(t))),B("change",qe,y),B("change",M,N),ze(J,()=>t().race,He=>Ot(pe,i(t).race=He,i(t))),ze(me,()=>t().background,He=>Ot(pe,i(t).background=He,i(t))),ze(Ne,()=>t().alignment,He=>Ot(pe,i(t).alignment=He,i(t))),o(H,T)};m(K,H=>{v(),i(()=>!v().characterInfo)&&H(ee)})}s(F),o(r,F),Xt(),p()}var Il=u('<div class="ability-card svelte-bbv1xt"><h3 class="svelte-bbv1xt"> </h3> <input type="number" class="ability-score svelte-bbv1xt" min="1" max="30"/> <div class="ability-modifier svelte-bbv1xt"> </div> <div class="roll-buttons svelte-bbv1xt"><button class="roll-btn svelte-bbv1xt">Check</button> <button class="roll-btn svelte-bbv1xt">Save</button></div> <div class="save-proficiency svelte-bbv1xt"><input type="checkbox" class="svelte-bbv1xt"/> <label class="svelte-bbv1xt">Save Prof.</label></div></div>'),El=u('<div class="proficiency-bonus svelte-bbv1xt"><label for="profBonus">Proficiency Bonus</label> <input type="number" id="profBonus" class="prof-input svelte-bbv1xt"/></div> <div class="abilities-grid svelte-bbv1xt"></div>',1),Ul=u("<section><!> <!></section>");function Nl(r,c){Qt(c,!1);const t=()=>_t(Xa,"$abilityModifiers",S),v=()=>_t(pe,"$character",S),f=()=>_t(xa,"$searchFilter",S),p=()=>_t(la,"$collapsedStates",S),g=()=>_t(Sa,"$isEditMode",S),[S,y]=fa(),_=w(),N=w(),F=ka(),Q=[{key:"strength",label:"Strength"},{key:"dexterity",label:"Dexterity"},{key:"constitution",label:"Constitution"},{key:"intelligence",label:"Intelligence"},{key:"wisdom",label:"Wisdom"},{key:"charisma",label:"Charisma"}];function K(){Ns()}function ee($e){const ue=t()[$e],ce=`1d20${ue>=0?"+":""}${ue}`,ye=[];ye.push({value:"1d20",source:"base die"}),ue!==0&&ye.push({value:ue,source:$e}),F("roll",{notation:ce,rollType:"check",bonusBreakdown:ye})}function H($e){const ue=t()[$e],ce=v().saveProficiencies[$e]?v().proficiencyBonus:0,ye=ue+ce,We=`1d20${ye>=0?"+":""}${ye}`,R=[];R.push({value:"1d20",source:"base die"}),ue!==0&&R.push({value:ue,source:$e}),ce!==0&&R.push({value:ce,source:"proficiency"}),F("roll",{notation:We,rollType:"save",bonusBreakdown:R})}Xe(()=>f(),()=>{n(_,Q.filter(({label:$e})=>f()?$e.toLowerCase().includes(f().toLowerCase()):!0))}),Xe(()=>(e(_),f()),()=>{n(N,e(_).length>0||!f()||f().toLowerCase().includes("proficiency"))}),ga(),Yt();var T=Ul();let I;var le=l(T);Da(le,{title:"Ability Scores",get collapsed(){return p(),i(()=>p().abilityScores)},ariaLabel:"Toggle Ability Scores Section",onToggle:()=>la.update($e=>({...$e,abilityScores:!$e.abilityScores}))});var be=a(le,2);{var qe=$e=>{var ue=El(),ce=De(ue),ye=a(l(ce),2);ke(ye),s(ce);var We=a(ce,2);Lt(We,5,()=>e(_),Rt,(R,M)=>{let x=()=>e(M).key,J=()=>e(M).label;var W=Il(),me=l(W),xe=l(me,!0);s(me);var Ne=a(me,2);ke(Ne);var He=a(Ne,2),Pe=l(He);s(He);var Ie=a(He,2),h=l(Ie),P=a(h,2);s(Ie);var oe=a(Ie,2),et=l(oe);ke(et);var lt=a(et,2);s(oe),s(W),D(yt=>{$(xe,yt),$(Pe,`${t(),x(),i(()=>t()[x()]>=0?"+":"")??""}${t(),x(),i(()=>t()[x()])??""}`),et.disabled=!g(),ut(et,"id",`${x()}-save`),ut(lt,"for",`${x()}-save`)},[()=>(J(),i(()=>J().substring(0,3).toUpperCase()))]),ze(Ne,()=>v().abilities[x()],yt=>Ot(pe,i(v).abilities[x()]=yt,i(v))),B("change",Ne,K),B("click",h,()=>ee(x())),B("click",P,()=>H(x())),wa(et,()=>v().saveProficiencies[x()],yt=>Ot(pe,i(v).saveProficiencies[x()]=yt,i(v))),o(R,W)}),s(We),ze(ye,()=>v().proficiencyBonus,R=>Ot(pe,i(v).proficiencyBonus=R,i(v))),o($e,ue)};m(be,$e=>{p(),i(()=>!p().abilityScores)&&$e(qe)})}s(T),D(()=>I=Et(T,1,"ability-scores svelte-bbv1xt",null,I,{hidden:!e(N)})),o(r,T),Xt(),y()}const Gs=[{name:"Unarmored",type:"none",baseAC:10},{name:"Padded",type:"light",baseAC:11},{name:"Leather",type:"light",baseAC:11},{name:"Studded Leather",type:"light",baseAC:12},{name:"Hide",type:"medium",baseAC:12,maxDexBonus:2},{name:"Chain Shirt",type:"medium",baseAC:13,maxDexBonus:2},{name:"Scale Mail",type:"medium",baseAC:14,maxDexBonus:2},{name:"Breastplate",type:"medium",baseAC:14,maxDexBonus:2},{name:"Half Plate",type:"medium",baseAC:15,maxDexBonus:2},{name:"Ring Mail",type:"heavy",baseAC:14,maxDexBonus:0},{name:"Chain Mail",type:"heavy",baseAC:16,maxDexBonus:0},{name:"Splint",type:"heavy",baseAC:17,maxDexBonus:0},{name:"Plate",type:"heavy",baseAC:18,maxDexBonus:0}];function qs(r){return Gs.find(c=>c.name===r)}function Hl(r,c,t){if(!r)return 10+c+(t?2:0);const v=qs(r);if(!v)return 10+c+(t?2:0);let f=v.baseAC;return v.maxDexBonus===void 0?f+=c:v.maxDexBonus>0&&(f+=Math.min(c,v.maxDexBonus)),t&&(f+=2),f}function Ha(r){return Math.floor((r-10)/2)}function bs(r,c){if(!r.class)return null;const t=ua(r.class);if(!t||!t.spellcaster||!t.spellcastingAbility)return null;const v=Ha(c[t.spellcastingAbility]);return 8+r.proficiencyBonus+v}function cs(r,c){if(!r.class)return 0;const t=ua(r.class);return!t||!t.spellcaster||!t.spellcastingAbility?0:Ha(c[t.spellcastingAbility])}function Ol(r,c){const t=[],v=Ha(c.dexterity),f=r.armorName?qs(r.armorName):void 0;if(f){if(f.type==="none")t.push("Unarmored"),t.push("Base: 10"),t.push(`Dexterity: ${v>=0?"+":""}${v}`);else if(f.type==="light")t.push(`${f.name}: ${f.baseAC}`),t.push(`Dexterity: ${v>=0?"+":""}${v}`);else if(f.type==="medium"){const p=Math.min(2,v);t.push(`${f.name}: ${f.baseAC}`),t.push(`Dexterity: ${p>=0?"+":""}${p} (max +2)`)}else f.type==="heavy"&&(t.push(`${f.name}: ${f.baseAC}`),t.push("Dexterity: +0 (heavy armor)"));r.shieldEquipped&&t.push("Shield: +2")}else{t.push("Base: 10"),v!==0&&t.push(`Dexterity: ${v>=0?"+":""}${v}`);const p=10+v,g=r.armorClass-p;g!==0&&t.push(`Other: ${g>=0?"+":""}${g}`)}return r.activeStates&&r.activeStates.length>0&&r.activeStates.forEach(p=>{typeof p.acBonus=="number"&&p.acBonus!==0&&(!p.target||p.target==="self")&&t.push(`${p.name}: ${p.acBonus>=0?"+":""}${p.acBonus}`)}),t.join(`
`)}function Gl(r,c){const t=[],v=Ha(c.dexterity);t.push(`Dexterity: ${v>=0?"+":""}${v}`);const f=r.initiative-v;return f!==0&&t.push(`Other Bonuses: ${f>=0?"+":""}${f}`),t.join(`
`)}function ql(r,c){if(!r.class)return"";const t=ua(r.class);if(!t||!t.spellcaster||!t.spellcastingAbility)return"";const v=[],f=Ha(c[t.spellcastingAbility]),p=t.spellcastingAbility.charAt(0).toUpperCase()+t.spellcastingAbility.slice(1);return v.push("Base: 8"),v.push(`Proficiency: +${r.proficiencyBonus}`),v.push(`${p}: ${f>=0?"+":""}${f}`),v.join(`
`)}function Wl(r,c,t){const v=[];let f=r;const p=c.toLowerCase().trim();if(t.activeStates){for(const S of t.activeStates)if(S.immunities&&S.immunities.length>0&&S.immunities.some(_=>_.toLowerCase().trim()===p))return v.push(`Immune to ${c} (${S.name})`),{finalDamage:0,adjustments:v}}let g=!1;if(t.activeStates){for(const S of t.activeStates)if(S.resistances&&S.resistances.length>0&&S.resistances.some(_=>_.toLowerCase().trim()===p)){const _=Math.floor(f/2);v.push(`Resistant to ${c} (${S.name}): ${f} ‚Üí ${_}`),f=_,g=!0;break}}if(!g&&t.race){const S=Ja(t.race);if(S){for(const y of S.traits)if(y.resistances&&y.resistances.some(_=>_.toLowerCase().trim()===p)){const _=Math.floor(f/2);v.push(`Resistant to ${c} (racial trait): ${f} ‚Üí ${_}`),f=_,g=!0;break}}}return v.length===0&&v.push(`No adjustments for ${c}`),{finalDamage:f,adjustments:v}}function zl(r,c){const t={...r};if(t.tempHP>0){if(c<=t.tempHP)return t.tempHP-=c,t;c-=t.tempHP,t.tempHP=0}return t.currentHP=Math.max(0,t.currentHP-c),t}var Kl=u('<button class="info-icon svelte-1o8ci7b" type="button">‚ÑπÔ∏è</button>'),Vl=u('<button class="info-icon svelte-1o8ci7b" type="button">‚ÑπÔ∏è</button>'),Jl=u("<div><!></div>"),Yl=u('<div class="tooltip-wrapper svelte-1o8ci7b"><!> <!></div>');function vs(r,c){Qt(c,!1);let t=Bt(c,"tooltipContent",8),v=Bt(c,"ariaLabel",8,"Show information"),f=w(!1),p=w(),g=w(!1),S=w(null),y=w(!1),_=w(!1),N=w("");const F=Math.random().toString(36).slice(2);function Q(){window.dispatchEvent(new CustomEvent("tooltip-open",{detail:F}))}function K(R){R.detail!==F&&(n(f,!1),n(y,!1))}function ee(){n(g,window.matchMedia("(pointer: coarse)").matches||"ontouchstart"in window)}function H(){if(!e(S)||!e(p))return;const R=e(p).getBoundingClientRect(),M=e(S).getBoundingClientRect();let x=R.bottom+5,J=R.left;n(y,!1),J+M.width>window.innerWidth-8&&(J=R.right-M.width,n(y,!0),J<8&&(J=8)),J<8&&(J=8),x+M.height>window.innerHeight-8&&(x=R.top-M.height-5),n(N,`position:fixed;top:${x}px;left:${J}px;z-index:1000;`),n(_,!0)}function T(){Q(),n(f,!1),n(_,!1),requestAnimationFrame(()=>{n(f,!0),n(_,!1),setTimeout(H,0)})}function I(){n(f,!1),n(y,!1)}function le(R){R.stopPropagation(),e(f)?(n(f,!1),n(y,!1),n(_,!1)):(Q(),n(f,!1),n(_,!1),requestAnimationFrame(()=>{n(f,!0),n(_,!1),setTimeout(H,0)}))}function be(R){e(p)&&!e(p).contains(R.target)&&(n(f,!1),n(y,!1))}Ca(()=>{ee(),document.addEventListener("click",be),window.addEventListener("tooltip-open",K)}),Vs(()=>{document.removeEventListener("click",be),window.removeEventListener("tooltip-open",K)}),Yt();var qe=Yl(),$e=l(qe);{var ue=R=>{var M=Kl();D(()=>ut(M,"aria-label",v())),B("click",M,le),o(R,M)},ce=R=>{var M=Vl();D(()=>ut(M,"aria-label",v())),B("mouseenter",M,T),B("mouseleave",M,I),o(R,M)};m($e,R=>{e(g)?R(ue):R(ce,!1)})}var ye=a($e,2);{var We=R=>{var M=Jl(),x=l(M);xl(x,c,"content",{},J=>{var W=$t(),me=De(W);ps(me,t),o(J,W)}),s(M),Ua(M,J=>n(S,J),()=>e(S)),D(()=>{Et(M,1,`tooltip-popup ${e(y)?"right-align":""}`,"svelte-1o8ci7b"),kl(M,e(_)?e(N)+"opacity:1;pointer-events:auto;":"opacity:0;pointer-events:none;position:fixed;top:0;left:0;z-index:1000;")}),o(R,M)};m(ye,R=>{e(f)&&R(We)})}s(qe),Ua(qe,R=>n(p,R),()=>e(p)),o(r,qe),Xt()}var Ql=u("<option> </option>"),Xl=u('<div class="armor-config svelte-1r5hyyb"><h4 class="svelte-1r5hyyb">Armor Configuration</h4> <div class="armor-controls svelte-1r5hyyb"><div class="armor-field svelte-1r5hyyb"><label for="armorName" class="svelte-1r5hyyb">Armor</label> <select id="armorName" class="armor-select svelte-1r5hyyb"><option>None (Unarmored)</option><!></select></div> <div class="armor-field svelte-1r5hyyb"><label class="shield-label svelte-1r5hyyb"><input type="checkbox" class="shield-checkbox svelte-1r5hyyb"/> Shield Equipped (+2 AC)</label></div></div></div>'),Zl=u('<div class="stat-box svelte-1r5hyyb"><div class="stat-label-with-icon svelte-1r5hyyb"><label for="spellSaveDC" class="svelte-1r5hyyb">Spell Save DC</label> <!></div> <input type="number" id="spellSaveDC" class="stat-input svelte-1r5hyyb" readonly=""/></div>'),er=u('<span class="hit-dice-type"> </span>'),tr=u('<!> <div class="stats-grid svelte-1r5hyyb"><div class="stat-box svelte-1r5hyyb"><div class="stat-label-with-icon svelte-1r5hyyb"><label for="armorClass" class="svelte-1r5hyyb">Armor Class</label> <!></div> <input type="text" id="armorClass" readonly=""/></div> <div class="stat-box svelte-1r5hyyb"><div class="stat-label-with-icon svelte-1r5hyyb"><label for="initiative" class="svelte-1r5hyyb">Initiative</label> <!></div> <input type="text" id="initiative" class="stat-input svelte-1r5hyyb" readonly=""/></div> <div class="stat-box svelte-1r5hyyb"><label for="speed" class="svelte-1r5hyyb">Speed</label> <input type="text" id="speed" class="stat-input svelte-1r5hyyb"/></div> <!></div> <div class="hp-section svelte-1r5hyyb"><h3 class="svelte-1r5hyyb">Hit Points</h3> <div><div class="hp-inputs svelte-1r5hyyb"><input type="number" class="hp-current svelte-1r5hyyb" min="0"/> <span class="hp-separator svelte-1r5hyyb">/</span> <input type="number" class="hp-max svelte-1r5hyyb" min="0"/></div> <div class="hp-controls svelte-1r5hyyb"><button class="hp-btn svelte-1r5hyyb">‚àí</button> <button class="hp-btn svelte-1r5hyyb">+</button> <button class="hp-btn svelte-1r5hyyb">‚àí5</button> <button class="hp-btn svelte-1r5hyyb">+5</button></div></div> <div class="temp-hp svelte-1r5hyyb"><label for="tempHP" class="svelte-1r5hyyb">Temp HP</label> <input type="number" id="tempHP" min="0" class="svelte-1r5hyyb"/></div></div> <div class="hit-dice-section svelte-1r5hyyb"><h3 class="svelte-1r5hyyb">Hit Dice</h3> <div class="hit-dice-display svelte-1r5hyyb"><input type="number" class="hit-dice-input svelte-1r5hyyb" min="0"/> <span>/</span> <input type="number" class="hit-dice-input svelte-1r5hyyb" min="0"/> <!></div> <div class="hit-dice-controls svelte-1r5hyyb"><label for="hitDiceCount" class="svelte-1r5hyyb">Roll</label> <div class="hit-dice-count-controls svelte-1r5hyyb"><button class="hit-dice-btn svelte-1r5hyyb">‚àí</button> <input type="number" id="hitDiceCount" class="hit-dice-count-input svelte-1r5hyyb" min="1"/> <button class="hit-dice-btn svelte-1r5hyyb">+</button></div> <button class="btn btn-primary roll-hit-dice use-enabled svelte-1r5hyyb">üé≤ Roll</button></div></div>',1),ar=u("<section><!> <!></section>");function sr(r,c){Qt(c,!1);const t=()=>_t(pe,"$character",S),v=()=>_t(Xa,"$abilityModifiers",S),f=()=>_t(xa,"$searchFilter",S),p=()=>_t(la,"$collapsedStates",S),g=()=>_t(Sa,"$isEditMode",S),[S,y]=fa(),_=w(),N=w(),F=w(),Q=w(),K=w(),ee=w(),H=w(),T=ka();let I=w(1);function le(R){pe.update(M=>(M.currentHP=Math.max(0,Math.min(M.maxHP,M.currentHP+R)),M))}function be(R){const M=e(I)+R,x=t().hitDice.current;n(I,Math.max(1,Math.min(x,M)))}function qe(R=1){if(t().hitDice.current<=0){alert("No hit dice remaining!");return}if(!t().class){alert("Please select a class first!");return}const M=ua(t().class);if(!M){alert("Invalid class configuration!");return}const x=Math.min(R,t().hitDice.current),J=M.hitDice,W=v().constitution,me=W*x,xe=me>=0?`+${me}`:`${me}`,Ne=`${x}${J}${xe}`,He=[];if(He.push({value:`${x}${J}`,source:"hit dice"}),W!==0)for(let Pe=0;Pe<x;Pe++)He.push({value:W,source:"constitution"});T("rollHitDice",{notation:Ne,hitDie:J,count:x,bonusBreakdown:He})}Xe(()=>(t(),v(),pe),()=>{if(t().armorName!==void 0||t().shieldEquipped!==void 0){const R=v().dexterity,M=Hl(t().armorName,R,t().shieldEquipped||!1);t().armorClass!==M&&pe.update(x=>({...x,armorClass:M}))}}),Xe(()=>(v(),t(),pe),()=>{const R=v().dexterity;t().initiative!==R&&pe.update(M=>({...M,initiative:R}))}),Xe(()=>t(),()=>{n(_,bs(t(),t().abilities))}),Xe(()=>t(),()=>{n(N,Ol(t(),t().abilities))}),Xe(()=>t(),()=>{n(F,Gl(t(),t().abilities))}),Xe(()=>t(),()=>{n(Q,ql(t(),t().abilities))}),Xe(()=>(t(),e(I)),()=>{const R=t().hitDice.current;R>0&&e(I)>R&&n(I,R)}),Xe(()=>t(),()=>{n(K,t().activeStates&&t().activeStates.length>0?t().activeStates.reduce((R,M)=>R+(M.acBonus||0),0):0)}),Xe(()=>t(),()=>{n(ee,t().activeStates&&t().activeStates.length>0?t().activeStates.some(R=>R.name==="Aid"&&R.target==="self"):!1)}),Xe(()=>f(),()=>{n(H,!f()||"armor class".includes(f().toLowerCase())||"initiative".includes(f().toLowerCase())||"speed".includes(f().toLowerCase())||"hit points".includes(f().toLowerCase())||"hp".includes(f().toLowerCase())||"hit dice".includes(f().toLowerCase())||"spell save".includes(f().toLowerCase())||"combat".includes(f().toLowerCase()))}),ga(),Yt();var $e=ar();let ue;var ce=l($e);{let R=xt(()=>(p(),i(()=>p().combatStats?"Expand":"Collapse")));Da(ce,{title:"Combat Stats",get collapsed(){return p(),i(()=>p().combatStats)},get ariaLabel(){return e(R)},onToggle:()=>la.update(M=>({...M,combatStats:!M.combatStats}))})}var ye=a(ce,2);{var We=R=>{var M=tr(),x=De(M);{var J=de=>{var Je=Xl(),Ge=a(l(Je),2),tt=l(Ge),Oe=a(l(tt),2);D(()=>{t(),Kt(()=>{})});var Ye=l(Oe);Ye.value=(Ye.__value=void 0)??"";var mt=a(Ye);Lt(mt,1,()=>Gs,Rt,(b,E)=>{var ie=$t(),ne=De(ie);{var ve=Re=>{var Ke=Ql(),Me=l(Ke);s(Ke);var re={};D(()=>{$(Me,`${e(E),i(()=>e(E).name)??""} (AC ${e(E),i(()=>e(E).baseAC)??""})`),re!==(re=(e(E),i(()=>e(E).name)))&&(Ke.value=(Ke.__value=(e(E),i(()=>e(E).name)))??"")}),o(Re,Ke)};m(ne,Re=>{e(E),i(()=>e(E).name!=="Unarmored")&&Re(ve)})}o(b,ie)}),s(Oe),s(tt);var X=a(tt,2),Qe=l(X),gt=l(Qe);ke(gt),ta(),s(Qe),s(X),s(Ge),s(Je),Na(Oe,()=>t().armorName,b=>Ot(pe,i(t).armorName=b,i(t))),wa(gt,()=>t().shieldEquipped,b=>Ot(pe,i(t).shieldEquipped=b,i(t))),o(de,Je)};m(x,de=>{g()&&de(J)})}var W=a(x,2),me=l(W),xe=l(me),Ne=a(l(xe),2);vs(Ne,{get tooltipContent(){return e(N)},ariaLabel:"Show AC breakdown"}),s(xe);var He=a(xe,2);ke(He),s(me);var Pe=a(me,2),Ie=l(Pe),h=a(l(Ie),2);vs(h,{get tooltipContent(){return e(F)},ariaLabel:"Show Initiative breakdown"}),s(Ie);var P=a(Ie,2);ke(P),s(Pe);var oe=a(Pe,2),et=a(l(oe),2);ke(et),s(oe);var lt=a(oe,2);{var yt=de=>{var Je=Zl(),Ge=l(Je),tt=a(l(Ge),2);vs(tt,{get tooltipContent(){return e(Q)},ariaLabel:"Show Spell Save DC breakdown"}),s(Ge);var Oe=a(Ge,2);ke(Oe),s(Je),D(()=>Ra(Oe,e(_))),o(de,Je)};m(lt,de=>{e(_)!==null&&de(yt)})}s(W);var Dt=a(W,2),wt=a(l(Dt),2);let C;var z=l(wt),A=l(z);ke(A);var O=a(A,4);ke(O),s(z);var Y=a(z,2),ge=l(Y),Ee=a(ge,2),Ae=a(Ee,2),Fe=a(Ae,2);s(Y),s(wt);var je=a(wt,2),k=a(l(je),2);ke(k),s(je),s(Dt);var Z=a(Dt,2),G=a(l(Z),2),Be=l(G);ke(Be);var he=a(Be,4);ke(he);var ct=a(he,2);{var Le=de=>{const Je=xt(()=>(U(ua),t(),i(()=>ua(t().class))));var Ge=$t(),tt=De(Ge);{var Oe=Ye=>{const mt=xt(()=>(v(),i(()=>v().constitution)));var X=er(),Qe=l(X);s(X),D(()=>$(Qe,`(${U(e(Je)),i(()=>e(Je).hitDice)??""}${(e(mt)>=0?`+${e(mt)}`:e(mt))??""})`)),o(Ye,X)};m(tt,Ye=>{e(Je)&&Ye(Oe)})}o(de,Ge)};m(ct,de=>{t(),i(()=>t().class)&&de(Le)})}s(G);var te=a(G,2),d=a(l(te),2),st=l(d),we=a(st,2);ke(we);var q=a(we,2);s(d);var Se=a(d,2);s(te),s(Z),D(()=>{Ra(He,(e(K),t(),i(()=>e(K)!==0?`${t().armorClass} ‚Üí ${t().armorClass+e(K)}`:`${t().armorClass}`))),Et(He,1,fl(e(K)!==0?"stat-input ac-enhanced":"stat-input"),"svelte-1r5hyyb"),Ra(P,(t(),i(()=>t().initiative))),C=Et(wt,1,"hp-display svelte-1r5hyyb",null,C,{"aid-active":e(ee)}),ut(A,"max",(t(),i(()=>t().maxHP))),ut(Be,"max",(t(),i(()=>t().hitDice.max))),st.disabled=e(I)<=1,ut(we,"max",(t(),i(()=>t().hitDice.current))),q.disabled=(e(I),t(),i(()=>e(I)>=t().hitDice.current)),Se.disabled=(t(),i(()=>t().hitDice.current<=0||!t().class))}),ze(et,()=>t().speed,de=>Ot(pe,i(t).speed=de,i(t))),ze(A,()=>t().currentHP,de=>Ot(pe,i(t).currentHP=de,i(t))),ze(O,()=>t().maxHP,de=>Ot(pe,i(t).maxHP=de,i(t))),B("click",ge,()=>le(-1)),B("click",Ee,()=>le(1)),B("click",Ae,()=>le(-5)),B("click",Fe,()=>le(5)),ze(k,()=>t().tempHP,de=>Ot(pe,i(t).tempHP=de,i(t))),ze(Be,()=>t().hitDice.current,de=>Ot(pe,i(t).hitDice.current=de,i(t))),ze(he,()=>t().hitDice.max,de=>Ot(pe,i(t).hitDice.max=de,i(t))),B("click",st,()=>be(-1)),ze(we,()=>e(I),de=>n(I,de)),B("input",we,de=>{const Je=de.target,Ge=parseInt(Je.value);Ge>t().hitDice.current&&n(I,t().hitDice.current),Ge<1&&n(I,1)}),B("click",q,()=>be(1)),B("click",Se,()=>qe(e(I))),o(R,M)};m(ye,R=>{p(),i(()=>!p().combatStats)&&R(We)})}s($e),D(()=>ue=Et($e,1,"combat-stats svelte-1r5hyyb",null,ue,{hidden:!e(H)})),o(r,$e),Xt(),y()}const qa={acrobatics:"dexterity",animalHandling:"wisdom",arcana:"intelligence",athletics:"strength",deception:"charisma",history:"intelligence",insight:"wisdom",intimidation:"charisma",investigation:"intelligence",medicine:"wisdom",nature:"intelligence",perception:"wisdom",performance:"charisma",persuasion:"charisma",religion:"intelligence",sleightOfHand:"dexterity",stealth:"dexterity",survival:"wisdom"};var lr=u('<div class="skill-row svelte-1f1pl16"><input type="checkbox" class="svelte-1f1pl16"/> <label class="svelte-1f1pl16"> <span class="ability-tag svelte-1f1pl16"> </span></label> <span class="skill-modifier svelte-1f1pl16"> </span> <button class="roll-btn svelte-1f1pl16">Roll</button></div>'),rr=u('<div class="skills-grid svelte-1f1pl16"></div>'),ir=u("<section><!> <!></section>");function nr(r,c){Qt(c,!1);const t=()=>_t(pe,"$character",S),v=()=>_t(Xa,"$abilityModifiers",S),f=()=>_t(xa,"$searchFilter",S),p=()=>_t(la,"$collapsedStates",S),g=()=>_t(Sa,"$isEditMode",S),[S,y]=fa(),_=w(),N=w(),F=w(),Q=w(),K=w(),ee=w(),H=ka(),T=[{key:"acrobatics",label:"Acrobatics"},{key:"animalHandling",label:"Animal Handling"},{key:"arcana",label:"Arcana"},{key:"athletics",label:"Athletics"},{key:"deception",label:"Deception"},{key:"history",label:"History"},{key:"insight",label:"Insight"},{key:"intimidation",label:"Intimidation"},{key:"investigation",label:"Investigation"},{key:"medicine",label:"Medicine"},{key:"nature",label:"Nature"},{key:"perception",label:"Perception"},{key:"performance",label:"Performance"},{key:"persuasion",label:"Persuasion"},{key:"religion",label:"Religion"},{key:"sleightOfHand",label:"Sleight of Hand"},{key:"stealth",label:"Stealth"},{key:"survival",label:"Survival"}];function I(ce){const ye=qa[ce],We=v()[ye],R=t().skillProficiencies[ce]?t().proficiencyBonus:0,M=e(_)[ce],x=`1d20${M>=0?"+":""}${M}`,J=[];J.push({value:"1d20",source:"base die"}),We!==0&&J.push({value:We,source:ye}),R!==0&&J.push({value:R,source:"proficiency"}),H("roll",{notation:x,rollType:"check",bonusBreakdown:J})}Xe(()=>{},()=>{n(_,{})}),Xe(()=>t(),()=>{n(N,t().skillProficiencies)}),Xe(()=>t(),()=>{n(F,t().proficiencyBonus)}),Xe(()=>v(),()=>{n(Q,v())}),Xe(()=>(e(Q),e(N),e(F)),()=>{for(const{key:ce}of T){const ye=qa[ce],We=e(Q)[ye],R=e(N)[ce]?e(F):0;_a(_,e(_)[ce]=We+R)}}),Xe(()=>f(),()=>{n(K,T.filter(({label:ce})=>f()?ce.toLowerCase().includes(f().toLowerCase()):!0))}),Xe(()=>e(K),()=>{n(ee,e(K).length>0)}),ga(),Yt();var le=ir();let be;var qe=l(le);{let ce=xt(()=>(p(),i(()=>p().skills?"Expand":"Collapse")));Da(qe,{title:"Skills",get collapsed(){return p(),i(()=>p().skills)},get ariaLabel(){return e(ce)},onToggle:()=>la.update(ye=>({...ye,skills:!ye.skills}))})}var $e=a(qe,2);{var ue=ce=>{var ye=rr();Lt(ye,5,()=>e(K),Rt,(We,R)=>{let M=()=>e(R).key,x=()=>e(R).label;var J=lr(),W=l(J);ke(W);var me=a(W,2),xe=l(me),Ne=a(xe),He=l(Ne);s(Ne),s(me);var Pe=a(me,2),Ie=l(Pe);s(Pe);var h=a(Pe,2);s(J),D(P=>{Hs(W,(e(N),M(),i(()=>e(N)[M()]))),W.disabled=!g(),ut(W,"id",M()),ut(me,"for",M()),$(xe,`${x()??""} `),$(He,`(${P??""})`),$(Ie,`${e(_),M(),i(()=>e(_)[M()]>=0?"+":"")??""}${e(_),M(),i(()=>e(_)[M()])??""}`)},[()=>(U(qa),M(),i(()=>qa[M()].substring(0,3).toUpperCase()))]),B("change",W,P=>{console.log("Skill proficiency changed:",M(),P.target.checked),pe.update(oe=>({...oe,skillProficiencies:{...oe.skillProficiencies,[M()]:P.target.checked}}))}),B("click",h,()=>I(M())),o(We,J)}),s(ye),o(ce,ye)};m($e,ce=>{p(),i(()=>!p().skills)&&ce(ue)})}s(le),D(()=>be=Et(le,1,"skills svelte-1f1pl16",null,be,{hidden:!e(ee)})),o(r,le),Xt(),y()}var or=u('<p class="empty-message svelte-1123ljy">No attacks or spells to reorder.</p>'),cr=u('<li class="reorder-item svelte-1123ljy"><span class="attack-name svelte-1123ljy"> </span> <div class="reorder-buttons svelte-1123ljy"><button class="btn-move svelte-1123ljy" aria-label="Move up">‚ñ≤</button> <button class="btn-move svelte-1123ljy" aria-label="Move down">‚ñº</button></div></li>'),vr=u('<ul class="reorder-list svelte-1123ljy"></ul>'),dr=u('<div class="modal-backdrop svelte-1123ljy" role="presentation"><div class="modal-content svelte-1123ljy" role="dialog" aria-modal="true" aria-labelledby="modal-title"><div class="modal-header svelte-1123ljy"><h3 id="modal-title" class="svelte-1123ljy">Reorder Attacks & Spells</h3> <button class="btn-close svelte-1123ljy" aria-label="Close">√ó</button></div> <div class="modal-body svelte-1123ljy"><!></div> <div class="modal-footer svelte-1123ljy"><button class="btn btn-secondary svelte-1123ljy">Cancel</button> <button class="btn btn-primary svelte-1123ljy">Save Order</button></div></div></div>');function ur(r,c){Qt(c,!1);let t=Bt(c,"show",8,!1),v=Bt(c,"attacks",24,()=>[]),f=Bt(c,"onSave",8),p=Bt(c,"onCancel",8),g=w([]);function S(T,I){const le=e(g)[T];_a(g,e(g)[T]=e(g)[I]),_a(g,e(g)[I]=le),n(g,[...e(g)])}function y(T){T>0&&S(T,T-1)}function _(T){T<e(g).length-1&&S(T,T+1)}function N(){f()(e(g))}function F(){p()()}function Q(T){T.target===T.currentTarget&&F()}Xe(()=>(U(t()),U(v())),()=>{t()&&n(g,[...v()])}),ga(),Yt();var K=$t(),ee=De(K);{var H=T=>{var I=dr(),le=l(I),be=l(le),qe=a(l(be),2);s(be);var $e=a(be,2),ue=l($e);{var ce=x=>{var J=or();o(x,J)},ye=x=>{var J=vr();Lt(J,7,()=>e(g),W=>W.id,(W,me,xe)=>{var Ne=cr(),He=l(Ne),Pe=l(He,!0);s(He);var Ie=a(He,2),h=l(Ie),P=a(h,2);s(Ie),s(Ne),D(()=>{$(Pe,(e(me),i(()=>e(me).name||"(Unnamed attack or spell)"))),h.disabled=e(xe)===0,P.disabled=(U(e(xe)),e(g),i(()=>e(xe)===e(g).length-1))}),B("click",h,()=>y(e(xe))),B("click",P,()=>_(e(xe))),o(W,Ne)}),s(J),o(x,J)};m(ue,x=>{e(g),i(()=>e(g).length===0)?x(ce):x(ye,!1)})}s($e);var We=a($e,2),R=l(We),M=a(R,2);s(We),s(le),s(I),B("click",qe,F),B("click",R,F),B("click",M,N),B("click",I,Q),o(T,I)};m(ee,T=>{t()&&T(H)})}o(r,K),Xt()}let Wa=null,za=null;async function Ws(){if(Wa)return Wa;try{return Wa=await(await fetch(Os("/data/spells.json"))).json(),Wa||[]}catch(r){return console.error("Failed to load spells:",r),[]}}async function fr(){if(za)return za;try{return za=await(await fetch(Os("/data/feats.json"))).json(),za||[]}catch(r){return console.error("Failed to load feats:",r),[]}}function Ms(r,c){if(!c.trim())return r;const t=c.toLowerCase();return r.filter(v=>v.name.toLowerCase().includes(t)||v.school.toLowerCase().includes(t)||v.classes.some(f=>f.toLowerCase().includes(t))||v.description.toLowerCase().includes(t))}function pr(r,c){return c===null?r:r.filter(t=>t.level===c)}function mr(r,c){if(!c.trim())return r;const t=c.toLowerCase();return r.filter(v=>v.name.toLowerCase().includes(t)||v.description.toLowerCase().includes(t))}function Ka(r){const c=r.description,t=/\b(Strength|Dexterity|Constitution|Intelligence|Wisdom|Charisma)\s+saving\s+throw/i,v=c.match(t);if(!v)return null;const f=v[1].toLowerCase(),g=/half\s+(?:as\s+much\s+)?damage\s+on\s+a\s+successful(?:\s+save)?|on\s+a\s+successful(?:\s+save)?[^.]*half\s+(?:as\s+much\s+)?damage/i.test(c),y=/saving\s+throw\s+or\s+take.*?damage/i.test(c)&&!g;return{ability:f,halfDamageOnSave:g,noDamageOnSave:y}}function gr(r){const c=r.description;return/(plus|add)\s+your\s+spellcasting\s+(ability\s+)?modifier/i.test(c)}function Aa(r){const c=r.description.toLowerCase();return c.includes("ranged spell attack")||c.includes("melee spell attack")}function Va(r){const c=r.description.toLowerCase();if(["Divine Favor","Bless","Aid","Command","Crusader's Mantle"].includes(r.name))return!0;const f=["takes","take","deals","deal","damage equal to","force damage","fire damage","cold damage","lightning damage","thunder damage","acid damage","poison damage","necrotic damage","radiant damage","psychic damage","regain","regains","hit point"].some(S=>c.includes(S));return["bonus to attack","bonus to damage","bonus to ac","gains a +","gain a +","+1 bonus","+2 bonus","+3 bonus","advantage on","becomes a magic weapon"].some(S=>c.includes(S))&&!f}function br(r){const c=r.description;let t=0,v=0,f=0,p="";const g=c.match(/\+(\d+)\s+bonus\s+to\s+attack\s+rolls\s+and\s+damage\s+rolls/i);if(g){const y=parseInt(g[1]);t=y,v=y,p=`+${y} to attack and damage rolls`}if(r.name==="Bless"&&(p="Add 1d4 to attack rolls and saves",t="1d4"),r.name==="Aid")return p="+5 HP (max and current) for 8 hours",{attackBonus:0,damageBonus:0,acBonus:0,hpBonus:5,description:p,name:r.name};r.name==="Divine Favor"&&(p="Your weapon attacks deal an extra 1d4 radiant damage on a hit.",v="1d4");const S=c.match(/\+(\d+)\s+bonus\s+to\s+AC/i);return S&&(f=parseInt(S[1]),p=`+${f} to AC`),r.name==="Haste"&&(p="+2 AC, doubled speed, extra action",f=2),r.name==="Crusader's Mantle"&&(p="Your weapon attacks deal an extra 1d4 radiant damage on a hit.",v="1d4"),p||t!==0||v!==0||f!==0?{attackBonus:t,damageBonus:v,acBonus:f,description:p||r.description.substring(0,100),name:r.name}:null}function ds(r){const c=r.description,t=/takes?\s+(\d+d\d+)\s+\w+\s+damage[^.]*\.\s*If\s+the\s+target\s+is\s+missing.*?instead\s+takes?\s+(\d+d\d+)/is,v=c.match(t);return v?{baseDamage:v[1],alternateDamage:v[2]}:null}var hr=u('<button class="btn btn-secondary">Reorder</button>'),_r=u('<div class="edit-buttons svelte-14o91c5"><button class="btn btn-secondary">Add Attack</button> <!></div>'),yr=u('<input type="text" placeholder="Attack name" class="attack-name svelte-14o91c5"/>'),xr=u('<h4 class="attack-name-display svelte-14o91c5"> </h4>'),kr=u('<button class="btn-remove svelte-14o91c5">√ó</button>'),$r=u('<div class="attack-field svelte-14o91c5"><label class="svelte-14o91c5">Bonus</label> <input type="number" class="attack-bonus svelte-14o91c5"/></div>'),wr=u('<div class="attack-field svelte-14o91c5"><label class="svelte-14o91c5">Damage</label> <input type="text" placeholder="e.g., 2d6+3" class="attack-damage svelte-14o91c5"/></div>'),Sr=u('<div class="spell-info-loading svelte-14o91c5">Loading spell info...</div>'),Cr=u('<li class="svelte-14o91c5"><strong>At Higher Levels:</strong> </li>'),Dr=u('<li style="color: #007bff;" class="svelte-14o91c5"><strong>Special:</strong> Mage Hand is invisible when cast via Githyanki Psionics.</li>'),Lr=u('<li style="color: #007bff;" class="svelte-14o91c5"><strong>Cast via:</strong> </li>'),Ar=u("<!> <!>",1),jr=u('<ul class="svelte-14o91c5"><li class="svelte-14o91c5"><strong>Level:</strong> </li> <li class="svelte-14o91c5"><strong>Casting Time:</strong> </li> <li class="svelte-14o91c5"><strong>Range:</strong> </li> <li class="svelte-14o91c5"><strong>Components:</strong> <!></li> <li class="svelte-14o91c5"><strong>Duration:</strong> <!> </li> <li class="svelte-14o91c5"><strong>Description:</strong> </li> <!> <!></ul>'),Br=u('<span class="scaled-damage svelte-14o91c5" style="margin-left: 8px;"> </span>'),Rr=u('<span class="scaled-damage svelte-14o91c5">(Half damage)</span>'),Mr=u('<span class="scaled-damage svelte-14o91c5">(No damage)</span>'),Tr=u('<div class="target-condition svelte-14o91c5"><label class="svelte-14o91c5"><input type="checkbox" class="use-enabled svelte-14o91c5"/> <!> <!></label></div>'),Fr=u('<span class="scaled-damage svelte-14o91c5"> </span>'),Pr=u('<span class="scaled-damage svelte-14o91c5"> </span>'),Ir=u('<div class="target-condition svelte-14o91c5"><label class="svelte-14o91c5"><input type="checkbox" class="use-enabled svelte-14o91c5"/> Target is missing HP <!></label></div>'),Er=u("<option> </option>"),Ur=u('<span class="scaled-damage svelte-14o91c5"><!> </span>'),Nr=u('<span class="scaled-damage svelte-14o91c5"> </span>'),Hr=u('<div class="target-condition svelte-14o91c5"><label class="svelte-14o91c5"><input type="checkbox" class="use-enabled svelte-14o91c5"/> Target is Fiend or Undead <!></label></div>'),Or=u('<div class="spell-level-selector svelte-14o91c5"><label class="svelte-14o91c5">Cast at Level:</label> <select class="spell-level-select use-enabled svelte-14o91c5"></select> <!></div> <!>',1),Gr=u('<div class="spell-info svelte-14o91c5"><div class="spell-info-header svelte-14o91c5" role="button" tabindex="0"><h4 class="svelte-14o91c5">Spell Info</h4> <button class="collapse-btn-small svelte-14o91c5"> </button></div> <!></div> <!> <!> <!>',1),qr=u('<div class="spell-info-missing svelte-14o91c5">Spell info not found.</div>'),Wr=u('<div class="attack-notes svelte-14o91c5"><label class="svelte-14o91c5">Notes</label> <textarea placeholder="e.g., DC 15 Dex save, Range 120 ft, Concentration" class="notes-input svelte-14o91c5" rows="2"></textarea></div>'),zr=u('<div style="margin-bottom: 0.5em;"><label style="font-size:0.95em;"><input type="checkbox" class="svelte-14o91c5"/> Use Racial Trait <span style="color:#007bff; font-size:0.95em; margin-left:0.5em;"> </span></label></div>'),Kr=u('<button class="btn btn-primary">Roll Attack (Spell Slot)</button>'),Vr=u('<button class="btn btn-primary" disabled>No spell slots available</button>'),Jr=u('<button class="btn btn-primary">Roll Attack (Racial Trait)</button>'),Yr=u('<button class="btn btn-primary" disabled>No racial uses left</button>'),Qr=u('<div class="buff-target-selection svelte-14o91c5"><div class="target-options svelte-14o91c5"><label class="target-option svelte-14o91c5"><input type="radio" class="svelte-14o91c5"/> Self</label> <label class="target-option svelte-14o91c5"><input type="radio" class="svelte-14o91c5"/> Other</label></div> <button class="btn btn-info"> </button></div>'),Xr=u('<button class="btn btn-info">Cast Spell</button>'),Zr=u("<button><!></button>"),ei=u('<button class="btn btn-info">Cast Spell</button>'),ti=u("<!> <!> <!> <!>",1),ai=u('<button class="btn btn-secondary">Roll Damage</button>'),si=u('<button class="btn btn-primary">Roll Attack</button> <!>',1),li=u('<div class="attack-card svelte-14o91c5"><div class="attack-header svelte-14o91c5"><!> <!></div> <div class="attack-details svelte-14o91c5"><!> <!> <div class="attack-field svelte-14o91c5"><label class="svelte-14o91c5">Type</label> <input type="text" placeholder="e.g., slashing" class="attack-type svelte-14o91c5"/></div></div> <!> <!> <div class="attack-actions svelte-14o91c5"><!> <!></div></div>'),ri=u('<p class="no-attacks svelte-14o91c5">No attacks added yet. Click "Add Attack" to create one.</p>'),ii=u('<p class="no-attacks svelte-14o91c5">No attacks match your search.</p>'),ni=u('<span class="ability-uses svelte-14o91c5"> <!></span>'),oi=u('<span class="ability-reaction svelte-14o91c5">‚ö° Reaction</span>'),ci=u('<button class="btn btn-ability svelte-14o91c5">Use Ability</button>'),vi=u('<div class="ability-card svelte-14o91c5"><div class="ability-header svelte-14o91c5"><h4 class="ability-name svelte-14o91c5"> </h4> <span class="ability-source svelte-14o91c5"> </span></div> <p class="ability-description svelte-14o91c5"> </p> <div class="ability-footer svelte-14o91c5"><!> <!> <!></div></div>'),di=u('<div class="condition-abilities-section svelte-14o91c5"><h3 class="abilities-header svelte-14o91c5">Condition Abilities</h3> <p class="section-description svelte-14o91c5">Special actions granted by active conditions (e.g., Flicker of Deceit)</p> <div class="abilities-list svelte-14o91c5"></div></div>'),ui=u('<button class="btn-remove svelte-14o91c5">√ó</button>'),fi=u('<div class="state-card svelte-14o91c5"><div class="state-header svelte-14o91c5"><input type="text" placeholder="Effect name (e.g., Magic Weapon)" class="state-name svelte-14o91c5"/> <!></div> <div class="state-details svelte-14o91c5"><div class="state-field svelte-14o91c5"><label class="svelte-14o91c5">Attack Bonus</label> <input type="text" class="state-bonus svelte-14o91c5" placeholder="0 or 1d4"/></div> <div class="state-field svelte-14o91c5"><label class="svelte-14o91c5">Damage Bonus</label> <input type="text" class="state-bonus svelte-14o91c5"/></div> <div class="state-field svelte-14o91c5"><label class="svelte-14o91c5">Target</label> <select class="state-bonus svelte-14o91c5"><option>Self</option><option>Other</option></select></div></div> <div class="state-description svelte-14o91c5"><label class="svelte-14o91c5">Description</label> <input type="text" placeholder="e.g., +1 to attack and damage rolls (Magic Weapon)" class="state-desc-input svelte-14o91c5"/></div></div>'),pi=u('<div class="states-list svelte-14o91c5"></div>'),mi=u('<p class="no-states svelte-14o91c5">No active effects. Add spell effects that modify your attacks.</p>'),gi=u('<!> <div class="attacks-list svelte-14o91c5"><!> <!> <!></div> <!> <div class="active-states-section svelte-14o91c5"><h3 class="svelte-14o91c5">Active Spell Effects</h3> <p class="section-description svelte-14o91c5">Effects that modify attack and damage rolls (e.g., Magic Weapon, Bless)</p> <button class="btn btn-secondary">Add Effect</button> <!></div>',1),bi=u("<section><!> <!></section> <!>",1);function hi(r,c){Qt(c,!1);const t=()=>_t(pe,"$character",g),v=()=>_t(xa,"$searchFilter",g),f=()=>_t(la,"$collapsedStates",g),p=()=>_t(Sa,"$isEditMode",g),[g,S]=fa(),y=w(),_=w(),N=w(),F=[];let Q=w({});function K(C,z){pe.update(A=>{if(!A.activeStates)return A;const O=A.activeStates.findIndex(Ae=>Ae.name===C);if(O===-1)return A;const Y=A.activeStates[O];if(!Y.abilities)return A;const ge=Y.abilities.findIndex(Ae=>Ae.name===z);if(ge===-1)return A;const Ee=Y.abilities[ge];return Ee.currentUses!==void 0&&Ee.currentUses>0&&(Ee.currentUses-=1,Ee.usesPerRest!==void 0?Ht.add(`Used ${z} (${Ee.currentUses}/${Ee.usesPerRest} remaining)`,"info"):Ht.add(`Used ${z}`,"info")),A})}const ee=ka();let H=w({}),T=w({}),I=w(!1);function le(C){_a(H,e(H)[C]=!e(H)[C]),n(H,{...e(H)})}function be(C){return C.description.toLowerCase().includes("regain")&&(C.description.toLowerCase().includes("hit point")||C.description.toLowerCase().includes("hp"))}function qe(C){return["Shield of Faith","Bless","Aid","Magic Weapon"].includes(C)}function $e(){pe.update(C=>(C.attacks=[...C.attacks,{id:crypto.randomUUID(),name:"",bonus:0,damage:"",damageType:"",notes:""}],C))}function ue(C){pe.update(z=>(z.attacks=z.attacks.filter(A=>A.id!==C),z))}function ce(){n(I,!0)}function ye(){n(I,!1)}function We(C){pe.update(z=>(z.attacks=C,z)),n(I,!1),Ht.add("Attack order updated successfully!","success")}function R(C,z){let A=C.damage,O=!1,Y=!1;const ge=[];if(C.spellRef){const k=W(C.spellRef);if(k&&(Y=Aa(k),k.level>0)){const Z=C.castAtLevel||k.level;let G=!1;if(z||C.source==="racial"){if(G=xe(C.name),!G){Ht.add(`No uses of ${C.name} remaining!`,"error");return}}else if(G=me(Z),!G){Ht.add(`No level ${Z} spell slots available!`,"error");return}const he=Ka(k);he&&C.targetSucceededSave&&he.noDamageOnSave?A="0":(O=he?.halfDamageOnSave&&C.targetSucceededSave||!1,A=Ne(C,k))}}else if(A){const k=A.match(/(\d+d\d+)([+-]?\d+)?/);if(k){const[,Z,G]=k,Be=G?parseInt(G):0;if(Be!==0&&ge.push({value:Be,source:"base"}),t().activeStates&&t().activeStates.length>0){let he=0,ct=[];for(const Le of t().activeStates)Le.target!=="other"&&(typeof Le.damageBonus=="string"?(ct.push(Le.damageBonus),ge.push({value:Le.damageBonus,source:Le.name})):typeof Le.damageBonus=="number"&&Le.damageBonus!==0&&(he+=Le.damageBonus,ge.push({value:Le.damageBonus,source:Le.name})));if(he!==0||ct.length>0){const Le=Be+he;let te=`${Z}`;Le!==0&&(te+=`${Le>=0?"+":""}${Le}`),ct.length>0&&(te+=" + "+ct.join(" + ")),A=te}}}}const Ee=[];let Ae=0;if(Y){const k=cs(t(),t().abilities),Z=t().proficiencyBonus||0;Ee.push({value:Z,source:"proficiency"}),Ee.push({value:k,source:"spellcasting"}),Ae=Z+k}else C.bonus!==0&&Ee.push({value:C.bonus,source:"base"}),Ae=C.bonus;let Fe=[];if(t().activeStates)for(const k of t().activeStates)k.target!=="other"&&(typeof k.attackBonus=="number"&&k.attackBonus!==0?(Ee.push({value:k.attackBonus,source:k.name}),Ae+=k.attackBonus):typeof k.attackBonus=="string"&&k.attackBonus&&(Fe.push(k.attackBonus),Ee.push({value:k.attackBonus,source:k.name})));let je=`1d20${Ae>=0?"+":""}${Ae}`;Fe.length>0&&(je+="+"+Fe.join("+")),ee("roll",{notation:je,damageNotation:A,attackName:C.name,applyHalfDamage:O,bonusBreakdown:Ee,damageBreakdown:ge,rollType:"attack"})}function M(C){if(!C.damage){Ht.add(`${C.name}: No damage specified`,"error");return}let z=C.damage,A=!1;const O=[];let Y=C.damageType||"";if(C.spellRef){const ge=W(C.spellRef);if(ge){const Ee=be(ge);if(Ee){const Ae=cs(t(),t().abilities),Fe=z.match(/^(\d+d\d+)/);Fe&&(z=Fe[1],Ae>0&&(z+=`+${Ae}`,O.push({value:Ae,source:"spellcasting"}))),Y="Healing"}if(ge.level>0){const Ae=C.castAtLevel||ge.level;let Fe=!1;if(C.source==="racial"){if(Fe=xe(C.name),!Fe){Ht.add(`No uses of ${C.name} remaining!`,"error");return}}else if(Fe=me(Ae),!Fe){Ht.add(`No level ${Ae} spell slots available!`,"error");return}const je=Ka(ge);je&&C.targetSucceededSave&&je.noDamageOnSave?z="0":(A=je?.halfDamageOnSave&&C.targetSucceededSave||!1,Ee||(z=Ne(C,ge)))}}}else{const ge=z.match(/(\d+d\d+)([+-]\d+)?/);if(ge){const[,Ee,Ae]=ge,Fe=Ae?parseInt(Ae):0;if(Fe!==0&&O.push({value:Fe,source:"base"}),t().activeStates&&t().activeStates.length>0){let je=0,k=[];for(const Z of t().activeStates)Z.target!=="other"&&(typeof Z.damageBonus=="string"?(k.push(Z.damageBonus),O.push({value:Z.damageBonus,source:Z.name})):typeof Z.damageBonus=="number"&&Z.damageBonus!==0&&(O.push({value:Z.damageBonus,source:Z.name}),je+=Z.damageBonus));if(je!==0||k.length>0){const Z=Fe+je;let G=`${Ee}`;Z!==0&&(G+=`${Z>=0?"+":""}${Z}`),k.length>0&&(G+=" + "+k.join(" + ")),z=G}}}}ee("roll",{notation:z,attackName:C.name,applyHalfDamage:A,bonusBreakdown:O,damageType:Y})}let x=w([]),J=w(!1);Ca(async()=>{n(x,await Ws()),n(J,!0)});function W(C){return e(x).find(z=>z.name===C)}function me(C){t().classFeatures.spellSlotsByLevel||Ot(pe,i(t).classFeatures.spellSlotsByLevel={},i(t)),t().classFeatures.spellSlotsByLevel[C]||Ot(pe,i(t).classFeatures.spellSlotsByLevel[C]=Array(2).fill(!1),i(t));const A=t().classFeatures.spellSlotsByLevel[C].findIndex(O=>!O);return A===-1?!1:(pe.update(O=>(O.classFeatures.spellSlotsByLevel||(O.classFeatures.spellSlotsByLevel={}),O.classFeatures.spellSlotsByLevel[C]||(O.classFeatures.spellSlotsByLevel[C]=Array(2).fill(!1)),O.classFeatures.spellSlotsByLevel[C][A]=!0,O)),!0)}function xe(C){return!t().racialTraits||!t().racialTraits.uses[C]?!0:t().racialTraits.uses[C].currentUses<=0?!1:(pl(C),!0)}function Ne(C,z){let A=C.damage,O=0,Y=0;const ge=ds(z);if(ge&&C.targetIsDamaged&&(A=ge.alternateDamage),gr(z)&&(Y+=cs(t(),t().abilities)),t().activeStates)for(const he of t().activeStates)he.target!=="other"&&typeof he.damageBonus=="number"&&(Y+=he.damageBonus);if(z.higherLevelSlot&&C.castAtLevel){const he=z.level,Le=(C.castAtLevel||he)-he;if(Le>0){const te=z.higherLevelSlot.match(/(\d+)d(\d+)\s+for\s+each.*?level\s+above/i);if(te){const[,d]=te;O+=Le*parseInt(d)}}}if(C.targetIsFiendOrUndead&&z.description.includes("Fiend or an Undead")){const he=z.description.match(/increases by (\d+)d(\d+) if.*?Fiend or.*?Undead/i);if(he){const[,ct]=he;O+=parseInt(ct)}}const Ee=A.match(/(\d+)d(\d+)([+-]\d+)?/);if(!Ee)return Y!==0?Y>=0?`${Y}`:`${Y}`:A||"0";const[,Ae,Fe,je]=Ee,k=parseInt(Ae)+O,G=(je?parseInt(je):0)+Y;let Be=`${k}d${Fe}`;return G!==0&&(Be+=G>=0?`+${G}`:`${G}`),Be}function He(C){const z=[];for(let O=C.level;O<=9;O++){const Y=t().classFeatures.spellSlotsByLevel?.[O];Y&&Y.length>0&&z.push(O)}return z}function Pe(){pe.update(C=>(C.activeStates||(C.activeStates=[]),C.activeStates=[...C.activeStates,{name:"",attackBonus:0,damageBonus:0,description:"",target:"self"}],C))}function Ie(C){pe.update(z=>{if(z.activeStates){const A=z.activeStates[C];A?.hpBonus&&A.target!=="other"&&(z.maxHP-=A.hpBonus,z.currentHP=Math.max(1,Math.min(z.currentHP-A.hpBonus,z.maxHP))),z.activeStates=z.activeStates.filter((O,Y)=>Y!==C)}return z})}function h(C,z="self"){const A=W(C.spellRef);if(!A){Ht.add("Spell not found","error");return}const O=C.castAtLevel||A.level;if(O>0){let k=!1;if(C.source==="racial"){if(k=xe(C.name),!k){Ht.add(`No uses of ${C.name} remaining!`,"error");return}}else if(k=me(O),!k){Ht.add(`No level ${O} spell slots available!`,"error");return}}const Y=br(A);if(!Y){Ht.add(`${A.name} cast! Check spell description for effects.`,"info");return}let ge=Y.hpBonus||0,Ee=Y.description;A.name==="Aid"&&O>A.level&&(ge=5+(O-A.level)*5,Ee=`+${ge} HP (max and current) for 8 hours`);const Fe=["Shield of Faith","Bless","Aid","Magic Weapon"].includes(A.name);pe.update(k=>{k.activeStates||(k.activeStates=[]);const Z=k.activeStates.find(G=>G.name===A.name);return Z&&Z.hpBonus&&Z.target!=="other"&&(k.maxHP-=Z.hpBonus,k.currentHP=Math.max(1,Math.min(k.currentHP-Z.hpBonus,k.maxHP))),k.activeStates=k.activeStates.filter(G=>G.name!==A.name),ge>0&&z==="self"&&(k.maxHP+=ge,k.currentHP+=ge),k.activeStates=[...k.activeStates,{name:A.name,attackBonus:Y.attackBonus,damageBonus:Y.damageBonus,acBonus:Y.acBonus,description:Ee,target:z,hpBonus:ge}],k});const je=z==="self"?" on self":" on other";Ht.add(`${A.name} cast${Fe?je:""}! Effect added to Active Spell Effects.`,"success")}Xe(()=>t(),()=>{n(y,t().activeStates?t().activeStates.filter(C=>C.abilities&&C.abilities.length>0).flatMap(C=>C.abilities.map(z=>({...z,conditionName:C.name}))):[])}),Xe(()=>(t(),e(H),e(T)),()=>{if(t()&&t().attacks)for(const C of t().attacks)C.spellRef&&e(H)[C.id]===void 0&&_a(H,e(H)[C.id]=!0),C.spellRef&&e(T)[C.id]===void 0&&_a(T,e(T)[C.id]="self")}),Xe(()=>(t(),v()),()=>{n(_,t().attacks.filter(C=>{if(!v())return!0;const z=v().toLowerCase();return C.name.toLowerCase().includes(z)||C.damageType.toLowerCase().includes(z)}).sort((C,z)=>!C.spellRef&&z.spellRef?-1:C.spellRef&&!z.spellRef?1:0))}),Xe(()=>(v(),e(_)),()=>{n(N,!v()||e(_).length>0||"attack".includes(v().toLowerCase())||"spell".includes(v().toLowerCase()))}),ga(),Yt();var P=bi(),oe=De(P);let et;var lt=l(oe);{let C=xt(()=>(f(),i(()=>f().attacks?"Expand":"Collapse")));Da(lt,{title:"Attacks & Spells",get collapsed(){return f(),i(()=>f().attacks)},get ariaLabel(){return e(C)},onToggle:()=>la.update(z=>({...z,attacks:!z.attacks}))})}var yt=a(lt,2);{var Dt=C=>{var z=gi(),A=De(z);{var O=te=>{var d=_r(),st=l(d),we=a(st,2);{var q=Se=>{var de=hr();B("click",de,ce),o(Se,de)};m(we,Se=>{t(),i(()=>t().attacks.length>0)&&Se(q)})}s(d),B("click",st,$e),o(te,d)};m(A,te=>{p()&&te(O)})}var Y=a(A,2),ge=l(Y);Lt(ge,1,()=>e(_),te=>te.id,(te,d,st)=>{var we=li(),q=l(we),Se=l(q);{var de=_e=>{var ae=yr();ke(ae),ze(ae,()=>e(d).name,fe=>(e(d).name=fe,Kt(()=>(e(_),t(),v())))),o(_e,ae)},Je=_e=>{var ae=xr(),fe=l(ae,!0);s(ae),D(()=>$(fe,(e(d),i(()=>e(d).name||"(Unnamed Attack)")))),o(_e,ae)};m(Se,_e=>{p()?_e(de):_e(Je,!1)})}var Ge=a(Se,2);{var tt=_e=>{var ae=kr();B("click",ae,()=>ue(e(d).id)),o(_e,ae)};m(Ge,_e=>{p()&&_e(tt)})}s(q);var Oe=a(q,2),Ye=l(Oe);{var mt=_e=>{var ae=$r(),fe=l(ae),Ze=a(fe,2);ke(Ze),s(ae),D(()=>{ut(fe,"for",`attack-bonus-${e(d),i(()=>e(d).id)??""}`),ut(Ze,"id",`attack-bonus-${e(d),i(()=>e(d).id)??""}`)}),ze(Ze,()=>e(d).bonus,St=>(e(d).bonus=St,Kt(()=>(e(_),t(),v())))),o(_e,ae)};m(Ye,_e=>{e(d),i(()=>e(d).bonus!==0&&e(d).bonus!==void 0)&&_e(mt)})}var X=a(Ye,2);{var Qe=_e=>{var ae=wr(),fe=l(ae),Ze=a(fe,2);ke(Ze),s(ae),D(()=>{ut(fe,"for",`attack-damage-${e(d),i(()=>e(d).id)??""}`),ut(Ze,"id",`attack-damage-${e(d),i(()=>e(d).id)??""}`)}),ze(Ze,()=>e(d).damage,St=>(e(d).damage=St,Kt(()=>(e(_),t(),v())))),o(_e,ae)};m(X,_e=>{e(d),i(()=>e(d).damage&&e(d).damage.trim()!=="")&&_e(Qe)})}var gt=a(X,2),b=l(gt),E=a(b,2);ke(E),s(gt),s(Oe);var ie=a(Oe,2);{var ne=_e=>{var ae=$t(),fe=De(ae);{var Ze=ot=>{var se=Sr();o(ot,se)},St=ot=>{const se=xt(()=>(e(d),i(()=>W(e(d).spellRef))));var Gt=$t(),Te=De(Gt);{var kt=sa=>{const j=xt(()=>(U(Ka),U(e(se)),i(()=>Ka(e(se))))),Ce=xt(()=>(U(ds),U(e(se)),i(()=>ds(e(se)))));var Ue=Gr(),bt=De(Ue),L=l(bt),ft=a(l(L),2),rt=l(ft,!0);s(ft),s(L);var ht=a(L,2);{var at=nt=>{var Pt=jr(),qt=l(Pt),Zt=a(l(qt));s(qt);var va=a(qt,2),pa=a(l(va));s(va);var da=a(va,2),Vt=a(l(da));s(da);var ea=a(da,2),Jt=a(l(ea)),It=a(Jt);{var na=jt=>{var ia=Tt();D(()=>$(ia,`(${U(e(se)),i(()=>e(se).material)??""})`)),o(jt,ia)};m(It,jt=>{U(e(se)),i(()=>e(se).material)&&jt(na)})}s(ea);var ma=a(ea,2),ha=a(l(ma),2);{var Wt=jt=>{var ia=Tt("Concentration,");o(jt,ia)};m(ha,jt=>{U(e(se)),i(()=>e(se).concentration)&&jt(Wt)})}var ra=a(ha,1,!0);s(ma);var dt=a(ma,2),Ct=a(l(dt));s(dt);var At=a(dt,2);{var zt=jt=>{var ia=Cr(),La=a(l(ia));s(ia),D(()=>$(La,` ${U(e(se)),i(()=>e(se).higherLevelSlot)??""}`)),o(jt,ia)};m(At,jt=>{U(e(se)),i(()=>e(se).higherLevelSlot)&&jt(zt)})}var Nt=a(At,2);{var oa=jt=>{var ia=Ar(),La=De(ia);{var es=ca=>{var ba=Dr();o(ca,ba)};m(La,ca=>{e(d),U(e(se)),i(()=>e(d).racialTraitName==="Githyanki Psionics"&&e(se).name==="Mage Hand")&&ca(es)})}var ts=a(La,2);{var as=ca=>{var ba=Lr(),Ba=a(l(ba));s(ba),D(()=>$(Ba,` ${e(d),i(()=>e(d).racialTraitName)??""}`)),o(ca,ba)};m(ts,ca=>{e(d),i(()=>e(d).racialTraitName)&&ca(as)})}o(jt,ia)};m(Nt,jt=>{e(d),i(()=>e(d).source==="racial")&&jt(oa)})}s(Pt),D(jt=>{$(Zt,` ${U(e(se)),i(()=>e(se).level)??""}`),$(pa,` ${U(e(se)),i(()=>e(se).castingTime||e(se).actionType)??""}`),$(Vt,` ${U(e(se)),i(()=>e(se).range)??""}`),$(Jt,` ${jt??""}`),$(ra,(U(e(se)),i(()=>e(se).duration))),$(Ct,` ${U(e(se)),i(()=>e(se).description)??""}`)},[()=>(U(e(se)),i(()=>e(se).components.join(", ")))]),o(nt,Pt)};m(ht,nt=>{e(H),e(d),i(()=>!e(H)[e(d).id])&&nt(at)})}s(bt);var it=a(bt,2);{var Ve=nt=>{var Pt=Tr(),qt=l(Pt),Zt=l(qt);ke(Zt);var va=a(Zt),pa=a(va);{var da=It=>{var na=Br(),ma=l(na);s(na),D(ha=>$(ma,`(Spell Save DC: ${ha??""})`),[()=>(U(bs),t(),i(()=>bs(t(),t().abilities)))]),o(It,na)};m(pa,It=>{t(),i(()=>t().class)&&It(da)})}var Vt=a(pa,2);{var ea=It=>{var na=Rr();o(It,na)},Jt=It=>{var na=$t(),ma=De(na);{var ha=Wt=>{var ra=Mr();o(Wt,ra)};m(ma,Wt=>{e(d),U(e(j)),i(()=>e(d).targetSucceededSave&&e(j).noDamageOnSave)&&Wt(ha)},!0)}o(It,na)};m(Vt,It=>{e(d),U(e(j)),i(()=>e(d).targetSucceededSave&&e(j).halfDamageOnSave)?It(ea):It(Jt,!1)})}s(qt),s(Pt),D(It=>$(va,` Target succeeded on ${It??""} save `),[()=>(U(e(j)),i(()=>e(j).ability.charAt(0).toUpperCase()+e(j).ability.slice(1)))]),wa(Zt,()=>e(d).targetSucceededSave,It=>(e(d).targetSucceededSave=It,Kt(()=>(e(_),t(),v())))),o(nt,Pt)};m(it,nt=>{e(j)&&nt(Ve)})}var Ft=a(it,2);{var Ut=nt=>{var Pt=Ir(),qt=l(Pt),Zt=l(qt);ke(Zt);var va=a(Zt,2);{var pa=Vt=>{const ea=xt(()=>(e(d),U(e(se)),i(()=>Ne(e(d),e(se)))));var Jt=Fr(),It=l(Jt);s(Jt),D(()=>$(It,`(${U(e(Ce)),i(()=>e(Ce).alternateDamage)??""}, total: ${e(ea)??""})`)),o(Vt,Jt)},da=Vt=>{var ea=Pr(),Jt=l(ea);s(ea),D(()=>$(Jt,`(${U(e(Ce)),i(()=>e(Ce).baseDamage)??""})`)),o(Vt,ea)};m(va,Vt=>{e(d),i(()=>e(d).targetIsDamaged)?Vt(pa):Vt(da,!1)})}s(qt),s(Pt),wa(Zt,()=>e(d).targetIsDamaged,Vt=>(e(d).targetIsDamaged=Vt,Kt(()=>(e(_),t(),v())))),o(nt,Pt)};m(Ft,nt=>{e(Ce)&&nt(Ut)})}var Mt=a(Ft,2);{var pt=nt=>{const Pt=xt(()=>(U(e(se)),i(()=>He(e(se)))));var qt=$t(),Zt=De(qt);{var va=pa=>{var da=Or(),Vt=De(da),ea=l(Vt),Jt=a(ea,2);D(()=>{e(d),Kt(()=>{e(Pt)})}),Lt(Jt,5,()=>e(Pt),Rt,(Wt,ra)=>{var dt=Er(),Ct=l(dt);s(dt);var At={};D(()=>{$(Ct,`Level ${e(ra)??""}`),At!==(At=e(ra))&&(dt.value=(dt.__value=e(ra))??"")}),o(Wt,dt)}),s(Jt);var It=a(Jt,2);{var na=Wt=>{const ra=xt(()=>(e(d),U(e(se)),i(()=>Ne(e(d),e(se)))));var dt=Ur(),Ct=l(dt);{var At=oa=>{var jt=Tt("Healing");o(oa,jt)},zt=oa=>{var jt=Tt("Damage");o(oa,jt)};m(Ct,oa=>{U(e(se)),i(()=>be(e(se)))?oa(At):oa(zt,!1)})}var Nt=a(Ct);s(dt),D(()=>$(Nt,` ${e(ra)??""}`)),o(Wt,dt)};m(It,Wt=>{e(d),U(e(se)),i(()=>e(d).castAtLevel&&e(d).castAtLevel>e(se).level)&&Wt(na)})}s(Vt);var ma=a(Vt,2);{var ha=Wt=>{var ra=Hr(),dt=l(ra),Ct=l(dt);ke(Ct);var At=a(Ct,2);{var zt=Nt=>{const oa=xt(()=>(e(d),U(e(se)),i(()=>Ne(e(d),e(se)))));var jt=Nr(),ia=l(jt);s(jt),D(()=>$(ia,`(+1d8, total: ${e(oa)??""})`)),o(Nt,jt)};m(At,Nt=>{e(d),i(()=>e(d).targetIsFiendOrUndead)&&Nt(zt)})}s(dt),s(ra),wa(Ct,()=>e(d).targetIsFiendOrUndead,Nt=>(e(d).targetIsFiendOrUndead=Nt,Kt(()=>(e(_),t(),v())))),o(Wt,ra)};m(ma,Wt=>{U(e(se)),i(()=>e(se).description.includes("Fiend or an Undead"))&&Wt(ha)})}D(()=>{ut(ea,"for",`castLevel-${e(d),i(()=>e(d).id)??""}`),ut(Jt,"id",`castLevel-${e(d),i(()=>e(d).id)??""}`)}),Na(Jt,()=>e(d).castAtLevel,Wt=>(e(d).castAtLevel=Wt,Kt(()=>(e(_),t(),v())))),o(pa,da)};m(Zt,pa=>{U(e(Pt)),e(Q),e(d),i(()=>e(Pt).length>0&&!e(Q)[e(d).id])&&pa(va)})}o(nt,qt)};m(Mt,nt=>{U(e(se)),i(()=>e(se).higherLevelSlot&&e(se).level>0)&&nt(pt)})}D(()=>{ut(ft,"aria-label",(e(H),e(d),i(()=>e(H)[e(d).id]?"Expand":"Collapse"))),$(rt,(e(H),e(d),i(()=>e(H)[e(d).id]?"‚ñº":"‚ñ≤")))}),B("click",L,()=>le(e(d).id)),B("keydown",L,nt=>nt.key==="Enter"&&le(e(d).id)),o(sa,Ue)},aa=sa=>{var j=qr();o(sa,j)};m(Te,sa=>{e(se)?sa(kt):sa(aa,!1)})}o(ot,Gt)};m(fe,ot=>{e(x),i(()=>e(x).length===0)?ot(Ze):ot(St,!1)})}o(_e,ae)};m(ie,_e=>{e(d),i(()=>e(d).spellRef)&&_e(ne)})}var ve=a(ie,2);{var Re=_e=>{var ae=$t(),fe=De(ae);{var Ze=St=>{var ot=Wr(),se=l(ot),Gt=a(se,2);ja(Gt),s(ot),D(()=>{ut(se,"for",`attack-notes-${e(d),i(()=>e(d).id)??""}`),ut(Gt,"id",`attack-notes-${e(d),i(()=>e(d).id)??""}`)}),ze(Gt,()=>e(d).notes,Te=>(e(d).notes=Te,Kt(()=>(e(_),t(),v())))),o(St,ot)};m(fe,St=>{e(d),i(()=>e(d).notes&&e(d).notes.trim()!=="")&&St(Ze)})}o(_e,ae)};m(ve,_e=>{e(d),i(()=>!e(d).spellRef)&&_e(Re)})}var Ke=a(ve,2),Me=l(Ke);{var re=_e=>{const ae=xt(()=>(e(d),i(()=>W(e(d).spellRef))));var fe=$t(),Ze=De(fe);{var St=ot=>{const se=xt(()=>(t(),e(d),i(()=>t().racialTraits&&t().racialTraits.uses[e(d).name])));var Gt=ti(),Te=De(Gt);{var kt=L=>{var ft=zr(),rt=l(ft),ht=l(rt);ke(ht);var at=a(ht,2),it=l(at);s(at),s(rt),s(ft),D(()=>$(it,`(${U(e(se)),i(()=>e(se).currentUses)??""}/${U(e(se)),i(()=>e(se).maxUses)??""} uses left)`)),wa(ht,()=>e(Q)[e(d).id],Ve=>_a(Q,e(Q)[e(d).id]=Ve)),B("change",ht,()=>{n(Q,{...e(Q)})}),o(L,ft)};m(Te,L=>{e(d),U(e(se)),i(()=>e(d).source==="racial"&&e(se))&&L(kt)})}var aa=a(Te,2);{var sa=L=>{var ft=$t(),rt=De(ft);{var ht=it=>{var Ve=$t(),Ft=De(Ve);{var Ut=pt=>{var nt=Kr();B("click",nt,()=>R(e(d),!1)),o(pt,nt)},Mt=pt=>{var nt=Vr();o(pt,nt)};m(Ft,pt=>{t(),U(e(ae)),i(()=>t().classFeatures&&t().classFeatures.spellSlotsByLevel&&t().classFeatures.spellSlotsByLevel[e(ae).level]?.some(nt=>!nt))?pt(Ut):pt(Mt,!1)})}o(it,Ve)},at=it=>{var Ve=$t(),Ft=De(Ve);{var Ut=pt=>{var nt=Jr();B("click",nt,()=>R(e(d),!0)),o(pt,nt)},Mt=pt=>{var nt=Yr();o(pt,nt)};m(Ft,pt=>{U(e(se)),i(()=>e(se)&&e(se).currentUses>0)?pt(Ut):pt(Mt,!1)})}o(it,Ve)};m(rt,it=>{e(Q),e(d),i(()=>!e(Q)[e(d).id])?it(ht):it(at,!1)})}o(L,ft)};m(aa,L=>{U(Aa),U(e(ae)),i(()=>Aa(e(ae)))&&L(sa)})}var j=a(aa,2);{var Ce=L=>{var ft=$t(),rt=De(ft);{var ht=it=>{var Ve=Qr(),Ft=l(Ve),Ut=l(Ft),Mt=l(Ut);ke(Mt),Mt.value=Mt.__value="self",ta(),s(Ut);var pt=a(Ut,2),nt=l(pt);ke(nt),nt.value=nt.__value="other",ta(),s(pt),s(Ft);var Pt=a(Ft,2),qt=l(Pt);s(Pt),s(Ve),D(()=>{ut(Mt,"name",`target-${e(d),i(()=>e(d).id)??""}`),ut(nt,"name",`target-${e(d),i(()=>e(d).id)??""}`),$(qt,`Cast ${U(e(ae)),i(()=>e(ae).name)??""}`)}),Ls(F,[st],Mt,()=>e(T)[e(d).id],Zt=>_a(T,e(T)[e(d).id]=Zt)),Ls(F,[st],nt,()=>e(T)[e(d).id],Zt=>_a(T,e(T)[e(d).id]=Zt)),B("click",Pt,()=>h(e(d),e(T)[e(d).id])),o(it,Ve)},at=it=>{var Ve=Xr();B("click",Ve,()=>h(e(d),"self")),o(it,Ve)};m(rt,it=>{U(e(ae)),i(()=>qe(e(ae).name))?it(ht):it(at,!1)})}o(L,ft)};m(j,L=>{U(Aa),U(e(ae)),U(Va),i(()=>!Aa(e(ae))&&Va(e(ae)))&&L(Ce)})}var Ue=a(j,2);{var bt=L=>{var ft=$t(),rt=De(ft);{var ht=it=>{var Ve=Zr(),Ft=l(Ve);{var Ut=pt=>{var nt=Tt("Roll Healing");o(pt,nt)},Mt=pt=>{var nt=Tt("Roll Damage");o(pt,nt)};m(Ft,pt=>{U(e(ae)),i(()=>be(e(ae)))?pt(Ut):pt(Mt,!1)})}s(Ve),D(pt=>Et(Ve,1,`btn ${pt??""}`),[()=>(U(e(ae)),i(()=>be(e(ae))?"btn-success":"btn-secondary"))]),B("click",Ve,()=>M(e(d))),o(it,Ve)},at=it=>{var Ve=ei();B("click",Ve,()=>h(e(d),"self")),o(it,Ve)};m(rt,it=>{e(d),i(()=>e(d).damage&&e(d).damage.trim()!=="")?it(ht):it(at,!1)})}o(L,ft)};m(Ue,L=>{U(Aa),U(e(ae)),U(Va),i(()=>!Aa(e(ae))&&!Va(e(ae)))&&L(bt)})}o(ot,Gt)};m(Ze,ot=>{e(ae)&&ot(St)})}o(_e,fe)};m(Me,_e=>{e(d),e(J),i(()=>e(d).spellRef&&e(J))&&_e(re)})}var V=a(Me,2);{var vt=_e=>{var ae=si(),fe=De(ae),Ze=a(fe,2);{var St=ot=>{var se=ai();B("click",se,()=>M(e(d))),o(ot,se)};m(Ze,ot=>{e(d),i(()=>e(d).damage&&e(d).damage.trim()!=="")&&ot(St)})}B("click",fe,()=>R(e(d))),o(_e,ae)};m(V,_e=>{e(d),i(()=>!e(d).spellRef)&&_e(vt)})}s(Ke),s(we),D(()=>{ut(b,"for",`attack-type-${e(d),i(()=>e(d).id)??""}`),ut(E,"id",`attack-type-${e(d),i(()=>e(d).id)??""}`)}),ze(E,()=>e(d).damageType,_e=>(e(d).damageType=_e,Kt(()=>(e(_),t(),v())))),o(te,we)});var Ee=a(ge,2);{var Ae=te=>{var d=ri();o(te,d)};m(Ee,te=>{t(),i(()=>t().attacks.length===0)&&te(Ae)})}var Fe=a(Ee,2);{var je=te=>{var d=ii();o(te,d)};m(Fe,te=>{e(_),t(),i(()=>e(_).length===0&&t().attacks.length>0)&&te(je)})}s(Y);var k=a(Y,2);{var Z=te=>{var d=di(),st=a(l(d),4);Lt(st,5,()=>e(y),Rt,(we,q)=>{var Se=vi(),de=l(Se),Je=l(de),Ge=l(Je,!0);s(Je);var tt=a(Je,2),Oe=l(tt);s(tt),s(de);var Ye=a(de,2),mt=l(Ye,!0);s(Ye);var X=a(Ye,2),Qe=l(X);{var gt=ve=>{var Re=ni(),Ke=l(Re),Me=a(Ke);{var re=V=>{var vt=Tt();D(()=>$(vt,`per ${e(q),i(()=>e(q).restType)??""} rest`)),o(V,vt)};m(Me,V=>{e(q),i(()=>e(q).restType)&&V(re)})}s(Re),D(()=>$(Ke,`${e(q),i(()=>e(q).currentUses??e(q).usesPerRest)??""}/${e(q),i(()=>e(q).usesPerRest)??""} uses `)),o(ve,Re)};m(Qe,ve=>{e(q),i(()=>e(q).usesPerRest)&&ve(gt)})}var b=a(Qe,2);{var E=ve=>{var Re=oi();o(ve,Re)};m(b,ve=>{e(q),i(()=>e(q).requiresReaction)&&ve(E)})}var ie=a(b,2);{var ne=ve=>{var Re=ci();D(()=>Re.disabled=(e(q),i(()=>e(q).currentUses===void 0||e(q).currentUses===0))),B("click",Re,()=>K(e(q).conditionName,e(q).name)),o(ve,Re)};m(ie,ve=>{p(),e(q),i(()=>!p()&&e(q).usesPerRest)&&ve(ne)})}s(X),s(Se),D(()=>{$(Ge,(e(q),i(()=>e(q).name))),$(Oe,`(${e(q),i(()=>e(q).conditionName)??""})`),$(mt,(e(q),i(()=>e(q).description)))}),o(we,Se)}),s(st),s(d),o(te,d)};m(k,te=>{e(y),i(()=>e(y).length>0)&&te(Z)})}var G=a(k,2),Be=a(l(G),4),he=a(Be,2);{var ct=te=>{var d=pi();Lt(d,5,()=>(t(),i(()=>t().activeStates)),Rt,(st,we,q)=>{var Se=fi(),de=l(Se),Je=l(de);ke(Je);var Ge=a(Je,2);{var tt=V=>{var vt=ui();B("click",vt,()=>Ie(q)),o(V,vt)};m(Ge,V=>{p()&&V(tt)})}s(de);var Oe=a(de,2),Ye=l(Oe),mt=l(Ye);ut(mt,"for",`state-attack-bonus-${q}`);var X=a(mt,2);ke(X),ut(X,"id",`state-attack-bonus-${q}`),s(Ye);var Qe=a(Ye,2),gt=l(Qe);ut(gt,"for",`state-damage-bonus-${q}`);var b=a(gt,2);ke(b),ut(b,"id",`state-damage-bonus-${q}`),s(Qe);var E=a(Qe,2),ie=l(E);ut(ie,"for",`state-target-${q}`);var ne=a(ie,2);D(()=>{e(we),Kt(()=>{})}),ut(ne,"id",`state-target-${q}`);var ve=l(ne);ve.value=ve.__value="self";var Re=a(ve);Re.value=Re.__value="other",s(ne),s(E),s(Oe);var Ke=a(Oe,2),Me=l(Ke);ut(Me,"for",`state-desc-${q}`);var re=a(Me,2);ke(re),ut(re,"id",`state-desc-${q}`),s(Ke),s(Se),ze(Je,()=>e(we).name,V=>(e(we).name=V,Kt(()=>t()),Pa(g,"$character"))),ze(X,()=>e(we).attackBonus,V=>(e(we).attackBonus=V,Kt(()=>t()),Pa(g,"$character"))),ze(b,()=>e(we).damageBonus,V=>(e(we).damageBonus=V,Kt(()=>t()),Pa(g,"$character"))),Na(ne,()=>e(we).target,V=>(e(we).target=V,Kt(()=>t()),Pa(g,"$character"))),ze(re,()=>e(we).description,V=>(e(we).description=V,Kt(()=>t()),Pa(g,"$character"))),o(st,Se)}),s(d),o(te,d)},Le=te=>{var d=mi();o(te,d)};m(he,te=>{t(),i(()=>t().activeStates&&t().activeStates.length>0)?te(ct):te(Le,!1)})}s(G),B("click",Be,Pe),o(C,z)};m(yt,C=>{f(),i(()=>!f().attacks)&&C(Dt)})}s(oe);var wt=a(oe,2);ur(wt,{get show(){return e(I)},get attacks(){return t(),i(()=>t().attacks)},onSave:We,onCancel:ye}),D(()=>et=Et(oe,1,"attacks svelte-14o91c5",null,et,{hidden:!e(N)})),o(r,P),Xt(),S()}var _i=u('<span class="slot-checkbox-x svelte-serp1j">&#8212;</span>'),yi=u('<label><input type="checkbox" class="slot-checkbox-input svelte-serp1j"/> <span><!></span></label>');function Ts(r,c){Qt(c,!1);const t=()=>_t(Sa,"$isEditMode",v),[v,f]=fa();let p=Bt(c,"checked",8,!1),g=Bt(c,"disabled",8,!1),S=Bt(c,"className",8,""),y=Bt(c,"index",8,void 0),_=Bt(c,"ariaLabel",8,void 0);const N=ka();function F(I){N("change",{checked:I.currentTarget.checked,index:y()})}Yt();var Q=yi(),K=l(Q);ke(K);var ee=a(K,2),H=l(ee);{var T=I=>{var le=_i();o(I,le)};m(H,I=>{p()&&I(T)})}s(ee),s(Q),D(()=>{Et(Q,1,"slot-checkbox-label "+S()+(t()?"":" not-editable"),"svelte-serp1j"),Hs(K,p()),K.disabled=g()||!t(),ut(K,"aria-label",_()),ut(K,"tabindex",t()?0:-1),Et(ee,1,`slot-checkbox-custom ${p()?"used":""} ${t()?"":"readonly"}`,"svelte-serp1j")}),B("change",K,F),o(r,Q),Xt(),f()}var xi=u('<span style="color:#007bff; margin-left:0.5em;"> </span>'),ki=u("<li><strong> </strong> <!></li>"),$i=u('<div class="racial-traits"><h4>Racial Traits</h4> <ul></ul></div>'),wi=u("<li> </li>"),Si=u('<div class="racial-resistances"><h4>Racial Resistances</h4> <ul></ul></div>'),Ci=u("<!> <!>",1);function Di(r,c){Qt(c,!1);const t=()=>_t(pe,"$character",v),[v,f]=fa(),p=w(),g=w();let S=w(),y=w();Ca(()=>{t().race&&t().level&&(ws(),rs(),n(S,t().race),n(y,t().level))}),Xe(()=>(t(),e(S),e(y),rs),()=>{t().race&&t().level&&(t().race!==e(S)||t().level!==e(y))&&(ws(),rs(),n(S,t().race),n(y,t().level))}),Xe(()=>(t(),Ja),()=>{n(p,(()=>{const ee=t().activeStates?t().activeStates.filter(I=>I.name&&I.name.toLowerCase().includes("racial")).flatMap(I=>I.resistances||[]):[],H=Ja(t().race||""),T=H?H.traits.flatMap(I=>I.resistances||[]):[];return Array.from(new Set([...ee,...T]))})())}),Xe(()=>t(),()=>{n(g,(()=>{const ee=Ja(t().race||"");return ee?ee.traits:[]})())}),ga(),Yt();var _=Ci(),N=De(_);{var F=ee=>{var H=$i(),T=a(l(H),2);Lt(T,5,()=>e(g),Rt,(I,le)=>{var be=ki(),qe=l(be),$e=l(qe);s(qe);var ue=a(qe),ce=a(ue);{var ye=We=>{var R=xi(),M=l(R);s(R),D(x=>$(M,`(Resistances: ${x??""})`),[()=>(e(le),i(()=>e(le).resistances.map(x=>x.charAt(0).toUpperCase()+x.slice(1)).join(", ")))]),o(We,R)};m(ce,We=>{e(le),i(()=>e(le).resistances&&e(le).resistances.length>0)&&We(ye)})}s(be),D(()=>{$($e,`${e(le),i(()=>e(le).name)??""}:`),$(ue,` ${e(le),i(()=>e(le).description)??""} `)}),o(I,be)}),s(T),s(H),o(ee,H)};m(N,ee=>{e(g),i(()=>e(g).length>0)&&ee(F)})}var Q=a(N,2);{var K=ee=>{var H=Si(),T=a(l(H),2);Lt(T,5,()=>e(p),Rt,(I,le)=>{var be=wi(),qe=l(be,!0);s(be),D($e=>$(qe,$e),[()=>(e(le),i(()=>e(le).charAt(0).toUpperCase()+e(le).slice(1)))]),o(I,be)}),s(T),s(H),o(ee,H)};m(Q,ee=>{e(p),i(()=>e(p).length>0)&&ee(K)})}o(r,_),Xt(),f()}var Li=u('<p class="no-features svelte-1kpvv0n">Select a class to see available features</p>'),Ai=u('<p class="no-features svelte-1kpvv0n">No class features available at this level</p>'),ji=u('<h5 class="svelte-1kpvv0n"> </h5>'),Bi=u('<p class="no-uses svelte-1kpvv0n">No Channel Divinity uses remaining</p>'),Ri=u('<div class="channel-divinity-option svelte-1kpvv0n"><button class="btn btn-primary use-enabled svelte-1kpvv0n"><!></button> <!></div>'),Mi=u('<div class="sub-feature-box svelte-1kpvv0n"><h4 class="svelte-1kpvv0n"> </h4> <!> <p class="feature-description svelte-1kpvv0n"><!></p> <!></div>'),Ti=u('<div class="sub-features-grid svelte-1kpvv0n"></div>'),Fi=u('<div class="feature-box channel-divinity-main svelte-1kpvv0n"><h3 class="svelte-1kpvv0n"> </h3> <p class="feature-description svelte-1kpvv0n"><!></p> <div class="pool-tracker svelte-1kpvv0n"><input type="number" min="0" class="pool-input svelte-1kpvv0n"/> <span> </span> <button class="btn-small svelte-1kpvv0n"> </button></div> <!></div>'),Pi=u('<div class="spell-slots svelte-1kpvv0n"><label class="svelte-1kpvv0n"> </label> <div class="slots-tracker svelte-1kpvv0n"></div></div>'),Ii=u('<div class="all-spell-slots"></div>'),Ei=u('<div class="feature-box spellcasting svelte-1kpvv0n"><h3 class="svelte-1kpvv0n"> </h3> <div class="spell-stats svelte-1kpvv0n"><div class="spell-stat svelte-1kpvv0n"><label class="svelte-1kpvv0n">Spell Save DC</label> <div class="spell-value svelte-1kpvv0n"> </div></div> <div class="spell-stat svelte-1kpvv0n"><label class="svelte-1kpvv0n">Prepared Spells</label> <div class="spell-value svelte-1kpvv0n"> </div></div></div> <!> <div class="prepared-spells svelte-1kpvv0n"><label class="svelte-1kpvv0n">Prepared Spells</label> <textarea placeholder="List your prepared spells..." class="svelte-1kpvv0n"></textarea></div></div>'),Ui=u('<p class="unlimited svelte-1kpvv0n">Unlimited Uses</p>'),Ni=u('<div class="slots-tracker svelte-1kpvv0n"></div> <div class="uses-actions-row"><button class="btn btn-primary use-enabled"> </button></div> <div class="uses-info svelte-1kpvv0n"><span class="reset-info svelte-1kpvv0n"> </span></div>',1),Hi=u('<div class="uses-tracker svelte-1kpvv0n"><!></div>'),Oi=u('<div class="pool-tracker svelte-1kpvv0n"><input type="number" min="0" class="pool-input svelte-1kpvv0n"/> <span> </span> <button class="btn-small svelte-1kpvv0n"> </button></div>'),Gi=u('<div class="feature-box svelte-1kpvv0n"><h3 class="svelte-1kpvv0n"><!> </h3> <p class="feature-description svelte-1kpvv0n"> </p> <!></div>'),qi=u('<!> <div class="features-grid svelte-1kpvv0n"><!> <!></div>',1),Wi=u("<!> <!>",1),zi=u("<section><!> <!></section>");function Ki(r,c){Qt(c,!1);const t=()=>_t(pe,"$character",g),v=()=>_t(Xa,"$abilityModifiers",g),f=()=>_t(xa,"$searchFilter",g),p=()=>_t(la,"$collapsedStates",g),[g,S]=fa(),y=w(),_=w(),N=w(),F=w(),Q=w(),K=w(),ee=w(),H=w(),T=w(),I=w(),le=ka();let be=w(0),qe=w(0);function $e(h,P){pe.update(oe=>(oe.classFeatures.features[h]=P,oe))}function ue(){pe.update(h=>(h.classFeatures.spellSlotsByLevel||(h.classFeatures.spellSlotsByLevel={}),e(F).forEach(({level:P,slots:oe})=>{h.classFeatures.spellSlotsByLevel[P]||(h.classFeatures.spellSlotsByLevel[P]=Array(oe).fill(!1))}),h))}function ce(h){if(typeof h.maxUses=="function"){if((h.name==="Divine Sense"||h.name==="War Priest")&&e(y)?.spellcastingAbility){const P=v()[e(y).spellcastingAbility];return h.maxUses(t().level,P)}return h.maxUses(t().level)}return h.maxUses||0}function ye(h,P){pe.update(oe=>((!oe.classFeatures.features[h]||!Array.isArray(oe.classFeatures.features[h])||oe.classFeatures.features[h].length!==P)&&(oe.classFeatures.features[h]=Array(P).fill(!1)),oe))}Js(()=>{e(K)&&t()&&t().classFeatures&&t().classFeatures.features&&e(K).forEach(h=>{if(h.type==="uses"){const oe=M(h).replace(/\s+/g,""),et=ce(h),lt=t().classFeatures.features[oe];(!Array.isArray(lt)||lt.length!==et)&&ye(oe,et)}})});function We(h){return typeof h.maxPool=="function"?h.maxPool(t().level):h.maxPool||0}function R(h){if(typeof h.description=="function"){if(e(y)?.spellcastingAbility){const P=v()[e(y).spellcastingAbility];return h.description(t().level,P)}return h.description(t().level)}return h.description}function M(h){if(typeof h.name=="function"){if(e(y)?.spellcastingAbility){const P=v()[e(y).spellcastingAbility];return h.name(t().level,P)}return h.name(t().level)}return h.name}function x(h){if(typeof h.subName=="function"){if(e(y)?.spellcastingAbility){const P=v()[e(y).spellcastingAbility];return h.subName(t().level,P)}return h.subName(t().level)}return h.subName||null}function J(h){if(typeof h.rollFormula=="function"){if(e(y)?.spellcastingAbility){const P=v()[e(y).spellcastingAbility];return h.rollFormula(t().level,P)}return h.rollFormula(t().level)}return h.rollFormula||""}function W(h){const P="ChannelDivinity",oe=t().classFeatures.features[P];if(typeof oe=="number"&&oe>0){pe.update(lt=>(lt.classFeatures.features[P]=oe-1,lt));const et=M(h);if(h.rollable&&h.rollFormula){const lt=J(h);lt?le("roll",{notation:lt,attackName:et,rollType:"other"}):Ht.add(`Used ${et}`,"info")}else Ht.add(`Used ${et}`,"info")}}function me(){la.update(h=>({...h,classFeatures:!h.classFeatures}))}Xe(()=>(t(),ua),()=>{n(y,t().class?ua(t().class):null)}),Xe(()=>(t(),Ta),()=>{n(_,t().class?Ta(t().class,t().level,t().subclass):[])}),Xe(()=>(t(),Bs),()=>{n(N,t().class?Bs(t().class,t().level):0)}),Xe(()=>(e(y),t()),()=>{n(F,(()=>{if(!e(y)?.spellcaster)return[];const h=t().level,P=[];return h>=1&&P.push({level:1,slots:Math.min(4,2+Math.floor(h/3))}),h>=3&&P.push({level:2,slots:Math.min(3,2+Math.floor((h-3)/4))}),h>=5&&P.push({level:3,slots:Math.min(3,2+Math.floor((h-5)/5))}),h>=7&&P.push({level:4,slots:Math.min(3,1+Math.floor((h-7)/6))}),h>=9&&P.push({level:5,slots:Math.min(2,1+Math.floor((h-9)/8))}),h>=11&&P.push({level:6,slots:1}),h>=13&&P.push({level:7,slots:1}),h>=15&&P.push({level:8,slots:1}),h>=17&&P.push({level:9,slots:1}),P})())}),Xe(()=>(e(y),v(),t(),Rs),()=>{if(e(y)?.spellcaster&&e(y).spellcastingAbility){const h=v()[e(y).spellcastingAbility];n(be,Ll(t().class,h,t().proficiencyBonus)||0),n(qe,Rs(t().class,t().level,h))}}),Xe(()=>(t(),e(y),e(F)),()=>{t().class&&e(y)?.spellcaster&&e(F).length>0&&ue()}),Xe(()=>t(),()=>{n(Q,(()=>{const P=t().classFeatures.features["ChannelDivinity"];return typeof P=="number"?P:0})())}),Xe(()=>(e(_),f()),()=>{n(K,e(_).filter(h=>{if(!f())return!0;const P=f().toLowerCase();return M(h).toLowerCase().includes(P)||R(h).toLowerCase().includes(P)}))}),Xe(()=>e(K),()=>{n(ee,e(K).find(h=>h.type==="pool"&&M(h)==="Channel Divinity"))}),Xe(()=>e(K),()=>{n(H,e(K).flatMap(h=>{const P=[];return h.subFeatures&&P.push(...h.subFeatures),h.type==="channelDivinity"&&P.push(h),P}))}),Xe(()=>e(K),()=>{n(T,e(K).filter(h=>{const P=M(h);return!(h.type==="pool"&&P==="Channel Divinity"||h.type==="channelDivinity"||P==="Channel Divinity"&&h.subFeatures)}))}),Xe(()=>(f(),t(),e(K)),()=>{n(I,!f()||t().class||"class features".includes(f().toLowerCase())||"spellcasting".includes(f().toLowerCase())||e(K).length>0)}),ga(),Yt();var xe=zi();let Ne;var He=l(xe);{let h=xt(()=>(p(),i(()=>p().classFeatures?"Expand":"Collapse")));Da(He,{title:"Class Features",get collapsed(){return p(),i(()=>p().classFeatures)},get ariaLabel(){return e(h)},onToggle:me})}var Pe=a(He,2);{var Ie=h=>{var P=Wi(),oe=De(P);Di(oe,{});var et=a(oe,2);{var lt=Dt=>{var wt=Li();o(Dt,wt)},yt=Dt=>{var wt=$t(),C=De(wt);{var z=O=>{var Y=Ai();o(O,Y)},A=O=>{var Y=qi(),ge=De(Y);{var Ee=Z=>{const G=xt(()=>(e(ee),i(()=>M(e(ee))))),Be=xt(()=>(U(e(G)),i(()=>e(G).replace(/\s+/g,"")))),he=xt(()=>(t(),U(e(Be)),i(()=>t().classFeatures.features[e(Be)]))),ct=xt(()=>typeof e(he)=="number"),Le=xt(()=>(e(ee),i(()=>We(e(ee)))));var te=Fi(),d=l(te),st=l(d,!0);s(d);var we=a(d,2),q=l(we);ps(q,()=>(e(ee),i(()=>R(e(ee))))),s(we);var Se=a(we,2),de=l(Se);ke(de);var Je=a(de,2),Ge=l(Je);s(Je);var tt=a(Je,2),Oe=l(tt,!0);s(tt),s(Se);var Ye=a(Se,2);{var mt=X=>{var Qe=Ti();Lt(Qe,5,()=>e(H),Rt,(gt,b)=>{const E=xt(()=>(e(b),i(()=>M(e(b)))));var ie=Mi(),ne=l(ie),ve=l(ne,!0);s(ne);var Re=a(ne,2);{var Ke=_e=>{var ae=ji(),fe=l(ae,!0);s(ae),D(Ze=>$(fe,Ze),[()=>(e(b),i(()=>x(e(b))))]),o(_e,ae)};m(Re,_e=>{e(b),i(()=>e(b).subName)&&_e(Ke)})}var Me=a(Re,2),re=l(Me);ps(re,()=>(e(b),i(()=>R(e(b))))),s(Me);var V=a(Me,2);{var vt=_e=>{var ae=Ri(),fe=l(ae),Ze=l(fe);{var St=Te=>{var kt=Tt();D(()=>$(kt,`Roll ${e(E)??""}`)),o(Te,kt)},ot=Te=>{var kt=Tt();D(()=>$(kt,`Use ${e(E)??""}`)),o(Te,kt)};m(Ze,Te=>{e(b),i(()=>e(b).rollable&&J(e(b)))?Te(St):Te(ot,!1)})}s(fe);var se=a(fe,2);{var Gt=Te=>{var kt=Bi();o(Te,kt)};m(se,Te=>{e(Q)<=0&&Te(Gt)})}s(ae),D(()=>fe.disabled=e(Q)<=0),B("click",fe,()=>W(e(b))),o(_e,ae)};m(V,_e=>{e(b),i(()=>e(b).type==="channelDivinity")&&_e(vt)})}s(ie),D(()=>$(ve,e(E))),o(gt,ie)}),s(Qe),o(X,Qe)};m(Ye,X=>{e(H),i(()=>e(H).length>0)&&X(mt)})}s(te),D(()=>{$(st,e(G)),Ra(de,e(ct)&&e(he)!==void 0?e(he):e(Le)),ut(de,"max",e(Le)),$(Ge,`/ ${e(Le)??""}`),$(Oe,(e(ee),i(()=>e(ee).resetOn==="short"?"Short Rest":"Long Rest")))}),B("input",de,X=>{pe.update(Qe=>(Qe.classFeatures.features[e(Be)]=parseInt(X.currentTarget.value)||0,Qe))}),B("click",tt,()=>$e(e(Be),e(Le))),o(Z,te)};m(ge,Z=>{e(ee)&&Z(Ee)})}var Ae=a(ge,2),Fe=l(Ae);{var je=Z=>{var G=Ei(),Be=l(G),he=l(Be);s(Be);var ct=a(Be,2),Le=l(ct),te=a(l(Le),2),d=l(te,!0);s(te),s(Le);var st=a(Le,2),we=a(l(st),2),q=l(we,!0);s(we),s(st),s(ct);var Se=a(ct,2);{var de=tt=>{var Oe=Ii();Lt(Oe,5,()=>e(F),Rt,(Ye,mt)=>{let X=()=>e(mt).level,Qe=()=>e(mt).slots;const gt=xt(()=>(t(),X(),Qe(),i(()=>t().classFeatures.spellSlotsByLevel?.[X()]||Array(Qe()).fill(!1))));var b=Pi(),E=l(b),ie=l(E);s(E);var ne=a(E,2);Lt(ne,5,()=>e(gt),Rt,(ve,Re,Ke)=>{{let Me=xt(()=>(U(e(gt)),i(()=>e(gt)[Ke]||!1)));Ts(ve,{get checked(){return e(Me)},$$events:{change:re=>{pe.update(V=>(V.classFeatures.spellSlotsByLevel||(V.classFeatures.spellSlotsByLevel={}),V.classFeatures.spellSlotsByLevel[X()]||(V.classFeatures.spellSlotsByLevel[X()]=Array(Qe()).fill(!1)),V.classFeatures.spellSlotsByLevel[X()][Ke]=re.detail.checked,V))}}})}}),s(ne),s(b),D(()=>$(ie,`${X()===1?"1st":X()===2?"2nd":X()===3?"3rd":`${X()}th`} Level Spell Slots`)),o(Ye,b)}),s(Oe),o(tt,Oe)};m(Se,tt=>{e(F),i(()=>e(F).length>0)&&tt(de)})}var Je=a(Se,2),Ge=a(l(Je),2);ja(Ge),s(Je),s(G),D(tt=>{$(he,`Spellcasting (${tt??""})`),$(d,e(be)),$(q,e(qe))},[()=>(e(y),i(()=>e(y).spellcastingAbility?.toUpperCase()))]),ze(Ge,()=>t().classFeatures.preparedSpells,tt=>Ot(pe,i(t).classFeatures.preparedSpells=tt,i(t))),o(Z,G)};m(Fe,Z=>{e(y),i(()=>e(y)?.spellcaster)&&Z(je)})}var k=a(Fe,2);Lt(k,1,()=>e(T),Rt,(Z,G)=>{const Be=xt(()=>(e(G),i(()=>M(e(G))))),he=xt(()=>(U(e(Be)),i(()=>e(Be).replace(/\s+/g,"")))),ct=xt(()=>(t(),U(e(he)),i(()=>t().classFeatures.features[e(he)]))),Le=xt(()=>typeof e(ct)=="number");var te=Gi(),d=l(te),st=l(d);{var we=Oe=>{var Ye=Tt("Channel Divinity:");o(Oe,Ye)};m(st,Oe=>{e(G),i(()=>e(G).type==="channelDivinity")&&Oe(we)})}var q=a(st);s(d);var Se=a(d,2),de=l(Se,!0);s(Se);var Je=a(Se,2);{var Ge=Oe=>{const Ye=xt(()=>(e(G),i(()=>ce(e(G))))),mt=xt(()=>(U(e(ct)),U(e(Ye)),i(()=>Array.isArray(e(ct))?e(ct):Array(e(Ye)).fill(!1))));var X=Hi(),Qe=l(X);{var gt=E=>{var ie=Ui();o(E,ie)},b=E=>{var ie=Ni(),ne=De(ie);Lt(ne,5,()=>e(mt),Rt,(vt,_e,ae)=>{Ts(vt,{get checked(){return e(_e)},index:ae,$$events:{change:fe=>{pe.update(Ze=>(Ze.classFeatures.features[e(he)]||(Ze.classFeatures.features[e(he)]=Array(e(Ye)).fill(!1)),Ze.classFeatures.features[e(he)][ae]=fe.detail.checked,Ze))}}})}),s(ne);var ve=a(ne,2),Re=l(ve),Ke=l(Re);s(Re),s(ve);var Me=a(ve,2),re=l(Me),V=l(re);s(re),s(Me),D(vt=>{Re.disabled=vt,$(Ke,`Use ${e(Be)??""}`),$(V,`Resets on ${e(G),i(()=>e(G).resetOn==="short"?"Short Rest":"Long Rest")??""}`)},[()=>(U(e(mt)),i(()=>e(mt).filter(vt=>!vt).length<=0))]),B("click",Re,()=>{pe.update(vt=>{vt.classFeatures.features[e(he)]||(vt.classFeatures.features[e(he)]=Array(e(Ye)).fill(!1));const _e=vt.classFeatures.features[e(he)],ae=_e.findIndex(fe=>!fe);return ae!==-1&&(_e[ae]=!0),vt})}),o(E,ie)};m(Qe,E=>{e(Ye)===1/0?E(gt):E(b,!1)})}s(X),o(Oe,X)},tt=Oe=>{var Ye=$t(),mt=De(Ye);{var X=Qe=>{const gt=xt(()=>(e(G),i(()=>We(e(G)))));var b=Oi(),E=l(b);ke(E);var ie=a(E,2),ne=l(ie);s(ie);var ve=a(ie,2),Re=l(ve,!0);s(ve),s(b),D(()=>{Ra(E,e(Le)&&e(ct)!==void 0?e(ct):e(gt)),ut(E,"max",e(gt)),$(ne,`/ ${e(gt)??""}`),$(Re,(e(G),i(()=>e(G).resetOn==="short"?"Short Rest":"Long Rest")))}),B("input",E,Ke=>{pe.update(Me=>(Me.classFeatures.features[e(he)]=parseInt(Ke.currentTarget.value)||0,Me))}),B("click",ve,()=>$e(e(he),e(gt))),o(Qe,b)};m(mt,Qe=>{e(G),i(()=>e(G).type==="pool")&&Qe(X)},!0)}o(Oe,Ye)};m(Je,Oe=>{e(G),i(()=>e(G).type==="uses")?Oe(Ge):Oe(tt,!1)})}s(te),D(Oe=>{$(q,` ${e(Be)??""}`),$(de,Oe)},[()=>(e(G),i(()=>R(e(G))))]),o(Z,te)}),s(Ae),o(O,Y)};m(C,O=>{e(_),i(()=>e(_).length===0)?O(z):O(A,!1)},!0)}o(Dt,wt)};m(et,Dt=>{t(),i(()=>!t().class)?Dt(lt):Dt(yt,!1)})}o(h,P)};m(Pe,h=>{p(),i(()=>!p().classFeatures)&&h(Ie)})}s(xe),D(()=>Ne=Et(xe,1,"class-features svelte-1kpvv0n",null,Ne,{hidden:!e(I)})),o(r,xe),Xt(),S()}var Vi=u('<textarea placeholder="Enter features, traits, and special abilities..." class="svelte-wttn0l"></textarea> <h3 class="svelte-wttn0l">Equipment</h3> <textarea placeholder="List your equipment and inventory..." class="svelte-wttn0l"></textarea> <h3 class="svelte-wttn0l">Notes</h3> <textarea placeholder="Additional notes..." class="svelte-wttn0l"></textarea>',1),Ji=u("<section><!> <!></section>");function Yi(r,c){Qt(c,!1);const t=()=>_t(xa,"$searchFilter",p),v=()=>_t(pe,"$character",p),f=()=>_t(la,"$collapsedStates",p),[p,g]=fa(),S=w();function y(){la.update(ee=>({...ee,notes:!ee.notes}))}Xe(()=>(t(),v()),()=>{n(S,!t()||"features".includes(t().toLowerCase())||"traits".includes(t().toLowerCase())||"equipment".includes(t().toLowerCase())||"notes".includes(t().toLowerCase())||v().features.toLowerCase().includes(t().toLowerCase())||v().equipment.toLowerCase().includes(t().toLowerCase())||v().notes.toLowerCase().includes(t().toLowerCase()))}),ga(),Yt();var _=Ji();let N;var F=l(_);{let ee=xt(()=>(f(),i(()=>f().notes?"Expand":"Collapse")));Da(F,{title:"Features & Traits",get collapsed(){return f(),i(()=>f().notes)},get ariaLabel(){return e(ee)},onToggle:y})}var Q=a(F,2);{var K=ee=>{var H=Vi(),T=De(H);ja(T);var I=a(T,4);ja(I);var le=a(I,4);ja(le),ze(T,()=>v().features,be=>Ot(pe,i(v).features=be,i(v))),ze(I,()=>v().equipment,be=>Ot(pe,i(v).equipment=be,i(v))),ze(le,()=>v().notes,be=>Ot(pe,i(v).notes=be,i(v))),o(ee,H)};m(Q,ee=>{f(),i(()=>!f().notes)&&ee(K)})}s(_),D(()=>N=Et(_,1,"notes svelte-wttn0l",null,N,{hidden:!e(S)})),o(r,_),Xt(),g()}var Qi=u(" <!> <!> <!> <!> <!>",1),Xi=u('<div class="color-picker-section svelte-1r90jgp"><h3 class="svelte-1r90jgp">Dice Colors</h3> <div class="color-inputs svelte-1r90jgp"><div class="color-input-group svelte-1r90jgp"><label for="dice-color" class="svelte-1r90jgp">Dice Color</label> <input type="color" id="dice-color" class="svelte-1r90jgp"/></div> <div class="color-input-group svelte-1r90jgp"><label for="label-color" class="svelte-1r90jgp">Label Color</label> <input type="color" id="label-color" class="svelte-1r90jgp"/></div> <div class="color-input-group svelte-1r90jgp"><label for="desk-color" class="svelte-1r90jgp">Background Color</label> <input type="color" id="desk-color" class="svelte-1r90jgp"/></div></div></div>'),Zi=u('<div class="loading svelte-1r90jgp"><p class="svelte-1r90jgp">Loading 3D dice...</p></div>'),en=u('<div class="custom-dice-selector svelte-1r90jgp"><h3 class="svelte-1r90jgp">Choose Dice to Roll</h3> <div class="dice-inputs svelte-1r90jgp"><div class="dice-input-group svelte-1r90jgp"><label for="d4" class="svelte-1r90jgp">d4</label> <input class="use-enabled svelte-1r90jgp" type="number" id="d4" min="0" max="10"/></div> <div class="dice-input-group svelte-1r90jgp"><label for="d6" class="svelte-1r90jgp">d6</label> <input class="use-enabled svelte-1r90jgp" type="number" id="d6" min="0" max="10"/></div> <div class="dice-input-group svelte-1r90jgp"><label for="d8" class="svelte-1r90jgp">d8</label> <input class="use-enabled svelte-1r90jgp" type="number" id="d8" min="0" max="10"/></div> <div class="dice-input-group svelte-1r90jgp"><label for="d10" class="svelte-1r90jgp">d10</label> <input class="use-enabled svelte-1r90jgp" type="number" id="d10" min="0" max="10"/></div> <div class="dice-input-group svelte-1r90jgp"><label for="d12" class="svelte-1r90jgp">d12</label> <input class="use-enabled svelte-1r90jgp" type="number" id="d12" min="0" max="10"/></div> <div class="dice-input-group svelte-1r90jgp"><label for="d20" class="svelte-1r90jgp">d20</label> <input class="use-enabled svelte-1r90jgp" type="number" id="d20" min="0" max="10"/></div></div> <div class="dice-controls svelte-1r90jgp"><button class="btn btn-primary use-enabled svelte-1r90jgp"> </button> <button class="btn btn-secondary use-enabled svelte-1r90jgp">Reset</button></div></div>'),tn=u('<h3 class="svelte-1r90jgp"> </h3>'),an=u('<h3 class="svelte-1r90jgp"> </h3>'),sn=u('<h3 class="svelte-1r90jgp"> </h3>'),ln=u('<h3 class="svelte-1r90jgp"> </h3>'),rn=u('<span class="crit-badge svelte-1r90jgp">CRITICAL HIT!</span>'),nn=u('<span class="crit-badge crit-fail svelte-1r90jgp">CRITICAL MISS!</span>'),on=u('<div class="bonus-item svelte-1r90jgp"><span class="bonus-value svelte-1r90jgp"> </span> <span class="bonus-source svelte-1r90jgp"> </span></div>'),cn=u('<div class="bonus-breakdown svelte-1r90jgp"></div>'),vn=u('<p class="modifier-text svelte-1r90jgp"> </p>'),dn=u('<div class="svelte-1r90jgp"><em class="svelte-1r90jgp">No damage is dealt on a critical miss.</em></div>'),un=u('<button class="btn btn-follow-up svelte-1r90jgp"> </button>'),fn=u('<button class="btn btn-guided-strike svelte-1r90jgp">‚ö° Use Guided Strike (+10)</button>'),pn=u('<div class="follow-up-actions svelte-1r90jgp"><!> <!></div>'),mn=u('<div class="result-header svelte-1r90jgp"><!> <!> <!></div> <div class="result-total svelte-1r90jgp"> </div> <div class="result-details svelte-1r90jgp"><!></div> <!> <!>',1),gn=u('<div role="button" tabindex="-1"><div class="modal-content svelte-1r90jgp" role="dialog" tabindex="0"><div class="modal-header svelte-1r90jgp"><h2 class="svelte-1r90jgp"><!></h2> <div class="header-buttons svelte-1r90jgp"><button class="color-btn svelte-1r90jgp" title="Customize dice colors">üé®</button> <button class="close-btn svelte-1r90jgp">√ó</button></div></div> <!> <!> <div class="dice-main-area svelte-1r90jgp"><div class="dice-container svelte-1r90jgp"></div> <!></div> <div><!></div></div></div>');function bn(r,c){Qt(c,!1);const t=()=>_t(pe,"$character",v),[v,f]=fa(),p=w(),g=w(),S=w(),y=ka();let _=Bt(c,"notation",12,""),N=Bt(c,"visible",8,!1),F=Bt(c,"damageNotation",12,""),Q=Bt(c,"damageType",8,""),K=Bt(c,"attackName",12,""),ee=Bt(c,"applyHalfDamage",8,!1),H=Bt(c,"bonusBreakdown",28,()=>[]),T=Bt(c,"rollType",12,"other"),I=Bt(c,"damageBreakdown",24,()=>[]),le=null,be=w(void 0),qe=w(!1),$e=w(""),ue=w(null),ce=w("");function ye(){return e(ue)?.resultTotal??null}function We(b,E,ie){const ne=[];if(!b||!b.result)return ne;const ve=E.match(/([+-]?\d*d\d+|[+-]?\d+)/g)||[];let Re=0;const Ke=new Set;let Me=!0;for(const re of ve){const V=re.trim();if(!V)continue;const vt=V.match(/([+-]?)(\d*)d(\d+)/);if(vt){const _e=parseInt(vt[2]||"1"),ae=`${_e}d${vt[3]}`,fe=ie.findIndex((ot,se)=>!Ke.has(se)&&typeof ot.value=="string"&&ot.value===ae),Ze=[];for(let ot=0;ot<_e&&Re<b.result.length;ot++)Ze.push(b.result[Re++]);let St;fe>=0?(St=ie[fe].source,Ke.add(fe)):St="base";for(const ot of Ze)ne.push({display:`${ot}`,source:St});Me=!1}}for(let re=0;re<ie.length;re++)if(!Ke.has(re)&&typeof ie[re].value=="number"){const V=ie[re].value;ne.push({display:V>=0?`+${V}`:`${V}`,source:ie[re].source})}return ne}let R=w(0),M=w(0),x=w(0),J=w(0),W=w(0),me=w(0),xe=w(0),Ne=w([]),He=w(!1),Pe=w(!1),Ie=w(!1),h=w("#051e0a"),P=w("#ffffff"),oe=w("#3a2004"),et=w(!1);function lt(b){return b.length===9&&b.startsWith("#")?b.substring(0,7):b}function yt(b,E="ff"){return b.length===7&&b.startsWith("#")?b+E:b}function Dt(){if(window.DICE&&e(be))try{le&&e(be)&&_a(be,e(be).innerHTML="");const b=e(be).clientWidth||500,E=e(be).clientHeight||300;le=new window.DICE.dice_box(e(be),{w:b,h:E}),n(qe,!0)}catch(b){console.error("Error initializing dice box:",b)}}Ca(()=>{const b=ne=>new Promise((ve,Re)=>{if(document.querySelector(`script[src="${ne}"]`)){ve(null);return}const Me=document.createElement("script");Me.src=ne,Me.onload=()=>{ve(null)},Me.onerror=()=>{console.error(`Failed to load: ${ne}`),Re(new Error(`Failed to load ${ne}`))},document.head.appendChild(Me)});setTimeout(()=>{b(`${Ia}/libs/three.min.js`).then(()=>b(`${Ia}/libs/cannon.min.js`)).then(()=>b(`${Ia}/libs/teal.js`)).then(()=>b(`${Ia}/dice.js`)).then(()=>{if(window.DICE){const ne=window.DICE.getColors();n(h,lt(ne.dice_color)),n(P,lt(ne.label_color)),n(oe,lt(ne.desk_color))}Dt()}).catch(ne=>{console.error("Failed to load dice libraries:",ne)})},100);const E=()=>{e(qe)&&Dt()},ie=ne=>{N()&&ne.key==="Escape"&&Ae()};return window.addEventListener("resize",E),window.addEventListener("keydown",ie),()=>{window.removeEventListener("resize",E),window.removeEventListener("keydown",ie)}});function wt(b,E="other"){if(!le||!e(qe))return;n(ue,null),n(Ne,[]),n(He,!1),n(Pe,!1),T(E),n(Ie,!1),n(ce,b),le.diceToRoll=b;const ie=ve=>null,ne=ve=>{let Re=ve.resultTotal,Ke=ve.resultString;if(ee()&&(Re=Math.floor(Re/2),Ke=Ke+" (halved)"),n(ue,{...ve,resultTotal:Re,resultString:Ke}),E==="attack"&&ve.result&&ve.result.length>0){const Me=ve.result[0];n(He,Me===20),n(Pe,Me===1)}if(n(Ne,[]),E==="attack"){if(F())if(e(He)){const Me=A(F()),re=I().map(V=>{if(typeof V.value=="string"&&V.value.match(/^\d+d\d+$/)){const vt=A(V.value);return{...V,value:vt}}return V});e(Ne).push({label:`Roll Critical Damage (${Me})`,notation:Me,breakdown:re})}else e(Pe)||e(Ne).push({label:`Roll Damage (${F()})`,notation:F(),breakdown:I()});if(K()&&F()&&t().class?.toLowerCase()==="rogue"&&t().features?.toLowerCase?.().includes("sneak attack")){const Me=`${F()}+3d6`,re=[...I(),{value:"3d6",source:"Sneak Attack"}];e(Ne).push({label:`Roll Damage + Sneak Attack (${Me})`,notation:Me,breakdown:re})}}};le.start_throw(ie,ne)}function C(){const b=[];e(R)>0&&b.push(`${e(R)}d4`),e(M)>0&&b.push(`${e(M)}d6`),e(x)>0&&b.push(`${e(x)}d8`),e(J)>0&&b.push(`${e(J)}d10`),e(W)>0&&b.push(`${e(W)}d12`),e(me)>0&&b.push(`${e(me)}d20`);let E=b.join("+")||"1d20";return e(xe)!==0&&(E+=e(xe)>=0?`+${e(xe)}`:`${e(xe)}`),E}function z(){const b=C();wt(b)}function A(b){return b.replace(/(\d+)d(\d+)/g,(E,ie,ne)=>`${parseInt(ie)*2}d${ne}`)}function O(){n(R,0),n(M,0),n(x,0),n(J,0),n(W,0),n(me,0),n(xe,0),n(ue,null),n(Ne,[]),n(He,!1),n(Pe,!1),T("other"),n(Ie,!1)}function Y(){window.DICE&&(window.DICE.setColors({dice_color:yt(e(h),"ff"),label_color:yt(e(P),"ff"),desk_color:e(oe)}),le&&(le.updateDeskColor(e(oe)),le.updateDiceColors()))}function ge(){n(et,!e(et))}function Ee(){!e(ue)||e(g)<=0||e(Ie)||(n(ue,{...e(ue),resultTotal:e(ue).resultTotal+10,resultString:e(ue).resultString+" + 10 (Guided Strike)"}),H([...H(),{value:10,source:"Guided Strike"}]),pe.update(b=>{const E="ChannelDivinity",ie=b.classFeatures.features[E];return typeof ie=="number"&&ie>0&&(b.classFeatures.features[E]=ie-1),b}),n(Ie,!0))}function Ae(){y("close"),_(""),F(""),K(""),n($e,""),n(ue,null),n(Ie,!1),n(He,!1),n(Pe,!1),O()}Xe(()=>(t(),Ta),()=>{n(p,t().class?Ta(t().class,t().level,t().subclass).some(E=>E.name==="Guided Strike"):!1)}),Xe(()=>t(),()=>{n(g,(()=>{const E=t().classFeatures.features["ChannelDivinity"];return typeof E=="number"?E:0})())}),Xe(()=>(e(R),e(M),e(x),e(J),e(W),e(me),e(xe)),()=>{n(S,(()=>{const b=[];e(R)>0&&b.push(`${e(R)}d4`),e(M)>0&&b.push(`${e(M)}d6`),e(x)>0&&b.push(`${e(x)}d8`),e(J)>0&&b.push(`${e(J)}d10`),e(W)>0&&b.push(`${e(W)}d12`),e(me)>0&&b.push(`${e(me)}d20`);let E=b.join("+")||"1d20";return e(xe)!==0&&(E+=e(xe)>=0?`+${e(xe)}`:`${e(xe)}`),E})())}),Xe(()=>(U(_()),e(qe),U(N()),e($e),U(T())),()=>{_()&&e(qe)&&N()&&_()!==e($e)&&(n($e,_()),n(ue,null),n(Ne,[]),n(He,!1),n(Pe,!1),n(Ie,!1),setTimeout(()=>wt(_(),T()),200))}),ga();var Fe={getLastRollTotal:ye};Yt();var je=gn();let k;var Z=l(je),G=l(Z),Be=l(G),he=l(Be);{var ct=b=>{var E=Qi(),ie=De(E),ne=a(ie);{var ve=fe=>{var Ze=Tt("- Attack Roll");o(fe,Ze)};m(ne,fe=>{T()==="attack"&&fe(ve)})}var Re=a(ne,2);{var Ke=fe=>{var Ze=Tt("- Damage Roll");o(fe,Ze)};m(Re,fe=>{T()==="damage"&&fe(Ke)})}var Me=a(Re,2);{var re=fe=>{var Ze=Tt("- Healing Roll");o(fe,Ze)};m(Me,fe=>{T()==="healing"&&fe(re)})}var V=a(Me,2);{var vt=fe=>{var Ze=Tt("- Ability Check");o(fe,Ze)};m(V,fe=>{T()==="check"&&fe(vt)})}var _e=a(V,2);{var ae=fe=>{var Ze=Tt("- Saving Throw");o(fe,Ze)};m(_e,fe=>{T()==="save"&&fe(ae)})}D(()=>$(ie,`${K()??""} `)),o(b,E)},Le=b=>{var E=Tt("Dice Roller");o(b,E)};m(he,b=>{K()?b(ct):b(Le,!1)})}s(Be);var te=a(Be,2),d=l(te),st=a(d,2);s(te),s(G);var we=a(G,2);{var q=b=>{var E=Xi(),ie=a(l(E),2),ne=l(ie),ve=a(l(ne),2);ke(ve),s(ne);var Re=a(ne,2),Ke=a(l(Re),2);ke(Ke),s(Re);var Me=a(Re,2),re=a(l(Me),2);ke(re),s(Me),s(ie),s(E),ze(ve,()=>e(h),V=>n(h,V)),B("change",ve,Y),ze(Ke,()=>e(P),V=>n(P,V)),B("change",Ke,Y),ze(re,()=>e(oe),V=>n(oe,V)),B("change",re,Y),o(b,E)};m(we,b=>{e(et)&&b(q)})}var Se=a(we,2);{var de=b=>{var E=Zi();o(b,E)};m(Se,b=>{e(qe)||b(de)})}var Je=a(Se,2),Ge=l(Je);Ua(Ge,b=>n(be,b),()=>e(be));var tt=a(Ge,2);{var Oe=b=>{var E=en(),ie=a(l(E),2),ne=l(ie),ve=a(l(ne),2);ke(ve),s(ne);var Re=a(ne,2),Ke=a(l(Re),2);ke(Ke),s(Re);var Me=a(Re,2),re=a(l(Me),2);ke(re),s(Me);var V=a(Me,2),vt=a(l(V),2);ke(vt),s(V);var _e=a(V,2),ae=a(l(_e),2);ke(ae),s(_e);var fe=a(_e,2),Ze=a(l(fe),2);ke(Ze),s(fe),s(ie);var St=a(ie,2),ot=l(St),se=l(ot);s(ot);var Gt=a(ot,2);s(St),s(E),D(()=>{ot.disabled=!e(qe),$(se,`Roll ${e(S)??""}`)}),ze(ve,()=>e(R),Te=>n(R,Te)),ze(Ke,()=>e(M),Te=>n(M,Te)),ze(re,()=>e(x),Te=>n(x,Te)),ze(vt,()=>e(J),Te=>n(J,Te)),ze(ae,()=>e(W),Te=>n(W,Te)),ze(Ze,()=>e(me),Te=>n(me,Te)),B("click",ot,z),B("click",Gt,O),o(b,E)};m(tt,b=>{_()||b(Oe)})}s(Je);var Ye=a(Je,2);let mt;var X=l(Ye);{var Qe=b=>{var E=mn(),ie=De(E),ne=l(ie);{var ve=Te=>{var kt=tn(),aa=l(kt,!0);s(kt),D(()=>$(aa,K()?`${K()} - Healing`:"Healing")),o(Te,kt)},Re=Te=>{var kt=$t(),aa=De(kt);{var sa=Ce=>{var Ue=an(),bt=l(Ue,!0);s(Ue),D(()=>$(bt,K()?`${K()} - ${Q()} Damage`:`${Q()} Damage`)),o(Ce,Ue)},j=Ce=>{var Ue=$t(),bt=De(Ue);{var L=rt=>{var ht=sn(),at=l(ht,!0);s(ht),D(()=>$(at,K()?`${K()} - Damage`:"Damage")),o(rt,ht)},ft=rt=>{var ht=ln(),at=l(ht,!0);s(ht),D(()=>$(at,K()?`${K()} - Result`:"Result")),o(rt,ht)};m(bt,rt=>{T()==="damage"?rt(L):rt(ft,!1)},!0)}o(Ce,Ue)};m(aa,Ce=>{T()==="damage"&&Q()?Ce(sa):Ce(j,!1)},!0)}o(Te,kt)};m(ne,Te=>{T()==="damage"&&Q()==="Healing"?Te(ve):Te(Re,!1)})}var Ke=a(ne,2);{var Me=Te=>{var kt=rn();o(Te,kt)};m(Ke,Te=>{e(He)&&Te(Me)})}var re=a(Ke,2);{var V=Te=>{var kt=nn();o(Te,kt)};m(re,Te=>{e(Pe)&&Te(V)})}s(ie);var vt=a(ie,2),_e=l(vt,!0);s(vt);var ae=a(vt,2),fe=l(ae);{var Ze=Te=>{var kt=$t(),aa=De(kt);{var sa=Ce=>{var Ue=cn();Lt(Ue,5,()=>(e(ue),e(ce),U(H()),i(()=>We(e(ue),e(ce),H()))),Rt,(bt,L)=>{var ft=on(),rt=l(ft),ht=l(rt,!0);s(rt);var at=a(rt,2),it=l(at);s(at),s(ft),D(()=>{$(ht,(e(L),i(()=>e(L).display))),$(it,`(${e(L),i(()=>e(L).source)??""})`)}),o(bt,ft)}),s(Ue),o(Ce,Ue)},j=Ce=>{var Ue=$t(),bt=De(Ue);{var L=ft=>{var rt=vn(),ht=l(rt);s(rt),D(()=>$(ht,`Modifier: ${e(ue),i(()=>e(ue).constant>=0?"+":"")??""}${e(ue),i(()=>e(ue).constant)??""}`)),o(ft,rt)};m(bt,ft=>{e(ue),i(()=>e(ue).constant)&&ft(L)},!0)}o(Ce,Ue)};m(aa,Ce=>{U(H()),i(()=>H().length>0)?Ce(sa):Ce(j,!1)})}o(Te,kt)};m(fe,Te=>{e(ue),U(H()),i(()=>e(ue).constant||H().length>0)&&Te(Ze)})}s(ae);var St=a(ae,2);{var ot=Te=>{var kt=dn();o(Te,kt)};m(St,Te=>{e(Pe)&&Te(ot)})}var se=a(St,2);{var Gt=Te=>{var kt=pn(),aa=l(kt);Lt(aa,1,()=>e(Ne),Rt,(Ce,Ue)=>{var bt=un(),L=l(bt,!0);s(bt),D(()=>$(L,(e(Ue),i(()=>e(Ue).label)))),B("click",bt,()=>{H(e(Ue).breakdown||[]),wt(e(Ue).notation,"damage")}),o(Ce,bt)});var sa=a(aa,2);{var j=Ce=>{var Ue=fn();D(()=>{Ue.disabled=e(g)<=0,ut(Ue,"title",e(g)<=0?"No Channel Divinity uses remaining":"Use Channel Divinity to add +10 to this attack roll")}),B("click",Ue,Ee),o(Ce,Ue)};m(sa,Ce=>{e(p)&&T()==="attack"&&!e(Ie)&&e(g)>0&&!e(Pe)&&Ce(j)})}s(kt),o(Te,kt)};m(se,Te=>{e(Ne),e(p),U(T()),e(Ie),e(g),i(()=>e(Ne).length>0||e(p)&&T()==="attack"&&!e(Ie)&&e(g)>0)&&Te(Gt)})}D(()=>$(_e,(e(ue),i(()=>e(ue).resultTotal)))),o(b,E)};m(X,b=>{e(ue)&&b(Qe)})}s(Ye),s(Z),s(je),D(()=>{k=Et(je,1,"modal-overlay svelte-1r90jgp",null,k,{hidden:!N()}),mt=Et(Ye,1,"roll-result svelte-1r90jgp",null,mt,{"has-result":e(ue)})}),B("click",d,ge),B("click",st,Ae),B("click",Z,xs(function(b){Ma.call(this,c,b)})),B("keydown",Z,function(b){Ma.call(this,c,b)}),B("click",je,Ae),B("keydown",je,b=>b.key==="Escape"&&Ae()),o(r,je),Cl(c,"getLastRollTotal",ye);var gt=Xt(Fe);return f(),gt}const Za="https://api.github.com/gists";async function hn(r,c,t){if(!c)throw new Error("GitHub token is required");const v=JSON.stringify(r,null,2),f=`${r.name||"character"}_dnd.json`,p={description:t||`D&D Character: ${r.name}`,public:!1,files:{[f]:{content:v}}},g=await fetch(Za,{method:"POST",headers:{Authorization:`token ${c}`,"Content-Type":"application/json"},body:JSON.stringify(p)});if(!g.ok)throw new Error(`Failed to create gist: ${g.statusText}`);return(await g.json()).id}async function _n(r,c,t){if(!c||!t)throw new Error("GitHub token and Gist ID are required");const v=JSON.stringify(r,null,2),p={files:{[`${r.name||"character"}_dnd.json`]:{content:v}}},g=await fetch(`${Za}/${t}`,{method:"PATCH",headers:{Authorization:`token ${c}`,"Content-Type":"application/json"},body:JSON.stringify(p)});if(!g.ok)throw new Error(`Failed to update gist: ${g.statusText}`)}async function yn(r,c){if(!r)throw new Error("Gist ID is required");const t={"Content-Type":"application/json"};c&&(t.Authorization=`token ${c}`);const v=await fetch(`${Za}/${r}`,{method:"GET",headers:t});if(!v.ok)throw new Error(`Failed to load gist: ${v.statusText}`);const f=await v.json(),p=Object.values(f.files);if(p.length===0)throw new Error("No files found in gist");const S=p[0].content;try{const y=JSON.parse(S);return y.attacks&&Array.isArray(y.attacks)&&(y.attacks=y.attacks.map(_=>({..._,id:_.id||crypto.randomUUID()}))),y.classFeatures?(y.classFeatures.features||(y.classFeatures.features={}),y.classFeatures.spellSlots||(y.classFeatures.spellSlots=[]),y.classFeatures.preparedSpells===void 0&&(y.classFeatures.preparedSpells="")):y.classFeatures={features:{},spellSlots:[],preparedSpells:""},y}catch{throw new Error("Invalid character data in gist")}}function Fs(r){typeof window<"u"&&localStorage.setItem("dnd_gist_config",JSON.stringify(r))}function xn(){if(typeof window<"u"){const r=localStorage.getItem("dnd_gist_config");if(r)return JSON.parse(r)}return{}}async function kn(r,c=30){if(!r)throw new Error("GitHub token is required to list gists");const t=await fetch(`${Za}?per_page=${c}`,{method:"GET",headers:{Authorization:`token ${r}`,"Content-Type":"application/json"}});if(!t.ok)throw new Error(`Failed to list gists: ${t.statusText}`);return await t.json()}var $n=u('<div class="error-message svelte-1jb5ckg"> </div>'),wn=u('<div class="toggle-container svelte-1jb5ckg"><button type="button" class="toggle-btn svelte-1jb5ckg"> </button></div>'),Sn=u('<div class="form-group svelte-1jb5ckg"><label for="gistId" class="svelte-1jb5ckg">Gist ID (leave empty to create new)</label> <input type="text" id="gistId" placeholder="Optional: existing Gist ID to update" class="svelte-1jb5ckg"/></div>'),Cn=u('<div class="loading-message svelte-1jb5ckg">Loading your gists...</div>'),Dn=u('<button type="button"><div class="gist-item-header svelte-1jb5ckg"><span class="gist-description svelte-1jb5ckg"> </span> <span class="gist-visibility svelte-1jb5ckg"> </span></div> <div class="gist-item-meta svelte-1jb5ckg"><span class="gist-id svelte-1jb5ckg"> </span> <span class="gist-date svelte-1jb5ckg"> </span></div></button>'),Ln=u('<div class="form-group svelte-1jb5ckg"><div class="gist-list-label svelte-1jb5ckg">Select a Gist to Update (or leave unselected to create new)</div> <div class="gist-list svelte-1jb5ckg"></div></div>'),An=u('<div class="info-message svelte-1jb5ckg">No gists found. A new one will be created.</div>'),jn=u('<!> <div class="form-group svelte-1jb5ckg"><label for="description" class="svelte-1jb5ckg"> </label> <input type="text" id="description" placeholder="D&amp;D Character Sheet" class="svelte-1jb5ckg"/></div>',1),Bn=u('<div class="form-group svelte-1jb5ckg"><label for="gistId" class="svelte-1jb5ckg">Gist ID *</label> <input type="text" id="gistId" placeholder="Enter Gist ID (for public or your private gists)" required class="svelte-1jb5ckg"/></div>'),Rn=u('<div class="loading-message svelte-1jb5ckg">Loading your gists...</div>'),Mn=u('<button type="button"><div class="gist-item-header svelte-1jb5ckg"><span class="gist-description svelte-1jb5ckg"> </span> <span class="gist-visibility svelte-1jb5ckg"> </span></div> <div class="gist-item-meta svelte-1jb5ckg"><span class="gist-id svelte-1jb5ckg"> </span> <span class="gist-date svelte-1jb5ckg"> </span></div></button>'),Tn=u('<div class="form-group svelte-1jb5ckg"><div class="gist-list-label svelte-1jb5ckg">Select a Gist to Load</div> <div class="gist-list svelte-1jb5ckg"></div></div>'),Fn=u('<div class="info-message svelte-1jb5ckg">No gists found. Enter a Gist ID manually or create a new one in Save mode.</div>'),Pn=u('<div class="modal-overlay svelte-1jb5ckg" role="button" tabindex="-1"><div class="modal-content svelte-1jb5ckg" role="dialog" tabindex="0"><div class="modal-header svelte-1jb5ckg"><h2 class="svelte-1jb5ckg"> </h2> <button class="close-btn svelte-1jb5ckg">√ó</button></div> <div class="modal-body svelte-1jb5ckg"><!> <div class="form-group svelte-1jb5ckg"><label for="token" class="svelte-1jb5ckg"> <a href="https://github.com/settings/tokens" target="_blank" rel="noopener" class="svelte-1jb5ckg">Get token</a></label> <input type="password" id="token" placeholder="ghp_xxxxxxxxxxxxx" class="svelte-1jb5ckg"/></div> <!> <!> <div class="modal-actions svelte-1jb5ckg"><button class="btn btn-primary svelte-1jb5ckg"><!></button> <button class="btn btn-secondary svelte-1jb5ckg">Cancel</button></div></div></div></div>');function In(r,c){Qt(c,!1);const t=()=>_t(pe,"$character",v),[v,f]=fa(),p=ka();let g=Bt(c,"mode",8,"save"),S=w(""),y=w(""),_=w(""),N=w(!1),F=w(""),Q=w(!1),K=w(!1),ee=w([]),H=w(null);const T=xn();T.token&&n(S,T.token),T.gistId&&n(y,T.gistId),Ca(async()=>{e(S)&&!e(Q)&&await I()});async function I(){if(e(S)){n(K,!0),n(F,"");try{n(ee,await kn(e(S))),e(y)&&n(H,e(ee).find(A=>A.id===e(y))||null)}catch(A){n(F,A.message||"Failed to load gists"),n(ee,[])}finally{n(K,!1)}}}function le(A){e(H)?.id===A.id?(n(H,null),n(y,"")):(n(H,A),n(y,A.id))}function be(){n(Q,!e(Q)),n(F,""),!e(Q)&&e(S)&&I()}async function qe(){if(!e(S)){n(F,"GitHub token is required");return}const A=e(H)?.id||e(y);n(N,!0),n(F,"");try{if(A)await _n(t(),e(S),A),n(y,A),Ht.add("Character updated in Gist successfully!","success");else{const O=await hn(t(),e(S),e(_));n(y,O),Ht.add(`Character saved to Gist! ID: ${O}`,"success")}Fs({token:e(S),gistId:e(y)}),p("close")}catch(O){n(F,O.message||"Failed to save to Gist")}finally{n(N,!1)}}async function $e(){const A=e(H)?.id||e(y);if(!A){n(F,"Please select a gist or enter a Gist ID");return}n(N,!0),n(F,"");try{const O=await yn(A,e(S)||void 0);pe.set(O),n(y,A),Fs({token:e(S),gistId:e(y)}),Ht.add("Character loaded from Gist successfully!","success"),p("close")}catch(O){n(F,O.message||"Failed to load from Gist")}finally{n(N,!1)}}function ue(){p("close")}Yt();var ce=Pn(),ye=l(ce),We=l(ye),R=l(We),M=l(R,!0);s(R);var x=a(R,2);s(We);var J=a(We,2),W=l(J);{var me=A=>{var O=$n(),Y=l(O,!0);s(O),D(()=>$(Y,e(F))),o(A,O)};m(W,A=>{e(F)&&A(me)})}var xe=a(W,2),Ne=l(xe),He=l(Ne);ta(),s(Ne);var Pe=a(Ne,2);ke(Pe),s(xe);var Ie=a(xe,2);{var h=A=>{var O=wn(),Y=l(O),ge=l(Y,!0);s(Y),s(O),D(()=>{Y.disabled=e(N),$(ge,e(Q)?"üìã Show My Gists":"‚úèÔ∏è Enter Gist ID Manually")}),B("click",Y,be),o(A,O)};m(Ie,A=>{(g()==="load"||g()==="save"&&e(S))&&A(h)})}var P=a(Ie,2);{var oe=A=>{var O=jn(),Y=De(O);{var ge=Z=>{var G=Sn(),Be=a(l(G),2);ke(Be),s(G),D(()=>Be.disabled=e(N)),ze(Be,()=>e(y),he=>n(y,he)),o(Z,G)},Ee=Z=>{var G=$t(),Be=De(G);{var he=Le=>{var te=Cn();o(Le,te)},ct=Le=>{var te=$t(),d=De(te);{var st=q=>{var Se=Ln(),de=a(l(Se),2);Lt(de,5,()=>e(ee),Rt,(Je,Ge)=>{var tt=Dn();let Oe;var Ye=l(tt),mt=l(Ye),X=l(mt,!0);s(mt);var Qe=a(mt,2),gt=l(Qe,!0);s(Qe),s(Ye);var b=a(Ye,2),E=l(b),ie=l(E);s(E);var ne=a(E,2),ve=l(ne);s(ne),s(b),s(tt),D(Re=>{Oe=Et(tt,1,"gist-item svelte-1jb5ckg",null,Oe,{selected:e(H)?.id===e(Ge).id}),tt.disabled=e(N),$(X,(e(Ge),i(()=>e(Ge).description||"Untitled"))),$(gt,(e(Ge),i(()=>e(Ge).public?"üåê Public":"üîí Private"))),$(ie,`ID: ${e(Ge),i(()=>e(Ge).id)??""}`),$(ve,`Updated: ${Re??""}`)},[()=>(e(Ge),i(()=>new Date(e(Ge).updated_at).toLocaleDateString()))]),B("click",tt,()=>le(e(Ge))),o(Je,tt)}),s(de),s(Se),o(q,Se)},we=q=>{var Se=$t(),de=De(Se);{var Je=Ge=>{var tt=An();o(Ge,tt)};m(de,Ge=>{e(S)&&Ge(Je)},!0)}o(q,Se)};m(d,q=>{e(ee),i(()=>e(ee).length>0)?q(st):q(we,!1)},!0)}o(Le,te)};m(Be,Le=>{e(K)?Le(he):Le(ct,!1)},!0)}o(Z,G)};m(Y,Z=>{e(Q)||!e(S)?Z(ge):Z(Ee,!1)})}var Ae=a(Y,2),Fe=l(Ae),je=l(Fe);s(Fe);var k=a(Fe,2);ke(k),s(Ae),D(()=>{$(je,`Description ${e(y)?"(optional)":""}`),k.disabled=e(N)}),ze(k,()=>e(_),Z=>n(_,Z)),o(A,O)},et=A=>{var O=$t(),Y=De(O);{var ge=Ae=>{var Fe=Bn(),je=a(l(Fe),2);ke(je),s(Fe),D(()=>je.disabled=e(N)),ze(je,()=>e(y),k=>n(y,k)),o(Ae,Fe)},Ee=Ae=>{var Fe=$t(),je=De(Fe);{var k=G=>{var Be=Rn();o(G,Be)},Z=G=>{var Be=$t(),he=De(Be);{var ct=te=>{var d=Tn(),st=a(l(d),2);Lt(st,5,()=>e(ee),Rt,(we,q)=>{var Se=Mn();let de;var Je=l(Se),Ge=l(Je),tt=l(Ge,!0);s(Ge);var Oe=a(Ge,2),Ye=l(Oe,!0);s(Oe),s(Je);var mt=a(Je,2),X=l(mt),Qe=l(X);s(X);var gt=a(X,2),b=l(gt);s(gt),s(mt),s(Se),D(E=>{de=Et(Se,1,"gist-item svelte-1jb5ckg",null,de,{selected:e(H)?.id===e(q).id}),Se.disabled=e(N),$(tt,(e(q),i(()=>e(q).description||"Untitled"))),$(Ye,(e(q),i(()=>e(q).public?"üåê Public":"üîí Private"))),$(Qe,`ID: ${e(q),i(()=>e(q).id)??""}`),$(b,`Updated: ${E??""}`)},[()=>(e(q),i(()=>new Date(e(q).updated_at).toLocaleDateString()))]),B("click",Se,()=>le(e(q))),o(we,Se)}),s(st),s(d),o(te,d)},Le=te=>{var d=$t(),st=De(d);{var we=q=>{var Se=Fn();o(q,Se)};m(st,q=>{e(S)&&q(we)},!0)}o(te,d)};m(he,te=>{e(ee),i(()=>e(ee).length>0)?te(ct):te(Le,!1)},!0)}o(G,Be)};m(je,G=>{e(K)?G(k):G(Z,!1)},!0)}o(Ae,Fe)};m(Y,Ae=>{e(Q)||!e(S)?Ae(ge):Ae(Ee,!1)},!0)}o(A,O)};m(P,A=>{g()==="save"?A(oe):A(et,!1)})}var lt=a(P,2),yt=l(lt),Dt=l(yt);{var wt=A=>{var O=Tt();D(()=>$(O,g()==="save"?"Saving...":"Loading...")),o(A,O)},C=A=>{var O=Tt();D(()=>$(O,g()==="save"?"Save":"Load")),o(A,O)};m(Dt,A=>{e(N)?A(wt):A(C,!1)})}s(yt);var z=a(yt,2);s(lt),s(J),s(ye),s(ce),D(()=>{$(M,g()==="save"?"Save to GitHub Gist":"Load from GitHub Gist"),$(He,`GitHub Token ${g()==="load"?"(optional for public gists)":"(required)"} `),Pe.disabled=e(N),yt.disabled=e(N),z.disabled=e(N)}),B("click",x,ue),ze(Pe,()=>e(S),A=>n(S,A)),B("blur",Pe,()=>{e(S)&&!e(Q)&&I()}),B("click",yt,function(...A){(g()==="save"?qe:$e)?.apply(this,A)}),B("click",z,ue),B("click",ye,xs(function(A){Ma.call(this,c,A)})),B("keydown",ye,function(A){Ma.call(this,c,A)}),B("click",ce,ue),B("keydown",ce,A=>A.key==="Escape"&&ue()),o(r,ce),Xt(),f()}var En=u('<div class="loading svelte-1ngjemu">Loading D&D data...</div>'),Un=u("<option> </option>"),Nn=u('<select class="level-filter svelte-1ngjemu"><option>All Levels</option><option>Cantrip</option><!></select>'),Hn=u('<div class="no-results svelte-1ngjemu"> </div>'),On=u('<div class="item-meta svelte-1ngjemu"> </div>'),Gn=u('<div class="item-meta svelte-1ngjemu"> </div>'),qn=u('<button><div class="item-name svelte-1ngjemu"> </div> <!></button>'),Wn=u('<p class="higher-levels"><strong>At Higher Levels:</strong> </p>'),zn=u('<p class="cantrip-upgrade"><strong>Cantrip Upgrade:</strong> </p>'),Kn=u('<h3 class="svelte-1ngjemu"> </h3> <p class="spell-meta svelte-1ngjemu"><!> <!></p> <p class="spell-classes"><strong>Classes:</strong> </p> <div class="spell-stats svelte-1ngjemu"><div><strong>Casting Time:</strong> </div> <div><strong>Range:</strong> </div> <div><strong>Components:</strong> <!></div> <div><strong>Duration:</strong> <!> </div></div> <p class="description svelte-1ngjemu"> </p> <!> <!>',1),Vn=u('<p class="prerequisite svelte-1ngjemu"><strong>Prerequisite:</strong> </p>'),Jn=u('<h3 class="svelte-1ngjemu"> </h3> <!> <p class="description svelte-1ngjemu"> </p> <a target="_blank" rel="noopener" class="source-link svelte-1ngjemu">View Full Details ‚Üí</a>',1),Yn=u('<div class="item-details svelte-1ngjemu"><!></div>'),Qn=u('<div class="controls svelte-1ngjemu"><div class="tabs svelte-1ngjemu"><button> </button> <button> </button></div> <div class="search-controls svelte-1ngjemu"><input type="text" placeholder="Search by name or description..." class="search-input svelte-1ngjemu"/> <!></div></div> <div class="content-container svelte-1ngjemu"><div class="items-list svelte-1ngjemu"><!></div> <!></div>',1),Xn=u('<div class="modal-backdrop svelte-1ngjemu" role="presentation"><div class="modal svelte-1ngjemu" role="dialog" aria-modal="true" tabindex="-1"><div class="modal-header svelte-1ngjemu"><h2 class="svelte-1ngjemu">Browse D&D Spells & Feats</h2> <button class="close-btn svelte-1ngjemu" aria-label="Close">&times;</button></div> <div class="modal-body svelte-1ngjemu"><!></div> <div class="modal-footer svelte-1ngjemu"><button class="btn-secondary svelte-1ngjemu">Cancel</button> <button class="btn-primary svelte-1ngjemu">Add to Character Sheet</button></div></div></div>');function Zn(r,c){Qt(c,!1);const t=w(),v=w(),f=w();let p=Bt(c,"onClose",8),g=w("spell"),S=w(!0),y=w(""),_=w(null),N=w([]),F=w([]),Q=w(null);Ca(async()=>{n(S,!0);try{n(N,await Ws()),n(F,await fr())}catch(x){console.error("Failed to load data:",x)}finally{n(S,!1)}});function K(x){n(Q,x)}function ee(x){const J=x.match(/(\d+d\d+(?:\s*\+\s*\d+)?)/i);return J?J[1]:""}function H(x){const J=x.split(/\.( |$)/)[0].trim(),W=Array.from(x.matchAll(/\*\*(.*?)\*\*/g)).map(xe=>xe[1].replace(/\.$/,""));let me=J;return W.length&&(me+=" | Effects: "+W.join(", ")),me}function T(){if(e(Q)){if(e(g)==="spell"){const x=e(Q);pe.update(J=>{const me=[];x.range&&me.push(`Range: ${x.range}`),x.castingTime&&me.push(`Cast: ${x.castingTime}`),x.duration&&me.push(`Duration: ${x.duration}`),x.actionType==="Save"&&me.push("Saving throw spell"),x.components&&x.components.length>0&&me.push(`Components: ${x.components.join(", ")}`),x.material&&me.push(`Material: ${x.material}`);const xe=me.join(" | "),Ne=H(x.description),He={id:crypto.randomUUID(),name:`${x.name}${x.concentration?" (C)":""}${x.ritual?" (R)":""}`,bonus:x.actionType==="Attack"?5:0,damage:ee(x.description),damageType:`${x.school} (Lvl ${x.level})`,spellRef:x.name,infoNotes:xe,generalNotes:Ne,castAtLevel:x.level};return J.attacks=[...J.attacks,He],J})}else if(e(g)==="feat"){const x=e(Q);pe.update(J=>{const W=`${x.name}${x.prerequisite?` (Req: ${x.prerequisite})`:""}
${x.description}
`;return J.features=J.features?`${J.features}
${W}`:W,J})}n(Q,null),p()()}}Xe(()=>(e(_),e(N),e(y)),()=>{n(t,e(_)!==null?pr(Ms(e(N),e(y)),e(_)):Ms(e(N),e(y)))}),Xe(()=>(e(F),e(y)),()=>{n(v,mr(e(F),e(y)))}),Xe(()=>(e(g),e(t),e(v)),()=>{n(f,e(g)==="spell"?e(t):e(v))}),ga(),Yt();var I=Xn(),le=l(I),be=l(le),qe=a(l(be),2);s(be);var $e=a(be,2),ue=l($e);{var ce=x=>{var J=En();o(x,J)},ye=x=>{var J=Qn(),W=De(J),me=l(W),xe=l(me);let Ne;var He=l(xe);s(xe);var Pe=a(xe,2);let Ie;var h=l(Pe);s(Pe),s(me);var P=a(me,2),oe=l(P);ke(oe);var et=a(oe,2);{var lt=Y=>{var ge=Nn();D(()=>{e(_),Kt(()=>{})});var Ee=l(ge);Ee.value=(Ee.__value=null)??"";var Ae=a(Ee);Ae.value=Ae.__value=0;var Fe=a(Ae);Lt(Fe,0,()=>[1,2,3,4,5,6,7,8,9],Rt,(je,k)=>{var Z=Un(),G=l(Z);s(Z);var Be={};D(()=>{$(G,`Level ${k??""}`),Be!==(Be=k)&&(Z.value=(Z.__value=k)??"")}),o(je,Z)}),s(ge),Na(ge,()=>e(_),je=>n(_,je)),o(Y,ge)};m(et,Y=>{e(g)==="spell"&&Y(lt)})}s(P),s(W);var yt=a(W,2),Dt=l(yt),wt=l(Dt);{var C=Y=>{var ge=Hn(),Ee=l(ge);s(ge),D(()=>$(Ee,`No ${e(g)??""}s found`)),o(Y,ge)},z=Y=>{var ge=$t(),Ee=De(ge);Lt(Ee,1,()=>e(f),Rt,(Ae,Fe)=>{var je=qn();let k;var Z=l(je),G=l(Z,!0);s(Z);var Be=a(Z,2);{var he=Le=>{const te=xt(()=>e(Fe));var d=On(),st=l(d);s(d),D(()=>$(st,`Level ${U(e(te)),i(()=>e(te).level)??""} ‚Ä¢ ${U(e(te)),i(()=>e(te).school)??""}`)),o(Le,d)},ct=Le=>{const te=xt(()=>e(Fe));var d=$t(),st=De(d);{var we=q=>{var Se=Gn(),de=l(Se,!0);s(Se),D(()=>$(de,(U(e(te)),i(()=>e(te).prerequisite)))),o(q,Se)};m(st,q=>{U(e(te)),i(()=>e(te).prerequisite)&&q(we)})}o(Le,d)};m(Be,Le=>{e(g)==="spell"?Le(he):Le(ct,!1)})}s(je),D(()=>{k=Et(je,1,"item-card svelte-1ngjemu",null,k,{selected:e(Q)?.name===e(Fe).name}),$(G,(e(Fe),i(()=>e(Fe).name)))}),B("click",je,()=>K(e(Fe))),o(Ae,je)}),o(Y,ge)};m(wt,Y=>{e(f),i(()=>e(f).length===0)?Y(C):Y(z,!1)})}s(Dt);var A=a(Dt,2);{var O=Y=>{var ge=Yn(),Ee=l(ge);{var Ae=je=>{const k=xt(()=>e(Q));var Z=Kn(),G=De(Z),Be=l(G,!0);s(G);var he=a(G,2),ct=l(he);{var Le=re=>{var V=Tt();D(()=>$(V,`${U(e(k)),i(()=>e(k).school)??""} cantrip`)),o(re,V)},te=re=>{var V=Tt();D(()=>$(V,`Level ${U(e(k)),i(()=>e(k).level)??""} ${U(e(k)),i(()=>e(k).school)??""}`)),o(re,V)};m(ct,re=>{U(e(k)),i(()=>e(k).level===0)?re(Le):re(te,!1)})}var d=a(ct,2);{var st=re=>{var V=Tt("(ritual)");o(re,V)};m(d,re=>{U(e(k)),i(()=>e(k).ritual)&&re(st)})}s(he);var we=a(he,2),q=a(l(we));s(we);var Se=a(we,2),de=l(Se),Je=a(l(de));s(de);var Ge=a(de,2),tt=a(l(Ge));s(Ge);var Oe=a(Ge,2),Ye=a(l(Oe)),mt=a(Ye);{var X=re=>{var V=Tt();D(()=>$(V,`(${U(e(k)),i(()=>e(k).material)??""})`)),o(re,V)};m(mt,re=>{U(e(k)),i(()=>e(k).material)&&re(X)})}s(Oe);var Qe=a(Oe,2),gt=a(l(Qe),2);{var b=re=>{var V=Tt("Concentration,");o(re,V)};m(gt,re=>{U(e(k)),i(()=>e(k).concentration)&&re(b)})}var E=a(gt,1,!0);s(Qe),s(Se);var ie=a(Se,2),ne=l(ie,!0);s(ie);var ve=a(ie,2);{var Re=re=>{var V=Wn(),vt=a(l(V));s(V),D(()=>$(vt,` ${U(e(k)),i(()=>e(k).higherLevelSlot)??""}`)),o(re,V)};m(ve,re=>{U(e(k)),i(()=>e(k).higherLevelSlot)&&re(Re)})}var Ke=a(ve,2);{var Me=re=>{var V=zn(),vt=a(l(V));s(V),D(()=>$(vt,` ${U(e(k)),i(()=>e(k).cantripUpgrade)??""}`)),o(re,V)};m(Ke,re=>{U(e(k)),i(()=>e(k).cantripUpgrade)&&re(Me)})}D((re,V)=>{$(Be,(U(e(k)),i(()=>e(k).name))),$(q,` ${re??""}`),$(Je,` ${U(e(k)),i(()=>e(k).castingTime||e(k).actionType)??""}`),$(tt,` ${U(e(k)),i(()=>e(k).range)??""}`),$(Ye,` ${V??""}`),$(E,(U(e(k)),i(()=>e(k).duration))),$(ne,(U(e(k)),i(()=>e(k).description)))},[()=>(U(e(k)),i(()=>e(k).classes.join(", "))),()=>(U(e(k)),i(()=>e(k).components.join(", ").toUpperCase()))]),o(je,Z)},Fe=je=>{const k=xt(()=>e(Q));var Z=Jn(),G=De(Z),Be=l(G,!0);s(G);var he=a(G,2);{var ct=st=>{var we=Vn(),q=a(l(we));s(we),D(()=>$(q,` ${U(e(k)),i(()=>e(k).prerequisite)??""}`)),o(st,we)};m(he,st=>{U(e(k)),i(()=>e(k).prerequisite)&&st(ct)})}var Le=a(he,2),te=l(Le,!0);s(Le);var d=a(Le,2);D(()=>{$(Be,(U(e(k)),i(()=>e(k).name))),$(te,(U(e(k)),i(()=>e(k).description))),ut(d,"href",(U(e(k)),i(()=>e(k).source)))}),o(je,Z)};m(Ee,je=>{e(g)==="spell"?je(Ae):je(Fe,!1)})}s(ge),o(Y,ge)};m(A,Y=>{e(Q)&&Y(O)})}s(yt),D(()=>{Ne=Et(xe,1,"tab svelte-1ngjemu",null,Ne,{active:e(g)==="spell"}),$(He,`üìú Spells (${e(N),i(()=>e(N).length)??""})`),Ie=Et(Pe,1,"tab svelte-1ngjemu",null,Ie,{active:e(g)==="feat"}),$(h,`‚≠ê Feats (${e(F),i(()=>e(F).length)??""})`)}),B("click",xe,()=>{n(g,"spell"),n(Q,null),n(y,"")}),B("click",Pe,()=>{n(g,"feat"),n(Q,null),n(y,"")}),ze(oe,()=>e(y),Y=>n(y,Y)),o(x,J)};m(ue,x=>{e(S)?x(ce):x(ye,!1)})}s($e);var We=a($e,2),R=l(We),M=a(R,2);s(We),s(le),s(I),D(()=>M.disabled=!e(Q)),B("click",qe,function(...x){p()?.apply(this,x)}),B("click",R,function(...x){p()?.apply(this,x)}),B("click",M,T),B("click",le,xs(function(x){Ma.call(this,c,x)})),B("keydown",le,function(x){Ma.call(this,c,x)}),B("click",I,function(...x){p()?.apply(this,x)}),B("keydown",I,x=>x.key==="Escape"&&p()()),o(r,I),Xt()}var eo=u('<span class="resistance-tag svelte-gdwwx1"> <button type="button" class="tag-remove svelte-gdwwx1">√ó</button></span>'),to=u('<div class="resistance-list svelte-gdwwx1"></div>'),ao=u('<p class="ability-meta svelte-gdwwx1"> <!></p>'),so=u('<p class="ability-meta svelte-gdwwx1">Requires Reaction</p>'),lo=u('<div class="ability-card svelte-gdwwx1"><div class="ability-header svelte-gdwwx1"><strong class="svelte-gdwwx1"> </strong> <button type="button" class="ability-remove svelte-gdwwx1">√ó</button></div> <p class="ability-description svelte-gdwwx1"> </p> <!></div>'),ro=u('<div class="abilities-list svelte-gdwwx1"></div>'),io=u(`<div class="modal-backdrop svelte-gdwwx1" role="presentation"><div class="modal-content svelte-gdwwx1" role="dialog" aria-modal="true" aria-labelledby="modal-title"><div class="modal-header svelte-gdwwx1"><h3 id="modal-title" class="svelte-gdwwx1">Add Custom Condition</h3> <button class="btn-close svelte-gdwwx1" aria-label="Close">√ó</button></div> <div class="modal-body svelte-gdwwx1"><div class="form-group svelte-gdwwx1"><label for="conditionName" class="svelte-gdwwx1">Condition Name*</label> <input type="text" id="conditionName" placeholder="e.g., Cazna's Mark" class="svelte-gdwwx1"/></div> <div class="form-group svelte-gdwwx1"><label for="description" class="svelte-gdwwx1">Description</label> <textarea id="description" placeholder="Describe the condition..." rows="3" class="svelte-gdwwx1"></textarea></div> <div class="form-row svelte-gdwwx1"><div class="form-group svelte-gdwwx1"><label for="attackBonus" class="svelte-gdwwx1">Attack Bonus</label> <input type="text" id="attackBonus" placeholder="0 or 1d4" class="svelte-gdwwx1"/></div> <div class="form-group svelte-gdwwx1"><label for="damageBonus" class="svelte-gdwwx1">Damage Bonus</label> <input type="text" id="damageBonus" placeholder="0 or 1d6" class="svelte-gdwwx1"/></div> <div class="form-group svelte-gdwwx1"><label for="acBonus" class="svelte-gdwwx1">AC Bonus</label> <input type="number" id="acBonus" placeholder="0" class="svelte-gdwwx1"/></div></div> <div class="form-group svelte-gdwwx1"><label for="darkvision" class="svelte-gdwwx1">Darkvision (feet)</label> <input type="number" id="darkvision" placeholder="0" min="0" step="30" class="svelte-gdwwx1"/> <small class="help-text svelte-gdwwx1">Grant or extend darkvision (e.g., 60 for 60 feet)</small></div> <div class="form-group svelte-gdwwx1"><label class="svelte-gdwwx1">Damage Resistances</label> <div class="resistance-input-group svelte-gdwwx1"><input type="text" placeholder="e.g., cold, fire, poison" class="svelte-gdwwx1"/> <button type="button" class="btn-add svelte-gdwwx1">Add</button></div> <!></div> <div class="form-group svelte-gdwwx1"><label class="svelte-gdwwx1">Special Abilities</label> <div class="ability-form svelte-gdwwx1"><input type="text" placeholder="Ability name (e.g., Flicker of Deceit)" class="ability-name-input svelte-gdwwx1"/> <textarea placeholder="Ability description..." rows="2" class="ability-desc-input svelte-gdwwx1"></textarea> <div class="ability-options svelte-gdwwx1"><div class="ability-option svelte-gdwwx1"><label for="abilityUses" class="svelte-gdwwx1">Uses per rest</label> <input type="number" id="abilityUses" min="0" class="svelte-gdwwx1"/></div> <div class="ability-option svelte-gdwwx1"><label for="restType" class="svelte-gdwwx1">Rest type</label> <select id="restType" class="svelte-gdwwx1"><option>Short</option><option>Long</option></select></div> <div class="ability-option svelte-gdwwx1"><label class="svelte-gdwwx1"><input type="checkbox" class="svelte-gdwwx1"/> Requires Reaction</label></div></div> <button type="button" class="btn-add svelte-gdwwx1">Add Ability</button></div> <!></div></div> <div class="modal-footer svelte-gdwwx1"><button class="btn btn-secondary svelte-gdwwx1">Cancel</button> <button class="btn btn-primary svelte-gdwwx1">Add Condition</button></div></div></div>`);function no(r,c){Qt(c,!1);let t=Bt(c,"show",8,!1),v=Bt(c,"onSave",8),f=Bt(c,"onCancel",8),p=w(""),g=w(""),S=w(0),y=w(0),_=w(0),N=w(0),F=w([]),Q=w(""),K=w([]),ee=w(""),H=w(""),T=w(0),I=w("short"),le=w(!1);function be(){n(p,""),n(g,""),n(S,0),n(y,0),n(_,0),n(N,0),n(F,[]),n(Q,""),n(K,[]),n(ee,""),n(H,""),n(T,0),n(I,"short"),n(le,!1)}function qe(){e(Q).trim()&&(n(F,[...e(F),e(Q).trim()]),n(Q,""))}function $e(W){n(F,e(F).filter((me,xe)=>xe!==W))}function ue(){if(e(ee).trim()&&e(H).trim()){const W={name:e(ee).trim(),description:e(H).trim(),requiresReaction:e(le)};e(T)>0&&(W.usesPerRest=e(T),W.currentUses=e(T),W.restType=e(I)),n(K,[...e(K),W]),n(ee,""),n(H,""),n(T,0),n(I,"short"),n(le,!1)}}function ce(W){n(K,e(K).filter((me,xe)=>xe!==W))}function ye(){if(!e(p).trim()){alert("Please enter a condition name");return}const W={name:e(p).trim(),description:e(g).trim()||"Custom condition",attackBonus:e(S)||0,damageBonus:e(y)||0,target:"self"};e(_)!==0&&(W.acBonus=e(_)),e(N)>0&&(W.darkvision=e(N)),e(F).length>0&&(W.resistances=e(F)),e(K).length>0&&(W.abilities=e(K)),v()(W),be()}function We(){be(),f()()}function R(W){W.target===W.currentTarget&&We()}Yt();var M=$t(),x=De(M);{var J=W=>{var me=io(),xe=l(me),Ne=l(xe),He=a(l(Ne),2);s(Ne);var Pe=a(Ne,2),Ie=l(Pe),h=a(l(Ie),2);ke(h),s(Ie);var P=a(Ie,2),oe=a(l(P),2);ja(oe),s(P);var et=a(P,2),lt=l(et),yt=a(l(lt),2);ke(yt),s(lt);var Dt=a(lt,2),wt=a(l(Dt),2);ke(wt),s(Dt);var C=a(Dt,2),z=a(l(C),2);ke(z),s(C),s(et);var A=a(et,2),O=a(l(A),2);ke(O),ta(2),s(A);var Y=a(A,2),ge=a(l(Y),2),Ee=l(ge);ke(Ee);var Ae=a(Ee,2);s(ge);var Fe=a(ge,2);{var je=X=>{var Qe=to();Lt(Qe,5,()=>e(F),Rt,(gt,b,E)=>{var ie=eo(),ne=l(ie),ve=a(ne);s(ie),D(()=>{$(ne,`${e(b)??""} `),ut(ve,"aria-label",`Remove ${e(b)??""}`)}),B("click",ve,()=>$e(E)),o(gt,ie)}),s(Qe),o(X,Qe)};m(Fe,X=>{e(F),i(()=>e(F).length>0)&&X(je)})}s(Y);var k=a(Y,2),Z=a(l(k),2),G=l(Z);ke(G);var Be=a(G,2);ja(Be);var he=a(Be,2),ct=l(he),Le=a(l(ct),2);ke(Le),s(ct);var te=a(ct,2),d=a(l(te),2);D(()=>{e(I),Kt(()=>{})});var st=l(d);st.value=st.__value="short";var we=a(st);we.value=we.__value="long",s(d),s(te);var q=a(te,2),Se=l(q),de=l(Se);ke(de),ta(),s(Se),s(q),s(he);var Je=a(he,2);s(Z);var Ge=a(Z,2);{var tt=X=>{var Qe=ro();Lt(Qe,5,()=>e(K),Rt,(gt,b,E)=>{var ie=lo(),ne=l(ie),ve=l(ne),Re=l(ve,!0);s(ve);var Ke=a(ve,2);s(ne);var Me=a(ne,2),re=l(Me,!0);s(Me);var V=a(Me,2);{var vt=ae=>{var fe=ao(),Ze=l(fe),St=a(Ze);{var ot=se=>{var Gt=Tt("‚Ä¢ Requires Reaction");o(se,Gt)};m(St,se=>{e(b),i(()=>e(b).requiresReaction)&&se(ot)})}s(fe),D(()=>$(Ze,`${e(b),i(()=>e(b).usesPerRest)??""} use${e(b),i(()=>e(b).usesPerRest>1?"s":"")??""} per ${e(b),i(()=>e(b).restType)??""}
                      rest `)),o(ae,fe)},_e=ae=>{var fe=$t(),Ze=De(fe);{var St=ot=>{var se=so();o(ot,se)};m(Ze,ot=>{e(b),i(()=>e(b).requiresReaction)&&ot(St)},!0)}o(ae,fe)};m(V,ae=>{e(b),i(()=>e(b).usesPerRest)?ae(vt):ae(_e,!1)})}s(ie),D(()=>{$(Re,(e(b),i(()=>e(b).name))),ut(Ke,"aria-label",`Remove ${e(b),i(()=>e(b).name)??""}`),$(re,(e(b),i(()=>e(b).description)))}),B("click",Ke,()=>ce(E)),o(gt,ie)}),s(Qe),o(X,Qe)};m(Ge,X=>{e(K),i(()=>e(K).length>0)&&X(tt)})}s(k),s(Pe);var Oe=a(Pe,2),Ye=l(Oe),mt=a(Ye,2);s(Oe),s(xe),s(me),B("click",He,We),ze(h,()=>e(p),X=>n(p,X)),ze(oe,()=>e(g),X=>n(g,X)),ze(yt,()=>e(S),X=>n(S,X)),ze(wt,()=>e(y),X=>n(y,X)),ze(z,()=>e(_),X=>n(_,X)),ze(O,()=>e(N),X=>n(N,X)),ze(Ee,()=>e(Q),X=>n(Q,X)),B("keydown",Ee,X=>X.key==="Enter"&&qe()),B("click",Ae,qe),ze(G,()=>e(ee),X=>n(ee,X)),ze(Be,()=>e(H),X=>n(H,X)),ze(Le,()=>e(T),X=>n(T,X)),Na(d,()=>e(I),X=>n(I,X)),wa(de,()=>e(le),X=>n(le,X)),B("click",Je,ue),B("click",Ye,We),B("click",mt,ye),B("click",me,R),o(W,me)};m(x,W=>{t()&&W(J)})}o(r,M),Xt()}var oo=u("<option></option>"),co=u("<button> </button>"),vo=u('<div class="input-field svelte-uvfntf"><label class="svelte-uvfntf"><input type="checkbox"/> Uncanny Dodge (When an attacker that you can see hits you with an attack roll, you can take a Reaction to halve the attack‚Äôs damage against you.)</label></div>'),uo=u('<div class="adjustment-msg svelte-uvfntf"> </div>'),fo=u('<div class="calculation-result svelte-uvfntf"><div class="result-header svelte-uvfntf"><h4 class="svelte-uvfntf">Damage Calculation</h4></div> <div class="result-content svelte-uvfntf"><div class="damage-breakdown svelte-uvfntf"><div class="damage-row svelte-uvfntf"><span class="label svelte-uvfntf">Original Damage:</span> <span class="value svelte-uvfntf"> </span></div> <div class="adjustments svelte-uvfntf"></div> <div class="damage-row final svelte-uvfntf"><span class="label svelte-uvfntf">Final Damage:</span> <span class="value damage-value svelte-uvfntf"> </span></div></div></div> <div class="result-actions svelte-uvfntf"><button class="btn btn-primary apply-btn use-enabled svelte-uvfntf">Apply Damage</button> <button class="btn btn-secondary cancel-btn use-enabled svelte-uvfntf">Cancel</button></div></div>'),po=u('<div class="damage-form svelte-uvfntf"><div class="input-group svelte-uvfntf"><div class="input-field svelte-uvfntf"><label for="damageAmount" class="svelte-uvfntf">Damage Amount</label> <input type="number" id="damageAmount" min="0" placeholder="0" class="damage-input-field use-enabled svelte-uvfntf"/></div> <div class="input-field svelte-uvfntf"><label for="damageType" class="svelte-uvfntf">Damage Type</label> <input type="text" id="damageType" list="damageTypes" placeholder="e.g., fire, cold" class="damage-input-field use-enabled svelte-uvfntf"/> <datalist id="damageTypes"></datalist></div></div> <div class="quick-types svelte-uvfntf"><span class="quick-types-label svelte-uvfntf">Quick Select:</span> <!></div> <!> <!></div>'),mo=u("<section><!> <!></section>");function go(r,c){Qt(c,!1);const t=()=>_t(pe,"$character",p),v=()=>_t(xa,"$searchFilter",p),f=()=>_t(la,"$collapsedStates",p),[p,g]=fa(),S=w(),y=w();ka();let _=w(0),N=w(""),F=w(0),Q=w([]),K=w(!1);const ee=["slashing","piercing","bludgeoning","fire","cold","lightning","thunder","acid","poison","necrotic","radiant","psychic","force"],H={slashing:"üó°Ô∏è",piercing:"üèπ",bludgeoning:"üî®",fire:"üî•",cold:"‚ùÑÔ∏è",lightning:"‚ö°",thunder:"üí•",acid:"üß™",poison:"‚ò†Ô∏è",necrotic:"üíÄ",radiant:"‚ú®",psychic:"üß†",force:"üå™Ô∏è"};function T(){pe.update(ce=>zl(ce,e(F))),Ht.add(`Applied ${e(F)} damage to character (${e(N)})`,"info"),n(_,0),n(N,""),n(F,0),n(Q,[])}function I(){n(_,0),n(N,""),n(F,0),n(Q,[])}Xe(()=>t(),()=>{n(S,t()?.features?.toLowerCase?.().includes("uncanny dodge"))}),Xe(()=>(e(_),e(N),t(),e(K)),()=>{if(e(_)>=0&&e(N).trim()){const ce=Wl(e(_),e(N),t());let ye=ce.finalDamage,We=[...ce.adjustments];e(K)&&(ye=Math.floor(ye/2),We.push("Uncanny Dodge: Halved final damage")),n(F,ye),n(Q,We)}else n(F,0),n(Q,[])}),Xe(()=>v(),()=>{n(y,!v()||"damage".includes(v().toLowerCase())||"resistance".includes(v().toLowerCase())||"immune".includes(v().toLowerCase()))}),ga(),Yt();var le=mo();let be;var qe=l(le);{let ce=xt(()=>(f(),i(()=>f().damageInput?"Expand":"Collapse")));Da(qe,{title:"Apply Damage",get collapsed(){return f(),i(()=>f().damageInput)},get ariaLabel(){return e(ce)},onToggle:()=>la.update(ye=>({...ye,damageInput:!ye.damageInput}))})}var $e=a(qe,2);{var ue=ce=>{var ye=po(),We=l(ye),R=l(We),M=a(l(R),2);ke(M),s(R);var x=a(R,2),J=a(l(x),2);ke(J);var W=a(J,2);Lt(W,5,()=>ee,Rt,(h,P)=>{var oe=oo(),et={};D(()=>{et!==(et=e(P))&&(oe.value=(oe.__value=e(P))??"")}),o(h,oe)}),s(W),s(x),s(We);var me=a(We,2),xe=a(l(me),2);Lt(xe,1,()=>ee,Rt,(h,P)=>{var oe=co();let et;var lt=l(oe);s(oe),D(()=>{et=Et(oe,1,"quick-type-btn use-enabled svelte-uvfntf",null,et,{active:e(N)===e(P)}),$(lt,`${e(P),i(()=>H[e(P)])??""} ${e(P)??""}`)}),B("click",oe,()=>n(N,e(P))),o(h,oe)}),s(me);var Ne=a(me,2);{var He=h=>{var P=vo(),oe=l(P),et=l(oe);ke(et),ta(),s(oe),s(P),wa(et,()=>e(K),lt=>n(K,lt)),o(h,P)};m(Ne,h=>{e(S)&&h(He)})}var Pe=a(Ne,2);{var Ie=h=>{var P=fo(),oe=a(l(P),2),et=l(oe),lt=l(et),yt=a(l(lt),2),Dt=l(yt);s(yt),s(lt);var wt=a(lt,2);Lt(wt,5,()=>e(Q),Rt,(Ee,Ae)=>{var Fe=uo(),je=l(Fe,!0);s(Fe),D(()=>$(je,e(Ae))),o(Ee,Fe)}),s(wt);var C=a(wt,2),z=a(l(C),2),A=l(z,!0);s(z),s(C),s(et),s(oe);var O=a(oe,2),Y=l(O),ge=a(Y,2);s(O),s(P),D(()=>{$(Dt,`${e(_)??""} ${e(N),i(()=>H[e(N)]||"")??""} ${e(N)??""}`),$(A,e(F))}),B("click",Y,T),B("click",ge,I),o(h,P)};m(Pe,h=>{e(_),e(N),i(()=>e(_)>=0&&e(N).trim())&&h(Ie)})}s(ye),ze(M,()=>e(_),h=>n(_,h)),ze(J,()=>e(N),h=>n(N,h)),o(ce,ye)};m($e,ce=>{f(),i(()=>!f().damageInput)&&ce(ue)})}s(le),D(()=>be=Et(le,1,"damage-input svelte-uvfntf",null,be,{hidden:!e(y)})),o(r,le),Xt(),g()}var bo=u('<link rel="icon" type="image/png" href="favicon4.png"/> <meta name="viewport" content="width=device-width, initial-scale=1"/>',1),ho=u('<span class="character-name svelte-1uha8ag"> </span>'),_o=u("<span> </span>"),yo=u('<div class="spell-slots-header svelte-1uha8ag"></div>'),xo=u("<span> </span><br/>",1),ko=u("<span> </span><br/>",1),$o=u("<span> </span><br/>",1),wo=u("<span> </span><br/>",1),So=u("<span> </span><br/>",1),Co=u("<span> </span><br/>",1),Do=u("<br/><em> <!>)</em>",1),Lo=u("<br/><em>(requires reaction)</em>",1),Ao=u('<div class="ability-detail"><strong> </strong> <!></div>'),jo=u('<div class="abilities-section"><strong>Abilities:</strong><br/> <!></div>'),Bo=u('<span class="effect-tooltip"><strong> </strong><br/> <br/> <!> <!> <!> <!> <!> <!> <!></span>'),Ro=u('<button class="effect-remove-btn svelte-1uha8ag">√ó</button>'),Mo=u('<span class="effect-badge svelte-1uha8ag" tabindex="0"> <!> <!></span>'),To=u(`<div class="active-effects-header svelte-1uha8ag"></div> <style>.effect-badge {
              position: relative;
            }
            .effect-tooltip {
              position: absolute;
              top: 120%;
              left: 50%;
              transform: translateX(-50%);
              background: #fff;
              color: #222;
              border: 1px solid #a5b4fc;
              border-radius: 6px;
              padding: 8px 12px;
              font-size: 0.95em;
              box-shadow: 0 2px 8px rgba(0, 0, 0, 0.12);
              z-index: 10;
              min-width: 180px;
              max-width: 300px;
              white-space: normal;
              pointer-events: none;
              opacity: 1;
              transition: opacity 0.15s;
            }

            .abilities-section {
              margin-top: 8px;
              padding-top: 8px;
              border-top: 1px solid #e5e7eb;
            }

            .ability-detail {
              margin-top: 6px;
              padding: 4px;
              background: #f9fafb;
              border-radius: 4px;
              font-size: 0.9em;
            }

            .ability-detail strong {
              color: #6366f1;
            }

            .ability-detail em {
              font-size: 0.85em;
              color: #6b7280;
            }</style>`,1),Fo=u('<div class="rest-menu svelte-1uha8ag"><button class="rest-option svelte-1uha8ag">‚òï Short Rest</button> <button class="rest-option svelte-1uha8ag">üõèÔ∏è Long Rest</button></div>'),Po=u('<div class="container svelte-1uha8ag"><header class="svelte-1uha8ag"><div class="header-top svelte-1uha8ag"><div class="header-title svelte-1uha8ag"><div class="title-row svelte-1uha8ag"><h1 class="svelte-1uha8ag">D&D Character Sheet</h1> <!></div> <!> <!></div> <div class="header-right svelte-1uha8ag"><div class="header-controls svelte-1uha8ag"><button class="btn btn-secondary use-enabled"><span class="btn-icon svelte-1uha8ag">üé≤</span><span class="btn-text svelte-1uha8ag">Roll Dice</span></button> <div class="rest-button-container svelte-1uha8ag"><button class="btn btn-secondary use-enabled"><span class="btn-icon svelte-1uha8ag">üò¥</span><span class="btn-text svelte-1uha8ag">Rest</span></button> <!></div> <button class="btn btn-secondary use-enabled" title="Add custom condition with effects"><span class="btn-icon svelte-1uha8ag">‚ú®</span><span class="btn-text svelte-1uha8ag">Add Condition</span></button> <div class="mode-toggle"><button><span class="btn-icon svelte-1uha8ag"> </span><span class="btn-text svelte-1uha8ag"> </span></button> <button class="btn btn-mode svelte-1uha8ag" title="Toggle dark mode"><span class="btn-icon svelte-1uha8ag"> </span> <span class="btn-text svelte-1uha8ag"> </span></button></div></div> <div class="header-search svelte-1uha8ag"><input type="text" placeholder="üîç Search..." class="search-input use-enabled svelte-1uha8ag"/></div></div></div> <div class="header-actions svelte-1uha8ag"><button class="btn btn-mode svelte-1uha8ag">üìö Browse Spells & Feats</button> <button class="btn btn-secondary">Save to Gist</button> <button class="btn btn-secondary">Load from Gist</button> <button class="btn btn-secondary">Export JSON</button> <button class="btn btn-secondary">Import JSON</button> <input type="file" accept=".json" style="display: none;"/></div></header> <main class="svelte-1uha8ag"><!> <!> <!> <!> <!> <!> <!> <!></main></div> <!> <!> <!> <!> <!>',1);function Wo(r,c){Qt(c,!1);const t=()=>_t(pe,"$character",p),v=()=>_t(Sa,"$isEditMode",p),f=()=>_t(xa,"$searchFilter",p),[p,g]=fa();let S=w(!1);function y(j){n(S,j),j?document.body.classList.add("dark-mode"):document.body.classList.remove("dark-mode"),localStorage.setItem("dnd-dark-mode",j?"true":"false")}function _(){y(!e(S))}Ca(()=>{const j=localStorage.getItem("dnd-dark-mode");y(j==="true")});function N(){const j=[],Ce=t().classFeatures.spellSlotsByLevel||{};for(let Ue=1;Ue<=9;Ue++){const bt=Ce[Ue];if(bt&&bt.length>0){const L=bt.length,ft=bt.filter(rt=>rt).length;j.push({level:Ue,available:L-ft,total:L})}}return j}let F=w(!1),Q=w(!1),K=w(!1),ee=w(!1),H=w("save"),T=w(void 0),I=w(""),le=w(""),be=w(""),qe=w(!1),$e=w([]),ue=w([]),ce=w("other"),ye=w(),We=!1,R=1,M=w(!1),x=w(null);function J(j){n(x,j)}function W(){n(x,null)}function me(j){n(x,e(x)===j?null:j)}function xe(j){pe.update(Ce=>(Ce.activeStates||(Ce.activeStates=[]),Ce.activeStates=[...Ce.activeStates,j],Ce)),n(ee,!1),Ht.add(`Added condition: ${j.name}`,"success")}function Ne(){n(ee,!1)}function He(){const j=[];pe.update(L=>{const ft=L.hitDice.current;L.hitDice.current=Math.min(L.hitDice.max,L.hitDice.current+Math.max(1,Math.floor(L.hitDice.max/2)));const rt=L.hitDice.current-ft;if(rt>0&&j.push(`${rt} hit ${rt===1?"die":"dice"}`),L.class){const ht=Ta(L.class,L.level,L.subclass);L.classFeatures.features||(L.classFeatures.features={}),ht.forEach(at=>{if(at.resetOn==="short"){const it=typeof at.name=="function"?at.name(L.level):at.name,Ve=it.replace(/\s+/g,"");if(at.type==="uses"){const Ft=typeof at.maxUses=="function"?at.maxUses(L.level):at.maxUses;L.classFeatures.features[Ve]=Array(Ft).fill(!1),j.push(it)}else if(at.type==="pool"){const Ft=typeof at.maxPool=="function"?at.maxPool(L.level):at.maxPool;Ft!==void 0&&(L.classFeatures.features[Ve]=Ft,j.push(it))}}})}return L.activeStates&&L.activeStates.forEach(ht=>{ht.abilities&&ht.abilities.forEach(at=>{if(at.restType==="short"&&at.usesPerRest){const it=at.usesPerRest-(at.currentUses||0)>0;at.currentUses=at.usesPerRest,it&&j.push(`${ht.name}: ${at.name}`)}})}),L}),Ss("short"),Cs(t().race,t().level).some(L=>L.restType==="short"&&L.usesPerRest)&&j.push("racial traits"),n(M,!1);const bt=j.length>0?`Short rest taken! Restored: ${j.join(", ")}`:"Short rest taken!";Ht.add(bt,"success")}function Pe(){const j=[];pe.update(L=>{const ft=L.maxHP-L.currentHP;ft>0&&j.push(`${ft} HP`),L.currentHP=L.maxHP,L.tempHP=0;const rt=L.hitDice.max-L.hitDice.current;rt>0&&j.push(`${rt} hit ${rt===1?"die":"dice"}`),L.hitDice.current=L.hitDice.max;let ht=0;if(L.classFeatures.spellSlotsByLevel&&Object.keys(L.classFeatures.spellSlotsByLevel).forEach(at=>{const it=L.classFeatures.spellSlotsByLevel[parseInt(at)];if(it){const Ve=it.filter(Ft=>Ft).length;ht+=Ve,L.classFeatures.spellSlotsByLevel[parseInt(at)]=Array(it.length).fill(!1)}}),ht>0&&j.push(`${ht} spell ${ht===1?"slot":"slots"}`),L.class){const at=Ta(L.class,L.level,L.subclass);L.classFeatures.features||(L.classFeatures.features={});let it=!1;at.forEach(Ve=>{const Ut=(typeof Ve.name=="function"?Ve.name(L.level):Ve.name).replace(/\s+/g,"");if(!(Ve.type==="info"||Ve.type==="channelDivinity")){if(Ve.type==="uses"){const Mt=typeof Ve.maxUses=="function"?Ve.maxUses(L.level):Ve.maxUses;L.classFeatures.features[Ut]=Array(Mt).fill(!1),it=!0}else if(Ve.type==="pool"){const Mt=typeof Ve.maxPool=="function"?Ve.maxPool(L.level):Ve.maxPool;Mt!==void 0&&(L.classFeatures.features[Ut]=Mt,it=!0)}}}),it&&j.push("all class features")}if(L.activeStates){let at=!1;L.activeStates.forEach(it=>{it.abilities&&it.abilities.forEach(Ve=>{if(Ve.usesPerRest){const Ft=(Ve.currentUses||0)<Ve.usesPerRest;Ve.currentUses=Ve.usesPerRest,Ft&&(at=!0)}})}),at&&j.push("condition abilities")}return L}),Ss("long"),Cs(t().race,t().level).some(L=>L.usesPerRest)&&j.push("racial traits"),n(M,!1);const bt=j.length>0?`Long rest taken! Restored: ${j.join(", ")}`:"Long rest taken! Fully rested.";Ht.add(bt,"success")}function Ie(j){n(I,""),n(le,""),n(be,""),n(qe,!1),n($e,[]),n(ue,[]),n(ce,"other"),We=!1,typeof j=="string"?n(I,j):(n(I,j.notation),n(le,j.damageNotation||""),n(be,j.attackName||""),n(qe,!!j.applyHalfDamage),n($e,j.bonusBreakdown||[]),n(ue,j.damageBreakdown||[]),n(ce,j.rollType||"other")),n(F,!0)}function h(j){const{notation:Ce,count:Ue,bonusBreakdown:bt}=j.detail;n(I,""),We=!0,R=Ue||1,setTimeout(()=>{n(I,Ce),n(le,""),n(be,"Hit Die"),n($e,bt||[]),n(ce,"other")},0),n(F,!0)}function P(){if(n(F,!1),We&&e(ye)){const j=e(ye).getLastRollTotal();if(j!==null){const Ce=Math.max(1,j);pe.update(Ue=>(Ue.hitDice.current=Math.max(0,Ue.hitDice.current-R),Ue.currentHP=Math.min(Ue.maxHP,Ue.currentHP+Ce),Ue))}We=!1}}function oe(){Sa.update(j=>!j)}function et(j){j.target.closest(".rest-button-container")||n(M,!1)}Ca(()=>{const j=Sa.subscribe(Ce=>{Ce?document.body.classList.remove("use-mode"):document.body.classList.add("use-mode")});return document.addEventListener("click",et),()=>{j(),document.removeEventListener("click",et)}});function lt(){bl(t())}function yt(){e(T)?.click()}async function Dt(j){const Ue=j.target.files?.[0];if(Ue)try{const bt=await hl(Ue);pe.set(bt),alert("Character imported successfully!")}catch{alert("Failed to import character file")}}Yt();var wt=Po();ml("1uha8ag",j=>{var Ce=bo();ta(2),Es(()=>{dl.title="D&D Character Sheet"}),o(j,Ce)});var C=De(wt),z=l(C),A=l(z),O=l(A),Y=l(O),ge=a(l(Y),2);{var Ee=j=>{var Ce=ho(),Ue=l(Ce);s(Ce),D(()=>$(Ue,`${t().name??""} (${t().level??""})`)),o(j,Ce)};m(ge,j=>{t().name&&j(Ee)})}s(Y);var Ae=a(Y,2);{var Fe=j=>{var Ce=yo();Lt(Ce,5,N,Rt,(Ue,bt)=>{var L=_o();let ft;var rt=l(L);s(L),D(()=>{ft=Et(L,1,"slot-badge svelte-1uha8ag",null,ft,{depleted:e(bt).available===0}),$(rt,`Lv${e(bt).level??""}: ${e(bt).available??""}/${e(bt).total??""}`)}),o(Ue,L)}),s(Ce),o(j,Ce)};m(Ae,j=>{N().length>0&&j(Fe)})}var je=a(Ae,2);{var k=j=>{var Ce=To(),Ue=De(Ce);Lt(Ue,5,()=>t().activeStates,Rt,(bt,L,ft)=>{var rt=Mo(),ht=l(rt),at=a(ht);{var it=Ut=>{var Mt=Bo(),pt=l(Mt),nt=l(pt,!0);s(pt);var Pt=a(pt,2),qt=a(Pt,3);{var Zt=dt=>{var Ct=xo(),At=De(Ct),zt=l(At);s(At),ta(),D(()=>$(zt,`Attack Bonus: ${typeof e(L).attackBonus=="number"&&e(L).attackBonus>0?"+":""}${e(L).attackBonus??""}`)),o(dt,Ct)};m(qt,dt=>{e(L).attackBonus&&dt(Zt)})}var va=a(qt,2);{var pa=dt=>{var Ct=ko(),At=De(Ct),zt=l(At);s(At),ta(),D(()=>$(zt,`Damage Bonus: ${typeof e(L).damageBonus=="number"&&e(L).damageBonus>0?"+":""}${e(L).damageBonus??""}`)),o(dt,Ct)};m(va,dt=>{e(L).damageBonus&&dt(pa)})}var da=a(va,2);{var Vt=dt=>{var Ct=$o(),At=De(Ct),zt=l(At);s(At),ta(),D(()=>$(zt,`AC Bonus: ${e(L).acBonus>0?"+":""}${e(L).acBonus??""}`)),o(dt,Ct)};m(da,dt=>{e(L).acBonus&&dt(Vt)})}var ea=a(da,2);{var Jt=dt=>{var Ct=wo(),At=De(Ct),zt=l(At);s(At),ta(),D(()=>$(zt,`Darkvision: ${e(L).darkvision??""} feet`)),o(dt,Ct)};m(ea,dt=>{e(L).darkvision&&dt(Jt)})}var It=a(ea,2);{var na=dt=>{var Ct=So(),At=De(Ct),zt=l(At);s(At),ta(),D(Nt=>$(zt,`Resistances: ${Nt??""}`),[()=>e(L).resistances.join(", ")]),o(dt,Ct)};m(It,dt=>{e(L).resistances&&e(L).resistances.length>0&&dt(na)})}var ma=a(It,2);{var ha=dt=>{var Ct=Co(),At=De(Ct),zt=l(At);s(At),ta(),D(Nt=>$(zt,`Immunities: ${Nt??""}`),[()=>e(L).immunities.join(", ")]),o(dt,Ct)};m(ma,dt=>{e(L).immunities&&e(L).immunities.length>0&&dt(ha)})}var Wt=a(ma,2);{var ra=dt=>{var Ct=jo(),At=a(l(Ct),3);Lt(At,1,()=>e(L).abilities,Rt,(zt,Nt)=>{var oa=Ao(),jt=l(oa),ia=l(jt);s(jt);var La=a(jt),es=a(La);{var ts=ca=>{var ba=Do(),Ba=a(De(ba)),Oa=l(Ba),Fa=a(Oa);{var ss=ls=>{var zs=Tt(", requires reaction");o(ls,zs)};m(Fa,ls=>{e(Nt).requiresReaction&&ls(ss)})}ta(),s(Ba),D(()=>$(Oa,`(${(e(Nt).currentUses||0)??""}/${e(Nt).usesPerRest??""} uses per ${e(Nt).restType??""}
                                rest`)),o(ca,ba)},as=ca=>{var ba=$t(),Ba=De(ba);{var Oa=Fa=>{var ss=Lo();ta(),o(Fa,ss)};m(Ba,Fa=>{e(Nt).requiresReaction&&Fa(Oa)},!0)}o(ca,ba)};m(es,ca=>{e(Nt).usesPerRest?ca(ts):ca(as,!1)})}s(oa),D(()=>{$(ia,`${e(Nt).name??""}:`),$(La,` ${e(Nt).description??""} `)}),o(zt,oa)}),s(Ct),o(dt,Ct)};m(Wt,dt=>{e(L).abilities&&e(L).abilities.length>0&&dt(ra)})}s(Mt),D(()=>{$(nt,e(L).name),$(Pt,` ${e(L).description??""}`)}),o(Ut,Mt)};m(at,Ut=>{e(x)===ft&&Ut(it)})}var Ve=a(at,2);{var Ft=Ut=>{var Mt=Ro();D(()=>ut(Mt,"title",`End ${e(L).name??""}`)),B("click",Mt,()=>{pe.update(pt=>{if(pt.activeStates){const nt=pt.activeStates[ft];nt?.hpBonus&&nt.target!=="other"&&(pt.maxHP-=nt.hpBonus,pt.currentHP=Math.max(1,Math.min(pt.currentHP-nt.hpBonus,pt.maxHP))),pt.activeStates=pt.activeStates.filter((Pt,qt)=>qt!==ft)}return pt})}),o(Ut,Mt)};m(Ve,Ut=>{v()||Ut(Ft)})}s(rt),D(()=>{ut(rt,"aria-label",e(L).name),$(ht,`‚ú® ${e(L).name??""} `)}),B("mouseenter",rt,()=>J(ft)),B("mouseleave",rt,W),B("focus",rt,()=>J(ft)),B("blur",rt,W),B("click",rt,()=>me(ft)),o(bt,rt)}),s(Ue),ta(2),o(j,Ce)};m(je,j=>{t().activeStates&&t().activeStates.length>0&&j(k)})}s(O);var Z=a(O,2),G=l(Z),Be=l(G),he=a(Be,2),ct=l(he),Le=a(ct,2);{var te=j=>{var Ce=Fo(),Ue=l(Ce),bt=a(Ue,2);s(Ce),B("click",Ue,He),B("click",bt,Pe),o(j,Ce)};m(Le,j=>{e(M)&&j(te)})}s(he);var d=a(he,2),st=a(d,2),we=l(st);let q;var Se=l(we),de=l(Se,!0);s(Se);var Je=a(Se),Ge=l(Je,!0);s(Je),s(we);var tt=a(we,2),Oe=l(tt),Ye=l(Oe,!0);s(Oe);var mt=a(Oe,2),X=l(mt,!0);s(mt),s(tt),s(st),s(G);var Qe=a(G,2),gt=l(Qe);ke(gt),s(Qe),s(Z),s(A);var b=a(A,2),E=l(b),ie=a(E,2),ne=a(ie,2),ve=a(ne,2),Re=a(ve,2),Ke=a(Re,2);Ua(Ke,j=>n(T,j),()=>e(T)),s(b),s(z);var Me=a(z,2),re=l(Me);Pl(re,{});var V=a(re,2);Nl(V,{$$events:{roll:j=>Ie(j.detail)}});var vt=a(V,2);nr(vt,{$$events:{roll:j=>Ie(j.detail)}});var _e=a(vt,2);sr(_e,{$$events:{rollHitDice:h}});var ae=a(_e,2);go(ae,{});var fe=a(ae,2);hi(fe,{$$events:{roll:j=>Ie(j.detail)}});var Ze=a(fe,2);Ki(Ze,{$$events:{roll:j=>Ie(j.detail)}});var St=a(Ze,2);Yi(St,{}),s(Me),s(C);var ot=a(C,2);Ua(bn(ot,{get notation(){return e(I)},get damageNotation(){return e(le)},get attackName(){return e(be)},get applyHalfDamage(){return e(qe)},get bonusBreakdown(){return e($e)},get damageBreakdown(){return e(ue)},get rollType(){return e(ce)},get visible(){return e(F)},$$events:{close:P},$$legacy:!0}),j=>n(ye,j),()=>e(ye));var se=a(ot,2);{var Gt=j=>{In(j,{get mode(){return e(H)},$$events:{close:()=>n(Q,!1)}})};m(se,j=>{e(Q)&&j(Gt)})}var Te=a(se,2);{var kt=j=>{Zn(j,{onClose:()=>n(K,!1)})};m(Te,j=>{e(K)&&j(kt)})}var aa=a(Te,2);no(aa,{get show(){return e(ee)},onSave:xe,onCancel:Ne});var sa=a(aa,2);gl(sa,{}),D(()=>{q=Et(we,1,"btn btn-mode svelte-1uha8ag",null,q,{"use-mode":!v()}),$(de,v()?"üìù":"üé≤"),$(Ge,v()?"Edit Mode":"Use Mode"),$(Ye,e(S)?"‚òÄÔ∏è":"üåô"),$(X,e(S)?"Light Mode":"Dark Mode")}),B("click",Be,()=>{n($e,[]),n(F,!0)}),B("click",ct,()=>n(M,!e(M))),B("click",d,()=>n(ee,!0)),B("click",we,oe),B("click",tt,_),ze(gt,f,j=>_l(xa,j)),B("click",E,()=>n(K,!0)),B("click",ie,()=>{n(H,"save"),n(Q,!0)}),B("click",ne,()=>{n(H,"load"),n(Q,!0)}),B("click",ve,lt),B("click",Re,yt),B("change",Ke,Dt),o(r,wt),Xt(),g()}export{Wo as component};
