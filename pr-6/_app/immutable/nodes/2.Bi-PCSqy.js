import{f as h,e as F,a as o,s as y,c as lt,t as ut}from"../chunks/BmKkCgmR.js";import{i as gt}from"../chunks/AFJ5q3G2.js";import{c as Bt,o as Wt}from"../chunks/BwhX61NF.js";import{a6 as ga,i as ma,b1 as Fa,b2 as Ra,b3 as ca,J as wt,e as _a,b4 as ya,aa as Aa,b as i,r as ka,R as xa,g as Ia,B as mt,b5 as Qe,b6 as Lt,E as I,F as _t,s as n,a3 as A,G as l,I as t,H as a,d as e,C as ze,k as at,z as U,b7 as Ct,b8 as Ot,b9 as $a,an as Sa,ba as Ma}from"../chunks/CmcvLP-Y.js";import{s as st,c as V,a as ft,r as De,e as ot,i as pt,b as Ca,u as Pa,d as Dt,f as ct,g as Yt,j as Qt,k as Ea,t as qt,h as Ua,T as Ba,l as Ha,m as Ta}from"../chunks/BH0g7pxY.js";import{i as j,s as St,a as We,b as Ze,d as Na}from"../chunks/BibxXT0t.js";import{p as Pt,b as ra}from"../chunks/BNYf2NzH.js";import{b as Gt,r as Ga}from"../chunks/Cil1w0Lt.js";function Xt(r,u,s=!1){if(r.multiple){if(u==null)return;if(!ma(u))return Fa();for(var v of r.options)v.selected=u.includes(zt(v));return}for(v of r.options){var S=zt(v);if(Ra(S,u)){v.selected=!0;return}}(!s||u!==void 0)&&(r.selectedIndex=-1)}function na(r){var u=new MutationObserver(()=>{Xt(r,r.__value)});u.observe(r,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),ga(()=>{u.disconnect()})}function La(r,u,s=u){var v=new WeakSet,S=!0;ca(r,"change",k=>{var w=k?"[selected]":":checked",T;if(r.multiple)T=[].map.call(r.querySelectorAll(w),zt);else{var f=r.querySelector(w)??r.querySelector("option:not([disabled])");T=f&&zt(f)}s(T),wt!==null&&v.add(wt)}),_a(()=>{var k=u();if(r===document.activeElement){var w=ya??wt;if(v.has(w))return}if(Xt(r,k,S),S&&k===void 0){var T=r.querySelector(":checked");T!==null&&(k=zt(T),s(k))}r.__value=k,S=!1}),na(r)}function zt(r){return"__value"in r?r.__value:r.value}function Me(r,u,s=u){var v=new WeakSet;ca(r,"input",async S=>{var k=S?r.defaultValue:r.value;if(k=sa(r)?la(k):k,s(k),wt!==null&&v.add(wt),await Aa(),k!==(k=u())){var w=r.selectionStart,T=r.selectionEnd,f=r.value.length;if(r.value=k??"",T!==null){var q=r.value.length;w===T&&T===f&&q>f?(r.selectionStart=q,r.selectionEnd=q):(r.selectionStart=w,r.selectionEnd=Math.min(T,q))}}}),(xa&&r.defaultValue!==r.value||i(u)==null&&r.value)&&(s(sa(r)?la(r.value):r.value),wt!==null&&v.add(wt)),ka(()=>{var S=u();if(r===document.activeElement){var k=ya??wt;if(v.has(k))return}sa(r)&&S===la(r.value)||r.type==="date"&&!S&&!r.value||S!==r.value&&(r.value=S??"")})}function va(r,u,s=u){ca(r,"change",v=>{var S=v?r.defaultChecked:r.checked;s(S)}),(xa&&r.defaultChecked!==r.checked||i(u)==null)&&s(r.checked),ka(()=>{var v=u();r.checked=!!v})}function sa(r){var u=r.type;return u==="number"||u==="range"}function la(r){return r===""?null:+r}function Oa(r,u,s){var v=Ia(r,u);v&&v.set&&(r[u]=s,ga(()=>{r[u]=null}))}function da(r){return function(...u){var s=u[0];return s.stopPropagation(),r?.apply(this,u)}}function Et(r,u){var s=r.$$events?.[u.type],v=ma(s)?s.slice():s==null?[]:[s];for(var S of v)S.call(this,u)}const qa="";function ja(...r){return Gt+qa+Ga(r[0],r[1])}const oa={paladin:{name:"Paladin",hitDice:"d10",spellcaster:!0,spellcastingAbility:"charisma",spellSlotsByLevel:{1:0,2:2,3:3,4:3,5:4,6:4,7:4,8:4,9:4,10:4,11:4,12:4,13:4,14:4,15:4,16:4,17:4,18:4,19:4,20:4},features:[{name:"Divine Sense",type:"uses",maxUses:(r,u=1)=>1+Math.max(1,u),resetOn:"long",description:"Detect celestials, fiends, and undead within 60 feet",minLevel:1},{name:"Lay on Hands",type:"pool",maxPool:r=>r*5,resetOn:"long",description:"Heal wounds or cure disease",minLevel:1},{name:"Divine Smite",type:"spellSlot",description:"Expend spell slot to deal extra radiant damage",minLevel:2,rollable:!0},{name:"Channel Divinity",type:"pool",maxPool:r=>r>=18?3:r>=6?2:1,resetOn:"short",description:"Sacred Weapon or Turn Undead",minLevel:3}]},fighter:{name:"Fighter",hitDice:"d10",spellcaster:!1,features:[{name:"Second Wind",type:"uses",maxUses:1,resetOn:"short",description:"Regain 1d10 + fighter level HP as bonus action",minLevel:1,rollable:!0,rollFormula:r=>`1d10+${r}`},{name:"Action Surge",type:"uses",maxUses:r=>r>=17?2:1,resetOn:"short",description:"Take one additional action on your turn",minLevel:2},{name:"Indomitable",type:"uses",maxUses:r=>r>=17?3:r>=13?2:1,resetOn:"long",description:"Reroll a failed saving throw",minLevel:9}],subclasses:{champion:{name:"Champion",features:[{name:"Improved Critical",type:"info",description:"Critical hit on 19-20",minLevel:3},{name:"Remarkable Athlete",type:"info",description:"Add half proficiency to STR/DEX/CON checks, increase long jump distance",minLevel:7},{name:"Additional Fighting Style",type:"info",description:"Choose a second fighting style",minLevel:10},{name:"Superior Critical",type:"info",description:"Critical hit on 18-20",minLevel:15},{name:"Survivor",type:"info",description:"Regain 5 + CON mod HP at start of turn if below half HP",minLevel:18}]},battlemaster:{name:"Battle Master",features:[{name:"Combat Superiority",type:"uses",maxUses:r=>r>=15?6:r>=7?5:4,resetOn:"short",description:r=>`Use superiority dice (${r>=18?"d12":r>=10?"d10":"d8"}) for maneuvers`,minLevel:3},{name:"Know Your Enemy",type:"info",description:"Learn capabilities of creatures you observe",minLevel:7},{name:"Improved Combat Superiority",type:"info",description:"Superiority dice become d10",minLevel:10},{name:"Relentless",type:"info",description:"Regain 1 superiority die if you have none at start of turn",minLevel:15}]}}},rogue:{name:"Rogue",hitDice:"d8",spellcaster:!1,features:[{name:"Sneak Attack",type:"info",description:r=>`Deal ${Math.ceil(r/2)}d6 extra damage once per turn with advantage or ally nearby`,minLevel:1,rollable:!0,rollFormula:r=>`${Math.ceil(r/2)}d6`},{name:"Cunning Action",type:"info",description:"Dash, Disengage, or Hide as a bonus action",minLevel:2},{name:"Uncanny Dodge",type:"info",description:"Use reaction to halve damage from an attack",minLevel:5},{name:"Evasion",type:"info",description:"Take no damage on successful Dex save (half on fail)",minLevel:7}]},wizard:{name:"Wizard",hitDice:"d6",spellcaster:!0,spellcastingAbility:"intelligence",spellSlotsByLevel:{1:2,2:3,3:4,4:4,5:4,6:4,7:4,8:4,9:4,10:4,11:4,12:4,13:4,14:4,15:4,16:4,17:4,18:4,19:4,20:4},features:[{name:"Arcane Recovery",type:"uses",maxUses:1,resetOn:"long",description:r=>`Recover spell slots totaling up to ${Math.ceil(r/2)} levels during short rest`,minLevel:1},{name:"Spell Mastery",type:"info",description:"Cast one 1st-level and one 2nd-level spell at will",minLevel:18}]},cleric:{name:"Cleric",hitDice:"d8",spellcaster:!0,spellcastingAbility:"wisdom",spellSlotsByLevel:{1:2,2:3,3:4,4:4,5:4,6:4,7:4,8:4,9:4,10:4,11:4,12:4,13:4,14:4,15:4,16:4,17:4,18:4,19:4,20:4},features:[{name:"Channel Divinity",type:"pool",maxPool:r=>r>=18?3:r>=6?2:1,resetOn:"short",description:"Turn Undead or domain-specific ability",minLevel:2},{name:"Destroy Undead",type:"info",description:r=>`Channel Divinity destroys undead of CR ${r>=17?4:r>=14?3:r>=11?2:r>=8?1:.5} or lower`,minLevel:5},{name:"Divine Intervention",type:"uses",maxUses:1,resetOn:"long",description:r=>`${r}% chance to succeed, implore deity for aid`,minLevel:10}],subclasses:{war:{name:"War Domain",features:[{name:"War Priest",type:"uses",maxUses:(r,u=1)=>Math.max(1,u),resetOn:"long",description:"Make one weapon attack as a bonus action",minLevel:1},{name:"Guided Strike",type:"channelDivinity",description:"Use your Channel Divinity to gain +10 to an attack roll. Make this choice after you see the roll, but before the DM says whether the attack hits or misses.",minLevel:2,resetOn:"short"},{name:"War God's Blessing",type:"channelDivinity",description:"Use reaction to grant +10 to an ally's attack roll within 30 feet. Consumes one use of Channel Divinity.",minLevel:6,resetOn:"short"},{name:"Divine Strike",type:"info",description:r=>`Deal extra ${r>=14?"2d8":"1d8"} weapon damage once per turn`,minLevel:8,rollable:!0,rollFormula:r=>r>=14?"2d8":"1d8"},{name:"Avatar of Battle",type:"info",description:"Gain resistance to nonmagical weapon damage",minLevel:17}]},life:{name:"Life Domain",features:[{name:"Disciple of Life",type:"info",description:"Healing spells restore additional 2 + spell level HP",minLevel:1},{name:"Preserve Life",type:"pool",maxPool:r=>r*5,resetOn:"short",description:"Restore HP to creatures within 30 feet",minLevel:2},{name:"Blessed Healer",type:"info",description:"Regain 2 + spell level HP when you cast healing spell",minLevel:6},{name:"Divine Strike",type:"info",description:r=>`Deal extra ${r>=14?"2d8":"1d8"} radiant damage once per turn`,minLevel:8,rollable:!0,rollFormula:r=>r>=14?"2d8":"1d8"},{name:"Supreme Healing",type:"info",description:"Maximize healing dice instead of rolling",minLevel:17}]}}},barbarian:{name:"Barbarian",hitDice:"d12",spellcaster:!1,features:[{name:"Rage",type:"uses",maxUses:r=>r>=20?1/0:r>=17?6:r>=12?5:r>=6?4:r>=3?3:2,resetOn:"long",description:r=>`+${r>=16?4:r>=9?3:2} damage, resistance to physical damage`,minLevel:1},{name:"Reckless Attack",type:"info",description:"Gain advantage on melee attacks, enemies get advantage on you",minLevel:2},{name:"Danger Sense",type:"info",description:"Advantage on Dex saves against effects you can see",minLevel:2}],subclasses:{berserker:{name:"Path of the Berserker",features:[{name:"Frenzy",type:"info",description:"While raging, make melee attack as bonus action (gain 1 exhaustion after rage)",minLevel:3},{name:"Mindless Rage",type:"info",description:"Cannot be charmed or frightened while raging",minLevel:6},{name:"Intimidating Presence",type:"info",description:"Use action to frighten creature within 30 feet",minLevel:10},{name:"Retaliation",type:"info",description:"When damaged by creature within 5 feet, make melee attack as reaction",minLevel:14}]}}}};function $t(r){const u=r.toLowerCase();return oa[u]||null}function Ut(r,u,s){const v=$t(r);if(!v)return[];const S=v.features.filter(k=>!k.minLevel||k.minLevel<=u);if(s&&v.subclasses&&v.subclasses[s]){const k=v.subclasses[s].features.filter(w=>!w.minLevel||w.minLevel<=u);return[...S,...k]}return S}function ua(r){const u=$t(r);return!u||!u.subclasses?[]:Object.keys(u.subclasses).map(s=>({id:s,name:u.subclasses[s].name}))}function pa(r,u){const s=$t(r);return!s||!s.spellcaster||!s.spellSlotsByLevel?0:s.spellSlotsByLevel[u]||0}function fa(r,u,s){const v=$t(r);return!v||!v.spellcaster?0:Math.max(1,s+u)}function za(r,u,s){const v=$t(r);return!v||!v.spellcaster?null:8+u+s}function Wa(){return Object.keys(oa).map(r=>({id:r,name:oa[r].name}))}var Ka=h("<option> </option>"),Ja=h("<option> </option>"),Va=h('<div class="form-group svelte-172i2fj"><label for="characterSubclass" class="svelte-172i2fj">Subclass</label> <select id="characterSubclass" class="svelte-172i2fj"><option>Select Subclass</option><!></select></div>'),Qa=h('<div class="info-grid svelte-172i2fj"><div class="form-group svelte-172i2fj"><label for="characterName" class="svelte-172i2fj">Character Name</label> <input type="text" id="characterName" placeholder="Enter name" class="svelte-172i2fj"/></div> <div class="form-group svelte-172i2fj"><label for="characterClass" class="svelte-172i2fj">Class</label> <select id="characterClass" class="svelte-172i2fj"><option>Select Class</option><!></select></div> <!> <div class="form-group svelte-172i2fj"><label for="characterLevel" class="svelte-172i2fj">Level</label> <input type="number" id="characterLevel" min="1" max="20" class="svelte-172i2fj"/></div> <div class="form-group svelte-172i2fj"><label for="characterRace" class="svelte-172i2fj">Race</label> <input type="text" id="characterRace" placeholder="e.g., Human" class="svelte-172i2fj"/></div> <div class="form-group svelte-172i2fj"><label for="characterBackground" class="svelte-172i2fj">Background</label> <input type="text" id="characterBackground" placeholder="e.g., Soldier" class="svelte-172i2fj"/></div> <div class="form-group svelte-172i2fj"><label for="characterAlignment" class="svelte-172i2fj">Alignment</label> <input type="text" id="characterAlignment" placeholder="e.g., Lawful Good" class="svelte-172i2fj"/></div></div>'),Xa=h('<section class="character-info svelte-172i2fj"><div class="header svelte-172i2fj"><h2 class="svelte-172i2fj">Character Info</h2> <button class="collapse-btn svelte-172i2fj"> </button></div> <!></section>');function Ya(r,u){mt(u,!1);const s=()=>We(V,"$character",S),v=()=>We(ft,"$collapsedStates",S),[S,k]=St(),w=A(),T=Wa();function f(ae){const ce=ae.target;V.update(Q=>(Q.class=ce.value,Q.subclass="",Q))}function q(ae){const ce=ae.target;V.update(Q=>(Q.subclass=ce.value,Q))}function ee(ae){const ce=ae.target;V.update(Q=>(Q.level=parseInt(ce.value)||1,Q)),Pa()}function B(){ft.update(ae=>({...ae,characterInfo:!ae.characterInfo}))}Qe(()=>(s(),ua),()=>{n(w,s().class?ua(s().class):[])}),Lt(),gt();var K=Xa(),de=l(K),oe=t(l(de),2),me=l(oe,!0);a(oe),a(de);var be=t(de,2);{var N=ae=>{var ce=Qa(),Q=l(ce),te=t(l(Q),2);De(te),a(Q);var se=t(Q,2),E=t(l(se),2),le=l(E);le.value=le.__value="";var ie=t(le);ot(ie,1,()=>T,pt,(xe,Te)=>{var Le=Ka(),he=l(Le,!0);a(Le);var _={};I(()=>{y(he,(e(Te),i(()=>e(Te).name))),_!==(_=(e(Te),i(()=>e(Te).id)))&&(Le.value=(Le.__value=(e(Te),i(()=>e(Te).id)))??"")}),o(xe,Le)}),a(E);var ne;na(E),a(se);var Be=t(se,2);{var x=xe=>{var Te=Va(),Le=t(l(Te),2),he=l(Le);he.value=he.__value="";var _=t(he);ot(_,1,()=>e(w),pt,(Ue,qe)=>{var Je=Ja(),et=l(Je,!0);a(Je);var g={};I(()=>{y(et,(e(qe),i(()=>e(qe).name))),g!==(g=(e(qe),i(()=>e(qe).id)))&&(Je.value=(Je.__value=(e(qe),i(()=>e(qe).id)))??"")}),o(Ue,Je)}),a(Le);var Pe;na(Le),a(Te),I(()=>{Pe!==(Pe=(s(),i(()=>s().subclass)))&&(Le.value=(Le.__value=(s(),i(()=>s().subclass)))??"",Xt(Le,(s(),i(()=>s().subclass))))}),F("change",Le,q),o(xe,Te)};j(Be,xe=>{e(w),i(()=>e(w).length>0)&&xe(x)})}var X=t(Be,2),Y=t(l(X),2);De(Y),a(X);var m=t(X,2),c=t(l(m),2);De(c),a(m);var R=t(m,2),ue=t(l(R),2);De(ue),a(R);var G=t(R,2),pe=t(l(G),2);De(pe),a(G),a(ce),I(()=>{ne!==(ne=(s(),i(()=>s().class)))&&(E.value=(E.__value=(s(),i(()=>s().class)))??"",Xt(E,(s(),i(()=>s().class)))),Ca(Y,(s(),i(()=>s().level)))}),Me(te,()=>s().name,xe=>Ze(V,i(s).name=xe,i(s))),F("change",E,f),F("change",Y,ee),Me(c,()=>s().race,xe=>Ze(V,i(s).race=xe,i(s))),Me(ue,()=>s().background,xe=>Ze(V,i(s).background=xe,i(s))),Me(pe,()=>s().alignment,xe=>Ze(V,i(s).alignment=xe,i(s))),o(ae,ce)};j(be,ae=>{v(),i(()=>!v().characterInfo)&&ae(N)})}a(K),I(()=>{st(oe,"aria-label",(v(),i(()=>v().characterInfo?"Expand":"Collapse"))),y(me,(v(),i(()=>v().characterInfo?"â–¼":"â–²")))}),F("click",oe,B),o(r,K),_t(),k()}var Za=h('<div class="ability-card svelte-bbv1xt"><h3 class="svelte-bbv1xt"> </h3> <input type="number" class="ability-score svelte-bbv1xt" min="1" max="30"/> <div class="ability-modifier svelte-bbv1xt"> </div> <button class="roll-btn svelte-bbv1xt">Check</button> <div class="save-row svelte-bbv1xt"><input type="checkbox" class="svelte-bbv1xt"/> <label class="svelte-bbv1xt">Save</label> <button class="roll-btn-small svelte-bbv1xt">Roll</button></div></div>'),es=h('<div class="proficiency-bonus svelte-bbv1xt"><label for="profBonus">Proficiency Bonus</label> <input type="number" id="profBonus" class="prof-input svelte-bbv1xt"/></div> <div class="abilities-grid svelte-bbv1xt"></div>',1),ts=h('<section><div class="header svelte-bbv1xt"><h2 class="svelte-bbv1xt">Ability Scores</h2> <button class="collapse-btn svelte-bbv1xt"> </button></div> <!></section>');function as(r,u){mt(u,!1);const s=()=>We(Yt,"$abilityModifiers",w),v=()=>We(V,"$character",w),S=()=>We(Dt,"$searchFilter",w),k=()=>We(ft,"$collapsedStates",w),[w,T]=St(),f=A(),q=A(),ee=Bt(),B=[{key:"strength",label:"Strength"},{key:"dexterity",label:"Dexterity"},{key:"constitution",label:"Constitution"},{key:"intelligence",label:"Intelligence"},{key:"wisdom",label:"Wisdom"},{key:"charisma",label:"Charisma"}];function K(){updateProficiencyBonus()}function de(E){const le=s()[E],ie=`1d20${le>=0?"+":""}${le}`;ee("roll",ie)}function oe(E){const le=s()[E],ie=v().saveProficiencies[E]?v().proficiencyBonus:0,ne=le+ie,Be=`1d20${ne>=0?"+":""}${ne}`;ee("roll",Be)}function me(){ft.update(E=>({...E,abilityScores:!E.abilityScores}))}Qe(()=>S(),()=>{n(f,B.filter(({label:E})=>S()?E.toLowerCase().includes(S().toLowerCase()):!0))}),Qe(()=>(e(f),S()),()=>{n(q,e(f).length>0||!S()||S().toLowerCase().includes("proficiency"))}),Lt(),gt();var be=ts();let N;var ae=l(be),ce=t(l(ae),2),Q=l(ce,!0);a(ce),a(ae);var te=t(ae,2);{var se=E=>{var le=es(),ie=ze(le),ne=t(l(ie),2);De(ne),a(ie);var Be=t(ie,2);ot(Be,5,()=>e(f),pt,(x,X)=>{let Y=()=>e(X).key,m=()=>e(X).label;var c=Za(),R=l(c),ue=l(R,!0);a(R);var G=t(R,2);De(G);var pe=t(G,2),xe=l(pe);a(pe);var Te=t(pe,2),Le=t(Te,2),he=l(Le);De(he);var _=t(he,2),Pe=t(_,2);a(Le),a(c),I(Ue=>{y(ue,Ue),y(xe,`${s(),Y(),i(()=>s()[Y()]>=0?"+":"")??""}${s(),Y(),i(()=>s()[Y()])??""}`),st(he,"id",`${Y()}-save`),st(_,"for",`${Y()}-save`)},[()=>(m(),i(()=>m().substring(0,3).toUpperCase()))]),Me(G,()=>v().abilities[Y()],Ue=>Ze(V,i(v).abilities[Y()]=Ue,i(v))),F("change",G,K),F("click",Te,()=>de(Y())),va(he,()=>v().saveProficiencies[Y()],Ue=>Ze(V,i(v).saveProficiencies[Y()]=Ue,i(v))),F("click",Pe,()=>oe(Y())),o(x,c)}),a(Be),Me(ne,()=>v().proficiencyBonus,x=>Ze(V,i(v).proficiencyBonus=x,i(v))),o(E,le)};j(te,E=>{k(),i(()=>!k().abilityScores)&&E(se)})}a(be),I(()=>{N=ct(be,1,"ability-scores svelte-bbv1xt",null,N,{hidden:!e(q)}),st(ce,"aria-label",(k(),i(()=>k().abilityScores?"Expand":"Collapse"))),y(Q,(k(),i(()=>k().abilityScores?"â–¼":"â–²")))}),F("click",ce,me),o(r,be),_t(),T()}var ss=h('<span class="hit-dice-type"> </span>'),ls=h('<div class="stats-grid svelte-1r5hyyb"><div class="stat-box svelte-1r5hyyb"><label for="armorClass" class="svelte-1r5hyyb">Armor Class</label> <input type="number" id="armorClass" class="stat-input svelte-1r5hyyb"/></div> <div class="stat-box svelte-1r5hyyb"><label for="initiative" class="svelte-1r5hyyb">Initiative</label> <input type="number" id="initiative" class="stat-input svelte-1r5hyyb"/></div> <div class="stat-box svelte-1r5hyyb"><label for="speed" class="svelte-1r5hyyb">Speed</label> <input type="text" id="speed" class="stat-input svelte-1r5hyyb"/></div></div> <div class="hp-section svelte-1r5hyyb"><h3 class="svelte-1r5hyyb">Hit Points</h3> <div class="hp-display svelte-1r5hyyb"><div class="hp-inputs svelte-1r5hyyb"><input type="number" class="hp-current svelte-1r5hyyb" min="0"/> <span class="hp-separator svelte-1r5hyyb">/</span> <input type="number" class="hp-max svelte-1r5hyyb" min="0"/></div> <div class="hp-controls svelte-1r5hyyb"><button class="hp-btn svelte-1r5hyyb">âˆ’</button> <button class="hp-btn svelte-1r5hyyb">+</button> <button class="hp-btn svelte-1r5hyyb">âˆ’5</button> <button class="hp-btn svelte-1r5hyyb">+5</button></div></div> <div class="temp-hp svelte-1r5hyyb"><label for="tempHP" class="svelte-1r5hyyb">Temp HP</label> <input type="number" id="tempHP" min="0" class="svelte-1r5hyyb"/></div></div> <div class="hit-dice-section svelte-1r5hyyb"><h3 class="svelte-1r5hyyb">Hit Dice</h3> <div class="hit-dice-display svelte-1r5hyyb"><input type="number" class="hit-dice-input svelte-1r5hyyb" min="0"/> <span>/</span> <input type="number" class="hit-dice-input svelte-1r5hyyb" min="0"/> <!></div> <div class="hit-dice-controls"><label for="hitDiceCount" class="svelte-1r5hyyb">Roll</label> <input type="number" id="hitDiceCount" class="hit-dice-count-input svelte-1r5hyyb" min="1" value="1"/> <button class="btn btn-primary roll-hit-dice use-enabled svelte-1r5hyyb">ðŸŽ² Roll</button></div></div>',1),is=h('<section><div class="header svelte-1r5hyyb"><h2 class="svelte-1r5hyyb">Combat Stats</h2> <button class="collapse-btn svelte-1r5hyyb"> </button></div> <!></section>');function rs(r,u){mt(u,!1);const s=()=>We(V,"$character",w),v=()=>We(Yt,"$abilityModifiers",w),S=()=>We(Dt,"$searchFilter",w),k=()=>We(ft,"$collapsedStates",w),[w,T]=St(),f=A(),q=Bt();function ee(Q){V.update(te=>(te.currentHP=Math.max(0,Math.min(te.maxHP,te.currentHP+Q)),te))}function B(Q=1){if(s().hitDice.current<=0){alert("No hit dice remaining!");return}if(!s().class){alert("Please select a class first!");return}const te=$t(s().class);if(!te){alert("Invalid class configuration!");return}const se=Math.min(Q,s().hitDice.current),E=te.hitDice,le=v().constitution,ie=le>=0?`+${le}`:`${le}`,ne=`${se}${E}${ie}`;q("rollHitDice",{notation:ne,hitDie:E,count:se})}function K(){ft.update(Q=>({...Q,combatStats:!Q.combatStats}))}Qe(()=>S(),()=>{n(f,!S()||"armor class".includes(S().toLowerCase())||"initiative".includes(S().toLowerCase())||"speed".includes(S().toLowerCase())||"hit points".includes(S().toLowerCase())||"hp".includes(S().toLowerCase())||"hit dice".includes(S().toLowerCase())||"combat".includes(S().toLowerCase()))}),Lt(),gt();var de=is();let oe;var me=l(de),be=t(l(me),2),N=l(be,!0);a(be),a(me);var ae=t(me,2);{var ce=Q=>{var te=ls(),se=ze(te),E=l(se),le=t(l(E),2);De(le),a(E);var ie=t(E,2),ne=t(l(ie),2);De(ne),a(ie);var Be=t(ie,2),x=t(l(Be),2);De(x),a(Be),a(se);var X=t(se,2),Y=t(l(X),2),m=l(Y),c=l(m);De(c);var R=t(c,4);De(R),a(m);var ue=t(m,2),G=l(ue),pe=t(G,2),xe=t(pe,2),Te=t(xe,2);a(ue),a(Y);var Le=t(Y,2),he=t(l(Le),2);De(he),a(Le),a(X);var _=t(X,2),Pe=t(l(_),2),Ue=l(Pe);De(Ue);var qe=t(Ue,4);De(qe);var Je=t(qe,2);{var et=H=>{const je=at(()=>(U($t),s(),i(()=>$t(s().class))));var Fe=lt(),Ee=ze(Fe);{var _e=L=>{const ge=at(()=>(v(),i(()=>v().constitution)));var fe=ss(),He=l(fe);a(fe),I(()=>y(He,`(${U(e(je)),i(()=>e(je).hitDice)??""}${(e(ge)>=0?`+${e(ge)}`:e(ge))??""})`)),o(L,fe)};j(Ee,L=>{e(je)&&L(_e)})}o(H,Fe)};j(Je,H=>{s(),i(()=>s().class)&&H(et)})}a(Pe);var g=t(Pe,2),z=t(l(g),2),J=t(z,2);a(g),a(_),I(()=>{st(c,"max",(s(),i(()=>s().maxHP))),st(Ue,"max",(s(),i(()=>s().hitDice.max))),st(z,"max",(s(),i(()=>s().hitDice.current))),J.disabled=(s(),i(()=>s().hitDice.current<=0||!s().class))}),Me(le,()=>s().armorClass,H=>Ze(V,i(s).armorClass=H,i(s))),Me(ne,()=>s().initiative,H=>Ze(V,i(s).initiative=H,i(s))),Me(x,()=>s().speed,H=>Ze(V,i(s).speed=H,i(s))),Me(c,()=>s().currentHP,H=>Ze(V,i(s).currentHP=H,i(s))),Me(R,()=>s().maxHP,H=>Ze(V,i(s).maxHP=H,i(s))),F("click",G,()=>ee(-1)),F("click",pe,()=>ee(1)),F("click",xe,()=>ee(-5)),F("click",Te,()=>ee(5)),Me(he,()=>s().tempHP,H=>Ze(V,i(s).tempHP=H,i(s))),Me(Ue,()=>s().hitDice.current,H=>Ze(V,i(s).hitDice.current=H,i(s))),Me(qe,()=>s().hitDice.max,H=>Ze(V,i(s).hitDice.max=H,i(s))),F("input",z,H=>{const je=H.target,Fe=parseInt(je.value);Fe>s().hitDice.current&&(je.value=String(s().hitDice.current)),Fe<1&&(je.value="1")}),F("click",J,()=>{const H=document.getElementById("hitDiceCount"),je=parseInt(H?.value||"1");B(je)}),o(Q,te)};j(ae,Q=>{k(),i(()=>!k().combatStats)&&Q(ce)})}a(de),I(()=>{oe=ct(de,1,"combat-stats svelte-1r5hyyb",null,oe,{hidden:!e(f)}),st(be,"aria-label",(k(),i(()=>k().combatStats?"Expand":"Collapse"))),y(N,(k(),i(()=>k().combatStats?"â–¼":"â–²")))}),F("click",be,K),o(r,de),_t(),T()}const ia={acrobatics:"dexterity",animalHandling:"wisdom",arcana:"intelligence",athletics:"strength",deception:"charisma",history:"intelligence",insight:"wisdom",intimidation:"charisma",investigation:"intelligence",medicine:"wisdom",nature:"intelligence",perception:"wisdom",performance:"charisma",persuasion:"charisma",religion:"intelligence",sleightOfHand:"dexterity",stealth:"dexterity",survival:"wisdom"};var ns=h('<div class="skill-row svelte-1f1pl16"><input type="checkbox" class="svelte-1f1pl16"/> <label class="svelte-1f1pl16"> <span class="ability-tag svelte-1f1pl16"> </span></label> <span class="skill-modifier svelte-1f1pl16"> </span> <button class="roll-btn svelte-1f1pl16">Roll</button></div>'),os=h('<div class="skills-grid svelte-1f1pl16"></div>'),cs=h('<section><div class="header svelte-1f1pl16"><h2 class="svelte-1f1pl16">Skills</h2> <button class="collapse-btn svelte-1f1pl16"> </button></div> <!></section>');function vs(r,u){mt(u,!1);const s=()=>We(Yt,"$abilityModifiers",w),v=()=>We(V,"$character",w),S=()=>We(Dt,"$searchFilter",w),k=()=>We(ft,"$collapsedStates",w),[w,T]=St(),f=A(),q=A(),ee=Bt(),B=[{key:"acrobatics",label:"Acrobatics"},{key:"animalHandling",label:"Animal Handling"},{key:"arcana",label:"Arcana"},{key:"athletics",label:"Athletics"},{key:"deception",label:"Deception"},{key:"history",label:"History"},{key:"insight",label:"Insight"},{key:"intimidation",label:"Intimidation"},{key:"investigation",label:"Investigation"},{key:"medicine",label:"Medicine"},{key:"nature",label:"Nature"},{key:"perception",label:"Perception"},{key:"performance",label:"Performance"},{key:"persuasion",label:"Persuasion"},{key:"religion",label:"Religion"},{key:"sleightOfHand",label:"Sleight of Hand"},{key:"stealth",label:"Stealth"},{key:"survival",label:"Survival"}];function K(se){const E=ia[se],le=s()[E],ie=v().skillProficiencies[se]?v().proficiencyBonus:0;return le+ie}function de(se){const E=K(se),le=`1d20${E>=0?"+":""}${E}`;ee("roll",le)}function oe(){ft.update(se=>({...se,skills:!se.skills}))}Qe(()=>S(),()=>{n(f,B.filter(({label:se})=>S()?se.toLowerCase().includes(S().toLowerCase()):!0))}),Qe(()=>e(f),()=>{n(q,e(f).length>0)}),Lt(),gt();var me=cs();let be;var N=l(me),ae=t(l(N),2),ce=l(ae,!0);a(ae),a(N);var Q=t(N,2);{var te=se=>{var E=os();ot(E,5,()=>e(f),pt,(le,ie)=>{let ne=()=>e(ie).key,Be=()=>e(ie).label;const x=at(()=>(U(ia),ne(),i(()=>ia[ne()]))),X=at(()=>(ne(),i(()=>K(ne()))));var Y=ns(),m=l(Y);De(m);var c=t(m,2),R=l(c),ue=t(R),G=l(ue);a(ue),a(c);var pe=t(c,2),xe=l(pe);a(pe);var Te=t(pe,2);a(Y),I(Le=>{st(m,"id",ne()),st(c,"for",ne()),y(R,`${Be()??""} `),y(G,`(${Le??""})`),y(xe,`${e(X)>=0?"+":""}${e(X)??""}`)},[()=>(U(e(x)),i(()=>e(x).substring(0,3).toUpperCase()))]),va(m,()=>v().skillProficiencies[ne()],Le=>Ze(V,i(v).skillProficiencies[ne()]=Le,i(v))),F("click",Te,()=>de(ne())),o(le,Y)}),a(E),o(se,E)};j(Q,se=>{k(),i(()=>!k().skills)&&se(te)})}a(me),I(()=>{be=ct(me,1,"skills svelte-1f1pl16",null,be,{hidden:!e(q)}),st(ae,"aria-label",(k(),i(()=>k().skills?"Expand":"Collapse"))),y(ce,(k(),i(()=>k().skills?"â–¼":"â–²")))}),F("click",ae,oe),o(r,me),_t(),T()}let Jt=null,Vt=null;async function wa(){if(Jt)return Jt;try{return Jt=await(await fetch(ja("/data/spells.json"))).json(),Jt||[]}catch(r){return console.error("Failed to load spells:",r),[]}}async function ds(){if(Vt)return Vt;try{return Vt=await(await fetch(ja("/data/feats.json"))).json(),Vt||[]}catch(r){return console.error("Failed to load feats:",r),[]}}function ba(r,u){if(!u.trim())return r;const s=u.toLowerCase();return r.filter(v=>v.name.toLowerCase().includes(s)||v.school.toLowerCase().includes(s)||v.classes.some(S=>S.toLowerCase().includes(s))||v.description.toLowerCase().includes(s))}function us(r,u){return u===null?r:r.filter(s=>s.level===u)}function ps(r,u){if(!u.trim())return r;const s=u.toLowerCase();return r.filter(v=>v.name.toLowerCase().includes(s)||v.description.toLowerCase().includes(s))}var fs=h('<button class="btn-remove svelte-14o91c5">Ã—</button>'),bs=h('<div class="spell-info-loading svelte-14o91c5">Loading spell info...</div>'),hs=h('<div class="spell-notes svelte-14o91c5"><h4 class="svelte-14o91c5">General Notes</h4> <p> </p></div>'),gs=h('<li class="svelte-14o91c5"><strong>At Higher Levels:</strong> </li>'),ms=h('<ul class="svelte-14o91c5"><li class="svelte-14o91c5"><strong>Level:</strong> </li> <li class="svelte-14o91c5"><strong>Casting Time:</strong> </li> <li class="svelte-14o91c5"><strong>Range:</strong> </li> <li class="svelte-14o91c5"><strong>Components:</strong> <!></li> <li class="svelte-14o91c5"><strong>Duration:</strong> <!> </li> <li class="svelte-14o91c5"><strong>Description:</strong> </li> <!></ul>'),_s=h("<option> </option>"),ys=h('<span class="scaled-damage svelte-14o91c5"><!> </span>'),ks=h('<span class="scaled-damage svelte-14o91c5"> </span>'),xs=h('<div class="target-condition svelte-14o91c5"><label class="svelte-14o91c5"><input type="checkbox" class="use-enabled svelte-14o91c5"/> Target is Fiend or Undead <!></label></div>'),$s=h('<div class="spell-level-selector svelte-14o91c5"><label class="svelte-14o91c5">Cast at Level:</label> <select class="spell-level-select use-enabled svelte-14o91c5"></select> <!></div> <!>',1),Ss=h('<div class="spell-level-selector svelte-14o91c5"><span style="color: #dc3545; font-weight: bold;">No spell slots available!</span></div>'),Cs=h('<!> <div class="spell-info svelte-14o91c5"><div class="spell-info-header svelte-14o91c5" role="button" tabindex="0"><h4 class="svelte-14o91c5">Spell Info</h4> <button class="collapse-btn-small svelte-14o91c5"> </button></div> <!></div> <!>',1),Ls=h('<div class="spell-info-missing svelte-14o91c5">Spell info not found.</div>'),js=h('<div class="attack-notes svelte-14o91c5"><label class="svelte-14o91c5">Notes</label> <textarea placeholder="e.g., DC 15 Dex save, Range 120 ft, Concentration" class="notes-input svelte-14o91c5" rows="2"></textarea></div>'),ws=h('<button class="btn btn-primary">Roll Attack</button>'),Ds=h('<button class="btn btn-secondary"><!></button>'),Fs=h('<button class="btn btn-secondary">Roll Damage</button>'),Rs=h('<div class="attack-card svelte-14o91c5"><div class="attack-header svelte-14o91c5"><input type="text" placeholder="Attack name" class="attack-name svelte-14o91c5"/> <!></div> <div class="attack-details svelte-14o91c5"><div class="attack-field svelte-14o91c5"><label class="svelte-14o91c5">Bonus</label> <input type="number" class="attack-bonus svelte-14o91c5"/></div> <div class="attack-field svelte-14o91c5"><label class="svelte-14o91c5">Damage</label> <input type="text" placeholder="e.g., 2d6+3" class="attack-damage svelte-14o91c5"/></div> <div class="attack-field svelte-14o91c5"><label class="svelte-14o91c5">Type</label> <input type="text" placeholder="e.g., slashing" class="attack-type svelte-14o91c5"/></div></div> <!> <!> <div class="attack-actions svelte-14o91c5"><!> <!></div></div>'),As=h('<p class="no-attacks svelte-14o91c5">No attacks added yet. Click "Add Attack" to create one.</p>'),Is=h('<p class="no-attacks svelte-14o91c5">No attacks match your search.</p>'),Ms=h('<button class="btn btn-secondary">Add Attack</button> <div class="attacks-list svelte-14o91c5"><!> <!></div>',1),Ps=h('<section><div class="header svelte-14o91c5"><h2 class="svelte-14o91c5">Attacks & Spells</h2> <button class="collapse-btn svelte-14o91c5"> </button></div> <!></section>');function Es(r,u){mt(u,!1);const s=()=>We(V,"$character",w),v=()=>We(Dt,"$searchFilter",w),S=()=>We(ft,"$collapsedStates",w),k=()=>We(Qt,"$isEditMode",w),[w,T]=St(),f=A(),q=A(),ee=Bt();let B=A({});function K(c){$a(B,e(B)[c]=!e(B)[c]),n(B,{...e(B)})}function de(c){return c.description.toLowerCase().includes("regain")&&(c.description.toLowerCase().includes("hit point")||c.description.toLowerCase().includes("hp"))}function oe(){V.update(c=>(c.attacks=[...c.attacks,{id:crypto.randomUUID(),name:"",bonus:0,damage:"",damageType:"",notes:""}],c))}function me(c){V.update(R=>(R.attacks=R.attacks.filter(ue=>ue.id!==c),R))}function be(c){let R=c.damage;if(c.spellRef){const G=te(c.spellRef);if(G&&G.level>0){const pe=c.castAtLevel||G.level;if(!se(pe)){alert(`No level ${pe} spell slots available!`);return}R=E(c,G)}}const ue=`1d20${c.bonus>=0?"+":""}${c.bonus}`;ee("roll",{notation:ue,damageNotation:R,attackName:c.name})}function N(c){if(!c.damage){alert(`${c.name}: No damage specified`);return}let R=c.damage;if(c.spellRef){const ue=te(c.spellRef);if(ue&&ue.level>0){const G=c.castAtLevel||ue.level;if(!se(G)){alert(`No level ${G} spell slots available!`);return}R=E(c,ue)}}ee("roll",{notation:R,attackName:c.name})}function ae(){ft.update(c=>({...c,attacks:!c.attacks}))}let ce=A([]),Q=A(!1);Wt(async()=>{n(ce,await wa()),n(Q,!0)});function te(c){return e(ce).find(R=>R.name===c)}function se(c){s().classFeatures.spellSlotsByLevel||Ze(V,i(s).classFeatures.spellSlotsByLevel={},i(s)),s().classFeatures.spellSlotsByLevel[c]||Ze(V,i(s).classFeatures.spellSlotsByLevel[c]=Array(2).fill(!1),i(s));const ue=s().classFeatures.spellSlotsByLevel[c].findIndex(G=>!G);return ue===-1?!1:(V.update(G=>(G.classFeatures.spellSlotsByLevel||(G.classFeatures.spellSlotsByLevel={}),G.classFeatures.spellSlotsByLevel[c]||(G.classFeatures.spellSlotsByLevel[c]=Array(2).fill(!1)),G.classFeatures.spellSlotsByLevel[c][ue]=!0,G)),!0)}function E(c,R){let ue=c.damage,G=0;if(R.higherLevelSlot&&c.castAtLevel){const he=R.level,Pe=(c.castAtLevel||he)-he;if(Pe>0){const Ue=R.higherLevelSlot.match(/(\d+)d(\d+)\s+for\s+each.*?level\s+above/i);if(Ue){const[,qe]=Ue;G+=Pe*parseInt(qe)}}}if(c.targetIsFiendOrUndead&&R.description.includes("Fiend or an Undead")){const he=R.description.match(/increases by (\d+)d(\d+) if.*?Fiend or.*?Undead/i);if(he){const[,_]=he;G+=parseInt(_)}}const pe=ue.match(/(\d+)d(\d+)/);if(!pe)return ue;const[,xe,Te]=pe;return`${parseInt(xe)+G}d${Te}`}function le(c){const R=[];for(let G=c.level;G<=9;G++){const pe=s().classFeatures.spellSlotsByLevel?.[G];pe&&pe.length>0&&R.push(G)}return R}Qe(()=>(s(),v()),()=>{n(f,s().attacks.filter(c=>{if(!v())return!0;const R=v().toLowerCase();return c.name.toLowerCase().includes(R)||c.damageType.toLowerCase().includes(R)}).sort((c,R)=>!c.spellRef&&R.spellRef?-1:c.spellRef&&!R.spellRef?1:0))}),Qe(()=>(v(),e(f)),()=>{n(q,!v()||e(f).length>0||"attack".includes(v().toLowerCase())||"spell".includes(v().toLowerCase()))}),Lt(),gt();var ie=Ps();let ne;var Be=l(ie),x=t(l(Be),2),X=l(x,!0);a(x),a(Be);var Y=t(Be,2);{var m=c=>{var R=Ms(),ue=ze(R),G=t(ue,2),pe=l(G);ot(pe,1,()=>e(f),he=>he.id,(he,_,Pe)=>{var Ue=Rs(),qe=l(Ue),Je=l(qe);De(Je);var et=t(Je,2);{var g=M=>{var P=fs();F("click",P,()=>me(e(_).id)),o(M,P)};j(et,M=>{k()&&M(g)})}a(qe);var z=t(qe,2),J=l(z),H=t(l(J),2);De(H),a(J);var je=t(J,2),Fe=t(l(je),2);De(Fe),a(je);var Ee=t(je,2),_e=t(l(Ee),2);De(_e),a(Ee),a(z);var L=t(z,2);{var ge=M=>{var P=lt(),d=ze(P);{var D=C=>{var b=bs();o(C,b)},W=C=>{const b=at(()=>(e(_),i(()=>te(e(_).spellRef))));var ve=lt(),Se=ze(ve);{var ye=p=>{var O=Cs(),$=ze(O);{var we=Ye=>{var tt=hs(),vt=t(l(tt),2),Ft=l(vt,!0);a(vt),a(tt),I(()=>y(Ft,(e(_),i(()=>e(_).generalNotes)))),o(Ye,tt)};j($,Ye=>{e(_),i(()=>e(_).generalNotes)&&Ye(we)})}var ke=t($,2),Oe=l(ke),Ae=t(l(Oe),2),Ce=l(Ae,!0);a(Ae),a(Oe);var Ie=t(Oe,2);{var it=Ye=>{var tt=ms(),vt=l(tt),Ft=t(l(vt));a(vt);var Ht=t(vt,2),ea=t(l(Ht));a(Ht);var yt=t(Ht,2),Mt=t(l(yt));a(yt);var Rt=t(yt,2),Tt=t(l(Rt)),At=t(Tt);{var ta=rt=>{var nt=ut();I(()=>y(nt,`(${U(e(b)),i(()=>e(b).material)??""})`)),o(rt,nt)};j(At,rt=>{U(e(b)),i(()=>e(b).material)&&rt(ta)})}a(Rt);var Nt=t(Rt,2),Kt=t(l(Nt),2);{var aa=rt=>{var nt=ut("Concentration,");o(rt,nt)};j(Kt,rt=>{U(e(b)),i(()=>e(b).concentration)&&rt(aa)})}var bt=t(Kt,1,!0);a(Nt);var ht=t(Nt,2),dt=t(l(ht));a(ht);var kt=t(ht,2);{var jt=rt=>{var nt=gs(),xt=t(l(nt));a(nt),I(()=>y(xt,` ${U(e(b)),i(()=>e(b).higherLevelSlot)??""}`)),o(rt,nt)};j(kt,rt=>{U(e(b)),i(()=>e(b).higherLevelSlot)&&rt(jt)})}a(tt),I(rt=>{y(Ft,` ${U(e(b)),i(()=>e(b).level)??""}`),y(ea,` ${U(e(b)),i(()=>e(b).castingTime||e(b).actionType)??""}`),y(Mt,` ${U(e(b)),i(()=>e(b).range)??""}`),y(Tt,` ${rt??""}`),y(bt,(U(e(b)),i(()=>e(b).duration))),y(dt,` ${U(e(b)),i(()=>e(b).description)??""}`)},[()=>(U(e(b)),i(()=>e(b).components.join(", ")))]),o(Ye,tt)};j(Ie,Ye=>{e(B),e(_),i(()=>!e(B)[e(_).id])&&Ye(it)})}a(ke);var re=t(ke,2);{var Ve=Ye=>{const tt=at(()=>(U(e(b)),i(()=>le(e(b)))));var vt=lt(),Ft=ze(vt);{var Ht=yt=>{var Mt=$s(),Rt=ze(Mt),Tt=l(Rt),At=t(Tt,2);I(()=>{e(_),Ct(()=>{e(tt)})}),ot(At,5,()=>e(tt),pt,(bt,ht)=>{var dt=_s(),kt=l(dt);a(dt);var jt={};I(()=>{y(kt,`Level ${e(ht)??""}`),jt!==(jt=e(ht))&&(dt.value=(dt.__value=e(ht))??"")}),o(bt,dt)}),a(At);var ta=t(At,2);{var Nt=bt=>{const ht=at(()=>(e(_),U(e(b)),i(()=>E(e(_),e(b)))));var dt=ys(),kt=l(dt);{var jt=xt=>{var It=ut("Healing");o(xt,It)},rt=xt=>{var It=ut("Damage");o(xt,It)};j(kt,xt=>{U(e(b)),i(()=>de(e(b)))?xt(jt):xt(rt,!1)})}var nt=t(kt);a(dt),I(()=>y(nt,` ${e(ht)??""}`)),o(bt,dt)};j(ta,bt=>{e(_),U(e(b)),i(()=>e(_).castAtLevel&&e(_).castAtLevel>e(b).level)&&bt(Nt)})}a(Rt);var Kt=t(Rt,2);{var aa=bt=>{var ht=xs(),dt=l(ht),kt=l(dt);De(kt);var jt=t(kt,2);{var rt=nt=>{const xt=at(()=>(e(_),U(e(b)),i(()=>E(e(_),e(b)))));var It=ks(),Da=l(It);a(It),I(()=>y(Da,`(+1d8, total: ${e(xt)??""})`)),o(nt,It)};j(jt,nt=>{e(_),i(()=>e(_).targetIsFiendOrUndead)&&nt(rt)})}a(dt),a(ht),va(kt,()=>e(_).targetIsFiendOrUndead,nt=>(e(_).targetIsFiendOrUndead=nt,Ct(()=>(e(f),s(),v())))),o(bt,ht)};j(Kt,bt=>{U(e(b)),i(()=>e(b).description.includes("Fiend or an Undead"))&&bt(aa)})}I(()=>{st(Tt,"for",`castLevel-${e(_),i(()=>e(_).id)??""}`),st(At,"id",`castLevel-${e(_),i(()=>e(_).id)??""}`)}),La(At,()=>e(_).castAtLevel,bt=>(e(_).castAtLevel=bt,Ct(()=>(e(f),s(),v())))),o(yt,Mt)},ea=yt=>{var Mt=Ss();o(yt,Mt)};j(Ft,yt=>{U(e(tt)),i(()=>e(tt).length>0)?yt(Ht):yt(ea,!1)})}o(Ye,vt)};j(re,Ye=>{U(e(b)),i(()=>e(b).higherLevelSlot&&e(b).level>0)&&Ye(Ve)})}I(()=>{st(Ae,"aria-label",(e(B),e(_),i(()=>e(B)[e(_).id]?"Expand":"Collapse"))),y(Ce,(e(B),e(_),i(()=>e(B)[e(_).id]?"â–¼":"â–²")))}),F("click",Oe,()=>K(e(_).id)),F("keydown",Oe,Ye=>Ye.key==="Enter"&&K(e(_).id)),o(p,O)},Ge=p=>{var O=Ls();o(p,O)};j(Se,p=>{e(b)?p(ye):p(Ge,!1)})}o(C,ve)};j(d,C=>{e(ce),i(()=>e(ce).length===0)?C(D):C(W,!1)})}o(M,P)};j(L,M=>{e(_),i(()=>e(_).spellRef)&&M(ge)})}var fe=t(L,2);{var He=M=>{var P=js(),d=t(l(P),2);Ot(d),a(P),Me(d,()=>e(_).notes,D=>(e(_).notes=D,Ct(()=>(e(f),s(),v())))),o(M,P)};j(fe,M=>{e(_),i(()=>!e(_).spellRef)&&M(He)})}var Ke=t(fe,2),Xe=l(Ke);{var Re=M=>{var P=ws();F("click",P,()=>be(e(_))),o(M,P)};j(Xe,M=>{e(_),i(()=>e(_).bonus!==0||!e(_).spellRef)&&M(Re)})}var Z=t(Xe,2);{var $e=M=>{const P=at(()=>(e(_),i(()=>te(e(_).spellRef))));var d=Ds(),D=l(d);{var W=b=>{var ve=ut("Roll Healing");o(b,ve)},C=b=>{var ve=ut("Roll Damage");o(b,ve)};j(D,b=>{U(e(P)),i(()=>e(P)&&de(e(P)))?b(W):b(C,!1)})}a(d),F("click",d,()=>N(e(_))),o(M,d)},Ne=M=>{var P=Fs();F("click",P,()=>N(e(_))),o(M,P)};j(Z,M=>{e(_),e(Q),i(()=>e(_).spellRef&&e(Q))?M($e):M(Ne,!1)})}a(Ke),a(Ue),Me(Je,()=>e(_).name,M=>(e(_).name=M,Ct(()=>(e(f),s(),v())))),Me(H,()=>e(_).bonus,M=>(e(_).bonus=M,Ct(()=>(e(f),s(),v())))),Me(Fe,()=>e(_).damage,M=>(e(_).damage=M,Ct(()=>(e(f),s(),v())))),Me(_e,()=>e(_).damageType,M=>(e(_).damageType=M,Ct(()=>(e(f),s(),v())))),o(he,Ue)});var xe=t(pe,2);{var Te=he=>{var _=As();o(he,_)},Le=he=>{var _=lt(),Pe=ze(_);{var Ue=qe=>{var Je=Is();o(qe,Je)};j(Pe,qe=>{e(f),i(()=>e(f).length===0)&&qe(Ue)},!0)}o(he,_)};j(xe,he=>{s(),i(()=>s().attacks.length===0)?he(Te):he(Le,!1)})}a(G),F("click",ue,oe),o(c,R)};j(Y,c=>{S(),i(()=>!S().attacks)&&c(m)})}a(ie),I(()=>{ne=ct(ie,1,"attacks svelte-14o91c5",null,ne,{hidden:!e(q)}),st(x,"aria-label",(S(),i(()=>S().attacks?"Expand":"Collapse"))),y(X,(S(),i(()=>S().attacks?"â–¼":"â–²")))}),F("click",x,ae),o(r,ie),_t(),T()}var Us=h('<p class="no-features svelte-1kpvv0n">Select a class to see available features</p>'),Bs=h('<p class="no-features svelte-1kpvv0n">No class features available at this level</p>'),Hs=h('<input type="checkbox" class="slot-checkbox svelte-1kpvv0n"/>'),Ts=h('<div class="spell-slots svelte-1kpvv0n"><label class="svelte-1kpvv0n"> </label> <div class="slots-tracker svelte-1kpvv0n"></div></div>'),Ns=h('<div class="all-spell-slots"></div>'),Gs=h('<div class="feature-box spellcasting svelte-1kpvv0n"><h3 class="svelte-1kpvv0n"> </h3> <div class="spell-stats svelte-1kpvv0n"><div class="spell-stat svelte-1kpvv0n"><label class="svelte-1kpvv0n">Spell Save DC</label> <div class="spell-value svelte-1kpvv0n"> </div></div> <div class="spell-stat svelte-1kpvv0n"><label class="svelte-1kpvv0n">Prepared Spells</label> <div class="spell-value svelte-1kpvv0n"> </div></div></div> <!> <div class="prepared-spells svelte-1kpvv0n"><label class="svelte-1kpvv0n">Prepared Spells</label> <textarea placeholder="List your prepared spells..." class="svelte-1kpvv0n"></textarea></div></div>'),Os=h('<p class="unlimited svelte-1kpvv0n">Unlimited Uses</p>'),qs=h('<p class="no-uses svelte-1kpvv0n">No uses remaining</p>'),zs=h('<div class="uses-with-button svelte-1kpvv0n"><button class="btn btn-primary use-enabled"> </button> <div class="uses-info svelte-1kpvv0n"><span class="uses-remaining svelte-1kpvv0n"> </span> <span class="reset-info svelte-1kpvv0n"> </span></div> <!></div>'),Ws=h('<div class="uses-tracker svelte-1kpvv0n"><!></div>'),Ks=h('<div class="pool-tracker svelte-1kpvv0n"><input type="number" min="0" class="pool-input svelte-1kpvv0n"/> <span> </span> <button class="btn-small svelte-1kpvv0n"> </button></div>'),Js=h('<p class="no-uses svelte-1kpvv0n">No Channel Divinity uses remaining</p>'),Vs=h('<div class="channel-divinity-option svelte-1kpvv0n"><button class="btn btn-primary use-enabled svelte-1kpvv0n">Use Channel Divinity</button> <div class="uses-info svelte-1kpvv0n"><span class="reset-info svelte-1kpvv0n"> </span></div> <!></div>'),Qs=h('<div class="feature-box svelte-1kpvv0n"><h3 class="svelte-1kpvv0n"><!> </h3> <p class="feature-description svelte-1kpvv0n"> </p> <!></div>'),Xs=h('<div class="features-grid svelte-1kpvv0n"><!> <!></div>'),Ys=h('<section><div class="header svelte-1kpvv0n"><h2 class="svelte-1kpvv0n">Class Features</h2> <button class="collapse-btn svelte-1kpvv0n"> </button></div> <!></section>');function Zs(r,u){mt(u,!1);const s=()=>We(V,"$character",w),v=()=>We(Yt,"$abilityModifiers",w),S=()=>We(Dt,"$searchFilter",w),k=()=>We(ft,"$collapsedStates",w),[w,T]=St(),f=A(),q=A(),ee=A(),B=A(),K=A(),de=A(),oe=A();let me=A(0),be=A(0);function N(m,c){V.update(R=>(R.classFeatures.features[m]=c,R))}function ae(){V.update(m=>(m.classFeatures.spellSlotsByLevel||(m.classFeatures.spellSlotsByLevel={}),e(B).forEach(({level:c,slots:R})=>{m.classFeatures.spellSlotsByLevel[c]||(m.classFeatures.spellSlotsByLevel[c]=Array(R).fill(!1))}),m))}function ce(m){if(typeof m.maxUses=="function"){if((m.name==="Divine Sense"||m.name==="War Priest")&&e(f)?.spellcastingAbility){const c=v()[e(f).spellcastingAbility];return m.maxUses(s().level,c)}return m.maxUses(s().level)}return m.maxUses||0}function Q(m){return typeof m.maxPool=="function"?m.maxPool(s().level):m.maxPool||0}function te(m){return typeof m.description=="function"?m.description(s().level):m.description}function se(){const m="ChannelDivinity";V.update(c=>{const R=c.classFeatures.features[m];return typeof R=="number"&&R>0&&(c.classFeatures.features[m]=R-1),c})}function E(){ft.update(m=>({...m,classFeatures:!m.classFeatures}))}Qe(()=>(s(),$t),()=>{n(f,s().class?$t(s().class):null)}),Qe(()=>(s(),Ut),()=>{n(q,s().class?Ut(s().class,s().level,s().subclass):[])}),Qe(()=>(s(),pa),()=>{n(ee,s().class?pa(s().class,s().level):0)}),Qe(()=>(e(f),s()),()=>{n(B,(()=>{if(!e(f)?.spellcaster)return[];const m=s().level,c=[];return m>=1&&c.push({level:1,slots:Math.min(4,2+Math.floor(m/3))}),m>=3&&c.push({level:2,slots:Math.min(3,2+Math.floor((m-3)/4))}),m>=5&&c.push({level:3,slots:Math.min(3,2+Math.floor((m-5)/5))}),m>=7&&c.push({level:4,slots:Math.min(3,1+Math.floor((m-7)/6))}),m>=9&&c.push({level:5,slots:Math.min(2,1+Math.floor((m-9)/8))}),m>=11&&c.push({level:6,slots:1}),m>=13&&c.push({level:7,slots:1}),m>=15&&c.push({level:8,slots:1}),m>=17&&c.push({level:9,slots:1}),c})())}),Qe(()=>(e(f),v(),s(),fa),()=>{if(e(f)?.spellcaster&&e(f).spellcastingAbility){const m=v()[e(f).spellcastingAbility];n(me,za(s().class,m,s().proficiencyBonus)||0),n(be,fa(s().class,s().level,m))}}),Qe(()=>(s(),e(f),e(B)),()=>{s().class&&e(f)?.spellcaster&&e(B).length>0&&ae()}),Qe(()=>s(),()=>{n(K,(()=>{const c=s().classFeatures.features["ChannelDivinity"];return typeof c=="number"?c:0})())}),Qe(()=>(e(q),S()),()=>{n(de,e(q).filter(m=>{if(!S())return!0;const c=S().toLowerCase();return m.name.toLowerCase().includes(c)||te(m).toLowerCase().includes(c)}))}),Qe(()=>(S(),s(),e(de)),()=>{n(oe,!S()||s().class||"class features".includes(S().toLowerCase())||"spellcasting".includes(S().toLowerCase())||e(de).length>0)}),Lt(),gt();var le=Ys();let ie;var ne=l(le),Be=t(l(ne),2),x=l(Be,!0);a(Be),a(ne);var X=t(ne,2);{var Y=m=>{var c=lt(),R=ze(c);{var ue=pe=>{var xe=Us();o(pe,xe)},G=pe=>{var xe=lt(),Te=ze(xe);{var Le=_=>{var Pe=Bs();o(_,Pe)},he=_=>{var Pe=Xs(),Ue=l(Pe);{var qe=et=>{var g=Gs(),z=l(g),J=l(z);a(z);var H=t(z,2),je=l(H),Fe=t(l(je),2),Ee=l(Fe,!0);a(Fe),a(je);var _e=t(je,2),L=t(l(_e),2),ge=l(L,!0);a(L),a(_e),a(H);var fe=t(H,2);{var He=Re=>{var Z=Ns();ot(Z,5,()=>e(B),pt,($e,Ne)=>{let M=()=>e(Ne).level,P=()=>e(Ne).slots;const d=at(()=>(s(),M(),P(),i(()=>s().classFeatures.spellSlotsByLevel?.[M()]||Array(P()).fill(!1))));var D=Ts(),W=l(D),C=l(W);a(W);var b=t(W,2);ot(b,5,()=>(P(),i(()=>Array(P()))),pt,(ve,Se,ye)=>{var Ge=Hs();De(Ge),I(()=>Ea(Ge,(U(e(d)),i(()=>e(d)[ye]||!1)))),F("change",Ge,p=>{V.update(O=>(O.classFeatures.spellSlotsByLevel||(O.classFeatures.spellSlotsByLevel={}),O.classFeatures.spellSlotsByLevel[M()]||(O.classFeatures.spellSlotsByLevel[M()]=Array(P()).fill(!1)),O.classFeatures.spellSlotsByLevel[M()][ye]=p.currentTarget.checked,O))}),o(ve,Ge)}),a(b),a(D),I(()=>y(C,`${M()===1?"1st":M()===2?"2nd":M()===3?"3rd":`${M()}th`} Level Spell Slots`)),o($e,D)}),a(Z),o(Re,Z)};j(fe,Re=>{e(B),i(()=>e(B).length>0)&&Re(He)})}var Ke=t(fe,2),Xe=t(l(Ke),2);Ot(Xe),a(Ke),a(g),I(Re=>{y(J,`Spellcasting (${Re??""})`),y(Ee,e(me)),y(ge,e(be))},[()=>(e(f),i(()=>e(f).spellcastingAbility?.toUpperCase()))]),Me(Xe,()=>s().classFeatures.preparedSpells,Re=>Ze(V,i(s).classFeatures.preparedSpells=Re,i(s))),o(et,g)};j(Ue,et=>{e(f),i(()=>e(f)?.spellcaster)&&et(qe)})}var Je=t(Ue,2);ot(Je,1,()=>e(de),pt,(et,g)=>{const z=at(()=>(e(g),i(()=>e(g).name.replace(/\s+/g,"")))),J=at(()=>(s(),U(e(z)),i(()=>s().classFeatures.features[e(z)]))),H=at(()=>(U(e(J)),i(()=>Array.isArray(e(J))))),je=at(()=>typeof e(J)=="number");var Fe=Qs(),Ee=l(Fe),_e=l(Ee);{var L=Z=>{var $e=ut("Channel Divinity:");o(Z,$e)};j(_e,Z=>{e(g),i(()=>e(g).type==="channelDivinity")&&Z(L)})}var ge=t(_e);a(Ee);var fe=t(Ee,2),He=l(fe,!0);a(fe);var Ke=t(fe,2);{var Xe=Z=>{const $e=at(()=>(e(g),i(()=>ce(e(g))))),Ne=at(()=>(U(e(H)),U(e($e)),U(e(J)),i(()=>e(H)?e(J).filter(C=>!C).length:e($e))));var M=Ws(),P=l(M);{var d=W=>{var C=Os();o(W,C)},D=W=>{var C=zs(),b=l(C),ve=l(b);a(b);var Se=t(b,2),ye=l(Se),Ge=l(ye);a(ye);var p=t(ye,2),O=l(p);a(p),a(Se);var $=t(Se,2);{var we=ke=>{var Oe=qs();o(ke,Oe)};j($,ke=>{e(Ne)<=0&&ke(we)})}a(C),I(()=>{b.disabled=e(Ne)<=0,y(ve,`Use ${e(g),i(()=>e(g).name)??""}`),y(Ge,`${e(Ne)??""} / ${e($e)??""} uses`),y(O,`Resets on ${e(g),i(()=>e(g).resetOn==="short"?"Short Rest":"Long Rest")??""}`)}),F("click",b,()=>{V.update(ke=>{ke.classFeatures.features[e(z)]||(ke.classFeatures.features[e(z)]=Array(e($e)).fill(!1));const Oe=ke.classFeatures.features[e(z)],Ae=Oe.findIndex(Ce=>!Ce);return Ae!==-1&&(Oe[Ae]=!0),ke})}),o(W,C)};j(P,W=>{e($e)===1/0?W(d):W(D,!1)})}a(M),o(Z,M)},Re=Z=>{var $e=lt(),Ne=ze($e);{var M=d=>{const D=at(()=>(e(g),i(()=>Q(e(g)))));var W=Ks(),C=l(W);De(C);var b=t(C,2),ve=l(b);a(b);var Se=t(b,2),ye=l(Se,!0);a(Se),a(W),I(()=>{Ca(C,e(je)&&e(J)!==void 0?e(J):e(D)),st(C,"max",e(D)),y(ve,`/ ${e(D)??""}`),y(ye,(e(g),i(()=>e(g).resetOn==="short"?"Short Rest":"Long Rest")))}),F("input",C,Ge=>{V.update(p=>(p.classFeatures.features[e(z)]=parseInt(Ge.currentTarget.value)||0,p))}),F("click",Se,()=>N(e(z),e(D))),o(d,W)},P=d=>{var D=lt(),W=ze(D);{var C=b=>{var ve=Vs(),Se=l(ve),ye=t(Se,2),Ge=l(ye),p=l(Ge);a(Ge),a(ye);var O=t(ye,2);{var $=we=>{var ke=Js();o(we,ke)};j(O,we=>{e(K)<=0&&we($)})}a(ve),I(()=>{Se.disabled=e(K)<=0,y(p,`Resets on ${e(g),i(()=>e(g).resetOn==="short"?"Short Rest":"Long Rest")??""}`)}),F("click",Se,se),o(b,ve)};j(W,b=>{e(g),i(()=>e(g).type==="channelDivinity")&&b(C)},!0)}o(d,D)};j(Ne,d=>{e(g),i(()=>e(g).type==="pool")?d(M):d(P,!1)},!0)}o(Z,$e)};j(Ke,Z=>{e(g),i(()=>e(g).type==="uses")?Z(Xe):Z(Re,!1)})}a(Fe),I(Z=>{y(ge,` ${e(g),i(()=>e(g).name)??""}`),y(He,Z)},[()=>(e(g),i(()=>te(e(g))))]),o(et,Fe)}),a(Pe),o(_,Pe)};j(Te,_=>{e(q),i(()=>e(q).length===0)?_(Le):_(he,!1)},!0)}o(pe,xe)};j(R,pe=>{s(),i(()=>!s().class)?pe(ue):pe(G,!1)})}o(m,c)};j(X,m=>{k(),i(()=>!k().classFeatures)&&m(Y)})}a(le),I(()=>{ie=ct(le,1,"class-features svelte-1kpvv0n",null,ie,{hidden:!e(oe)}),st(Be,"aria-label",(k(),i(()=>k().classFeatures?"Expand":"Collapse"))),y(x,(k(),i(()=>k().classFeatures?"â–¼":"â–²")))}),F("click",Be,E),o(r,le),_t(),T()}var el=h('<textarea placeholder="Enter features, traits, and special abilities..." class="svelte-wttn0l"></textarea> <h3 class="svelte-wttn0l">Equipment</h3> <textarea placeholder="List your equipment and inventory..." class="svelte-wttn0l"></textarea> <h3 class="svelte-wttn0l">Notes</h3> <textarea placeholder="Additional notes..." class="svelte-wttn0l"></textarea>',1),tl=h('<section><div class="header svelte-wttn0l"><h2 class="svelte-wttn0l">Features & Traits</h2> <button class="collapse-btn svelte-wttn0l"> </button></div> <!></section>');function al(r,u){mt(u,!1);const s=()=>We(Dt,"$searchFilter",k),v=()=>We(V,"$character",k),S=()=>We(ft,"$collapsedStates",k),[k,w]=St(),T=A();function f(){ft.update(be=>({...be,notes:!be.notes}))}Qe(()=>(s(),v()),()=>{n(T,!s()||"features".includes(s().toLowerCase())||"traits".includes(s().toLowerCase())||"equipment".includes(s().toLowerCase())||"notes".includes(s().toLowerCase())||v().features.toLowerCase().includes(s().toLowerCase())||v().equipment.toLowerCase().includes(s().toLowerCase())||v().notes.toLowerCase().includes(s().toLowerCase()))}),Lt(),gt();var q=tl();let ee;var B=l(q),K=t(l(B),2),de=l(K,!0);a(K),a(B);var oe=t(B,2);{var me=be=>{var N=el(),ae=ze(N);Ot(ae);var ce=t(ae,4);Ot(ce);var Q=t(ce,4);Ot(Q),Me(ae,()=>v().features,te=>Ze(V,i(v).features=te,i(v))),Me(ce,()=>v().equipment,te=>Ze(V,i(v).equipment=te,i(v))),Me(Q,()=>v().notes,te=>Ze(V,i(v).notes=te,i(v))),o(be,N)};j(oe,be=>{S(),i(()=>!S().notes)&&be(me)})}a(q),I(()=>{ee=ct(q,1,"notes svelte-wttn0l",null,ee,{hidden:!e(T)}),st(K,"aria-label",(S(),i(()=>S().notes?"Expand":"Collapse"))),y(de,(S(),i(()=>S().notes?"â–¼":"â–²")))}),F("click",K,f),o(r,q),_t(),w()}var sl=h('<div class="color-picker-section svelte-1r90jgp"><h3 class="svelte-1r90jgp">Dice Colors</h3> <div class="color-inputs svelte-1r90jgp"><div class="color-input-group svelte-1r90jgp"><label for="dice-color" class="svelte-1r90jgp">Dice Color</label> <input type="color" id="dice-color" class="svelte-1r90jgp"/></div> <div class="color-input-group svelte-1r90jgp"><label for="label-color" class="svelte-1r90jgp">Label Color</label> <input type="color" id="label-color" class="svelte-1r90jgp"/></div> <div class="color-input-group svelte-1r90jgp"><label for="desk-color" class="svelte-1r90jgp">Background Color</label> <input type="color" id="desk-color" class="svelte-1r90jgp"/></div></div></div>'),ll=h('<div class="loading svelte-1r90jgp"><p class="svelte-1r90jgp">Loading 3D dice...</p></div>'),il=h('<div class="custom-dice-selector svelte-1r90jgp"><h3 class="svelte-1r90jgp">Choose Dice to Roll</h3> <div class="dice-inputs svelte-1r90jgp"><div class="dice-input-group svelte-1r90jgp"><label for="d4" class="svelte-1r90jgp">d4</label> <input class="use-enabled svelte-1r90jgp" type="number" id="d4" min="0" max="10"/></div> <div class="dice-input-group svelte-1r90jgp"><label for="d6" class="svelte-1r90jgp">d6</label> <input class="use-enabled svelte-1r90jgp" type="number" id="d6" min="0" max="10"/></div> <div class="dice-input-group svelte-1r90jgp"><label for="d8" class="svelte-1r90jgp">d8</label> <input class="use-enabled svelte-1r90jgp" type="number" id="d8" min="0" max="10"/></div> <div class="dice-input-group svelte-1r90jgp"><label for="d10" class="svelte-1r90jgp">d10</label> <input class="use-enabled svelte-1r90jgp" type="number" id="d10" min="0" max="10"/></div> <div class="dice-input-group svelte-1r90jgp"><label for="d12" class="svelte-1r90jgp">d12</label> <input class="use-enabled svelte-1r90jgp" type="number" id="d12" min="0" max="10"/></div> <div class="dice-input-group svelte-1r90jgp"><label for="d20" class="svelte-1r90jgp">d20</label> <input class="use-enabled svelte-1r90jgp" type="number" id="d20" min="0" max="10"/></div></div> <div class="dice-controls svelte-1r90jgp"><button class="btn btn-primary use-enabled svelte-1r90jgp"> </button> <button class="btn btn-secondary use-enabled svelte-1r90jgp">Reset</button></div></div>'),rl=h('<span class="crit-badge svelte-1r90jgp">CRITICAL!</span>'),nl=h('<p class="svelte-1r90jgp"> </p>'),ol=h('<p class="modifier-text svelte-1r90jgp"> </p>'),cl=h('<button class="btn btn-follow-up svelte-1r90jgp"> </button>'),vl=h('<button class="btn btn-guided-strike svelte-1r90jgp">âš¡ Use Guided Strike (+10)</button>'),dl=h('<div class="follow-up-actions svelte-1r90jgp"><!> <!></div>'),ul=h('<div class="result-header svelte-1r90jgp"><h3 class="svelte-1r90jgp"> </h3> <!></div> <div class="result-total svelte-1r90jgp"> </div> <div class="result-details svelte-1r90jgp"><!> <!></div> <!>',1),pl=h('<div role="button" tabindex="-1"><div class="modal-content svelte-1r90jgp" role="dialog" tabindex="0"><div class="modal-header svelte-1r90jgp"><h2 class="svelte-1r90jgp">Dice Roller</h2> <div class="header-buttons svelte-1r90jgp"><button class="color-btn svelte-1r90jgp" title="Customize dice colors">ðŸŽ¨</button> <button class="close-btn svelte-1r90jgp">Ã—</button></div></div> <!> <!> <div class="dice-main-area svelte-1r90jgp"><div class="dice-container svelte-1r90jgp"></div> <!></div> <div><!></div></div></div>');function fl(r,u){mt(u,!1);const s=()=>We(V,"$character",v),[v,S]=St(),k=A(),w=A(),T=A(),f=Bt();let q=Pt(u,"notation",12,""),ee=Pt(u,"visible",8,!1),B=Pt(u,"damageNotation",12,""),K=Pt(u,"attackName",12,""),de=null,oe=A(void 0),me=A(!1),be=A(""),N=A(null);function ae(){return e(N)?.resultTotal??null}let ce=A(0),Q=A(0),te=A(0),se=A(0),E=A(0),le=A(0),ie=A(0),ne=A([]),Be=A(!1),x=A("other"),X=A(!1),Y=A("#051e0a"),m=A("#ffffff"),c=A("#3a2004"),R=A(!1);function ue(d){return d.length===9&&d.startsWith("#")?d.substring(0,7):d}function G(d,D="ff"){return d.length===7&&d.startsWith("#")?d+D:d}function pe(){if(window.DICE&&e(oe))try{de&&e(oe)&&$a(oe,e(oe).innerHTML="");const d=e(oe).clientWidth||500,D=e(oe).clientHeight||300;de=new window.DICE.dice_box(e(oe),{w:d,h:D}),n(me,!0)}catch(d){console.error("Error initializing dice box:",d)}}Wt(()=>{const d=C=>new Promise((b,ve)=>{if(document.querySelector(`script[src="${C}"]`)){console.log(`Script already loaded: ${C}`),b(null);return}const ye=document.createElement("script");ye.src=C,ye.onload=()=>{console.log(`Loaded: ${C}`),b(null)},ye.onerror=()=>{console.error(`Failed to load: ${C}`),ve(new Error(`Failed to load ${C}`))},document.head.appendChild(ye)});setTimeout(()=>{d(`${Gt}/libs/three.min.js`).then(()=>d(`${Gt}/libs/cannon.min.js`)).then(()=>d(`${Gt}/libs/teal.js`)).then(()=>d(`${Gt}/dice.js`)).then(()=>{if(console.log("All scripts loaded, initializing dice box..."),console.log("DICE available:",!!window.DICE),console.log("Container available:",!!e(oe)),window.DICE){const C=window.DICE.getColors();n(Y,ue(C.dice_color)),n(m,ue(C.label_color)),n(c,ue(C.desk_color))}pe()}).catch(C=>{console.error("Failed to load dice libraries:",C)})},100);const D=()=>{e(me)&&(console.log("Window resized, reinitializing dice box..."),pe())},W=C=>{ee()&&C.key==="Escape"&&Je()};return window.addEventListener("resize",D),window.addEventListener("keydown",W),()=>{window.removeEventListener("resize",D),window.removeEventListener("keydown",W)}});function xe(d,D="other"){if(!de||!e(me))return;console.log("Rolling dice:",d,"type:",D),n(x,D),n(X,!1),de.diceToRoll=d;const W=b=>(console.log("Before roll:",b),null),C=b=>{if(console.log("After roll:",b),console.log("Result:",b.resultTotal),n(N,b),D==="attack"||D==="check"||D==="save"){const ve=b.results?.filter(Se=>Se.sides===20)||[];if(ve.length>0){const Se=ve[0].value;n(Be,Se===20)}}if(n(ne,[]),D==="attack"&&B())if(e(Be)){const ve=he(B());e(ne).push({label:`Roll Critical Damage (${ve})`,notation:ve})}else e(ne).push({label:`Roll Damage (${B()})`,notation:B()})};de.start_throw(W,C)}function Te(){const d=[];e(ce)>0&&d.push(`${e(ce)}d4`),e(Q)>0&&d.push(`${e(Q)}d6`),e(te)>0&&d.push(`${e(te)}d8`),e(se)>0&&d.push(`${e(se)}d10`),e(E)>0&&d.push(`${e(E)}d12`),e(le)>0&&d.push(`${e(le)}d20`);let D=d.join("+")||"1d20";return e(ie)!==0&&(D+=e(ie)>=0?`+${e(ie)}`:`${e(ie)}`),D}function Le(){const d=Te();xe(d)}function he(d){return d.replace(/(\d+)d(\d+)/g,(D,W,C)=>`${parseInt(W)*2}d${C}`)}function _(){n(ce,0),n(Q,0),n(te,0),n(se,0),n(E,0),n(le,0),n(ie,0),n(N,null),n(ne,[]),n(Be,!1),n(x,"other"),n(X,!1)}function Pe(){window.DICE&&(window.DICE.setColors({dice_color:G(e(Y),"ff"),label_color:G(e(m),"ff"),desk_color:e(c)}),de&&(de.updateDeskColor(e(c)),de.updateDiceColors()))}function Ue(){n(R,!e(R))}function qe(){!e(N)||e(w)<=0||e(X)||(n(N,{...e(N),resultTotal:e(N).resultTotal+10,resultString:e(N).resultString+" + 10 (Guided Strike)"}),V.update(d=>{const D="ChannelDivinity",W=d.classFeatures.features[D];return typeof W=="number"&&W>0&&(d.classFeatures.features[D]=W-1),d}),n(X,!0))}function Je(){f("close"),q(""),B(""),K(""),n(be,""),n(N,null),n(X,!1),_()}Qe(()=>(s(),Ut),()=>{n(k,s().class?Ut(s().class,s().level,s().subclass).some(D=>D.name==="Guided Strike"):!1)}),Qe(()=>s(),()=>{n(w,(()=>{const D=s().classFeatures.features["ChannelDivinity"];return typeof D=="number"?D:0})())}),Qe(()=>(e(ce),e(Q),e(te),e(se),e(E),e(le),e(ie)),()=>{n(T,(()=>{const d=[];e(ce)>0&&d.push(`${e(ce)}d4`),e(Q)>0&&d.push(`${e(Q)}d6`),e(te)>0&&d.push(`${e(te)}d8`),e(se)>0&&d.push(`${e(se)}d10`),e(E)>0&&d.push(`${e(E)}d12`),e(le)>0&&d.push(`${e(le)}d20`);let D=d.join("+")||"1d20";return e(ie)!==0&&(D+=e(ie)>=0?`+${e(ie)}`:`${e(ie)}`),D})())}),Qe(()=>(U(q()),e(me),U(ee()),e(be),U(B()),U(K())),()=>{if(q()&&e(me)&&ee()&&q()!==e(be)){n(be,q()),n(N,null),n(ne,[]),n(Be,!1),n(X,!1);const d=q().includes("1d20")?"attack":"other";console.log("Auto-roll triggered. notation:",q(),"damageNotation:",B(),"attackName:",K()),setTimeout(()=>xe(q(),d),200)}}),Lt();var et={getLastRollTotal:ae};gt();var g=pl();let z;var J=l(g),H=l(J),je=t(l(H),2),Fe=l(je),Ee=t(Fe,2);a(je),a(H);var _e=t(H,2);{var L=d=>{var D=sl(),W=t(l(D),2),C=l(W),b=t(l(C),2);De(b),a(C);var ve=t(C,2),Se=t(l(ve),2);De(Se),a(ve);var ye=t(ve,2),Ge=t(l(ye),2);De(Ge),a(ye),a(W),a(D),Me(b,()=>e(Y),p=>n(Y,p)),F("change",b,Pe),Me(Se,()=>e(m),p=>n(m,p)),F("change",Se,Pe),Me(Ge,()=>e(c),p=>n(c,p)),F("change",Ge,Pe),o(d,D)};j(_e,d=>{e(R)&&d(L)})}var ge=t(_e,2);{var fe=d=>{var D=ll();o(d,D)};j(ge,d=>{e(me)||d(fe)})}var He=t(ge,2),Ke=l(He);ra(Ke,d=>n(oe,d),()=>e(oe));var Xe=t(Ke,2);{var Re=d=>{var D=il(),W=t(l(D),2),C=l(W),b=t(l(C),2);De(b),a(C);var ve=t(C,2),Se=t(l(ve),2);De(Se),a(ve);var ye=t(ve,2),Ge=t(l(ye),2);De(Ge),a(ye);var p=t(ye,2),O=t(l(p),2);De(O),a(p);var $=t(p,2),we=t(l($),2);De(we),a($);var ke=t($,2),Oe=t(l(ke),2);De(Oe),a(ke),a(W);var Ae=t(W,2),Ce=l(Ae),Ie=l(Ce);a(Ce);var it=t(Ce,2);a(Ae),a(D),I(()=>{Ce.disabled=!e(me),y(Ie,`Roll ${e(T)??""}`)}),Me(b,()=>e(ce),re=>n(ce,re)),Me(Se,()=>e(Q),re=>n(Q,re)),Me(Ge,()=>e(te),re=>n(te,re)),Me(O,()=>e(se),re=>n(se,re)),Me(we,()=>e(E),re=>n(E,re)),Me(Oe,()=>e(le),re=>n(le,re)),F("click",Ce,Le),F("click",it,_),o(d,D)};j(Xe,d=>{q()||d(Re)})}a(He);var Z=t(He,2);let $e;var Ne=l(Z);{var M=d=>{var D=ul(),W=ze(D),C=l(W),b=l(C,!0);a(C);var ve=t(C,2);{var Se=Ce=>{var Ie=rl();o(Ce,Ie)};j(ve,Ce=>{e(Be)&&Ce(Se)})}a(W);var ye=t(W,2),Ge=l(ye,!0);a(ye);var p=t(ye,2),O=l(p);{var $=Ce=>{var Ie=nl(),it=l(Ie,!0);a(Ie),I(()=>y(it,(e(N),i(()=>e(N).resultString)))),o(Ce,Ie)};j(O,Ce=>{e(N),i(()=>e(N).resultString)&&Ce($)})}var we=t(O,2);{var ke=Ce=>{var Ie=ol(),it=l(Ie);a(Ie),I(()=>y(it,`Modifier: ${e(N),i(()=>e(N).constant>=0?"+":"")??""}${e(N),i(()=>e(N).constant)??""}`)),o(Ce,Ie)};j(we,Ce=>{e(N),i(()=>e(N).constant)&&Ce(ke)})}a(p);var Oe=t(p,2);{var Ae=Ce=>{var Ie=dl(),it=l(Ie);ot(it,1,()=>e(ne),pt,(Ye,tt)=>{var vt=cl(),Ft=l(vt,!0);a(vt),I(()=>y(Ft,(e(tt),i(()=>e(tt).label)))),F("click",vt,()=>xe(e(tt).notation,"damage")),o(Ye,vt)});var re=t(it,2);{var Ve=Ye=>{var tt=vl();I(()=>{tt.disabled=e(w)<=0,st(tt,"title",e(w)<=0?"No Channel Divinity uses remaining":"Use Channel Divinity to add +10 to this attack roll")}),F("click",tt,qe),o(Ye,tt)};j(re,Ye=>{e(k)&&e(x)==="attack"&&!e(X)&&Ye(Ve)})}a(Ie),o(Ce,Ie)};j(Oe,Ce=>{e(ne),e(k),e(x),e(X),i(()=>e(ne).length>0||e(k)&&e(x)==="attack"&&!e(X))&&Ce(Ae)})}I(()=>{y(b,K()?`${K()} - Result`:"Result"),y(Ge,(e(N),i(()=>e(N).resultTotal)))}),o(d,D)};j(Ne,d=>{e(N)&&d(M)})}a(Z),a(J),a(g),I(()=>{z=ct(g,1,"modal-overlay svelte-1r90jgp",null,z,{hidden:!ee()}),$e=ct(Z,1,"roll-result svelte-1r90jgp",null,$e,{"has-result":e(N)})}),F("click",Fe,Ue),F("click",Ee,Je),F("click",J,da(function(d){Et.call(this,u,d)})),F("keydown",J,function(d){Et.call(this,u,d)}),F("click",g,Je),F("keydown",g,d=>d.key==="Escape"&&Je()),o(r,g),Oa(u,"getLastRollTotal",ae);var P=_t(et);return S(),P}const Zt="https://api.github.com/gists";async function bl(r,u,s){if(!u)throw new Error("GitHub token is required");const v=JSON.stringify(r,null,2),S=`${r.name||"character"}_dnd.json`,k={description:s||`D&D Character: ${r.name}`,public:!1,files:{[S]:{content:v}}},w=await fetch(Zt,{method:"POST",headers:{Authorization:`token ${u}`,"Content-Type":"application/json"},body:JSON.stringify(k)});if(!w.ok)throw new Error(`Failed to create gist: ${w.statusText}`);return(await w.json()).id}async function hl(r,u,s){if(!u||!s)throw new Error("GitHub token and Gist ID are required");const v=JSON.stringify(r,null,2),k={files:{[`${r.name||"character"}_dnd.json`]:{content:v}}},w=await fetch(`${Zt}/${s}`,{method:"PATCH",headers:{Authorization:`token ${u}`,"Content-Type":"application/json"},body:JSON.stringify(k)});if(!w.ok)throw new Error(`Failed to update gist: ${w.statusText}`)}async function gl(r,u){if(!r)throw new Error("Gist ID is required");const s={"Content-Type":"application/json"};u&&(s.Authorization=`token ${u}`);const v=await fetch(`${Zt}/${r}`,{method:"GET",headers:s});if(!v.ok)throw new Error(`Failed to load gist: ${v.statusText}`);const S=await v.json(),k=Object.values(S.files);if(k.length===0)throw new Error("No files found in gist");const T=k[0].content;try{const f=JSON.parse(T);return f.attacks&&Array.isArray(f.attacks)&&(f.attacks=f.attacks.map(q=>({...q,id:q.id||crypto.randomUUID()}))),f.classFeatures?(f.classFeatures.features||(f.classFeatures.features={}),f.classFeatures.spellSlots||(f.classFeatures.spellSlots=[]),f.classFeatures.preparedSpells===void 0&&(f.classFeatures.preparedSpells="")):f.classFeatures={features:{},spellSlots:[],preparedSpells:""},f}catch{throw new Error("Invalid character data in gist")}}function ha(r){typeof window<"u"&&localStorage.setItem("dnd_gist_config",JSON.stringify(r))}function ml(){if(typeof window<"u"){const r=localStorage.getItem("dnd_gist_config");if(r)return JSON.parse(r)}return{}}async function _l(r,u=30){if(!r)throw new Error("GitHub token is required to list gists");const s=await fetch(`${Zt}?per_page=${u}`,{method:"GET",headers:{Authorization:`token ${r}`,"Content-Type":"application/json"}});if(!s.ok)throw new Error(`Failed to list gists: ${s.statusText}`);return await s.json()}var yl=h('<div class="error-message svelte-1jb5ckg"> </div>'),kl=h('<div class="toggle-container svelte-1jb5ckg"><button type="button" class="toggle-btn svelte-1jb5ckg"> </button></div>'),xl=h('<div class="form-group svelte-1jb5ckg"><label for="gistId" class="svelte-1jb5ckg">Gist ID (leave empty to create new)</label> <input type="text" id="gistId" placeholder="Optional: existing Gist ID to update" class="svelte-1jb5ckg"/></div>'),$l=h('<div class="loading-message svelte-1jb5ckg">Loading your gists...</div>'),Sl=h('<button type="button"><div class="gist-item-header svelte-1jb5ckg"><span class="gist-description svelte-1jb5ckg"> </span> <span class="gist-visibility svelte-1jb5ckg"> </span></div> <div class="gist-item-meta svelte-1jb5ckg"><span class="gist-id svelte-1jb5ckg"> </span> <span class="gist-date svelte-1jb5ckg"> </span></div></button>'),Cl=h('<div class="form-group svelte-1jb5ckg"><div class="gist-list-label svelte-1jb5ckg">Select a Gist to Update (or leave unselected to create new)</div> <div class="gist-list svelte-1jb5ckg"></div></div>'),Ll=h('<div class="info-message svelte-1jb5ckg">No gists found. A new one will be created.</div>'),jl=h('<!> <div class="form-group svelte-1jb5ckg"><label for="description" class="svelte-1jb5ckg"> </label> <input type="text" id="description" placeholder="D&amp;D Character Sheet" class="svelte-1jb5ckg"/></div>',1),wl=h('<div class="form-group svelte-1jb5ckg"><label for="gistId" class="svelte-1jb5ckg">Gist ID *</label> <input type="text" id="gistId" placeholder="Enter Gist ID (for public or your private gists)" required class="svelte-1jb5ckg"/></div>'),Dl=h('<div class="loading-message svelte-1jb5ckg">Loading your gists...</div>'),Fl=h('<button type="button"><div class="gist-item-header svelte-1jb5ckg"><span class="gist-description svelte-1jb5ckg"> </span> <span class="gist-visibility svelte-1jb5ckg"> </span></div> <div class="gist-item-meta svelte-1jb5ckg"><span class="gist-id svelte-1jb5ckg"> </span> <span class="gist-date svelte-1jb5ckg"> </span></div></button>'),Rl=h('<div class="form-group svelte-1jb5ckg"><div class="gist-list-label svelte-1jb5ckg">Select a Gist to Load</div> <div class="gist-list svelte-1jb5ckg"></div></div>'),Al=h('<div class="info-message svelte-1jb5ckg">No gists found. Enter a Gist ID manually or create a new one in Save mode.</div>'),Il=h('<div class="modal-overlay svelte-1jb5ckg" role="button" tabindex="-1"><div class="modal-content svelte-1jb5ckg" role="dialog" tabindex="0"><div class="modal-header svelte-1jb5ckg"><h2 class="svelte-1jb5ckg"> </h2> <button class="close-btn svelte-1jb5ckg">Ã—</button></div> <div class="modal-body svelte-1jb5ckg"><!> <div class="form-group svelte-1jb5ckg"><label for="token" class="svelte-1jb5ckg"> <a href="https://github.com/settings/tokens" target="_blank" rel="noopener" class="svelte-1jb5ckg">Get token</a></label> <input type="password" id="token" placeholder="ghp_xxxxxxxxxxxxx" class="svelte-1jb5ckg"/></div> <!> <!> <div class="modal-actions svelte-1jb5ckg"><button class="btn btn-primary svelte-1jb5ckg"><!></button> <button class="btn btn-secondary svelte-1jb5ckg">Cancel</button></div></div></div></div>');function Ml(r,u){mt(u,!1);const s=()=>We(V,"$character",v),[v,S]=St(),k=Bt();let w=Pt(u,"mode",8,"save"),T=A(""),f=A(""),q=A(""),ee=A(!1),B=A(""),K=A(!1),de=A(!1),oe=A([]),me=A(null);const be=ml();be.token&&n(T,be.token),be.gistId&&n(f,be.gistId),Wt(async()=>{e(T)&&!e(K)&&await N()});async function N(){if(e(T)){n(de,!0),n(B,"");try{n(oe,await _l(e(T))),e(f)&&n(me,e(oe).find(g=>g.id===e(f))||null)}catch(g){n(B,g.message||"Failed to load gists"),n(oe,[])}finally{n(de,!1)}}}function ae(g){n(me,g),n(f,g.id)}function ce(){n(K,!e(K)),n(B,""),!e(K)&&e(T)&&N()}async function Q(){if(!e(T)){n(B,"GitHub token is required");return}const g=e(me)?.id||e(f);n(ee,!0),n(B,"");try{if(g)await hl(s(),e(T),g),n(f,g),qt.add("Character updated in Gist successfully!","success");else{const z=await bl(s(),e(T),e(q));n(f,z),qt.add(`Character saved to Gist! ID: ${z}`,"success")}ha({token:e(T),gistId:e(f)}),k("close")}catch(z){n(B,z.message||"Failed to save to Gist")}finally{n(ee,!1)}}async function te(){const g=e(me)?.id||e(f);if(!g){n(B,"Please select a gist or enter a Gist ID");return}n(ee,!0),n(B,"");try{const z=await gl(g,e(T)||void 0);V.set(z),n(f,g),ha({token:e(T),gistId:e(f)}),qt.add("Character loaded from Gist successfully!","success"),k("close")}catch(z){n(B,z.message||"Failed to load from Gist")}finally{n(ee,!1)}}function se(){k("close")}gt();var E=Il(),le=l(E),ie=l(le),ne=l(ie),Be=l(ne,!0);a(ne);var x=t(ne,2);a(ie);var X=t(ie,2),Y=l(X);{var m=g=>{var z=yl(),J=l(z,!0);a(z),I(()=>y(J,e(B))),o(g,z)};j(Y,g=>{e(B)&&g(m)})}var c=t(Y,2),R=l(c),ue=l(R);Sa(),a(R);var G=t(R,2);De(G),a(c);var pe=t(c,2);{var xe=g=>{var z=kl(),J=l(z),H=l(J,!0);a(J),a(z),I(()=>{J.disabled=e(ee),y(H,e(K)?"ðŸ“‹ Show My Gists":"âœï¸ Enter Gist ID Manually")}),F("click",J,ce),o(g,z)};j(pe,g=>{(w()==="load"||w()==="save"&&e(T))&&g(xe)})}var Te=t(pe,2);{var Le=g=>{var z=jl(),J=ze(z);{var H=ge=>{var fe=xl(),He=t(l(fe),2);De(He),a(fe),I(()=>He.disabled=e(ee)),Me(He,()=>e(f),Ke=>n(f,Ke)),o(ge,fe)},je=ge=>{var fe=lt(),He=ze(fe);{var Ke=Re=>{var Z=$l();o(Re,Z)},Xe=Re=>{var Z=lt(),$e=ze(Z);{var Ne=P=>{var d=Cl(),D=t(l(d),2);ot(D,5,()=>e(oe),pt,(W,C)=>{var b=Sl();let ve;var Se=l(b),ye=l(Se),Ge=l(ye,!0);a(ye);var p=t(ye,2),O=l(p,!0);a(p),a(Se);var $=t(Se,2),we=l($),ke=l(we);a(we);var Oe=t(we,2),Ae=l(Oe);a(Oe),a($),a(b),I(Ce=>{ve=ct(b,1,"gist-item svelte-1jb5ckg",null,ve,{selected:e(me)?.id===e(C).id}),b.disabled=e(ee),y(Ge,(e(C),i(()=>e(C).description||"Untitled"))),y(O,(e(C),i(()=>e(C).public?"ðŸŒ Public":"ðŸ”’ Private"))),y(ke,`ID: ${e(C),i(()=>e(C).id)??""}`),y(Ae,`Updated: ${Ce??""}`)},[()=>(e(C),i(()=>new Date(e(C).updated_at).toLocaleDateString()))]),F("click",b,()=>ae(e(C))),o(W,b)}),a(D),a(d),o(P,d)},M=P=>{var d=lt(),D=ze(d);{var W=C=>{var b=Ll();o(C,b)};j(D,C=>{e(T)&&C(W)},!0)}o(P,d)};j($e,P=>{e(oe),i(()=>e(oe).length>0)?P(Ne):P(M,!1)},!0)}o(Re,Z)};j(He,Re=>{e(de)?Re(Ke):Re(Xe,!1)},!0)}o(ge,fe)};j(J,ge=>{e(K)||!e(T)?ge(H):ge(je,!1)})}var Fe=t(J,2),Ee=l(Fe),_e=l(Ee);a(Ee);var L=t(Ee,2);De(L),a(Fe),I(()=>{y(_e,`Description ${e(f)?"(optional)":""}`),L.disabled=e(ee)}),Me(L,()=>e(q),ge=>n(q,ge)),o(g,z)},he=g=>{var z=lt(),J=ze(z);{var H=Fe=>{var Ee=wl(),_e=t(l(Ee),2);De(_e),a(Ee),I(()=>_e.disabled=e(ee)),Me(_e,()=>e(f),L=>n(f,L)),o(Fe,Ee)},je=Fe=>{var Ee=lt(),_e=ze(Ee);{var L=fe=>{var He=Dl();o(fe,He)},ge=fe=>{var He=lt(),Ke=ze(He);{var Xe=Z=>{var $e=Rl(),Ne=t(l($e),2);ot(Ne,5,()=>e(oe),pt,(M,P)=>{var d=Fl();let D;var W=l(d),C=l(W),b=l(C,!0);a(C);var ve=t(C,2),Se=l(ve,!0);a(ve),a(W);var ye=t(W,2),Ge=l(ye),p=l(Ge);a(Ge);var O=t(Ge,2),$=l(O);a(O),a(ye),a(d),I(we=>{D=ct(d,1,"gist-item svelte-1jb5ckg",null,D,{selected:e(me)?.id===e(P).id}),d.disabled=e(ee),y(b,(e(P),i(()=>e(P).description||"Untitled"))),y(Se,(e(P),i(()=>e(P).public?"ðŸŒ Public":"ðŸ”’ Private"))),y(p,`ID: ${e(P),i(()=>e(P).id)??""}`),y($,`Updated: ${we??""}`)},[()=>(e(P),i(()=>new Date(e(P).updated_at).toLocaleDateString()))]),F("click",d,()=>ae(e(P))),o(M,d)}),a(Ne),a($e),o(Z,$e)},Re=Z=>{var $e=lt(),Ne=ze($e);{var M=P=>{var d=Al();o(P,d)};j(Ne,P=>{e(T)&&P(M)},!0)}o(Z,$e)};j(Ke,Z=>{e(oe),i(()=>e(oe).length>0)?Z(Xe):Z(Re,!1)},!0)}o(fe,He)};j(_e,fe=>{e(de)?fe(L):fe(ge,!1)},!0)}o(Fe,Ee)};j(J,Fe=>{e(K)||!e(T)?Fe(H):Fe(je,!1)})}o(g,z)};j(Te,g=>{w()==="save"?g(Le):g(he,!1)})}var _=t(Te,2),Pe=l(_),Ue=l(Pe);{var qe=g=>{var z=ut();I(()=>y(z,w()==="save"?"Saving...":"Loading...")),o(g,z)},Je=g=>{var z=ut();I(()=>y(z,w()==="save"?"Save":"Load")),o(g,z)};j(Ue,g=>{e(ee)?g(qe):g(Je,!1)})}a(Pe);var et=t(Pe,2);a(_),a(X),a(le),a(E),I(()=>{y(Be,w()==="save"?"Save to GitHub Gist":"Load from GitHub Gist"),y(ue,`GitHub Token ${w()==="load"?"(optional for public gists)":"(required)"} `),G.disabled=e(ee),Pe.disabled=e(ee),et.disabled=e(ee)}),F("click",x,se),Me(G,()=>e(T),g=>n(T,g)),F("blur",G,()=>{e(T)&&!e(K)&&N()}),F("click",Pe,function(...g){(w()==="save"?Q:te)?.apply(this,g)}),F("click",et,se),F("click",le,da(function(g){Et.call(this,u,g)})),F("keydown",le,function(g){Et.call(this,u,g)}),F("click",E,se),F("keydown",E,g=>g.key==="Escape"&&se()),o(r,E),_t(),S()}var Pl=h('<div class="loading svelte-1ngjemu">Loading D&D data...</div>'),El=h("<option> </option>"),Ul=h('<select class="level-filter svelte-1ngjemu"><option>All Levels</option><option>Cantrip</option><!></select>'),Bl=h('<div class="no-results svelte-1ngjemu"> </div>'),Hl=h('<div class="item-meta svelte-1ngjemu"> </div>'),Tl=h('<div class="item-meta svelte-1ngjemu"> </div>'),Nl=h('<button><div class="item-name svelte-1ngjemu"> </div> <!></button>'),Gl=h('<p class="higher-levels"><strong>At Higher Levels:</strong> </p>'),Ol=h('<p class="cantrip-upgrade"><strong>Cantrip Upgrade:</strong> </p>'),ql=h('<h3 class="svelte-1ngjemu"> </h3> <p class="spell-meta svelte-1ngjemu"><!> <!></p> <p class="spell-classes"><strong>Classes:</strong> </p> <div class="spell-stats svelte-1ngjemu"><div><strong>Casting Time:</strong> </div> <div><strong>Range:</strong> </div> <div><strong>Components:</strong> <!></div> <div><strong>Duration:</strong> <!> </div></div> <p class="description svelte-1ngjemu"> </p> <!> <!>',1),zl=h('<p class="prerequisite svelte-1ngjemu"><strong>Prerequisite:</strong> </p>'),Wl=h('<h3 class="svelte-1ngjemu"> </h3> <!> <p class="description svelte-1ngjemu"> </p> <a target="_blank" rel="noopener" class="source-link svelte-1ngjemu">View Full Details â†’</a>',1),Kl=h('<div class="item-details svelte-1ngjemu"><!></div>'),Jl=h('<div class="controls svelte-1ngjemu"><div class="tabs svelte-1ngjemu"><button> </button> <button> </button></div> <div class="search-controls svelte-1ngjemu"><input type="text" placeholder="Search by name or description..." class="search-input svelte-1ngjemu"/> <!></div></div> <div class="content-container svelte-1ngjemu"><div class="items-list svelte-1ngjemu"><!></div> <!></div>',1),Vl=h('<div class="modal-backdrop svelte-1ngjemu" role="presentation"><div class="modal svelte-1ngjemu" role="dialog" aria-modal="true" tabindex="-1"><div class="modal-header svelte-1ngjemu"><h2 class="svelte-1ngjemu">Browse D&D Spells & Feats</h2> <button class="close-btn svelte-1ngjemu" aria-label="Close">&times;</button></div> <div class="modal-body svelte-1ngjemu"><!></div> <div class="modal-footer svelte-1ngjemu"><button class="btn-secondary svelte-1ngjemu">Cancel</button> <button class="btn-primary svelte-1ngjemu">Add to Character Sheet</button></div></div></div>');function Ql(r,u){mt(u,!1);const s=A(),v=A(),S=A();let k=Pt(u,"onClose",8),w=A("spell"),T=A(!0),f=A(""),q=A(null),ee=A([]),B=A([]),K=A(null);Wt(async()=>{n(T,!0);try{n(ee,await wa()),n(B,await ds())}catch(x){console.error("Failed to load data:",x)}finally{n(T,!1)}});function de(x){n(K,x)}function oe(x){const X=x.match(/(\d+d\d+(?:\s*\+\s*\d+)?)/i);return X?X[1]:""}function me(x){const X=x.split(/\.( |$)/)[0].trim(),Y=Array.from(x.matchAll(/\*\*(.*?)\*\*/g)).map(c=>c[1].replace(/\.$/,""));let m=X;return Y.length&&(m+=" | Effects: "+Y.join(", ")),m}function be(){if(e(K)){if(e(w)==="spell"){const x=e(K);V.update(X=>{const m=[];x.range&&m.push(`Range: ${x.range}`),x.castingTime&&m.push(`Cast: ${x.castingTime}`),x.duration&&m.push(`Duration: ${x.duration}`),x.actionType==="Save"&&m.push("Saving throw spell"),x.components&&x.components.length>0&&m.push(`Components: ${x.components.join(", ")}`),x.material&&m.push(`Material: ${x.material}`);const c=m.join(" | "),R=me(x.description),ue={id:crypto.randomUUID(),name:`${x.name}${x.concentration?" (C)":""}${x.ritual?" (R)":""}`,bonus:x.actionType==="Attack"?5:0,damage:oe(x.description),damageType:`${x.school} (Lvl ${x.level})`,spellRef:x.name,infoNotes:c,generalNotes:R,castAtLevel:x.level};return X.attacks=[...X.attacks,ue],X})}else if(e(w)==="feat"){const x=e(K);V.update(X=>{const Y=`${x.name}${x.prerequisite?` (Req: ${x.prerequisite})`:""}
${x.description}
`;return X.features=X.features?`${X.features}
${Y}`:Y,X})}n(K,null),k()()}}Qe(()=>(e(q),e(ee),e(f)),()=>{n(s,e(q)!==null?us(ba(e(ee),e(f)),e(q)):ba(e(ee),e(f)))}),Qe(()=>(e(B),e(f)),()=>{n(v,ps(e(B),e(f)))}),Qe(()=>(e(w),e(s),e(v)),()=>{n(S,e(w)==="spell"?e(s):e(v))}),Lt(),gt();var N=Vl(),ae=l(N),ce=l(ae),Q=t(l(ce),2);a(ce);var te=t(ce,2),se=l(te);{var E=x=>{var X=Pl();o(x,X)},le=x=>{var X=Jl(),Y=ze(X),m=l(Y),c=l(m);let R;var ue=l(c);a(c);var G=t(c,2);let pe;var xe=l(G);a(G),a(m);var Te=t(m,2),Le=l(Te);De(Le);var he=t(Le,2);{var _=J=>{var H=Ul();I(()=>{e(q),Ct(()=>{})});var je=l(H);je.value=(je.__value=null)??"";var Fe=t(je);Fe.value=Fe.__value=0;var Ee=t(Fe);ot(Ee,0,()=>[1,2,3,4,5,6,7,8,9],pt,(_e,L)=>{var ge=El(),fe=l(ge);a(ge);var He={};I(()=>{y(fe,`Level ${L??""}`),He!==(He=L)&&(ge.value=(ge.__value=L)??"")}),o(_e,ge)}),a(H),La(H,()=>e(q),_e=>n(q,_e)),o(J,H)};j(he,J=>{e(w)==="spell"&&J(_)})}a(Te),a(Y);var Pe=t(Y,2),Ue=l(Pe),qe=l(Ue);{var Je=J=>{var H=Bl(),je=l(H);a(H),I(()=>y(je,`No ${e(w)??""}s found`)),o(J,H)},et=J=>{var H=lt(),je=ze(H);ot(je,1,()=>e(S),pt,(Fe,Ee)=>{var _e=Nl();let L;var ge=l(_e),fe=l(ge,!0);a(ge);var He=t(ge,2);{var Ke=Re=>{const Z=at(()=>e(Ee));var $e=Hl(),Ne=l($e);a($e),I(()=>y(Ne,`Level ${U(e(Z)),i(()=>e(Z).level)??""} â€¢ ${U(e(Z)),i(()=>e(Z).school)??""}`)),o(Re,$e)},Xe=Re=>{const Z=at(()=>e(Ee));var $e=lt(),Ne=ze($e);{var M=P=>{var d=Tl(),D=l(d,!0);a(d),I(()=>y(D,(U(e(Z)),i(()=>e(Z).prerequisite)))),o(P,d)};j(Ne,P=>{U(e(Z)),i(()=>e(Z).prerequisite)&&P(M)})}o(Re,$e)};j(He,Re=>{e(w)==="spell"?Re(Ke):Re(Xe,!1)})}a(_e),I(()=>{L=ct(_e,1,"item-card svelte-1ngjemu",null,L,{selected:e(K)?.name===e(Ee).name}),y(fe,(e(Ee),i(()=>e(Ee).name)))}),F("click",_e,()=>de(e(Ee))),o(Fe,_e)}),o(J,H)};j(qe,J=>{e(S),i(()=>e(S).length===0)?J(Je):J(et,!1)})}a(Ue);var g=t(Ue,2);{var z=J=>{var H=Kl(),je=l(H);{var Fe=_e=>{const L=at(()=>e(K));var ge=ql(),fe=ze(ge),He=l(fe,!0);a(fe);var Ke=t(fe,2),Xe=l(Ke);{var Re=re=>{var Ve=ut();I(()=>y(Ve,`${U(e(L)),i(()=>e(L).school)??""} cantrip`)),o(re,Ve)},Z=re=>{var Ve=ut();I(()=>y(Ve,`Level ${U(e(L)),i(()=>e(L).level)??""} ${U(e(L)),i(()=>e(L).school)??""}`)),o(re,Ve)};j(Xe,re=>{U(e(L)),i(()=>e(L).level===0)?re(Re):re(Z,!1)})}var $e=t(Xe,2);{var Ne=re=>{var Ve=ut("(ritual)");o(re,Ve)};j($e,re=>{U(e(L)),i(()=>e(L).ritual)&&re(Ne)})}a(Ke);var M=t(Ke,2),P=t(l(M));a(M);var d=t(M,2),D=l(d),W=t(l(D));a(D);var C=t(D,2),b=t(l(C));a(C);var ve=t(C,2),Se=t(l(ve)),ye=t(Se);{var Ge=re=>{var Ve=ut();I(()=>y(Ve,`(${U(e(L)),i(()=>e(L).material)??""})`)),o(re,Ve)};j(ye,re=>{U(e(L)),i(()=>e(L).material)&&re(Ge)})}a(ve);var p=t(ve,2),O=t(l(p),2);{var $=re=>{var Ve=ut("Concentration,");o(re,Ve)};j(O,re=>{U(e(L)),i(()=>e(L).concentration)&&re($)})}var we=t(O,1,!0);a(p),a(d);var ke=t(d,2),Oe=l(ke,!0);a(ke);var Ae=t(ke,2);{var Ce=re=>{var Ve=Gl(),Ye=t(l(Ve));a(Ve),I(()=>y(Ye,` ${U(e(L)),i(()=>e(L).higherLevelSlot)??""}`)),o(re,Ve)};j(Ae,re=>{U(e(L)),i(()=>e(L).higherLevelSlot)&&re(Ce)})}var Ie=t(Ae,2);{var it=re=>{var Ve=Ol(),Ye=t(l(Ve));a(Ve),I(()=>y(Ye,` ${U(e(L)),i(()=>e(L).cantripUpgrade)??""}`)),o(re,Ve)};j(Ie,re=>{U(e(L)),i(()=>e(L).cantripUpgrade)&&re(it)})}I((re,Ve)=>{y(He,(U(e(L)),i(()=>e(L).name))),y(P,` ${re??""}`),y(W,` ${U(e(L)),i(()=>e(L).castingTime||e(L).actionType)??""}`),y(b,` ${U(e(L)),i(()=>e(L).range)??""}`),y(Se,` ${Ve??""}`),y(we,(U(e(L)),i(()=>e(L).duration))),y(Oe,(U(e(L)),i(()=>e(L).description)))},[()=>(U(e(L)),i(()=>e(L).classes.join(", "))),()=>(U(e(L)),i(()=>e(L).components.join(", ").toUpperCase()))]),o(_e,ge)},Ee=_e=>{const L=at(()=>e(K));var ge=Wl(),fe=ze(ge),He=l(fe,!0);a(fe);var Ke=t(fe,2);{var Xe=Ne=>{var M=zl(),P=t(l(M));a(M),I(()=>y(P,` ${U(e(L)),i(()=>e(L).prerequisite)??""}`)),o(Ne,M)};j(Ke,Ne=>{U(e(L)),i(()=>e(L).prerequisite)&&Ne(Xe)})}var Re=t(Ke,2),Z=l(Re,!0);a(Re);var $e=t(Re,2);I(()=>{y(He,(U(e(L)),i(()=>e(L).name))),y(Z,(U(e(L)),i(()=>e(L).description))),st($e,"href",(U(e(L)),i(()=>e(L).source)))}),o(_e,ge)};j(je,_e=>{e(w)==="spell"?_e(Fe):_e(Ee,!1)})}a(H),o(J,H)};j(g,J=>{e(K)&&J(z)})}a(Pe),I(()=>{R=ct(c,1,"tab svelte-1ngjemu",null,R,{active:e(w)==="spell"}),y(ue,`ðŸ“œ Spells (${e(ee),i(()=>e(ee).length)??""})`),pe=ct(G,1,"tab svelte-1ngjemu",null,pe,{active:e(w)==="feat"}),y(xe,`â­ Feats (${e(B),i(()=>e(B).length)??""})`)}),F("click",c,()=>{n(w,"spell"),n(K,null),n(f,"")}),F("click",G,()=>{n(w,"feat"),n(K,null),n(f,"")}),Me(Le,()=>e(f),J=>n(f,J)),o(x,X)};j(se,x=>{e(T)?x(E):x(le,!1)})}a(te);var ie=t(te,2),ne=l(ie),Be=t(ne,2);a(ie),a(ae),a(N),I(()=>Be.disabled=!e(K)),F("click",Q,function(...x){k()?.apply(this,x)}),F("click",ne,function(...x){k()?.apply(this,x)}),F("click",Be,be),F("click",ae,da(function(x){Et.call(this,u,x)})),F("keydown",ae,function(x){Et.call(this,u,x)}),F("click",N,function(...x){k()?.apply(this,x)}),F("keydown",N,x=>x.key==="Escape"&&k()()),o(r,N),_t()}var Xl=h('<link rel="icon" type="image/png" href="/favicon.png"/> <meta name="viewport" content="width=device-width, initial-scale=1"/>',1),Yl=h('<span class="character-name svelte-1uha8ag"> </span>'),Zl=h("<span> </span>"),ei=h('<div class="spell-slots-header svelte-1uha8ag"></div>'),ti=h('<div class="rest-menu svelte-1uha8ag"><button class="rest-option svelte-1uha8ag">â˜• Short Rest</button> <button class="rest-option svelte-1uha8ag">ðŸ›ï¸ Long Rest</button></div>'),ai=h('<div class="container svelte-1uha8ag"><header class="svelte-1uha8ag"><div class="header-top svelte-1uha8ag"><div class="header-title svelte-1uha8ag"><div class="title-row svelte-1uha8ag"><h1 class="svelte-1uha8ag">D&D Character Sheet</h1> <!></div> <!></div> <div class="header-right svelte-1uha8ag"><div class="header-controls svelte-1uha8ag"><button class="btn btn-secondary use-enabled"><span class="btn-icon svelte-1uha8ag">ðŸŽ²</span><span class="btn-text svelte-1uha8ag">Roll Dice</span></button> <div class="rest-button-container svelte-1uha8ag"><button class="btn btn-secondary use-enabled"><span class="btn-icon svelte-1uha8ag">ðŸ˜´</span><span class="btn-text svelte-1uha8ag">Rest</span></button> <!></div> <div class="mode-toggle"><button><span class="btn-icon svelte-1uha8ag"> </span><span class="btn-text svelte-1uha8ag"> </span></button></div></div> <div class="header-search svelte-1uha8ag"><input type="text" placeholder="ðŸ” Search..." class="search-input use-enabled svelte-1uha8ag"/></div></div></div> <div class="header-actions svelte-1uha8ag"><button class="btn btn-mode svelte-1uha8ag">ðŸ“š Browse Spells & Feats</button> <button class="btn btn-secondary">Save to Gist</button> <button class="btn btn-secondary">Load from Gist</button> <button class="btn btn-secondary">Export JSON</button> <button class="btn btn-secondary">Import JSON</button> <input type="file" accept=".json" style="display: none;"/></div></header> <main class="svelte-1uha8ag"><!> <!> <!> <!> <!> <!> <!></main></div> <!> <!> <!> <!>',1);function di(r,u){mt(u,!1);const s=()=>We(V,"$character",k),v=()=>We(Qt,"$isEditMode",k),S=()=>We(Dt,"$searchFilter",k),[k,w]=St();function T(){const p=[],O=s().classFeatures.spellSlotsByLevel||{};for(let $=1;$<=9;$++){const we=O[$];if(we&&we.length>0){const ke=we.length,Oe=we.filter(Ae=>Ae).length;p.push({level:$,available:ke-Oe,total:ke})}}return p}let f=A(!1),q=A(!1),ee=A(!1),B=A("save"),K=A(void 0),de=A(""),oe=A(""),me=A(""),be=A(),N=!1,ae=A(!1);function ce(){const p=[];V.update($=>{const we=$.hitDice.current;$.hitDice.current=Math.min($.hitDice.max,$.hitDice.current+Math.max(1,Math.floor($.hitDice.max/2)));const ke=$.hitDice.current-we;if(ke>0&&p.push(`${ke} hit ${ke===1?"die":"dice"}`),$.class){const Oe=Ut($.class,$.level,$.subclass);$.classFeatures.features||($.classFeatures.features={}),Oe.forEach(Ae=>{if(Ae.resetOn==="short"){const Ce=Ae.name.replace(/\s+/g,"");if(Ae.type==="uses"){const Ie=typeof Ae.maxUses=="function"?Ae.maxUses($.level):Ae.maxUses;$.classFeatures.features[Ce]=Array(Ie).fill(!1),p.push(Ae.name)}else if(Ae.type==="pool"){const Ie=typeof Ae.maxPool=="function"?Ae.maxPool($.level):Ae.maxPool;Ie!==void 0&&($.classFeatures.features[Ce]=Ie,p.push(Ae.name))}}})}return $}),n(ae,!1);const O=p.length>0?`Short rest taken! Restored: ${p.join(", ")}`:"Short rest taken!";qt.add(O,"success")}function Q(){const p=[];V.update($=>{const we=$.maxHP-$.currentHP;we>0&&p.push(`${we} HP`),$.currentHP=$.maxHP,$.tempHP=0;const ke=$.hitDice.max-$.hitDice.current;ke>0&&p.push(`${ke} hit ${ke===1?"die":"dice"}`),$.hitDice.current=$.hitDice.max;let Oe=0;if($.classFeatures.spellSlotsByLevel&&Object.keys($.classFeatures.spellSlotsByLevel).forEach(Ae=>{const Ce=$.classFeatures.spellSlotsByLevel[parseInt(Ae)];if(Ce){const Ie=Ce.filter(it=>it).length;Oe+=Ie,$.classFeatures.spellSlotsByLevel[parseInt(Ae)]=Array(Ce.length).fill(!1)}}),Oe>0&&p.push(`${Oe} spell ${Oe===1?"slot":"slots"}`),$.class){const Ae=Ut($.class,$.level,$.subclass);$.classFeatures.features||($.classFeatures.features={});let Ce=!1;Ae.forEach(Ie=>{const it=Ie.name.replace(/\s+/g,"");if(!(Ie.type==="info"||Ie.type==="channelDivinity")){if(Ie.type==="uses"){const re=typeof Ie.maxUses=="function"?Ie.maxUses($.level):Ie.maxUses;$.classFeatures.features[it]=Array(re).fill(!1),Ce=!0}else if(Ie.type==="pool"){const re=typeof Ie.maxPool=="function"?Ie.maxPool($.level):Ie.maxPool;re!==void 0&&($.classFeatures.features[it]=re,Ce=!0)}}}),Ce&&p.push("all class features")}return $}),n(ae,!1);const O=p.length>0?`Long rest taken! Restored: ${p.join(", ")}`:"Long rest taken! Fully rested.";qt.add(O,"success")}function te(p){n(de,""),n(oe,""),n(me,""),N=!1,typeof p=="string"?n(de,p):(n(de,p.notation),n(oe,p.damageNotation||""),n(me,p.attackName||"")),n(f,!0)}function se(p){const{notation:O}=p.detail;n(de,""),N=!0,setTimeout(()=>{n(de,O),n(oe,""),n(me,"Hit Die")},0),n(f,!0)}function E(){if(n(f,!1),N&&e(be)){const p=e(be).getLastRollTotal();if(p!==null){const O=Math.max(1,p);V.update($=>($.hitDice.current=Math.max(0,$.hitDice.current-1),$.currentHP=Math.min($.maxHP,$.currentHP+O),$))}N=!1}}function le(){console.log("toggleMode called, current isEditMode:",v()),Qt.update(p=>(console.log("Updating isEditMode from",p,"to",!p),!p))}function ie(p){p.target.closest(".rest-button-container")||n(ae,!1)}Wt(()=>{console.log("onMount - initial isEditMode:",v()),console.log("onMount - body classes:",document.body.className);const p=Qt.subscribe(O=>{console.log("isEditMode subscription triggered, value:",O),console.log("Body classes before:",document.body.className),O?(document.body.classList.remove("use-mode"),console.log("Removed use-mode class (Edit Mode)")):(document.body.classList.add("use-mode"),console.log("Added use-mode class (Use Mode)")),console.log("Body classes after:",document.body.className)});return document.addEventListener("click",ie),()=>{p(),document.removeEventListener("click",ie)}});function ne(){Ha(s())}function Be(){e(K)?.click()}async function x(p){const $=p.target.files?.[0];if($)try{const we=await Ta($);V.set(we),alert("Character imported successfully!")}catch{alert("Failed to import character file")}}gt();var X=ai();Ua("1uha8ag",p=>{var O=Xl();Sa(2),_a(()=>{Ma.title="D&D Character Sheet"}),o(p,O)});var Y=ze(X),m=l(Y),c=l(m),R=l(c),ue=l(R),G=t(l(ue),2);{var pe=p=>{var O=Yl(),$=l(O,!0);a(O),I(()=>y($,s().name)),o(p,O)};j(G,p=>{s().name&&p(pe)})}a(ue);var xe=t(ue,2);{var Te=p=>{var O=ei();ot(O,5,T,pt,($,we)=>{var ke=Zl();let Oe;var Ae=l(ke);a(ke),I(()=>{Oe=ct(ke,1,"slot-badge svelte-1uha8ag",null,Oe,{depleted:e(we).available===0}),y(Ae,`Lv${e(we).level??""}: ${e(we).available??""}/${e(we).total??""}`)}),o($,ke)}),a(O),o(p,O)};j(xe,p=>{T().length>0&&p(Te)})}a(R);var Le=t(R,2),he=l(Le),_=l(he),Pe=t(_,2),Ue=l(Pe),qe=t(Ue,2);{var Je=p=>{var O=ti(),$=l(O),we=t($,2);a(O),F("click",$,ce),F("click",we,Q),o(p,O)};j(qe,p=>{e(ae)&&p(Je)})}a(Pe);var et=t(Pe,2),g=l(et);let z;var J=l(g),H=l(J,!0);a(J);var je=t(J),Fe=l(je,!0);a(je),a(g),a(et),a(he);var Ee=t(he,2),_e=l(Ee);De(_e),a(Ee),a(Le),a(c);var L=t(c,2),ge=l(L),fe=t(ge,2),He=t(fe,2),Ke=t(He,2),Xe=t(Ke,2),Re=t(Xe,2);ra(Re,p=>n(K,p),()=>e(K)),a(L),a(m);var Z=t(m,2),$e=l(Z);Ya($e,{});var Ne=t($e,2);rs(Ne,{$$events:{rollHitDice:se}});var M=t(Ne,2);as(M,{$$events:{roll:p=>te(p.detail)}});var P=t(M,2);vs(P,{$$events:{roll:p=>te(p.detail)}});var d=t(P,2);Es(d,{$$events:{roll:p=>te(p.detail)}});var D=t(d,2);Zs(D,{});var W=t(D,2);al(W,{}),a(Z),a(Y);var C=t(Y,2);ra(fl(C,{get notation(){return e(de)},get damageNotation(){return e(oe)},get attackName(){return e(me)},get visible(){return e(f)},$$events:{close:E},$$legacy:!0}),p=>n(be,p),()=>e(be));var b=t(C,2);{var ve=p=>{Ml(p,{get mode(){return e(B)},$$events:{close:()=>n(q,!1)}})};j(b,p=>{e(q)&&p(ve)})}var Se=t(b,2);{var ye=p=>{Ql(p,{onClose:()=>n(ee,!1)})};j(Se,p=>{e(ee)&&p(ye)})}var Ge=t(Se,2);Ba(Ge,{}),I(()=>{z=ct(g,1,"btn btn-mode svelte-1uha8ag",null,z,{"use-mode":!v()}),y(H,v()?"ðŸ“":"ðŸŽ²"),y(Fe,v()?"Edit Mode":"Use Mode")}),F("click",_,()=>n(f,!0)),F("click",Ue,()=>n(ae,!e(ae))),F("click",g,le),Me(_e,S,p=>Na(Dt,p)),F("click",ge,()=>n(ee,!0)),F("click",fe,()=>{n(B,"save"),n(q,!0)}),F("click",He,()=>{n(B,"load"),n(q,!0)}),F("click",Ke,ne),F("click",Xe,Be),F("change",Re,x),o(r,X),_t(),w()}export{di as component};
