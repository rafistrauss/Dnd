import{O as D,W as ae,a0 as M,R as m,a8 as se,X as de,d as X,k as ve,Z as pe,_ as he,$ as Q,a1 as x,T as C,a9 as te,aa as me,ab as W,J as ge,Q as P,V as _e,a3 as Se,ac as Z,ad as re,i as be,ae as le,K as ie,N as ye,af as ne,ag as Ee,ah as R,ai as U,aj as Fe,ak as Ae,al as Ie,M as Ne,am as fe,q as ce,an as Te,ao as we,ap as ke,aq as Ce,ar as Me,as as xe,at as Oe,au as O,av as Le}from"./BMWhyEAP.js";function Qe(e,a){return a}function De(e,a,s){for(var r=[],i=a.length,l=0;l<i;l++)Fe(a[l].e,r,!0);Ae(r,()=>{var t=r.length===0&&s!==null;if(t){var c=s,n=c.parentNode;Ie(n),n.append(c),e.items.clear(),S(e,a[0].prev,a[i-1].next)}for(var v=0;v<i;v++){var o=a[v];t||(e.items.delete(o.k),S(e,o.prev,o.next)),Ne(o.e,!t)}e.first===a[0]&&(e.first=a[0].prev)})}function We(e,a,s,r,i,l=null){var t=e,c=new Map,n=null,v=(a&fe)!==0,o=(a&ne)!==0,b=(a&le)!==0;if(v){var h=e;t=m?M(se(h)):h.appendChild(D())}m&&de();var u=null,F=ve(()=>{var p=s();return be(p)?p:p==null?[]:re(p)}),g,f=!0;function d(){He(I,g,t,a,r),u!==null&&(g.length===0?(u.fragment?(t.before(u.fragment),u.fragment=null):ie(u.effect),w.first=u.effect):ye(u.effect,()=>{u=null}))}var w=ae(()=>{g=X(F);var p=g.length;let N=!1;if(m){var k=pe(t)===he;k!==(p===0)&&(t=Q(),M(t),x(!1),N=!0)}for(var y=new Set,E=ge,T=null,Y=_e(),A=0;A<p;A+=1){m&&C.nodeType===te&&C.data===me&&(t=C,N=!0,x(!1));var H=g[A],L=r(H,A),_=f?null:c.get(L);_?(o&&W(_.v,H),b?W(_.i,A):_.i=A,Y&&E.skipped_effects.delete(_.e)):(_=Re(f?t:null,T,H,L,A,i,a,s),f&&(_.o=!0,T===null?n=_:T.next=_,T=_),c.set(L,_)),y.add(L)}if(p===0&&l&&!u)if(f)u={fragment:null,effect:P(()=>l(t))};else{var G=document.createDocumentFragment(),K=D();G.append(K),u={fragment:G,effect:P(()=>l(K))}}if(m&&p>0&&M(Q()),!f)if(Y){for(const[oe,ue]of c)y.has(oe)||E.skipped_effects.add(ue.e);E.oncommit(d),E.ondiscard(()=>{})}else d();N&&x(!0),X(F)}),I={effect:w,items:c,first:n};f=!1,m&&(t=C)}function He(e,a,s,r,i){var l=(r&Te)!==0,t=a.length,c=e.items,n=e.first,v,o=null,b,h=[],u=[],F,g,f,d;if(l)for(d=0;d<t;d+=1)F=a[d],g=i(F,d),f=c.get(g),f.a?.measure(),(b??=new Set).add(f);for(d=0;d<t;d+=1){if(F=a[d],g=i(F,d),f=c.get(g),e.first??=f,!f.o){f.o=!0;var w=o?o.next:n;S(e,o,f),S(e,f,w),B(f,w,s),o=f,h=[],u=[],n=o.next;continue}if((f.e.f&R)!==0&&(ie(f.e),l&&(f.a?.unfix(),(b??=new Set).delete(f))),f!==n){if(v!==void 0&&v.has(f)){if(h.length<u.length){var I=u[0],p;o=I.prev;var N=h[0],k=h[h.length-1];for(p=0;p<h.length;p+=1)B(h[p],I,s);for(p=0;p<u.length;p+=1)v.delete(u[p]);S(e,N.prev,k.next),S(e,o,N),S(e,k,I),n=I,o=k,d-=1,h=[],u=[]}else v.delete(f),B(f,n,s),S(e,f.prev,f.next),S(e,f,o===null?e.first:o.next),S(e,o,f),o=f;continue}for(h=[],u=[];n!==null&&n.k!==g;)(n.e.f&R)===0&&(v??=new Set).add(n),u.push(n),n=n.next;if(n===null)continue;f=n}h.push(f),o=f,n=f.next}if(n!==null||v!==void 0){for(var y=v===void 0?[]:re(v);n!==null;)(n.e.f&R)===0&&y.push(n),n=n.next;var E=y.length;if(E>0){var T=(r&fe)!==0&&t===0?s:null;if(l){for(d=0;d<E;d+=1)y[d].a?.measure();for(d=0;d<E;d+=1)y[d].a?.fix()}De(e,y,T)}}l&&ce(()=>{if(b!==void 0)for(f of b)f.a?.apply()})}function Re(e,a,s,r,i,l,t,c){var n=(t&ne)!==0,v=(t&Ee)===0,o=n?v?Se(s,!1,!1):Z(s):s,b=(t&le)===0?i:Z(i),h={i:b,v:o,k:r,a:null,e:null,o:!1,prev:a,next:null};try{if(e===null){var u=document.createDocumentFragment();u.append(e=D())}return h.e=P(()=>l(e,o,b,c)),a!==null&&(a.next=h),h}finally{}}function B(e,a,s){for(var r=e.next?e.next.e.nodes_start:s,i=a?a.e.nodes_start:s,l=e.e.nodes_start;l!==null&&l!==r;){var t=U(l);i.before(l),l=t}}function S(e,a,s){a===null?(e.first=s,e.effect.first=s&&s.e):(a.e.next&&(a.e.next.prev=null),a.next=s,a.e.next=s&&s.e),s===null?e.effect.last=a&&a.e:(s.e.prev&&(s.e.prev.next=null),s.prev=a,s.e.prev=a&&a.e)}function Ze(e,a){let s=null,r=m;var i;if(m){s=C;for(var l=se(document.head);l!==null&&(l.nodeType!==te||l.data!==e);)l=U(l);if(l===null)x(!1);else{var t=U(l);l.remove(),M(t)}}m||(i=document.head.appendChild(D()));try{ae(()=>a(i),we)}finally{r&&(x(!0),M(s))}}const z=[...` 	
\r\fÂ \v\uFEFF`];function Be(e,a,s){var r=e==null?"":""+e;if(a&&(r=r?r+" "+a:a),s){for(var i in s)if(s[i])r=r?r+" "+i:i;else if(r.length)for(var l=i.length,t=0;(t=r.indexOf(i,t))>=0;){var c=t+l;(t===0||z.includes(r[t-1]))&&(c===r.length||z.includes(r[c]))?r=(t===0?"":r.substring(0,t))+r.substring(c+1):t=c}}return r===""?null:r}function ze(e,a,s,r,i,l){var t=e.__className;if(m||t!==s||t===void 0){var c=Be(s,r,l);(!m||c!==e.getAttribute("class"))&&(c==null?e.removeAttribute("class"):e.className=c),e.__className=s}else if(l&&i!==l)for(var n in l){var v=!!l[n];(i==null||v!==!!i[n])&&e.classList.toggle(n,v)}return l}const Pe=Symbol("is custom element"),Ue=Symbol("is html");function $e(e){if(m){var a=!1,s=()=>{if(!a){if(a=!0,e.hasAttribute("value")){var r=e.value;$(e,"value",null),e.value=r}if(e.hasAttribute("checked")){var i=e.checked;$(e,"checked",null),e.checked=i}}};e.__on_r=s,ce(s),Ce()}}function je(e,a){var s=q(e);s.value===(s.value=a??void 0)||e.value===a&&(a!==0||e.nodeName!=="PROGRESS")||(e.value=a??"")}function ea(e,a){var s=q(e);s.checked!==(s.checked=a??void 0)&&(e.checked=a)}function $(e,a,s,r){var i=q(e);m&&(i[a]=e.getAttribute(a),a==="src"||a==="srcset"||a==="href"&&e.nodeName==="LINK")||i[a]!==(i[a]=s)&&(a==="loading"&&(e[Me]=s),s==null?e.removeAttribute(a):typeof s!="string"&&Je(e).includes(a)?e[a]=s:e.setAttribute(a,s))}function q(e){return e.__attributes??={[Pe]:e.nodeName.includes("-"),[Ue]:e.namespaceURI===ke}}var j=new Map;function Je(e){var a=e.getAttribute("is")||e.nodeName,s=j.get(a);if(s)return s;j.set(a,s=[]);for(var r,i=e,l=Element.prototype;l!==i;){r=Oe(i);for(var t in r)r[t].set&&s.push(t);i=xe(i)}return s}function qe(){const{subscribe:e,update:a}=O([]);let s=0;return{subscribe:e,add:(r,i="info",l=3e3)=>{const t=s++,c={id:t,message:r,type:i,duration:l};a(n=>[...n,c]),l>0&&setTimeout(()=>{a(n=>n.filter(v=>v.id!==t))},l)},remove:r=>{a(i=>i.filter(l=>l.id!==r))},clear:()=>{a(()=>[])}}}const aa=qe(),J={name:"",class:"",subclass:"",level:1,race:"",background:"",alignment:"",armorClass:10,initiative:0,speed:"30 ft",currentHP:0,maxHP:0,tempHP:0,hitDice:{current:3,max:3},abilities:{strength:10,dexterity:10,constitution:10,intelligence:10,wisdom:10,charisma:10},proficiencyBonus:2,saveProficiencies:{strength:!1,dexterity:!1,constitution:!1,intelligence:!1,wisdom:!1,charisma:!1},skillProficiencies:{acrobatics:!1,animalHandling:!1,arcana:!1,athletics:!1,deception:!1,history:!1,insight:!1,intimidation:!1,investigation:!1,medicine:!1,nature:!1,perception:!1,performance:!1,persuasion:!1,religion:!1,sleightOfHand:!1,stealth:!1,survival:!1},attacks:[],features:"",equipment:"",notes:"",classFeatures:{features:{},spellSlots:[],spellSlotsByLevel:{},preparedSpells:""}};function Ve(){try{const e=localStorage.getItem("dndCharacter");if(e){const a={...J,...JSON.parse(e)};return!a.attacks||!Array.isArray(a.attacks)?a.attacks=[]:a.attacks=a.attacks.map(s=>({...s,id:s.id||crypto.randomUUID()})),a.classFeatures?(a.classFeatures.features||(a.classFeatures.features={}),a.classFeatures.spellSlots||(a.classFeatures.spellSlots=[]),a.classFeatures.spellSlotsByLevel||(a.classFeatures.spellSlotsByLevel={}),a.classFeatures.preparedSpells===void 0&&(a.classFeatures.preparedSpells="")):a.classFeatures={features:{},spellSlots:[],spellSlotsByLevel:{},preparedSpells:""},a}}catch(e){console.error("Failed to load character from storage:",e)}return J}const V=O(Ve());V.subscribe(e=>{try{localStorage.setItem("dndCharacter",JSON.stringify(e))}catch(a){console.error("Failed to save character to storage:",a)}});const ee=O(!0);{const e=localStorage.getItem("dndMode");ee.set(e==="edit"),ee.subscribe(a=>{localStorage.setItem("dndMode",a?"edit":"use")})}const sa=Le(V,e=>{const a=s=>Math.floor((s-10)/2);return{strength:a(e.abilities.strength),dexterity:a(e.abilities.dexterity),constitution:a(e.abilities.constitution),intelligence:a(e.abilities.intelligence),wisdom:a(e.abilities.wisdom),charisma:a(e.abilities.charisma)}});function Ye(e){return Math.ceil(e/4)+1}function ta(){V.update(e=>(e.proficiencyBonus=Ye(e.level),e))}function ra(e){const a=JSON.stringify(e,null,2),s="data:application/json;charset=utf-8,"+encodeURIComponent(a),r=`${e.name||"character"}_${new Date().toISOString().split("T")[0]}.json`,i=document.createElement("a");i.setAttribute("href",s),i.setAttribute("download",r),i.click()}function la(e){return new Promise((a,s)=>{const r=new FileReader;r.onload=i=>{try{const l=JSON.parse(i.target?.result),t={...J,...l};t.attacks&&Array.isArray(t.attacks)&&(t.attacks=t.attacks.map(c=>({...c,id:c.id||crypto.randomUUID()}))),t.classFeatures?(t.classFeatures.features||(t.classFeatures.features={}),t.classFeatures.spellSlots||(t.classFeatures.spellSlots=[]),t.classFeatures.spellSlotsByLevel||(t.classFeatures.spellSlotsByLevel={}),t.classFeatures.preparedSpells===void 0&&(t.classFeatures.preparedSpells="")):t.classFeatures={features:{},spellSlots:[],spellSlotsByLevel:{},preparedSpells:""},a(t)}catch{s(new Error("Invalid character file"))}},r.onerror=()=>s(new Error("Failed to read file")),r.readAsText(e)})}const ia=O("");function Ge(){try{const e=localStorage.getItem("dndCollapsedStates");if(e)return JSON.parse(e)}catch(e){console.error("Failed to load collapsed states:",e)}return{characterInfo:!1,combatStats:!1,abilityScores:!1,skills:!1,attacks:!1,classFeatures:!1,notes:!1}}const Ke=O(Ge());Ke.subscribe(e=>{try{localStorage.setItem("dndCollapsedStates",JSON.stringify(e))}catch(a){console.error("Failed to save collapsed states:",a)}});export{$ as a,Ke as b,V as c,je as d,We as e,ia as f,sa as g,Ze as h,Qe as i,ee as j,ea as k,ra as l,la as m,$e as r,ze as s,aa as t,ta as u};
