import{O as J,W as _e,a0 as R,R as y,au as me,X as Ne,d as C,k as Ie,Z as Ce,_ as xe,$ as ie,a1 as B,T as L,af as he,aI as Me,am as ne,J as Oe,Q as X,V as Le,a3 as Re,ad as le,aG as ge,i as Be,aK as Se,K as ye,N as De,aL as be,aM as He,aN as G,aC as z,aO as $e,aP as Pe,aF as Ue,M as Je,aQ as Ee,q as j,aR as qe,aS as Ge,aT as Ye,aU as Ke,aV as Ve,aW as We,aX as Xe,h as ze,Y as Qe,aY as Ze,ay as je,e as ea,b as aa,aZ as ta,at as Fe,a_ as sa,a2 as M,a$ as D,b0 as ra,B as ia,F as na,G as Y,I as $,H as P,E as la}from"./CmcvLP-Y.js";import{b as oa,f as ke,a as O,s as fa,e as ca,t as K}from"./BmKkCgmR.js";import{i as ua}from"./AFJ5q3G2.js";import{s as da,i as V,a as va}from"./BibxXT0t.js";function Ua(a,e){return e}function pa(a,e,t){for(var r=[],i=e.length,n=0;n<i;n++)$e(e[n].e,r,!0);Pe(r,()=>{var s=r.length===0&&t!==null;if(s){var f=t,o=f.parentNode;Ue(o),o.append(f),a.items.clear(),A(a,e[0].prev,e[i-1].next)}for(var u=0;u<i;u++){var c=e[u];s||(a.items.delete(c.k),A(a,c.prev,c.next)),Je(c.e,!s)}a.first===e[0]&&(a.first=e[0].prev)})}function _a(a,e,t,r,i,n=null){var s=a,f=new Map,o=null,u=(e&Ee)!==0,c=(e&be)!==0,S=(e&Se)!==0;if(u){var p=a;s=y?R(me(p)):p.appendChild(J())}y&&Ne();var v=null,g=Ie(()=>{var m=t();return Be(m)?m:m==null?[]:ge(m)}),d,l=!0;function _(){ma(h,d,s,e,r),v!==null&&(d.length===0?(v.fragment?(s.before(v.fragment),v.fragment=null):ye(v.effect),b.first=v.effect):De(v.effect,()=>{v=null}))}var b=_e(()=>{d=C(g);var m=d.length;let T=!1;if(y){var N=Ce(s)===xe;N!==(m===0)&&(s=ie(),R(s),B(!1),T=!0)}for(var E=new Set,F=Oe,k=null,te=Le(),x=0;x<m;x+=1){y&&L.nodeType===he&&L.data===Me&&(s=L,T=!0,B(!1));var q=d[x],H=r(q,x),w=l?null:f.get(H);w?(c&&ne(w.v,q),S?ne(w.i,x):w.i=x,te&&F.skipped_effects.delete(w.e)):(w=ha(l?s:null,k,q,H,x,i,e,t),l&&(w.o=!0,k===null?o=w:k.next=w,k=w),f.set(H,w)),E.add(H)}if(m===0&&n&&!v)if(l)v={fragment:null,effect:X(()=>n(s))};else{var se=document.createDocumentFragment(),re=J();se.append(re),v={fragment:se,effect:X(()=>n(re))}}if(y&&m>0&&R(ie()),!l)if(te){for(const[Ae,Te]of f)E.has(Ae)||F.skipped_effects.add(Te.e);F.oncommit(_),F.ondiscard(()=>{})}else _();T&&B(!0),C(g)}),h={effect:b,items:f,first:o};l=!1,y&&(s=L)}function ma(a,e,t,r,i){var n=(r&qe)!==0,s=e.length,f=a.items,o=a.first,u,c=null,S,p=[],v=[],g,d,l,_;if(n)for(_=0;_<s;_+=1)g=e[_],d=i(g,_),l=f.get(d),l.a?.measure(),(S??=new Set).add(l);for(_=0;_<s;_+=1){if(g=e[_],d=i(g,_),l=f.get(d),a.first??=l,!l.o){l.o=!0;var b=c?c.next:o;A(a,c,l),A(a,l,b),W(l,b,t),c=l,p=[],v=[],o=c.next;continue}if((l.e.f&G)!==0&&(ye(l.e),n&&(l.a?.unfix(),(S??=new Set).delete(l))),l!==o){if(u!==void 0&&u.has(l)){if(p.length<v.length){var h=v[0],m;c=h.prev;var T=p[0],N=p[p.length-1];for(m=0;m<p.length;m+=1)W(p[m],h,t);for(m=0;m<v.length;m+=1)u.delete(v[m]);A(a,T.prev,N.next),A(a,c,T),A(a,N,h),o=h,c=N,_-=1,p=[],v=[]}else u.delete(l),W(l,o,t),A(a,l.prev,l.next),A(a,l,c===null?a.first:c.next),A(a,c,l),c=l;continue}for(p=[],v=[];o!==null&&o.k!==d;)(o.e.f&G)===0&&(u??=new Set).add(o),v.push(o),o=o.next;if(o===null)continue;l=o}p.push(l),c=l,o=l.next}if(o!==null||u!==void 0){for(var E=u===void 0?[]:ge(u);o!==null;)(o.e.f&G)===0&&E.push(o),o=o.next;var F=E.length;if(F>0){var k=(r&Ee)!==0&&s===0?t:null;if(n){for(_=0;_<F;_+=1)E[_].a?.measure();for(_=0;_<F;_+=1)E[_].a?.fix()}pa(a,E,k)}}n&&j(()=>{if(S!==void 0)for(l of S)l.a?.apply()})}function ha(a,e,t,r,i,n,s,f){var o=(s&be)!==0,u=(s&He)===0,c=o?u?Re(t,!1,!1):le(t):t,S=(s&Se)===0?i:le(i),p={i:S,v:c,k:r,a:null,e:null,o:!1,prev:e,next:null};try{if(a===null){var v=document.createDocumentFragment();v.append(a=J())}return p.e=X(()=>n(a,c,S,f)),e!==null&&(e.next=p),p}finally{}}function W(a,e,t){for(var r=a.next?a.next.e.nodes_start:t,i=e?e.e.nodes_start:t,n=a.e.nodes_start;n!==null&&n!==r;){var s=z(n);i.before(n),n=s}}function A(a,e,t){e===null?(a.first=t,a.effect.first=t&&t.e):(e.e.next&&(e.e.next.prev=null),e.next=t,e.e.next=t&&t.e),t===null?a.effect.last=e&&e.e:(t.e.prev&&(t.e.prev.next=null),t.prev=e,t.e.prev=e&&e.e)}function Ja(a,e){let t=null,r=y;var i;if(y){t=L;for(var n=me(document.head);n!==null&&(n.nodeType!==he||n.data!==a);)n=z(n);if(n===null)B(!1);else{var s=z(n);n.remove(),R(s)}}y||(i=document.head.appendChild(J()));try{_e(()=>e(i),Ge)}finally{r&&(B(!0),R(t))}}const oe=[...` 	
\r\f \v\uFEFF`];function ga(a,e,t){var r=a==null?"":""+a;if(e&&(r=r?r+" "+e:e),t){for(var i in t)if(t[i])r=r?r+" "+i:i;else if(r.length)for(var n=i.length,s=0;(s=r.indexOf(i,s))>=0;){var f=s+n;(s===0||oe.includes(r[s-1]))&&(f===r.length||oe.includes(r[f]))?r=(s===0?"":r.substring(0,s))+r.substring(f+1):s=f}}return r===""?null:r}function Sa(a,e,t,r,i,n){var s=a.__className;if(y||s!==t||s===void 0){var f=ga(t,r,n);(!y||f!==a.getAttribute("class"))&&(f==null?a.removeAttribute("class"):a.className=f),a.__className=t}else if(n&&i!==n)for(var o in n){var u=!!n[o];(i==null||u!==!!i[o])&&a.classList.toggle(o,u)}return n}const ya=Symbol("is custom element"),ba=Symbol("is html");function qa(a){if(y){var e=!1,t=()=>{if(!e){if(e=!0,a.hasAttribute("value")){var r=a.value;fe(a,"value",null),a.value=r}if(a.hasAttribute("checked")){var i=a.checked;fe(a,"checked",null),a.checked=i}}};a.__on_r=t,j(t),Ke()}}function Ga(a,e){var t=ee(a);t.value===(t.value=e??void 0)||a.value===e&&(e!==0||a.nodeName!=="PROGRESS")||(a.value=e??"")}function Ya(a,e){var t=ee(a);t.checked!==(t.checked=e??void 0)&&(a.checked=e)}function fe(a,e,t,r){var i=ee(a);y&&(i[e]=a.getAttribute(e),e==="src"||e==="srcset"||e==="href"&&a.nodeName==="LINK")||i[e]!==(i[e]=t)&&(e==="loading"&&(a[Ve]=t),t==null?a.removeAttribute(e):typeof t!="string"&&Ea(a).includes(e)?a[e]=t:a.setAttribute(e,t))}function ee(a){return a.__attributes??={[ya]:a.nodeName.includes("-"),[ba]:a.namespaceURI===Ye}}var ce=new Map;function Ea(a){var e=a.getAttribute("is")||a.nodeName,t=ce.get(e);if(t)return t;ce.set(e,t=[]);for(var r,i=a,n=Element.prototype;n!==i;){r=Xe(i);for(var s in r)r[s].set&&t.push(s);i=We(i)}return t}const Fa=()=>performance.now(),I={tick:a=>requestAnimationFrame(a),now:()=>Fa(),tasks:new Set};function we(){const a=I.now();I.tasks.forEach(e=>{e.c(a)||(I.tasks.delete(e),e.f())}),I.tasks.size!==0&&I.tick(we)}function ka(a){let e;return I.tasks.size===0&&I.tick(we),{promise:new Promise(t=>{I.tasks.add(e={c:a,f:t})}),abort(){I.tasks.delete(e)}}}function U(a,e){Fe(()=>{a.dispatchEvent(new CustomEvent(e))})}function wa(a){if(a==="float")return"cssFloat";if(a==="offset")return"cssOffset";if(a.startsWith("--"))return a;const e=a.split("-");return e.length===1?e[0]:e[0]+e.slice(1).map(t=>t[0].toUpperCase()+t.slice(1)).join("")}function ue(a){const e={},t=a.split(";");for(const r of t){const[i,n]=r.split(":");if(!i||n===void 0)break;const s=wa(i.trim());e[s]=n.trim()}return e}const Aa=a=>a;function Ta(a,e,t,r){var i=(a&ta)!==0,n="both",s,f=e.inert,o=e.style.overflow,u,c;function S(){return Fe(()=>s??=t()(e,r?.()??{},{direction:n}))}var p={is_global:i,in(){e.inert=f,U(e,"introstart"),u=Q(e,S(),c,1,()=>{U(e,"introend"),u?.abort(),u=s=void 0,e.style.overflow=o})},out(l){e.inert=!0,U(e,"outrostart"),c=Q(e,S(),u,0,()=>{U(e,"outroend"),l?.()})},stop:()=>{u?.abort(),c?.abort()}},v=ze;if((v.transitions??=[]).push(p),oa){var g=i;if(!g){for(var d=v.parent;d&&(d.f&Qe)!==0;)for(;(d=d.parent)&&(d.f&Ze)===0;);g=!d||(d.f&je)!==0}g&&ea(()=>{aa(()=>p.in())})}}function Q(a,e,t,r,i){var n=r===1;if(sa(e)){var s,f=!1;return j(()=>{if(!f){var l=e({direction:n?"in":"out"});s=Q(a,l,t,r,i)}}),{abort:()=>{f=!0,s?.abort()},deactivate:()=>s.deactivate(),reset:()=>s.reset(),t:()=>s.t()}}if(t?.deactivate(),!e?.duration)return i(),{abort:M,deactivate:M,reset:M,t:()=>r};const{delay:o=0,css:u,tick:c,easing:S=Aa}=e;var p=[];if(n&&t===void 0&&(c&&c(0,1),u)){var v=ue(u(0,1));p.push(v,v)}var g=()=>1-r,d=a.animate(p,{duration:o,fill:"forwards"});return d.onfinish=()=>{d.cancel();var l=t?.t()??1-r;t?.abort();var _=r-l,b=e.duration*Math.abs(_),h=[];if(b>0){var m=!1;if(u)for(var T=Math.ceil(b/16.666666666666668),N=0;N<=T;N+=1){var E=l+_*S(N/T),F=ue(u(E,1-E));h.push(F),m||=F.overflow==="hidden"}m&&(a.style.overflow="hidden"),g=()=>{var k=d.currentTime;return l+_*S(k/b)},c&&ka(()=>{if(d.playState!=="running")return!1;var k=g();return c(k,1-k),!0})}d=a.animate(h,{duration:b,fill:"forwards"}),d.onfinish=()=>{g=()=>r,c?.(r,1-r),i()}},{abort:()=>{d&&(d.cancel(),d.effect=null,d.onfinish=M)},deactivate:()=>{i=M},reset:()=>{r===0&&c?.(1,0)},t:()=>g()}}function Na(){const{subscribe:a,update:e}=D([]);let t=0;return{subscribe:a,add:(r,i="info",n=3e3)=>{const s=t++,f={id:s,message:r,type:i,duration:n};e(o=>[...o,f]),n>0&&setTimeout(()=>{e(o=>o.filter(u=>u.id!==s))},n)},remove:r=>{e(i=>i.filter(n=>n.id!==r))},clear:()=>{e(()=>[])}}}const de=Na(),Z={name:"",class:"",subclass:"",level:1,race:"",background:"",alignment:"",armorClass:10,initiative:0,speed:"30 ft",currentHP:0,maxHP:0,tempHP:0,hitDice:{current:3,max:3},abilities:{strength:10,dexterity:10,constitution:10,intelligence:10,wisdom:10,charisma:10},proficiencyBonus:2,saveProficiencies:{strength:!1,dexterity:!1,constitution:!1,intelligence:!1,wisdom:!1,charisma:!1},skillProficiencies:{acrobatics:!1,animalHandling:!1,arcana:!1,athletics:!1,deception:!1,history:!1,insight:!1,intimidation:!1,investigation:!1,medicine:!1,nature:!1,perception:!1,performance:!1,persuasion:!1,religion:!1,sleightOfHand:!1,stealth:!1,survival:!1},attacks:[],features:"",equipment:"",notes:"",classFeatures:{features:{},spellSlots:[],spellSlotsByLevel:{},preparedSpells:""}};function Ia(){try{const a=localStorage.getItem("dndCharacter");if(a){const e={...Z,...JSON.parse(a)};return!e.attacks||!Array.isArray(e.attacks)?e.attacks=[]:e.attacks=e.attacks.map(t=>({...t,id:t.id||crypto.randomUUID()})),e.classFeatures?(e.classFeatures.features||(e.classFeatures.features={}),e.classFeatures.spellSlots||(e.classFeatures.spellSlots=[]),e.classFeatures.spellSlotsByLevel||(e.classFeatures.spellSlotsByLevel={}),e.classFeatures.preparedSpells===void 0&&(e.classFeatures.preparedSpells="")):e.classFeatures={features:{},spellSlots:[],spellSlotsByLevel:{},preparedSpells:""},e}}catch(a){console.error("Failed to load character from storage:",a)}return Z}const ae=D(Ia());ae.subscribe(a=>{try{localStorage.setItem("dndCharacter",JSON.stringify(a))}catch(e){console.error("Failed to save character to storage:",e)}});const ve=D(!0);{const a=localStorage.getItem("dndMode");ve.set(a==="edit"),ve.subscribe(e=>{localStorage.setItem("dndMode",e?"edit":"use")})}const Ka=ra(ae,a=>{const e=t=>Math.floor((t-10)/2);return{strength:e(a.abilities.strength),dexterity:e(a.abilities.dexterity),constitution:e(a.abilities.constitution),intelligence:e(a.abilities.intelligence),wisdom:e(a.abilities.wisdom),charisma:e(a.abilities.charisma)}});function Ca(a){return Math.ceil(a/4)+1}function Va(){ae.update(a=>(a.proficiencyBonus=Ca(a.level),a))}function Wa(a){const e=JSON.stringify(a,null,2),t="data:application/json;charset=utf-8,"+encodeURIComponent(e),r=`${a.name||"character"}_${new Date().toISOString().split("T")[0]}.json`,i=document.createElement("a");i.setAttribute("href",t),i.setAttribute("download",r),i.click()}function Xa(a){return new Promise((e,t)=>{const r=new FileReader;r.onload=i=>{try{const n=JSON.parse(i.target?.result),s={...Z,...n};s.attacks&&Array.isArray(s.attacks)&&(s.attacks=s.attacks.map(f=>({...f,id:f.id||crypto.randomUUID()}))),s.classFeatures?(s.classFeatures.features||(s.classFeatures.features={}),s.classFeatures.spellSlots||(s.classFeatures.spellSlots=[]),s.classFeatures.spellSlotsByLevel||(s.classFeatures.spellSlotsByLevel={}),s.classFeatures.preparedSpells===void 0&&(s.classFeatures.preparedSpells="")):s.classFeatures={features:{},spellSlots:[],spellSlotsByLevel:{},preparedSpells:""},e(s)}catch{t(new Error("Invalid character file"))}},r.onerror=()=>t(new Error("Failed to read file")),r.readAsText(a)})}const za=D("");function xa(){try{const a=localStorage.getItem("dndCollapsedStates");if(a)return JSON.parse(a)}catch(a){console.error("Failed to load collapsed states:",a)}return{characterInfo:!1,combatStats:!1,abilityScores:!1,skills:!1,attacks:!1,classFeatures:!1,notes:!1}}const Ma=D(xa());Ma.subscribe(a=>{try{localStorage.setItem("dndCollapsedStates",JSON.stringify(a))}catch(e){console.error("Failed to save collapsed states:",e)}});function Oa(a){const e=a-1;return e*e*e+1}function pe(a){const e=typeof a=="string"&&a.match(/^\s*(-?[\d.]+)([^\s]*)\s*$/);return e?[parseFloat(e[1]),e[2]||"px"]:[a,"px"]}function La(a,{delay:e=0,duration:t=400,easing:r=Oa,x:i=0,y:n=0,opacity:s=0}={}){const f=getComputedStyle(a),o=+f.opacity,u=f.transform==="none"?"":f.transform,c=o*(1-s),[S,p]=pe(i),[v,g]=pe(n);return{delay:e,duration:t,easing:r,css:(d,l)=>`
			transform: ${u} translate(${(1-d)*S}${p}, ${(1-d)*v}${g});
			opacity: ${o-c*l}`}}var Ra=ke('<div><span class="toast-icon svelte-1cpok13"><!> <!> <!></span> <span class="toast-message svelte-1cpok13"> </span> <button class="toast-close svelte-1cpok13" aria-label="Close notification">×</button></div>'),Ba=ke('<div class="toast-container svelte-1cpok13"></div>');function Qa(a,e){ia(e,!1);const t=()=>va(de,"$toasts",r),[r,i]=da();ua();var n=Ba();_a(n,5,t,s=>s.id,(s,f)=>{var o=Ra(),u=Y(o),c=Y(u);{var S=h=>{var m=K("✓");O(h,m)};V(c,h=>{C(f).type==="success"&&h(S)})}var p=$(c,2);{var v=h=>{var m=K("✕");O(h,m)};V(p,h=>{C(f).type==="error"&&h(v)})}var g=$(p,2);{var d=h=>{var m=K("ℹ");O(h,m)};V(g,h=>{C(f).type==="info"&&h(d)})}P(u);var l=$(u,2),_=Y(l,!0);P(l);var b=$(l,2);P(o),la(()=>{Sa(o,1,`toast toast-${C(f).type??""}`,"svelte-1cpok13"),fa(_,C(f).message)}),ca("click",b,()=>de.remove(C(f).id)),Ta(3,o,()=>La,()=>({y:-50,duration:300})),O(s,o)}),P(n),O(a,n),na(),i()}export{Qa as T,Ma as a,Ga as b,ae as c,za as d,_a as e,Sa as f,Ka as g,Ja as h,Ua as i,ve as j,Ya as k,Wa as l,Xa as m,qa as r,fe as s,de as t,Va as u};
