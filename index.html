<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>D&D Character Sheet</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>D&D Character Sheet</h1>
            <div class="header-actions">
                <button id="saveBtn" class="btn btn-primary">Save</button>
                <button id="exportBtn" class="btn btn-secondary">Export</button>
                <button id="importBtn" class="btn btn-secondary">Import</button>
                <button id="saveToGistBtn" class="btn btn-secondary">Save to Gist</button>
                <button id="loadFromGistBtn" class="btn btn-secondary">Load from Gist</button>
                <input type="file" id="fileInput" accept=".json" style="display: none;">
            </div>
        </header>

        <main>
            <!-- Character Info Section -->
            <section class="character-info">
                <div class="info-row">
                    <div class="form-group">
                        <label>Character Name</label>
                        <input type="text" id="characterName" placeholder="Enter name">
                    </div>
                    <div class="form-group">
                        <label>Class</label>
                        <input type="text" id="characterClass" placeholder="e.g., Fighter">
                    </div>
                    <div class="form-group">
                        <label>Level</label>
                        <input type="number" id="characterLevel" placeholder="1" min="1" max="20">
                    </div>
                </div>
                <div class="info-row">
                    <div class="form-group">
                        <label>Race</label>
                        <input type="text" id="characterRace" placeholder="e.g., Human">
                    </div>
                    <div class="form-group">
                        <label>Background</label>
                        <input type="text" id="characterBackground" placeholder="e.g., Soldier">
                    </div>
                    <div class="form-group">
                        <label>Alignment</label>
                        <input type="text" id="characterAlignment" placeholder="e.g., Lawful Good">
                    </div>
                </div>
            </section>

            <!-- HP and AC Section -->
            <section class="combat-stats">
                <div class="stat-box">
                    <label>Armor Class</label>
                    <input type="number" id="armorClass" placeholder="10" class="stat-input">
                </div>
                <div class="stat-box">
                    <label>Initiative</label>
                    <input type="number" id="initiative" placeholder="+0" class="stat-input">
                </div>
                <div class="stat-box">
                    <label>Speed</label>
                    <input type="text" id="speed" placeholder="30 ft" class="stat-input">
                </div>
                <div class="stat-box hp-box">
                    <label>Hit Points</label>
                    <div class="hp-inputs">
                        <input type="number" id="currentHP" placeholder="0" class="stat-input">
                        <span>/</span>
                        <input type="number" id="maxHP" placeholder="0" class="stat-input">
                    </div>
                </div>
            </section>

            <!-- Ability Scores Section -->
            <section class="ability-scores">
                <h2>Ability Scores</h2>
                <div class="abilities-grid">
                    <div class="ability-card" data-ability="strength">
                        <div class="ability-name">STR</div>
                        <div class="ability-modifier" id="strMod">+0</div>
                        <input type="number" id="strength" placeholder="10" class="ability-score" min="1" max="30">
                        <button class="roll-btn" data-check="strength">Roll</button>
                    </div>
                    <div class="ability-card" data-ability="dexterity">
                        <div class="ability-name">DEX</div>
                        <div class="ability-modifier" id="dexMod">+0</div>
                        <input type="number" id="dexterity" placeholder="10" class="ability-score" min="1" max="30">
                        <button class="roll-btn" data-check="dexterity">Roll</button>
                    </div>
                    <div class="ability-card" data-ability="constitution">
                        <div class="ability-name">CON</div>
                        <div class="ability-modifier" id="conMod">+0</div>
                        <input type="number" id="constitution" placeholder="10" class="ability-score" min="1" max="30">
                        <button class="roll-btn" data-check="constitution">Roll</button>
                    </div>
                    <div class="ability-card" data-ability="intelligence">
                        <div class="ability-name">INT</div>
                        <div class="ability-modifier" id="intMod">+0</div>
                        <input type="number" id="intelligence" placeholder="10" class="ability-score" min="1" max="30">
                        <button class="roll-btn" data-check="intelligence">Roll</button>
                    </div>
                    <div class="ability-card" data-ability="wisdom">
                        <div class="ability-name">WIS</div>
                        <div class="ability-modifier" id="wisMod">+0</div>
                        <input type="number" id="wisdom" placeholder="10" class="ability-score" min="1" max="30">
                        <button class="roll-btn" data-check="wisdom">Roll</button>
                    </div>
                    <div class="ability-card" data-ability="charisma">
                        <div class="ability-name">CHA</div>
                        <div class="ability-modifier" id="chaMod">+0</div>
                        <input type="number" id="charisma" placeholder="10" class="ability-score" min="1" max="30">
                        <button class="roll-btn" data-check="charisma">Roll</button>
                    </div>
                </div>
            </section>

            <!-- Saving Throws Section -->
            <section class="saves-skills">
                <h2>Saving Throws</h2>
                <div class="saves-grid">
                    <div class="save-item">
                        <input type="checkbox" id="strSaveProf">
                        <label for="strSaveProf">Strength</label>
                        <span class="save-mod" id="strSave">+0</span>
                        <button class="roll-btn-small" data-save="strength">Roll</button>
                    </div>
                    <div class="save-item">
                        <input type="checkbox" id="dexSaveProf">
                        <label for="dexSaveProf">Dexterity</label>
                        <span class="save-mod" id="dexSave">+0</span>
                        <button class="roll-btn-small" data-save="dexterity">Roll</button>
                    </div>
                    <div class="save-item">
                        <input type="checkbox" id="conSaveProf">
                        <label for="conSaveProf">Constitution</label>
                        <span class="save-mod" id="conSave">+0</span>
                        <button class="roll-btn-small" data-save="constitution">Roll</button>
                    </div>
                    <div class="save-item">
                        <input type="checkbox" id="intSaveProf">
                        <label for="intSaveProf">Intelligence</label>
                        <span class="save-mod" id="intSave">+0</span>
                        <button class="roll-btn-small" data-save="intelligence">Roll</button>
                    </div>
                    <div class="save-item">
                        <input type="checkbox" id="wisSaveProf">
                        <label for="wisSaveProf">Wisdom</label>
                        <span class="save-mod" id="wisSave">+0</span>
                        <button class="roll-btn-small" data-save="wisdom">Roll</button>
                    </div>
                    <div class="save-item">
                        <input type="checkbox" id="chaSaveProf">
                        <label for="chaSaveProf">Charisma</label>
                        <span class="save-mod" id="chaSave">+0</span>
                        <button class="roll-btn-small" data-save="charisma">Roll</button>
                    </div>
                </div>
            </section>

            <!-- Skills Section -->
            <section class="skills-section">
                <h2>Skills</h2>
                <div class="form-group">
                    <label>Proficiency Bonus</label>
                    <input type="number" id="proficiencyBonus" placeholder="+2" class="stat-input">
                </div>
                <div class="skills-grid">
                    <div class="skill-item">
                        <input type="checkbox" id="acrobaticsProf">
                        <label for="acrobaticsProf">Acrobatics (DEX)</label>
                        <span class="skill-mod" id="acrobatics">+0</span>
                        <button class="roll-btn-small" data-skill="acrobatics">Roll</button>
                    </div>
                    <div class="skill-item">
                        <input type="checkbox" id="animalHandlingProf">
                        <label for="animalHandlingProf">Animal Handling (WIS)</label>
                        <span class="skill-mod" id="animalHandling">+0</span>
                        <button class="roll-btn-small" data-skill="animalHandling">Roll</button>
                    </div>
                    <div class="skill-item">
                        <input type="checkbox" id="arcanaProf">
                        <label for="arcanaProf">Arcana (INT)</label>
                        <span class="skill-mod" id="arcana">+0</span>
                        <button class="roll-btn-small" data-skill="arcana">Roll</button>
                    </div>
                    <div class="skill-item">
                        <input type="checkbox" id="athleticsProf">
                        <label for="athleticsProf">Athletics (STR)</label>
                        <span class="skill-mod" id="athletics">+0</span>
                        <button class="roll-btn-small" data-skill="athletics">Roll</button>
                    </div>
                    <div class="skill-item">
                        <input type="checkbox" id="deceptionProf">
                        <label for="deceptionProf">Deception (CHA)</label>
                        <span class="skill-mod" id="deception">+0</span>
                        <button class="roll-btn-small" data-skill="deception">Roll</button>
                    </div>
                    <div class="skill-item">
                        <input type="checkbox" id="historyProf">
                        <label for="historyProf">History (INT)</label>
                        <span class="skill-mod" id="history">+0</span>
                        <button class="roll-btn-small" data-skill="history">Roll</button>
                    </div>
                    <div class="skill-item">
                        <input type="checkbox" id="insightProf">
                        <label for="insightProf">Insight (WIS)</label>
                        <span class="skill-mod" id="insight">+0</span>
                        <button class="roll-btn-small" data-skill="insight">Roll</button>
                    </div>
                    <div class="skill-item">
                        <input type="checkbox" id="intimidationProf">
                        <label for="intimidationProf">Intimidation (CHA)</label>
                        <span class="skill-mod" id="intimidation">+0</span>
                        <button class="roll-btn-small" data-skill="intimidation">Roll</button>
                    </div>
                    <div class="skill-item">
                        <input type="checkbox" id="investigationProf">
                        <label for="investigationProf">Investigation (INT)</label>
                        <span class="skill-mod" id="investigation">+0</span>
                        <button class="roll-btn-small" data-skill="investigation">Roll</button>
                    </div>
                    <div class="skill-item">
                        <input type="checkbox" id="medicineProf">
                        <label for="medicineProf">Medicine (WIS)</label>
                        <span class="skill-mod" id="medicine">+0</span>
                        <button class="roll-btn-small" data-skill="medicine">Roll</button>
                    </div>
                    <div class="skill-item">
                        <input type="checkbox" id="natureProf">
                        <label for="natureProf">Nature (INT)</label>
                        <span class="skill-mod" id="nature">+0</span>
                        <button class="roll-btn-small" data-skill="nature">Roll</button>
                    </div>
                    <div class="skill-item">
                        <input type="checkbox" id="perceptionProf">
                        <label for="perceptionProf">Perception (WIS)</label>
                        <span class="skill-mod" id="perception">+0</span>
                        <button class="roll-btn-small" data-skill="perception">Roll</button>
                    </div>
                    <div class="skill-item">
                        <input type="checkbox" id="performanceProf">
                        <label for="performanceProf">Performance (CHA)</label>
                        <span class="skill-mod" id="performance">+0</span>
                        <button class="roll-btn-small" data-skill="performance">Roll</button>
                    </div>
                    <div class="skill-item">
                        <input type="checkbox" id="persuasionProf">
                        <label for="persuasionProf">Persuasion (CHA)</label>
                        <span class="skill-mod" id="persuasion">+0</span>
                        <button class="roll-btn-small" data-skill="persuasion">Roll</button>
                    </div>
                    <div class="skill-item">
                        <input type="checkbox" id="religionProf">
                        <label for="religionProf">Religion (INT)</label>
                        <span class="skill-mod" id="religion">+0</span>
                        <button class="roll-btn-small" data-skill="religion">Roll</button>
                    </div>
                    <div class="skill-item">
                        <input type="checkbox" id="sleightOfHandProf">
                        <label for="sleightOfHandProf">Sleight of Hand (DEX)</label>
                        <span class="skill-mod" id="sleightOfHand">+0</span>
                        <button class="roll-btn-small" data-skill="sleightOfHand">Roll</button>
                    </div>
                    <div class="skill-item">
                        <input type="checkbox" id="stealthProf">
                        <label for="stealthProf">Stealth (DEX)</label>
                        <span class="skill-mod" id="stealth">+0</span>
                        <button class="roll-btn-small" data-skill="stealth">Roll</button>
                    </div>
                    <div class="skill-item">
                        <input type="checkbox" id="survivalProf">
                        <label for="survivalProf">Survival (WIS)</label>
                        <span class="skill-mod" id="survival">+0</span>
                        <button class="roll-btn-small" data-skill="survival">Roll</button>
                    </div>
                </div>
            </section>

            <!-- Attacks Section -->
            <section class="attacks-section">
                <h2>Attacks & Spells</h2>
                <button id="addAttackBtn" class="btn btn-secondary">Add Attack</button>
                <div id="attacksList"></div>
            </section>

            <!-- Class Features Section -->
            <section class="class-features-section">
                <h2>Class Features</h2>
                
                <!-- Divine Sense -->
                <div class="feature-tracker">
                    <h3>Divine Sense (3/day)</h3>
                    <p class="feature-description">Detect celestials, fiends, undead within 60 ft.</p>
                    <div class="use-tracker">
                        <input type="checkbox" id="divineSense1" class="use-checkbox">
                        <input type="checkbox" id="divineSense2" class="use-checkbox">
                        <input type="checkbox" id="divineSense3" class="use-checkbox">
                        <button class="btn-small btn-secondary" onclick="resetDivineSense()">Long Rest</button>
                    </div>
                </div>

                <!-- Lay on Hands -->
                <div class="feature-tracker">
                    <h3>Lay on Hands (15 HP Pool)</h3>
                    <p class="feature-description">Heal or cure disease/poison (5 HP to cure)</p>
                    <div class="hp-pool-tracker">
                        <label>Remaining HP:</label>
                        <input type="number" id="layOnHandsPool" value="15" min="0" max="15" class="pool-input">
                        <button class="btn-small btn-secondary" onclick="resetLayOnHands()">Long Rest</button>
                    </div>
                </div>

                <!-- Spellcasting -->
                <div class="feature-tracker">
                    <h3>Spellcasting (CHA + Prof)</h3>
                    <p class="feature-description">Prepared Spells: <span id="preparedSpellsCount">3</span> (CHA mod + 1)</p>
                    <div class="spell-slots">
                        <div class="spell-slot-level">
                            <label>1st Level Slots (4 total):</label>
                            <div class="use-tracker">
                                <input type="checkbox" id="spellSlot1_1" class="use-checkbox">
                                <input type="checkbox" id="spellSlot1_2" class="use-checkbox">
                                <input type="checkbox" id="spellSlot1_3" class="use-checkbox">
                                <input type="checkbox" id="spellSlot1_4" class="use-checkbox">
                                <button class="btn-small btn-secondary" onclick="resetSpellSlots()">Long Rest</button>
                            </div>
                        </div>
                    </div>
                    <div class="prepared-spells">
                        <label>Prepared Spells:</label>
                        <textarea id="preparedSpells" placeholder="List your prepared spells...
e.g., Bless, Cure Wounds, Shield of Faith"></textarea>
                    </div>
                </div>

                <!-- Divine Smite -->
                <div class="feature-tracker">
                    <h3>Divine Smite</h3>
                    <p class="feature-description">Expend spell slot to deal extra radiant damage on melee hit</p>
                    <div class="smite-calculator">
                        <label>Spell Slot Level:</label>
                        <select id="smiteLevel" class="smite-select">
                            <option value="1">1st Level (2d8)</option>
                            <option value="2">2nd Level (3d8)</option>
                            <option value="3">3rd Level (4d8)</option>
                            <option value="4">4th Level (5d8)</option>
                        </select>
                        <label>
                            <input type="checkbox" id="smiteUndead">
                            Target is undead/fiend (+1d8)
                        </label>
                        <button class="btn btn-primary" onclick="rollDivineSmite()">Roll Smite Damage</button>
                    </div>
                </div>

                <!-- Sacred Oath -->
                <div class="feature-tracker">
                    <h3>Sacred Oath: Oath of the Ancients</h3>
                    <p class="feature-description">Channel Divinity (1/short rest)</p>
                    <div class="oath-features">
                        <div class="channel-divinity">
                            <input type="checkbox" id="channelDivinity" class="use-checkbox">
                            <label for="channelDivinity">Channel Divinity Available</label>
                            <button class="btn-small btn-secondary" onclick="resetChannelDivinity()">Rest</button>
                        </div>
                        <div class="channel-options">
                            <div class="channel-option">
                                <strong>Nature's Wrath:</strong>
                                <p>Restrain a creature you can see within 10 ft. (STR/DEX save, DC <span id="spellSaveDC">13</span>)</p>
                            </div>
                            <div class="channel-option">
                                <strong>Turn the Faithless:</strong>
                                <p>Turn fey and fiends within 30 ft. (WIS save, DC <span id="spellSaveDC2">13</span>)</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Oath Spells -->
                <div class="feature-tracker">
                    <h3>Oath Spells (Always Prepared)</h3>
                    <ul class="oath-spells-list">
                        <li><strong>Ensnaring Strike</strong> - Restrain target with magical vines</li>
                        <li><strong>Speak with Animals</strong> - Communicate with beasts</li>
                    </ul>
                </div>
            </section>

            <!-- Notes Section -->
            <section class="notes-section">
                <h2>Features & Traits</h2>
                <textarea id="features" placeholder="Enter features, traits, and special abilities..."></textarea>
                
                <h2>Equipment</h2>
                <textarea id="equipment" placeholder="List your equipment and inventory..."></textarea>
                
                <h2>Notes</h2>
                <textarea id="notes" placeholder="Additional notes..."></textarea>
            </section>
        </main>

        <!-- Roll Result Modal -->
        <div id="rollModal" class="modal">
            <div class="modal-content">
                <span class="close">&times;</span>
                <div id="rollResult"></div>
            </div>
        </div>

        <!-- Gist Auth Modal -->
        <div id="gistModal" class="modal">
            <div class="modal-content">
                <span class="close-gist">&times;</span>
                <div id="gistContent">
                    <h3>GitHub Gist Integration</h3>
                    <p>To save/load your character to GitHub Gists, you need a Personal Access Token.</p>
                    <div class="form-group">
                        <label>GitHub Personal Access Token:</label>
                        <input type="password" id="githubToken" placeholder="ghp_xxxxxxxxxxxx">
                        <small>Need a token? <a href="https://github.com/settings/tokens/new?description=DnD%20Character%20Sheet&scopes=gist" target="_blank">Create one here</a> (requires 'gist' scope)</small>
                    </div>
                    <div class="form-group">
                        <label>
                            <input type="checkbox" id="rememberToken">
                            Remember token (stored locally)
                        </label>
                    </div>
                    <div class="gist-actions">
                        <button id="saveGistConfirm" class="btn btn-primary">Save to Gist</button>
                        <button id="loadGistConfirm" class="btn btn-secondary">Load from Gist</button>
                        <button id="cancelGist" class="btn btn-secondary">Cancel</button>
                    </div>
                    <div id="gistStatus"></div>
                    <div id="gistList"></div>
                </div>
            </div>
        </div>
    </div>

    <script src="app.js"></script>
</body>
</html>
