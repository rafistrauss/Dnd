import{O as J,W as ue,a0 as B,R as k,au as de,X as ke,d as I,k as Te,Z as xe,_ as Ce,$ as se,a1 as D,T as L,af as ve,aI as Ae,am as re,J as Ie,Q as Y,V as Ne,a3 as Oe,ad as ie,aG as pe,i as Me,aK as me,K as he,N as Le,aL as _e,aM as Be,aN as V,aC as z,aO as De,aP as Re,aF as He,M as $e,aQ as ge,q as Se,aR as Pe,aS as Ue,h as Je,Y as qe,aT as Ve,ay as Ge,e as Ke,b as We,aU as Xe,at as ye,aV as Ye,a2 as O,aW as R,aX as ze,B as Qe,F as Ze,G,I as $,H as P,E as je}from"./AJ6jX9JW.js";import{b as ea,f as be,a as M,s as aa,e as ta,t as K}from"./Bvl623tb.js";import{i as sa}from"./BkeYosbO.js";import{s as ra,i as W,a as ia}from"./950rBGDg.js";function Ia(a,e){return e}function na(a,e,s){for(var r=[],n=e.length,i=0;i<n;i++)De(e[i].e,r,!0);Re(r,()=>{var t=r.length===0&&s!==null;if(t){var f=s,o=f.parentNode;He(o),o.append(f),a.items.clear(),T(a,e[0].prev,e[n-1].next)}for(var u=0;u<n;u++){var c=e[u];t||(a.items.delete(c.k),T(a,c.prev,c.next)),$e(c.e,!t)}a.first===e[0]&&(a.first=e[0].prev)})}function la(a,e,s,r,n,i=null){var t=a,f=new Map,o=null,u=(e&ge)!==0,c=(e&_e)!==0,S=(e&me)!==0;if(u){var p=a;t=k?B(de(p)):p.appendChild(J())}k&&ke();var v=null,g=Te(()=>{var h=s();return Me(h)?h:h==null?[]:pe(h)}),d,l=!0;function m(){oa(_,d,t,e,r),v!==null&&(d.length===0?(v.fragment?(t.before(v.fragment),v.fragment=null):he(v.effect),y.first=v.effect):Le(v.effect,()=>{v=null}))}var y=ue(()=>{d=I(g);var h=d.length;let x=!1;if(k){var C=xe(t)===Ce;C!==(h===0)&&(t=se(),B(t),D(!1),x=!0)}for(var b=new Set,F=Ie,E=null,ee=Ne(),N=0;N<h;N+=1){k&&L.nodeType===ve&&L.data===Ae&&(t=L,x=!0,D(!1));var q=d[N],H=r(q,N),w=l?null:f.get(H);w?(c&&re(w.v,q),S?re(w.i,N):w.i=N,ee&&F.skipped_effects.delete(w.e)):(w=fa(l?t:null,E,q,H,N,n,e,s),l&&(w.o=!0,E===null?o=w:E.next=w,E=w),f.set(H,w)),b.add(H)}if(h===0&&i&&!v)if(l)v={fragment:null,effect:Y(()=>i(t))};else{var ae=document.createDocumentFragment(),te=J();ae.append(te),v={fragment:ae,effect:Y(()=>i(te))}}if(k&&h>0&&B(se()),!l)if(ee){for(const[Ee,we]of f)b.has(Ee)||F.skipped_effects.add(we.e);F.oncommit(m),F.ondiscard(()=>{})}else m();x&&D(!0),I(g)}),_={effect:y,items:f,first:o};l=!1,k&&(t=L)}function oa(a,e,s,r,n){var i=(r&Pe)!==0,t=e.length,f=a.items,o=a.first,u,c=null,S,p=[],v=[],g,d,l,m;if(i)for(m=0;m<t;m+=1)g=e[m],d=n(g,m),l=f.get(d),l.a?.measure(),(S??=new Set).add(l);for(m=0;m<t;m+=1){if(g=e[m],d=n(g,m),l=f.get(d),a.first??=l,!l.o){l.o=!0;var y=c?c.next:o;T(a,c,l),T(a,l,y),X(l,y,s),c=l,p=[],v=[],o=c.next;continue}if((l.e.f&V)!==0&&(he(l.e),i&&(l.a?.unfix(),(S??=new Set).delete(l))),l!==o){if(u!==void 0&&u.has(l)){if(p.length<v.length){var _=v[0],h;c=_.prev;var x=p[0],C=p[p.length-1];for(h=0;h<p.length;h+=1)X(p[h],_,s);for(h=0;h<v.length;h+=1)u.delete(v[h]);T(a,x.prev,C.next),T(a,c,x),T(a,C,_),o=_,c=C,m-=1,p=[],v=[]}else u.delete(l),X(l,o,s),T(a,l.prev,l.next),T(a,l,c===null?a.first:c.next),T(a,c,l),c=l;continue}for(p=[],v=[];o!==null&&o.k!==d;)(o.e.f&V)===0&&(u??=new Set).add(o),v.push(o),o=o.next;if(o===null)continue;l=o}p.push(l),c=l,o=l.next}if(o!==null||u!==void 0){for(var b=u===void 0?[]:pe(u);o!==null;)(o.e.f&V)===0&&b.push(o),o=o.next;var F=b.length;if(F>0){var E=(r&ge)!==0&&t===0?s:null;if(i){for(m=0;m<F;m+=1)b[m].a?.measure();for(m=0;m<F;m+=1)b[m].a?.fix()}na(a,b,E)}}i&&Se(()=>{if(S!==void 0)for(l of S)l.a?.apply()})}function fa(a,e,s,r,n,i,t,f){var o=(t&_e)!==0,u=(t&Be)===0,c=o?u?Oe(s,!1,!1):ie(s):s,S=(t&me)===0?n:ie(n),p={i:S,v:c,k:r,a:null,e:null,o:!1,prev:e,next:null};try{if(a===null){var v=document.createDocumentFragment();v.append(a=J())}return p.e=Y(()=>i(a,c,S,f)),e!==null&&(e.next=p),p}finally{}}function X(a,e,s){for(var r=a.next?a.next.e.nodes_start:s,n=e?e.e.nodes_start:s,i=a.e.nodes_start;i!==null&&i!==r;){var t=z(i);n.before(i),i=t}}function T(a,e,s){e===null?(a.first=s,a.effect.first=s&&s.e):(e.e.next&&(e.e.next.prev=null),e.next=s,e.e.next=s&&s.e),s===null?a.effect.last=e&&e.e:(s.e.prev&&(s.e.prev.next=null),s.prev=e,s.e.prev=e&&e.e)}function Na(a,e){let s=null,r=k;var n;if(k){s=L;for(var i=de(document.head);i!==null&&(i.nodeType!==ve||i.data!==a);)i=z(i);if(i===null)D(!1);else{var t=z(i);i.remove(),B(t)}}k||(n=document.head.appendChild(J()));try{ue(()=>e(n),Ue)}finally{r&&(D(!0),B(s))}}const ne=[...` 	
\r\f \v\uFEFF`];function ca(a,e,s){var r=a==null?"":""+a;if(e&&(r=r?r+" "+e:e),s){for(var n in s)if(s[n])r=r?r+" "+n:n;else if(r.length)for(var i=n.length,t=0;(t=r.indexOf(n,t))>=0;){var f=t+i;(t===0||ne.includes(r[t-1]))&&(f===r.length||ne.includes(r[f]))?r=(t===0?"":r.substring(0,t))+r.substring(f+1):t=f}}return r===""?null:r}function ua(a,e,s,r,n,i){var t=a.__className;if(k||t!==s||t===void 0){var f=ca(s,r,i);(!k||f!==a.getAttribute("class"))&&(f==null?a.removeAttribute("class"):a.className=f),a.__className=s}else if(i&&n!==i)for(var o in i){var u=!!i[o];(n==null||u!==!!n[o])&&a.classList.toggle(o,u)}return i}const da=()=>performance.now(),A={tick:a=>requestAnimationFrame(a),now:()=>da(),tasks:new Set};function Fe(){const a=A.now();A.tasks.forEach(e=>{e.c(a)||(A.tasks.delete(e),e.f())}),A.tasks.size!==0&&A.tick(Fe)}function va(a){let e;return A.tasks.size===0&&A.tick(Fe),{promise:new Promise(s=>{A.tasks.add(e={c:a,f:s})}),abort(){A.tasks.delete(e)}}}function U(a,e){ye(()=>{a.dispatchEvent(new CustomEvent(e))})}function pa(a){if(a==="float")return"cssFloat";if(a==="offset")return"cssOffset";if(a.startsWith("--"))return a;const e=a.split("-");return e.length===1?e[0]:e[0]+e.slice(1).map(s=>s[0].toUpperCase()+s.slice(1)).join("")}function le(a){const e={},s=a.split(";");for(const r of s){const[n,i]=r.split(":");if(!n||i===void 0)break;const t=pa(n.trim());e[t]=i.trim()}return e}const ma=a=>a;function ha(a,e,s,r){var n=(a&Xe)!==0,i="both",t,f=e.inert,o=e.style.overflow,u,c;function S(){return ye(()=>t??=s()(e,r?.()??{},{direction:i}))}var p={is_global:n,in(){e.inert=f,U(e,"introstart"),u=Q(e,S(),c,1,()=>{U(e,"introend"),u?.abort(),u=t=void 0,e.style.overflow=o})},out(l){e.inert=!0,U(e,"outrostart"),c=Q(e,S(),u,0,()=>{U(e,"outroend"),l?.()})},stop:()=>{u?.abort(),c?.abort()}},v=Je;if((v.transitions??=[]).push(p),ea){var g=n;if(!g){for(var d=v.parent;d&&(d.f&qe)!==0;)for(;(d=d.parent)&&(d.f&Ve)===0;);g=!d||(d.f&Ge)!==0}g&&Ke(()=>{We(()=>p.in())})}}function Q(a,e,s,r,n){var i=r===1;if(Ye(e)){var t,f=!1;return Se(()=>{if(!f){var l=e({direction:i?"in":"out"});t=Q(a,l,s,r,n)}}),{abort:()=>{f=!0,t?.abort()},deactivate:()=>t.deactivate(),reset:()=>t.reset(),t:()=>t.t()}}if(s?.deactivate(),!e?.duration)return n(),{abort:O,deactivate:O,reset:O,t:()=>r};const{delay:o=0,css:u,tick:c,easing:S=ma}=e;var p=[];if(i&&s===void 0&&(c&&c(0,1),u)){var v=le(u(0,1));p.push(v,v)}var g=()=>1-r,d=a.animate(p,{duration:o,fill:"forwards"});return d.onfinish=()=>{d.cancel();var l=s?.t()??1-r;s?.abort();var m=r-l,y=e.duration*Math.abs(m),_=[];if(y>0){var h=!1;if(u)for(var x=Math.ceil(y/16.666666666666668),C=0;C<=x;C+=1){var b=l+m*S(C/x),F=le(u(b,1-b));_.push(F),h||=F.overflow==="hidden"}h&&(a.style.overflow="hidden"),g=()=>{var E=d.currentTime;return l+m*S(E/y)},c&&va(()=>{if(d.playState!=="running")return!1;var E=g();return c(E,1-E),!0})}d=a.animate(_,{duration:y,fill:"forwards"}),d.onfinish=()=>{g=()=>r,c?.(r,1-r),n()}},{abort:()=>{d&&(d.cancel(),d.effect=null,d.onfinish=O)},deactivate:()=>{n=O},reset:()=>{r===0&&c?.(1,0)},t:()=>g()}}function _a(){const{subscribe:a,update:e}=R([]);let s=0;return{subscribe:a,add:(r,n="info",i=3e3)=>{const t=s++,f={id:t,message:r,type:n,duration:i};e(o=>[...o,f]),i>0&&setTimeout(()=>{e(o=>o.filter(u=>u.id!==t))},i)},remove:r=>{e(n=>n.filter(i=>i.id!==r))},clear:()=>{e(()=>[])}}}const oe=_a(),Z={name:"",class:"",subclass:"",level:1,race:"",background:"",alignment:"",armorClass:10,initiative:0,speed:"30 ft",currentHP:0,maxHP:0,tempHP:0,hitDice:{current:3,max:3},abilities:{strength:10,dexterity:10,constitution:10,intelligence:10,wisdom:10,charisma:10},proficiencyBonus:2,saveProficiencies:{strength:!1,dexterity:!1,constitution:!1,intelligence:!1,wisdom:!1,charisma:!1},skillProficiencies:{acrobatics:!1,animalHandling:!1,arcana:!1,athletics:!1,deception:!1,history:!1,insight:!1,intimidation:!1,investigation:!1,medicine:!1,nature:!1,perception:!1,performance:!1,persuasion:!1,religion:!1,sleightOfHand:!1,stealth:!1,survival:!1},attacks:[],features:"",equipment:"",notes:"",classFeatures:{features:{},spellSlots:[],spellSlotsByLevel:{},preparedSpells:""}};function ga(){try{const a=localStorage.getItem("dndCharacter");if(a){const e={...Z,...JSON.parse(a)};return!e.attacks||!Array.isArray(e.attacks)?e.attacks=[]:e.attacks=e.attacks.map(s=>({...s,id:s.id||crypto.randomUUID()})),e.classFeatures?(e.classFeatures.features||(e.classFeatures.features={}),e.classFeatures.spellSlots||(e.classFeatures.spellSlots=[]),e.classFeatures.spellSlotsByLevel||(e.classFeatures.spellSlotsByLevel={}),e.classFeatures.preparedSpells===void 0&&(e.classFeatures.preparedSpells="")):e.classFeatures={features:{},spellSlots:[],spellSlotsByLevel:{},preparedSpells:""},e}}catch(a){console.error("Failed to load character from storage:",a)}return Z}const j=R(ga());j.subscribe(a=>{try{localStorage.setItem("dndCharacter",JSON.stringify(a))}catch(e){console.error("Failed to save character to storage:",e)}});const fe=R(!0);{const a=localStorage.getItem("dndMode");fe.set(a==="edit"),fe.subscribe(e=>{localStorage.setItem("dndMode",e?"edit":"use")})}const Oa=ze(j,a=>{const e=s=>Math.floor((s-10)/2);return{strength:e(a.abilities.strength),dexterity:e(a.abilities.dexterity),constitution:e(a.abilities.constitution),intelligence:e(a.abilities.intelligence),wisdom:e(a.abilities.wisdom),charisma:e(a.abilities.charisma)}});function Sa(a){return Math.ceil(a/4)+1}function Ma(){j.update(a=>(a.proficiencyBonus=Sa(a.level),a))}function La(a){const e=JSON.stringify(a,null,2),s="data:application/json;charset=utf-8,"+encodeURIComponent(e),r=`${a.name||"character"}_${new Date().toISOString().split("T")[0]}.json`,n=document.createElement("a");n.setAttribute("href",s),n.setAttribute("download",r),n.click()}function Ba(a){return new Promise((e,s)=>{const r=new FileReader;r.onload=n=>{try{const i=JSON.parse(n.target?.result),t={...Z,...i};t.attacks&&Array.isArray(t.attacks)&&(t.attacks=t.attacks.map(f=>({...f,id:f.id||crypto.randomUUID()}))),t.classFeatures?(t.classFeatures.features||(t.classFeatures.features={}),t.classFeatures.spellSlots||(t.classFeatures.spellSlots=[]),t.classFeatures.spellSlotsByLevel||(t.classFeatures.spellSlotsByLevel={}),t.classFeatures.preparedSpells===void 0&&(t.classFeatures.preparedSpells="")):t.classFeatures={features:{},spellSlots:[],spellSlotsByLevel:{},preparedSpells:""},e(t)}catch{s(new Error("Invalid character file"))}},r.onerror=()=>s(new Error("Failed to read file")),r.readAsText(a)})}const Da=R("");function ya(){try{const a=localStorage.getItem("dndCollapsedStates");if(a)return JSON.parse(a)}catch(a){console.error("Failed to load collapsed states:",a)}return{characterInfo:!1,combatStats:!1,abilityScores:!1,skills:!1,attacks:!1,classFeatures:!1,notes:!1}}const ba=R(ya());ba.subscribe(a=>{try{localStorage.setItem("dndCollapsedStates",JSON.stringify(a))}catch(e){console.error("Failed to save collapsed states:",e)}});function Fa(a){const e=a-1;return e*e*e+1}function ce(a){const e=typeof a=="string"&&a.match(/^\s*(-?[\d.]+)([^\s]*)\s*$/);return e?[parseFloat(e[1]),e[2]||"px"]:[a,"px"]}function Ea(a,{delay:e=0,duration:s=400,easing:r=Fa,x:n=0,y:i=0,opacity:t=0}={}){const f=getComputedStyle(a),o=+f.opacity,u=f.transform==="none"?"":f.transform,c=o*(1-t),[S,p]=ce(n),[v,g]=ce(i);return{delay:e,duration:s,easing:r,css:(d,l)=>`
			transform: ${u} translate(${(1-d)*S}${p}, ${(1-d)*v}${g});
			opacity: ${o-c*l}`}}var wa=be('<div><span class="toast-icon svelte-1cpok13"><!> <!> <!></span> <span class="toast-message svelte-1cpok13"> </span> <button class="toast-close svelte-1cpok13" aria-label="Close notification">×</button></div>'),ka=be('<div class="toast-container svelte-1cpok13"></div>');function Ra(a,e){Qe(e,!1);const s=()=>ia(oe,"$toasts",r),[r,n]=ra();sa();var i=ka();la(i,5,s,t=>t.id,(t,f)=>{var o=wa(),u=G(o),c=G(u);{var S=_=>{var h=K("✓");M(_,h)};W(c,_=>{I(f).type==="success"&&_(S)})}var p=$(c,2);{var v=_=>{var h=K("✕");M(_,h)};W(p,_=>{I(f).type==="error"&&_(v)})}var g=$(p,2);{var d=_=>{var h=K("ℹ");M(_,h)};W(g,_=>{I(f).type==="info"&&_(d)})}P(u);var l=$(u,2),m=G(l,!0);P(l);var y=$(l,2);P(o),je(()=>{ua(o,1,`toast toast-${I(f).type??""}`,"svelte-1cpok13"),aa(m,I(f).message)}),ta("click",y,()=>oe.remove(I(f).id)),ha(3,o,()=>Ea,()=>({y:-50,duration:300})),M(t,o)}),P(i),M(a,i),Ze(),n()}export{Ra as T,ba as a,ua as b,j as c,Oa as d,la as e,fe as f,La as g,Na as h,Ia as i,Ba as j,Da as s,oe as t,Ma as u};
