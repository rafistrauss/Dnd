import{K as _,M as g,N as h,O as y,Q as b,R as p,T as l,U as k,V as T,W as w,X as A,Y as E,Z as M,_ as N,$ as S,a0 as R,a1 as D,a2 as v,a3 as m,a4 as F,a5 as x,a6 as O,f as U,a7 as B,s as C,a8 as I}from"./TSJapsqm.js";class Y{anchor;#s=new Map;#t=new Map;#e=new Map;#a=new Set;#r=!0;constructor(e,t=!0){this.anchor=e,this.#r=t}#i=()=>{var e=_;if(this.#s.has(e)){var t=this.#s.get(e),s=this.#t.get(t);if(s)g(s),this.#a.delete(t);else{var n=this.#e.get(t);n&&(this.#t.set(t,n.effect),this.#e.delete(t),n.fragment.lastChild.remove(),this.anchor.before(n.fragment),s=n.effect)}for(const[r,i]of this.#s){if(this.#s.delete(r),r===e)break;const f=this.#e.get(i);f&&(h(f.effect),this.#e.delete(i))}for(const[r,i]of this.#t){if(r===t||this.#a.has(r))continue;const f=()=>{if(Array.from(this.#s.values()).includes(r)){var o=document.createDocumentFragment();T(i,o),o.append(b()),this.#e.set(r,{effect:i,fragment:o})}else h(i);this.#a.delete(r),this.#t.delete(r)};this.#r||!s?(this.#a.add(r),y(i,f,!1)):f()}}};#n=e=>{this.#s.delete(e);const t=Array.from(this.#s.values());for(const[s,n]of this.#e)t.includes(s)||(h(n.effect),this.#e.delete(s))};ensure(e,t){var s=_,n=w();if(t&&!this.#t.has(e)&&!this.#e.has(e))if(n){var r=document.createDocumentFragment(),i=b();r.append(i),this.#e.set(e,{effect:p(()=>t(i)),fragment:r})}else this.#t.set(e,p(()=>t(this.anchor)));if(this.#s.set(s,e),n){for(const[f,c]of this.#t)f===e?s.skipped_effects.delete(c):s.skipped_effects.add(c);for(const[f,c]of this.#e)f===e?s.skipped_effects.delete(c.effect):s.skipped_effects.add(c.effect);s.oncommit(this.#i),s.ondiscard(this.#n)}else l&&(this.anchor=k),this.#i()}}function K(a,e,t=!1){l&&E();var s=new Y(a),n=t?M:0;function r(i,f){if(l){const o=N(a)===S;if(i===o){var c=R();D(c),s.anchor=c,v(!1),s.ensure(i,f),v(!0);return}}s.ensure(i,f)}A(()=>{var i=!1;e((f,c=!0)=>{i=!0,r(c,f)}),i||r(!1,null)},n)}let u=!1,d=Symbol();function L(a,e,t){const s=t[e]??={store:null,source:F(void 0),unsubscribe:m};if(s.store!==a&&!(d in t))if(s.unsubscribe(),s.store=a??null,a==null)s.source.v=void 0,s.unsubscribe=m;else{var n=!0;s.unsubscribe=x(a,r=>{n?s.source.v=r:C(s.source,r)}),n=!1}return a&&d in t?O(a):U(s.source)}function $(a,e){return a.set(e),e}function P(a,e){var t=a[e];t.store!==null&&$(t.store,t.source.v)}function Q(){const a={};function e(){B(()=>{for(var t in a)a[t].unsubscribe();I(a,d,{enumerable:!1,value:!0})})}return[a,e]}function V(a,e,t){return a.set(t),e}function W(a){var e=u;try{return u=!1,[a(),u]}finally{u=e}}export{Y as B,L as a,V as b,W as c,P as d,$ as e,K as i,Q as s};
